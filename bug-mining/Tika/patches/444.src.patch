diff --git a/tika-app/src/main/java/org/apache/tika/cli/TikaCLI.java b/tika-app/src/main/java/org/apache/tika/cli/TikaCLI.java
index 1ab4df9cc..073eed38f 100644
--- a/tika-app/src/main/java/org/apache/tika/cli/TikaCLI.java
+++ b/tika-app/src/main/java/org/apache/tika/cli/TikaCLI.java
@@ -705,7 +705,7 @@ public class TikaCLI {
             }
 
             String relID = metadata.get(Metadata.EMBEDDED_RELATIONSHIP_ID);
-            if (relID != null) {
+            if (relID != null && !name.startsWith(relID)) {
               name = relID + "_" + name;
             }
 
diff --git a/tika-app/src/test/java/org/apache/tika/cli/TikaCLITest.java b/tika-app/src/test/java/org/apache/tika/cli/TikaCLITest.java
index 031d4cbc1..d5366178f 100644
--- a/tika-app/src/test/java/org/apache/tika/cli/TikaCLITest.java
+++ b/tika-app/src/test/java/org/apache/tika/cli/TikaCLITest.java
@@ -188,7 +188,7 @@ public class TikaCLITest extends TestCase{
             // ChemDraw file
             File expected1 = new File(tempFile, "MBD002B040A.cdx");
             // OLE10Native
-            File expected2 = new File(tempFile, "file5");
+            File expected2 = new File(tempFile, "MBD002B0FA6_file5");
             // Image of one of the embedded resources
             File expected3 = new File(tempFile, "file0.emf");
             
diff --git a/tika-parsers/src/main/java/org/apache/tika/parser/microsoft/AbstractPOIFSExtractor.java b/tika-parsers/src/main/java/org/apache/tika/parser/microsoft/AbstractPOIFSExtractor.java
index eb9516bd8..e7b0dcd8e 100644
--- a/tika-parsers/src/main/java/org/apache/tika/parser/microsoft/AbstractPOIFSExtractor.java
+++ b/tika-parsers/src/main/java/org/apache/tika/parser/microsoft/AbstractPOIFSExtractor.java
@@ -84,7 +84,8 @@ abstract class AbstractPOIFSExtractor {
     }
     
     protected void handleEmbeddedResource(TikaInputStream resource, String filename,
-          String mediaType, XHTMLContentHandler xhtml, boolean outputHtml)
+                                          String relationshipID, String mediaType, XHTMLContentHandler xhtml,
+                                          boolean outputHtml)
           throws IOException, SAXException, TikaException {
        try {
            Metadata metadata = new Metadata();
@@ -92,6 +93,9 @@ abstract class AbstractPOIFSExtractor {
                metadata.set(Metadata.TIKA_MIME_FILE, filename);
                metadata.set(Metadata.RESOURCE_NAME_KEY, filename);
            }
+           if (relationshipID != null) {
+               metadata.set(Metadata.EMBEDDED_RELATIONSHIP_ID, relationshipID);
+           }
            if(mediaType != null) {
                metadata.set(Metadata.CONTENT_TYPE, mediaType);
            }
@@ -122,7 +126,7 @@ abstract class AbstractPOIFSExtractor {
             try {
                 ZipContainerDetector detector = new ZipContainerDetector();
                 MediaType type = detector.detect(stream, new Metadata());
-                handleEmbeddedResource(stream, null, type.toString(), xhtml, true);
+                handleEmbeddedResource(stream, null, dir.getName(), type.toString(), xhtml, true);
                 return;
             } finally {
                 stream.close();
@@ -133,6 +137,7 @@ abstract class AbstractPOIFSExtractor {
 
         // What kind of document is it?
         Metadata metadata = new Metadata();
+        metadata.set(Metadata.EMBEDDED_RELATIONSHIP_ID, dir.getName());
         POIFSDocumentType type = POIFSDocumentType.detectType(dir);
         TikaInputStream embedded = null;
 
diff --git a/tika-parsers/src/main/java/org/apache/tika/parser/microsoft/ExcelExtractor.java b/tika-parsers/src/main/java/org/apache/tika/parser/microsoft/ExcelExtractor.java
index 1fa83a0e3..bf3d2e752 100644
--- a/tika-parsers/src/main/java/org/apache/tika/parser/microsoft/ExcelExtractor.java
+++ b/tika-parsers/src/main/java/org/apache/tika/parser/microsoft/ExcelExtractor.java
@@ -577,7 +577,7 @@ public class ExcelExtractor extends AbstractPOIFSExtractor {
                     
                     // Handle the embeded resource
                     extractor.handleEmbeddedResource(
-                          stream, null, mimeType,
+                          stream, null, null, mimeType,
                           handler, true
                     );
                  }
diff --git a/tika-parsers/src/main/java/org/apache/tika/parser/microsoft/HSLFExtractor.java b/tika-parsers/src/main/java/org/apache/tika/parser/microsoft/HSLFExtractor.java
index 98e845a2e..92c4febf0 100644
--- a/tika-parsers/src/main/java/org/apache/tika/parser/microsoft/HSLFExtractor.java
+++ b/tika-parsers/src/main/java/org/apache/tika/parser/microsoft/HSLFExtractor.java
@@ -202,7 +202,7 @@ public class HSLFExtractor extends AbstractPOIFSExtractor {
             }
 
             handleEmbeddedResource(
-                  TikaInputStream.get(pic.getData()), null,
+                  TikaInputStream.get(pic.getData()), null, null,
                   mediaType, xhtml, false);
         }
     }
@@ -234,7 +234,7 @@ public class HSLFExtractor extends AbstractPOIFSExtractor {
                         mediaType = "application/vnd.ms-excel";
                      }
                      handleEmbeddedResource(
-                           stream, Integer.toString(oleShape.getObjectID()),
+                           stream, Integer.toString(oleShape.getObjectID()), null,
                            mediaType, xhtml, false);
                   } finally {
                      stream.close();
diff --git a/tika-parsers/src/main/java/org/apache/tika/parser/microsoft/OutlookExtractor.java b/tika-parsers/src/main/java/org/apache/tika/parser/microsoft/OutlookExtractor.java
index eda5f4870..ae3b02fcd 100644
--- a/tika-parsers/src/main/java/org/apache/tika/parser/microsoft/OutlookExtractor.java
+++ b/tika-parsers/src/main/java/org/apache/tika/parser/microsoft/OutlookExtractor.java
@@ -234,7 +234,7 @@ public class OutlookExtractor extends AbstractPOIFSExtractor {
                if(attachment.attachData != null) {
                   handleEmbeddedResource(
                         TikaInputStream.get(attachment.attachData.getValue()),
-                        filename,
+                        filename, null,
                         null, xhtml, true
                   );
                }
diff --git a/tika-parsers/src/main/java/org/apache/tika/parser/microsoft/WordExtractor.java b/tika-parsers/src/main/java/org/apache/tika/parser/microsoft/WordExtractor.java
index ea316a83c..1c5335350 100644
--- a/tika-parsers/src/main/java/org/apache/tika/parser/microsoft/WordExtractor.java
+++ b/tika-parsers/src/main/java/org/apache/tika/parser/microsoft/WordExtractor.java
@@ -196,8 +196,8 @@ public class WordExtractor extends AbstractPOIFSExtractor {
              Field field = document.getFields().getFieldByStartOffset(FieldsDocumentPart.MAIN,
                                                                       cr.getStartOffset());
              if (field != null && field.getType() == 58) {
-                // Embedded Object: add a <div
-               // embedded="name"/> so consumer can see where
+               // Embedded Object: add a <div
+               // class="embedded" id="_X"/> so consumer can see where
                // in the main text each embedded document
                // occurred:
                String id = "_" + field.getMarkSeparatorCharacterRun(r).getPicOffset();
@@ -422,7 +422,7 @@ public class WordExtractor extends AbstractPOIFSExtractor {
        // (Only expose each individual image once) 
        if(! pictures.hasOutput(picture)) {
           TikaInputStream stream = TikaInputStream.get(picture.getContent());
-          handleEmbeddedResource(stream, filename, mimeType, xhtml, false);
+          handleEmbeddedResource(stream, filename, null, mimeType, xhtml, false);
           pictures.recordOutput(picture);
        }
     }
