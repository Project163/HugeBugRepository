diff --git a/src/changes/changes.xml b/src/changes/changes.xml
index 06fff91..d7d6db0 100644
--- a/src/changes/changes.xml
+++ b/src/changes/changes.xml
@@ -47,7 +47,10 @@
         Only set the global shutdown event if the event is created.
       </action>
       <action issue="DAEMON-379" type="fix" dev="sebb">
-        Unable to build with java-9 using ant; dropped Ant build files
+        Unable to build with Java 9 using ant; dropped Ant build files
+      </action>
+      <action issue="DAEMON-384" type="fix" dev="ggregory" due-to="blassmegod">
+        prunsrv stopping with error due to hardcoded timeout.
       </action>
     </release>
     <release version="1.1.0" date="2017-11-15" description="Feature and bug fix release">
diff --git a/src/native/windows/apps/prunsrv/prunsrv.c b/src/native/windows/apps/prunsrv/prunsrv.c
index bd46ec1..1fb6de3 100644
--- a/src/native/windows/apps/prunsrv/prunsrv.c
+++ b/src/native/windows/apps/prunsrv/prunsrv.c
@@ -1353,7 +1353,12 @@ void WINAPI service_ctrl_handler(DWORD dwCtrlCode)
         case SERVICE_CONTROL_SHUTDOWN:
             apxLogWrite(APXLOG_MARK_INFO "Service SHUTDOWN signalled");
         case SERVICE_CONTROL_STOP:
-            reportServiceStatus(SERVICE_STOP_PENDING, NO_ERROR, 3 * 1000);
+            if (SO_STOPTIMEOUT > 0) {
+                reportServiceStatus(SERVICE_STOP_PENDING, NO_ERROR, SO_STOPTIMEOUT * 1000);
+            }
+            else {
+                reportServiceStatus(SERVICE_STOP_PENDING, NO_ERROR, 3 * 1000);
+            }
             /* Stop the service asynchronously */
             stopThread = CreateThread(NULL, 0,
                                       serviceStop,
