diff --git a/src/changes/changes.xml b/src/changes/changes.xml
index 5dff7f2..2fafd97 100644
--- a/src/changes/changes.xml
+++ b/src/changes/changes.xml
@@ -104,6 +104,10 @@
         Procrun. Change the default service user from LocalSystem to
         'NT Authority\LocalService'.
       </action>
+      <action issue="DAEMON-402" yype="fix" dev="markt" due-to="Iode Leroy">
+        Procrun. Avoid a crash on shutdown if multiple WM_CLOSE messages are
+        received.
+      </action>
     </release>
     <release version="1.1.0" date="2017-11-15" description="Feature and bug fix release">
       <action issue="DAEMON-368" type="add" dev="ggregory">
diff --git a/src/native/windows/src/rprocess.c b/src/native/windows/src/rprocess.c
index 1b58bfe..727ff18 100644
--- a/src/native/windows/src/rprocess.c
+++ b/src/native/windows/src/rprocess.c
@@ -376,6 +376,8 @@ static BOOL __apxProcessCallback(APXHANDLE hObject, UINT uMsg,
         (*lpProc->fnUserCallback)(hObject, uMsg, wParam, lParam);
     switch (uMsg) {
         case WM_CLOSE:
+        	/* Avoid processing the WM_CLOSE message multiple times */
+        	if (lpProc->stProcInfo.hProcess == NULL) break;
             if (lpProc->dwChildStatus & CHILD_RUNNING) {
                 __apxProcessClose(hObject);
                 /* Wait for all worker threads to exit */
