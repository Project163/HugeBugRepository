diff --git a/tika-core/src/main/java/org/apache/tika/mime/ProbabilisticMimeDetectionSelector.java b/tika-core/src/main/java/org/apache/tika/mime/ProbabilisticMimeDetectionSelector.java
index c317735dd..f0f38690a 100644
--- a/tika-core/src/main/java/org/apache/tika/mime/ProbabilisticMimeDetectionSelector.java
+++ b/tika-core/src/main/java/org/apache/tika/mime/ProbabilisticMimeDetectionSelector.java
@@ -20,15 +20,11 @@ import java.io.IOException;
 import java.io.InputStream;
 import java.net.URI;
 import java.net.URISyntaxException;
+import java.util.ArrayList;
 import java.util.List;
 
 import org.apache.tika.detect.Detector;
 import org.apache.tika.metadata.Metadata;
-import org.apache.tika.mime.MediaType;
-import org.apache.tika.mime.MediaTypeRegistry;
-import org.apache.tika.mime.MimeType;
-import org.apache.tika.mime.MimeTypeException;
-import org.apache.tika.mime.MimeTypes;
 
 /**
  * Selector for combining different mime detection results
@@ -128,14 +124,16 @@ public class ProbabilisticMimeDetectionSelector implements Detector {
 
     public MediaType detect(InputStream input, Metadata metadata)
             throws IOException {
-        List<MimeType> possibleTypes = null;
+
+        List<MimeType> possibleTypes = new ArrayList<>();
 
         // Get type based on magic prefix
         if (input != null) {
             input.mark(mimeTypes.getMinLength());
             try {
                 byte[] prefix = mimeTypes.readMagicHeader(input);
-                possibleTypes = mimeTypes.getMimeType(prefix);
+                //defensive copy
+                possibleTypes.addAll(mimeTypes.getMimeType(prefix));
             } finally {
                 input.reset();
             }
diff --git a/tika-core/src/test/java/org/apache/tika/mime/ProbabilisticMimeDetectionTest.java b/tika-core/src/test/java/org/apache/tika/mime/ProbabilisticMimeDetectionTest.java
index 35c75b780..ecd3330ba 100644
--- a/tika-core/src/test/java/org/apache/tika/mime/ProbabilisticMimeDetectionTest.java
+++ b/tika-core/src/test/java/org/apache/tika/mime/ProbabilisticMimeDetectionTest.java
@@ -26,6 +26,7 @@ import java.io.ByteArrayInputStream;
 import java.io.IOException;
 import java.io.InputStream;
 import java.net.URL;
+import java.nio.charset.StandardCharsets;
 
 import org.apache.tika.metadata.Metadata;
 import org.junit.Before;
@@ -246,4 +247,18 @@ public class ProbabilisticMimeDetectionTest {
         assertEquals(helloXType, proDetector.detect(
                 new ByteArrayInputStream(helloWorld), metadata));
     }
+
+    @Test
+    public void testTIKA2237() throws IOException {
+        Metadata metadata = new Metadata();
+        metadata.add(Metadata.CONTENT_TYPE, MediaType.text("javascript").toString());
+        InputStream input = new ByteArrayInputStream(("function() {};\n" +
+                "try {\n" +
+                "    window.location = 'index.html';\n" +
+                "} catch (e) {\n" +
+                "    console.log(e);\n" +
+                "}").getBytes(StandardCharsets.UTF_8));
+        MediaType detect = new ProbabilisticMimeDetectionSelector().detect(input, metadata);
+        assertEquals(MediaType.application("javascript"), detect);
+    }
 }
