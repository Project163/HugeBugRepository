<!--
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Thu Oct 23 09:41:01 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<!-- If you wish to do custom client-side styling of RSS, uncomment this:
<?xml-stylesheet href="https://issues.apache.org/jira/styles/jiraxml2html.xsl" type="text/xsl"?>
-->
<rss version="0.92">
    <channel>
        <title>ASF JIRA</title>
        <link>https://issues.apache.org/jira/issues/?jql=project+%3D+%22DBCP%22+AND+issuetype+%3D+Bug+ORDER+BY+key+DESC</link>
        <description>An XML representation of a search request</description>
                <language>en-uk</language>
                        <issue start="200" end="400" total="400"/>
                <build-info>
            <version>8.20.10</version>
            <build-number>820010</build-number>
            <build-date>22-06-2022</build-date>
        </build-info>

<item>
            <title>[DBCP-277] DBCP Locking Up</title>
                <link>https://issues.apache.org/jira/browse/DBCP-277</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;We had hanging threads that stalled in SocketInputStream.socketRead0 via Oracle-JDBC-Driver in our tomcat. &lt;br/&gt;
Because we found &lt;a href=&quot;https://issues.apache.org/jira/browse/DBCP-28&quot; title=&quot;[dbcp][PATCH] Connection leak in PoolableConnection.close() (Oracle 10g driver)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DBCP-28&quot;&gt;&lt;del&gt;DBCP-28&lt;/del&gt;&lt;/a&gt;, we decided to update to version 1.2.2 of commons-dbcp.&lt;br/&gt;
Since that our Problems got worse because we experience some sort of deadlock in commons-dbcp. &lt;br/&gt;
Thread-Dumps after a nightly loadtest expose that threads got stuck in GenericObjectPool.returnObject, while others wait in borrowObject. &lt;br/&gt;
We stopped the load and waited for hours. The thread-dump still looks the same:&lt;/p&gt;

&lt;p&gt;&quot;TP-Processor1361&quot; daemon prio=1 tid=0x67379fb8 nid=0x36e9 waiting for monitor entry &lt;span class=&quot;error&quot;&gt;&amp;#91;0x5f5cb000..0x5f5cc0c0&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at org.apache.commons.pool.impl.GenericObjectPool.returnObject(GenericObjectPool.java:916)&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;waiting to lock &amp;lt;0x716c4e50&amp;gt; (a org.apache.commons.pool.impl.GenericObjectPool)&lt;br/&gt;
	at org.apache.commons.dbcp.PoolableConnection.close(PoolableConnection.java:87)&lt;/li&gt;
	&lt;li&gt;locked &amp;lt;0x7a6d0408&amp;gt; (a org.apache.commons.dbcp.PoolableConnection)&lt;br/&gt;
	at org.apache.commons.dbcp.PoolingDataSource$PoolGuardConnectionWrapper.close(PoolingDataSource.java:181)&lt;br/&gt;
	at org.springframework.orm.hibernate3.LocalDataSourceConnectionProvider.closeConnection(LocalDataSourceConnectionProvider.java:96)&lt;br/&gt;
	at org.hibernate.jdbc.ConnectionManager.closeConnection(ConnectionManager.java:451)&lt;br/&gt;
	at org.hibernate.jdbc.ConnectionManager.cleanup(ConnectionManager.java:385)&lt;br/&gt;
	at org.hibernate.jdbc.ConnectionManager.close(ConnectionManager.java:324)&lt;br/&gt;
	at org.hibernate.impl.SessionImpl.close(SessionImpl.java:298)&lt;br/&gt;
	at org.springframework.orm.hibernate3.SessionFactoryUtils.closeSession(SessionFactoryUtils.java:774)&lt;br/&gt;
	at org.springframework.orm.hibernate3.SessionFactoryUtils.closeSessionOrRegisterDeferredClose(SessionFactoryUtils.java:760)&lt;br/&gt;
	at org.springframework.orm.hibernate3.HibernateTransactionManager.doCleanupAfterCompletion(HibernateTransactionManager.java:674)&lt;br/&gt;
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.cleanupAfterCompletion(AbstractPlatformTransactionManager.java:966)&lt;br/&gt;
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:759)&lt;br/&gt;
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:678)&lt;br/&gt;
...&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;The same issue was already discussed on the mailing-list so we are not the only ones with this problem:&lt;br/&gt;
&lt;a href=&quot;http://mail-archives.apache.org/mod_mbox/commons-user/200712.mbox/%3C5611A9EAACBFF444BE35BF1DAAB314DDE2A71F@DKKOB2101MB.tsden.tcad.telia.se%3E&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://mail-archives.apache.org/mod_mbox/commons-user/200712.mbox/%3C5611A9EAACBFF444BE35BF1DAAB314DDE2A71F@DKKOB2101MB.tsden.tcad.telia.se%3E&lt;/a&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="12409632">DBCP-277</key>
            <summary>DBCP Locking Up</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="4">Incomplete</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="joerg@j-hohwiller.de">J&#246;rg Hohwiller</reporter>
                        <labels>
                    </labels>
                <created>Tue, 2 Dec 2008 09:27:04 +0000</created>
                <updated>Mon, 15 Feb 2010 02:31:09 +0000</updated>
                            <resolved>Sat, 24 Jan 2009 21:42:46 +0000</resolved>
                                    <version>1.2.2</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12667000" author="psteitz" created="Sat, 24 Jan 2009 21:42:46 +0000"  >&lt;p&gt;Please reopen, attaching a fuller thread dump (including the thread that is holding the lock on the GenericObjectPool)  if the explanation below is incorrect / inconsistent with examination of full thread dumps.&lt;/p&gt;

&lt;p&gt;From the line numbers in the stack trace, it looks like you are using Pool 1.3, which fully synchronizes borrowObject and returnObject. If a thread that is opening, validating or closing a connection hangs, it will effectively &quot;lock up&quot; the pool.  See POOL=93.  Synchronization of borrow/return methods was narrowed in Pool 1.4, so upgrading pool might resolve your problem.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114555</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            16 years, 41 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0v0n3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>179077</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-275] removeAbandoned parameter not working</title>
                <link>https://issues.apache.org/jira/browse/DBCP-275</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;Hi,&lt;/p&gt;

&lt;p&gt;         Iam using tomcat connection pooling to maintain db connections.&lt;br/&gt;
The following configurations were made in context.xml.&lt;/p&gt;

&lt;p&gt;&amp;lt;Resource name=&quot;jdbc/testdb&quot; auth=&quot;Container&quot;&lt;br/&gt;
type=&quot;javax.sql.DataSource&quot; &lt;br/&gt;
username=&quot;root&quot; password=&quot;root123&quot;&lt;br/&gt;
driverClassName=&quot;com.mysql.jdbc.Driver&quot; &lt;br/&gt;
url=&quot;jdbc:mysql://localhost:3306/test35_dev&quot;&lt;br/&gt;
maxActive=&quot;-1&quot; &lt;br/&gt;
maxIdle=&quot;10&quot; &lt;br/&gt;
minIdle=&quot;6&quot; &lt;br/&gt;
maxwait=&quot;5000&quot; &lt;br/&gt;
minEvictableIdleTimeMillis=&quot;30000&quot;&lt;br/&gt;
numTestsPerEvictionRun = &quot;25&quot;&lt;br/&gt;
timeBetweenEvictionRunsMillis=&quot;30000&quot;&lt;br/&gt;
removeAbandoned=&quot;true&quot;&lt;br/&gt;
removeAbandonedTimeout=&quot;60&quot;&lt;br/&gt;
/&amp;gt;&lt;/p&gt;

&lt;p&gt;I used the following code to look up and get the data base connections&lt;/p&gt;

&lt;p&gt;Context initCtx = new InitialContext();&lt;br/&gt;
Context envCtx = (Context) initCtx.lookup(&quot;java:comp/env&quot;);&lt;br/&gt;
// Look up our data source&lt;br/&gt;
DataSource ds = (DataSource) envCtx.lookup(&quot;jdbc/testdb&quot;);&lt;br/&gt;
// Allocate and use a connection from the pool&lt;br/&gt;
Connection connection = ds.getConnection();&lt;/p&gt;


&lt;p&gt;After this the application is creating 50 connections and it is not  closing&lt;br/&gt;
the connections after using.Will removeAbandoned step in and return the&lt;br/&gt;
connections to the pool and remove the excess connections greater than maxIdle&lt;br/&gt;
parameter.But when the application needs the next set of connections it is&lt;br/&gt;
creating new connections instead of using the existing ones and as a result the&lt;br/&gt;
MySql server is running out of connections.Why is removeAbandoned not handling&lt;br/&gt;
the unclosed connections even after 1 minute even though it is configured to do&lt;br/&gt;
so.&lt;/p&gt;

&lt;p&gt;Please advise on the possible solutions.&lt;/p&gt;

&lt;p&gt;Thanks&lt;/p&gt;</description>
                <environment>&lt;p&gt;Windows XP,Tomcat 5.5.12,My SQL 5.0.68 Enterprise version,java 1.5&lt;/p&gt;</environment>
        <key id="12405444">DBCP-275</key>
            <summary>removeAbandoned parameter not working</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="6">Invalid</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="svkirans">Venkata Kiran</reporter>
                        <labels>
                    </labels>
                <created>Tue, 30 Sep 2008 07:48:49 +0000</created>
                <updated>Mon, 15 Feb 2010 02:32:07 +0000</updated>
                            <resolved>Sat, 24 Jan 2009 22:28:20 +0000</resolved>
                                    <version>1.2.2</version>
                                    <fixVersion>1.2.2</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12667007" author="psteitz" created="Sat, 24 Jan 2009 22:28:20 +0000"  >&lt;p&gt;This does not look like a DBCP bug.  You should not depend on the idle object evictor to close connections.  The application should close the connections it opens.  Setting maxActive = -1 means there is not limit to the number of connections that the pool will open.  To limint the number of connections allocated to the  the pool, set this to a positve value.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114553</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            16 years, 41 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0v0dz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>179036</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-274] DBCP Returns a closed connection even though testOnBorrow is set to true</title>
                <link>https://issues.apache.org/jira/browse/DBCP-274</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;Hello,&lt;br/&gt;
  I am using a BasicDataSource to acquire connections.  The particular service that is facing the issue basically goes through periods of high activity followed by many hours of idle time.  After long idle times, DBCP starts returning closed connections. I tried setting the testOnBorrow flag BEFORE any connections were acquired, but it has not helped the situation.  One caveat is that I am not setting the validationQuery string.  This is only because as far as I could tell, if the validationQuery is null, the pool will simply check if the connection is open.  Please let me know if I can provide any more information.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12404626">DBCP-274</key>
            <summary>DBCP Returns a closed connection even though testOnBorrow is set to true</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="6">Invalid</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="ksshams">Khawaja Shams</reporter>
                        <labels>
                    </labels>
                <created>Thu, 18 Sep 2008 09:27:53 +0000</created>
                <updated>Fri, 19 Sep 2008 03:53:38 +0000</updated>
                            <resolved>Fri, 19 Sep 2008 03:53:38 +0000</resolved>
                                    <version>1.2.2</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12632497" author="ksshams" created="Fri, 19 Sep 2008 03:53:38 +0000"  >&lt;p&gt;I am sorry; it turns out that I did need to set the validationQuery string as the createDataSource method sets the test properties to false.  &lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114552</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            17 years, 7 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0v0bb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>179024</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-273] validation on testonborrow does not work</title>
                <link>https://issues.apache.org/jira/browse/DBCP-273</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;Our use of dbcp (1.2.1 and 1.2.2) shows that connection validation on testonborrow does not work. The pool still return closed connections. The error is in the following code.  See the commented out line for the specific error.&lt;br/&gt;
----------------------&lt;br/&gt;
 ra = ref.get(&quot;testOnBorrow&quot;);&lt;br/&gt;
  if (ra != null &amp;amp;&amp;amp; ra.getContent() != null) &lt;/p&gt;
{
        	//comment out old code
        	//ikds.setTestOnBorrow(Boolean.getBoolean(ra.getContent().toString()));
        	ikds.setTestOnBorrow(Boolean.valueOf(ra.getContent().toString()).booleanValue());

        }

&lt;p&gt;        ra = ref.get(&quot;testOnReturn&quot;);&lt;br/&gt;
        if (ra != null &amp;amp;&amp;amp; ra.getContent() != null) &lt;/p&gt;
{
            ikds.setTestOnReturn(Boolean.valueOf(
                ra.getContent().toString()).booleanValue());
        }</description>
                <environment></environment>
        <key id="12399633">DBCP-273</key>
            <summary>validation on testonborrow does not work</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="marklsenior">mark lin</reporter>
                        <labels>
                    </labels>
                <created>Fri, 4 Jul 2008 19:44:07 +0000</created>
                <updated>Mon, 15 Feb 2010 02:33:58 +0000</updated>
                            <resolved>Sun, 25 Jan 2009 03:31:35 +0000</resolved>
                                    <version>1.2.1</version>
                    <version>1.2.2</version>
                                    <fixVersion>1.3</fixVersion>
                    <fixVersion>1.4</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="12644940" author="srempfer" created="Tue, 4 Nov 2008 10:43:15 +0000"  >&lt;p&gt;Class:	  InstanceKeyObjectFactory&lt;br/&gt;
Revision: 479137 &lt;br/&gt;
Date: 	  2006-11-25 08:51:48 -0700 (Sat, 25 Nov 2006)&lt;br/&gt;
Method:	  private void setCommonProperties(Reference ref, InstanceKeyDataSource ikds)&lt;br/&gt;
Line:	  175&lt;/p&gt;

&lt;p&gt;Code-Snipped:&lt;/p&gt;

&lt;p&gt;	Bug:&lt;br/&gt;
	---------&lt;/p&gt;

&lt;p&gt;        ra = ref.get(&quot;testOnBorrow&quot;);&lt;br/&gt;
        if (ra != null &amp;amp;&amp;amp; ra.getContent() != null) &lt;/p&gt;
{
            ikds.setTestOnBorrow(
                Boolean.getBoolean(ra.getContent().toString()));
        }

&lt;p&gt;        Solution:&lt;br/&gt;
        ------------&lt;/p&gt;

&lt;p&gt;        ra = ref.get(&quot;testOnBorrow&quot;);&lt;br/&gt;
        if (ra != null &amp;amp;&amp;amp; ra.getContent() != null) &lt;/p&gt;
{
            ikds.setTestOnBorrow(
                Boolean.valueOf(ra.getContent().toString()));
        }</comment>
                            <comment id="12667040" author="psteitz" created="Sun, 25 Jan 2009 03:31:35 +0000"  >&lt;p&gt;Fixed in r737481.&lt;/p&gt;

&lt;p&gt;Used old (&amp;lt;=1.4) method to preserve compatability.&lt;/p&gt;

&lt;p&gt;Thanks!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114551</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            16 years, 41 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uvvj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178305</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-272] Contention for DriverManager when initializing multiple datasources </title>
                <link>https://issues.apache.org/jira/browse/DBCP-272</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;This issue has been discussed in the commons user&apos;s mailing list between myself, Simon Kitching and Phil Steitz. &lt;/p&gt;

&lt;p&gt;In summary:&lt;/p&gt;

&lt;p&gt;I have a webapp deployed in tomcat containing 3 pooled datasources which are managed by Spring. The webapp starts up OK and is immediately hit by a load of a few hundred requests a second. It seems to handle a few hundred request and then just locks up entirely and stops responding entirely. Attached is a stack trace obtained by doing kill -3 when in this state. After discussion on the mailing list I changed the datasources to be non-lazy initialised in spring but the issue still occurs. &lt;/p&gt;

&lt;p&gt;Simon Kitching said:&lt;br/&gt;
&quot;The first thread is trying to initialise a postgresql driver and register it with DriverManager. The driver registration is being triggered from a static initialiser block on the postgresql driver class, so is executing from within the Class.forName method (and therefore the postgresql driver Class object is locked by this thread).&lt;/p&gt;

&lt;p&gt;The second thread is trying to initialise a mysql driver and register it with DriverManager. Again, the driver registration is being triggered from a static initialiser block on the mysql driver class, so the mysql driver Class object is locked by this thread).&lt;/p&gt;

&lt;p&gt;But in both cases, the DriverManager needs to be initialised before anything can be registered. The first thread appears to have run first, triggering the initialisation process, and the second thread is blocked waiting for initialisation of DriverManager to complete before it registers the mysql driver. &lt;/p&gt;

&lt;p&gt;&amp;lt;snip/&amp;gt;&lt;/p&gt;

&lt;p&gt;Possibly dbcp should call DriverManager.getDrivers() internally on startup to avoid this race... &quot;&lt;/p&gt;


</description>
                <environment>&lt;p&gt;Java HotSpot(TM) 64-Bit Server VM (1.6.0-b105 mixed mode) on Linux&lt;/p&gt;</environment>
        <key id="12399369">DBCP-272</key>
            <summary>Contention for DriverManager when initializing multiple datasources </summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="adrianw">Adrian Woodhead</reporter>
                        <labels>
                    </labels>
                <created>Tue, 1 Jul 2008 13:51:14 +0000</created>
                <updated>Mon, 15 Feb 2010 02:34:40 +0000</updated>
                            <resolved>Wed, 18 Feb 2009 18:31:23 +0000</resolved>
                                    <version>1.2.2</version>
                                    <fixVersion>1.3</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12612006" author="adrianw" created="Wed, 9 Jul 2008 11:44:22 +0000"  >&lt;p&gt;This is the thread dump obtained by doing a &quot;kill -3&quot; on the tomcat process when in the stuck state soon after startup.&lt;/p&gt;</comment>
                            <comment id="12612202" author="adrianw" created="Wed, 9 Jul 2008 17:46:14 +0000"  >&lt;p&gt;Interestingly, we tried to replace the DBCP connection pool with c3p0. We did not mark the datasources as lazy-init in spring. c3p0 exhibited very similar behaviour to dbcp, what is does better is that it actually detects the deadlock itself and outputs some useful information related to this It seems it also blocks in DirverManager.registerDriver and in doing the Class.forName step:&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;2008-07-09 17:31:24&amp;#93;&lt;/span&gt; WARN (com.mchange.v2.async.ThreadPoolAsynchronousRunner:608) - com.mchange.v2.async.ThreadPoolAsynchronousRunner$DeadlockDetector@2cec4462 &amp;#8211; APPARENT DEADLOCK!!! Creating emergency threads for unassigned pending tasks!&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;2008-07-09 17:31:24&amp;#93;&lt;/span&gt; WARN (com.mchange.v2.async.ThreadPoolAsynchronousRunner:624) - com.mchange.v2.async.ThreadPoolAsynchronousRunner$DeadlockDetector@2cec4462 &amp;#8211; APPARENT DEADLOCK!!! Complete Status: &lt;br/&gt;
	Managed Threads: 3&lt;br/&gt;
	Active Threads: 3&lt;br/&gt;
	Active Tasks: &lt;br/&gt;
		com.mchange.v2.resourcepool.BasicResourcePool$AcquireTask@21bf4c80 (com.mchange.v2.async.ThreadPoolAsynchronousRunner$PoolThread-#0)&lt;br/&gt;
		com.mchange.v2.resourcepool.BasicResourcePool$AcquireTask@163778cf (com.mchange.v2.async.ThreadPoolAsynchronousRunner$PoolThread-#1)&lt;br/&gt;
		com.mchange.v2.resourcepool.BasicResourcePool$AcquireTask@13dc696e (com.mchange.v2.async.ThreadPoolAsynchronousRunner$PoolThread-#2)&lt;br/&gt;
	Pending Tasks: &lt;br/&gt;
		com.mchange.v2.resourcepool.BasicResourcePool$AcquireTask@6b8dbef1&lt;br/&gt;
		com.mchange.v2.resourcepool.BasicResourcePool$AcquireTask@26f2f761&lt;br/&gt;
		com.mchange.v2.resourcepool.BasicResourcePool$AcquireTask@194f1541&lt;br/&gt;
		com.mchange.v2.resourcepool.BasicResourcePool$AcquireTask@16fc6b62&lt;br/&gt;
		com.mchange.v2.resourcepool.BasicResourcePool$AcquireTask@15edfab8&lt;br/&gt;
		com.mchange.v2.resourcepool.BasicResourcePool$AcquireTask@3ae75147&lt;br/&gt;
		com.mchange.v2.resourcepool.BasicResourcePool$AcquireTask@28892a87&lt;br/&gt;
		com.mchange.v2.resourcepool.BasicResourcePool$AcquireTask@454719db&lt;br/&gt;
		com.mchange.v2.resourcepool.BasicResourcePool$AcquireTask@3ef29c65&lt;br/&gt;
		com.mchange.v2.resourcepool.BasicResourcePool$AcquireTask@29f9cb2c&lt;br/&gt;
Pool thread stack traces:&lt;br/&gt;
	Thread&lt;a href=&quot;#0,5,main&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;com.mchange.v2.async.ThreadPoolAsynchronousRunner$PoolThread-#0,5,main&lt;/a&gt;&lt;br/&gt;
		java.sql.DriverManager.registerDriver(DriverManager.java:280)&lt;br/&gt;
		com.mysql.jdbc.Driver.&amp;lt;clinit&amp;gt;(Driver.java:62)&lt;br/&gt;
		java.lang.Class.forName0(Native Method)&lt;br/&gt;
		java.lang.Class.forName(Class.java:169)&lt;br/&gt;
		com.mchange.v2.c3p0.DriverManagerDataSource.ensureDriverLoaded(DriverManagerDataSource.java:100)&lt;br/&gt;
		com.mchange.v2.c3p0.DriverManagerDataSource.getConnection(DriverManagerDataSource.java:132)&lt;br/&gt;
		com.mchange.v2.c3p0.WrapperConnectionPoolDataSource.getPooledConnection(WrapperConnectionPoolDataSource.java:182)&lt;br/&gt;
		com.mchange.v2.c3p0.WrapperConnectionPoolDataSource.getPooledConnection(WrapperConnectionPoolDataSource.java:171)&lt;br/&gt;
		com.mchange.v2.c3p0.impl.C3P0PooledConnectionPool$1PooledConnectionResourcePoolManager.acquireResource(C3P0PooledConnectionPool.java:137)&lt;br/&gt;
		com.mchange.v2.resourcepool.BasicResourcePool.doAcquire(BasicResourcePool.java:1014)&lt;br/&gt;
		com.mchange.v2.resourcepool.BasicResourcePool.access$800(BasicResourcePool.java:32)&lt;br/&gt;
		com.mchange.v2.resourcepool.BasicResourcePool$AcquireTask.run(BasicResourcePool.java:1810)&lt;br/&gt;
		com.mchange.v2.async.ThreadPoolAsynchronousRunner$PoolThread.run(ThreadPoolAsynchronousRunner.java:547)&lt;br/&gt;
	Thread&lt;a href=&quot;#1,5,main&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;com.mchange.v2.async.ThreadPoolAsynchronousRunner$PoolThread-#1,5,main&lt;/a&gt;&lt;br/&gt;
		java.lang.Class.forName0(Native Method)&lt;br/&gt;
		java.lang.Class.forName(Class.java:169)&lt;br/&gt;
		com.mchange.v2.c3p0.DriverManagerDataSource.ensureDriverLoaded(DriverManagerDataSource.java:100)&lt;br/&gt;
		com.mchange.v2.c3p0.DriverManagerDataSource.getConnection(DriverManagerDataSource.java:132)&lt;br/&gt;
		com.mchange.v2.c3p0.WrapperConnectionPoolDataSource.getPooledConnection(WrapperConnectionPoolDataSource.java:182)&lt;br/&gt;
		com.mchange.v2.c3p0.WrapperConnectionPoolDataSource.getPooledConnection(WrapperConnectionPoolDataSource.java:171)&lt;br/&gt;
		com.mchange.v2.c3p0.impl.C3P0PooledConnectionPool$1PooledConnectionResourcePoolManager.acquireResource(C3P0PooledConnectionPool.java:137)&lt;br/&gt;
		com.mchange.v2.resourcepool.BasicResourcePool.doAcquire(BasicResourcePool.java:1014)&lt;br/&gt;
		com.mchange.v2.resourcepool.BasicResourcePool.access$800(BasicResourcePool.java:32)&lt;br/&gt;
		com.mchange.v2.resourcepool.BasicResourcePool$AcquireTask.run(BasicResourcePool.java:1810)&lt;br/&gt;
		com.mchange.v2.async.ThreadPoolAsynchronousRunner$PoolThread.run(ThreadPoolAsynchronousRunner.java:547)&lt;br/&gt;
	Thread&lt;a href=&quot;#2,5,main&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;com.mchange.v2.async.ThreadPoolAsynchronousRunner$PoolThread-#2,5,main&lt;/a&gt;&lt;br/&gt;
		java.lang.Class.forName0(Native Method)&lt;br/&gt;
		java.lang.Class.forName(Class.java:169)&lt;br/&gt;
		com.mchange.v2.c3p0.DriverManagerDataSource.ensureDriverLoaded(DriverManagerDataSource.java:100)&lt;br/&gt;
		com.mchange.v2.c3p0.DriverManagerDataSource.getConnection(DriverManagerDataSource.java:132)&lt;br/&gt;
		com.mchange.v2.c3p0.WrapperConnectionPoolDataSource.getPooledConnection(WrapperConnectionPoolDataSource.java:182)&lt;br/&gt;
		com.mchange.v2.c3p0.WrapperConnectionPoolDataSource.getPooledConnection(WrapperConnectionPoolDataSource.java:171)&lt;br/&gt;
		com.mchange.v2.c3p0.impl.C3P0PooledConnectionPool$1PooledConnectionResourcePoolManager.acquireResource(C3P0PooledConnectionPool.java:137)&lt;br/&gt;
		com.mchange.v2.resourcepool.BasicResourcePool.doAcquire(BasicResourcePool.java:1014)&lt;br/&gt;
		com.mchange.v2.resourcepool.BasicResourcePool.access$800(BasicResourcePool.java:32)&lt;br/&gt;
		com.mchange.v2.resourcepool.BasicResourcePool$AcquireTask.run(BasicResourcePool.java:1810)&lt;br/&gt;
		com.mchange.v2.async.ThreadPoolAsynchronousRunner$PoolThread.run(ThreadPoolAsynchronousRunner.java:547)&lt;/p&gt;</comment>
                            <comment id="12674725" author="markt" created="Wed, 18 Feb 2009 18:31:23 +0000"  >&lt;p&gt;We can never truly fix this since the way drivers are expected to register with the DriverManager is asking for a deadlock to occur in multi-thread environments. Yuck.&lt;/p&gt;

&lt;p&gt;What we can do is attempt to prevent this in environments where only DBCP is used. I have applied a patch that calls DriverManager.getDrivers() to force initialisation before we ever do anything that might use Class.forName() to load (and register) a JDBC driver. This should prevent this deadlock occurring. Any feedback from testing in your environment would be appreciated.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12385621" name="catalina.out.stuck2" size="939919" author="adrianw" created="Wed, 9 Jul 2008 11:44:22 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114550</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            16 years, 38 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uycf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178705</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-271] Thread safety issues in AbandonedTrace class</title>
                <link>https://issues.apache.org/jira/browse/DBCP-271</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/DBCP-270&quot; title=&quot;Dead lock using the evictor&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DBCP-270&quot;&gt;&lt;del&gt;DBCP-270&lt;/del&gt;&lt;/a&gt; implies that the AbandonedTrace class is called from multiple threads, however it is not thread-safe:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;SimpleDateFormat  is not threadsafe, but it is called without protection.&lt;/li&gt;
	&lt;li&gt;various instance fields need to be made final to ensure that they are published correctly (memory visibility)&lt;/li&gt;
	&lt;li&gt;getLastUsed/setLastUsed need to be synchronized - or better, createdBy made volatile so printStackTrace can access the variable safely&lt;br/&gt;
(createdBy is rewritten, not updated, so lost updates are not important)&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Also, the Javadoc for printStackTrace() is wrong.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12399155">DBCP-271</key>
            <summary>Thread safety issues in AbandonedTrace class</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="sebb">Sebb</reporter>
                        <labels>
                    </labels>
                <created>Fri, 27 Jun 2008 09:59:39 +0000</created>
                <updated>Mon, 15 Feb 2010 02:35:02 +0000</updated>
                            <resolved>Sun, 25 Jan 2009 02:52:01 +0000</resolved>
                                                    <fixVersion>1.3</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12608725" author="sebb@apache.org" created="Fri, 27 Jun 2008 11:14:20 +0000"  >&lt;p&gt;Also, as far as I can tell, the parent instance field is used but never initialised.&lt;/p&gt;</comment>
                            <comment id="12667038" author="psteitz" created="Sun, 25 Jan 2009 02:52:00 +0000"  >&lt;p&gt;Made relevant instance fields volatile or final in r737478.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114549</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            16 years, 41 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uxmf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178588</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-270] Dead lock using the evictor</title>
                <link>https://issues.apache.org/jira/browse/DBCP-270</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;Patch attached, dead lock reported. the abandonedtrace does synchronized(this) when it really only needs to do synchronized(this.trace)&lt;/p&gt;

&lt;p&gt;Dead lock reported when using the evictor&lt;/p&gt;

&lt;p&gt;=============================&lt;br/&gt;
&quot;Timer-3&quot;:&lt;br/&gt;
  waiting to lock monitor 0x0000000053b40548 (object 0x00002aaabf3210f0, a&lt;br/&gt;
org.apache.tomcat.dbcp.dbcp.PoolableConnection),&lt;br/&gt;
  which is held by &quot;TP-Processor27&quot;&lt;br/&gt;
&quot;TP-Processor27&quot;:&lt;br/&gt;
  waiting to lock monitor 0x0000000053b404d0 (object 0x00002aaab9fa8b08, a&lt;br/&gt;
org.apache.tomcat.dbcp.pool.impl.GenericObjectPool),&lt;br/&gt;
  which is held by &quot;Timer-3&quot;&lt;/p&gt;

&lt;p&gt;Java stack information for the threads listed above:&lt;br/&gt;
===================================================&lt;br/&gt;
&quot;Timer-3&quot;:&lt;br/&gt;
        at&lt;br/&gt;
org.apache.tomcat.dbcp.dbcp.AbandonedTrace.addTrace(AbandonedTrace.java:175)&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;waiting to lock &amp;lt;0x00002aaabf3210f0&amp;gt; (a&lt;br/&gt;
org.apache.tomcat.dbcp.dbcp.PoolableConnection)&lt;br/&gt;
        at&lt;br/&gt;
org.apache.tomcat.dbcp.dbcp.AbandonedTrace.init(AbandonedTrace.java:92)&lt;br/&gt;
        at&lt;br/&gt;
org.apache.tomcat.dbcp.dbcp.AbandonedTrace.&amp;lt;init&amp;gt;(AbandonedTrace.java:82)&lt;br/&gt;
        at&lt;br/&gt;
org.apache.tomcat.dbcp.dbcp.DelegatingStatement.&amp;lt;init&amp;gt;(DelegatingStatement.java:61)&lt;br/&gt;
        at&lt;br/&gt;
org.apache.tomcat.dbcp.dbcp.DelegatingConnection.createStatement(DelegatingConnection.java:224)&lt;br/&gt;
        at&lt;br/&gt;
org.apache.tomcat.dbcp.dbcp.PoolableConnectionFactory.validateConnection(PoolableConnectionFactory.java:331)&lt;br/&gt;
        at&lt;br/&gt;
org.apache.tomcat.dbcp.dbcp.PoolableConnectionFactory.validateObject(PoolableConnectionFactory.java:312)&lt;br/&gt;
        at&lt;br/&gt;
org.apache.tomcat.dbcp.pool.impl.GenericObjectPool.evict(GenericObjectPool.java:1217)&lt;/li&gt;
	&lt;li&gt;locked &amp;lt;0x00002aaab9fa8b08&amp;gt; (a&lt;br/&gt;
org.apache.tomcat.dbcp.pool.impl.GenericObjectPool)&lt;br/&gt;
        at&lt;br/&gt;
org.apache.tomcat.dbcp.pool.impl.GenericObjectPool$Evictor.run(GenericObjectPool.java:1341)&lt;br/&gt;
        at java.util.TimerThread.mainLoop(Timer.java:512)&lt;br/&gt;
        at java.util.TimerThread.run(Timer.java:462)&lt;br/&gt;
&quot;TP-Processor27&quot;:&lt;br/&gt;
        at&lt;br/&gt;
org.apache.tomcat.dbcp.pool.impl.GenericObjectPool.addObjectToPool(GenericObjectPool.java:1136)&lt;/li&gt;
	&lt;li&gt;waiting to lock &amp;lt;0x00002aaab9fa8b08&amp;gt; (a&lt;br/&gt;
org.apache.tomcat.dbcp.pool.impl.GenericObjectPool)&lt;br/&gt;
        at&lt;br/&gt;
org.apache.tomcat.dbcp.pool.impl.GenericObjectPool.returnObject(GenericObjectPool.java:1076)&lt;br/&gt;
        at&lt;br/&gt;
org.apache.tomcat.dbcp.dbcp.PoolableConnection.close(PoolableConnection.java:87)&lt;/li&gt;
	&lt;li&gt;locked &amp;lt;0x00002aaabf3210f0&amp;gt; (a&lt;br/&gt;
org.apache.tomcat.dbcp.dbcp.PoolableConnection)&lt;br/&gt;
        ....&lt;/li&gt;
&lt;/ul&gt;
</description>
                <environment></environment>
        <key id="12399099">DBCP-270</key>
            <summary>Dead lock using the evictor</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="fhanik">Filip Hanik</reporter>
                        <labels>
                    </labels>
                <created>Thu, 26 Jun 2008 17:18:57 +0000</created>
                <updated>Mon, 15 Feb 2010 02:35:59 +0000</updated>
                            <resolved>Fri, 27 Jun 2008 02:51:09 +0000</resolved>
                                    <version>1.2.2</version>
                                    <fixVersion>1.3</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12608505" author="fhanik" created="Thu, 26 Jun 2008 17:19:47 +0000"  >&lt;p&gt;Patch to properly synchronize the abandoned trace object&lt;/p&gt;</comment>
                            <comment id="12608508" author="fhanik" created="Thu, 26 Jun 2008 17:31:18 +0000"  >&lt;p&gt;Same patch as before, but no whitespace inclusions as the previous one&lt;/p&gt;</comment>
                            <comment id="12608643" author="psteitz" created="Fri, 27 Jun 2008 02:51:09 +0000"  >&lt;p&gt;Pactch applied.  Thanks!&lt;/p&gt;

&lt;p&gt;This patch also resolves the last deadlock reported in &lt;a href=&quot;https://issues.apache.org/jira/browse/DBCP-44&quot; title=&quot;[dbcp] Evictor thread in GenericObjectPool has potential for deadlock&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DBCP-44&quot;&gt;&lt;del&gt;DBCP-44&lt;/del&gt;&lt;/a&gt;.  &lt;/p&gt;</comment>
                            <comment id="12608721" author="sebb@apache.org" created="Fri, 27 Jun 2008 10:41:49 +0000"  >&lt;p&gt;Note that the patch also adds synchronisation to the getTrace() method.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12384772" name="deadlock-abandoned-trace.patch" size="1862" author="fhanik" created="Thu, 26 Jun 2008 17:31:18 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114548</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            17 years, 19 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uve7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178227</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-269] final jdbc connection never closed --&gt; number of connections grows</title>
                <link>https://issues.apache.org/jira/browse/DBCP-269</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;Using DBCP parameters:&lt;/p&gt;

&lt;p&gt;    JdbcDriver  com.mysql.jdbc.Driver&lt;br/&gt;
    JdbcUrl     jdbc:mysql://localhost:3307/dbcp?cacheResultsetMetadata=true&lt;br/&gt;
    UserName    dbcp&lt;br/&gt;
    Password    dbcp&lt;br/&gt;
    InitialSize 5&lt;br/&gt;
    MaxActive 8&lt;br/&gt;
    MaxWait -1&lt;br/&gt;
    TestOnBorrow false&lt;br/&gt;
    TestOnReturn false&lt;br/&gt;
    PoolPreparedStatements true&lt;br/&gt;
    MaxOpenPreparedStatements 10&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;TimeBetweenEvictionRunsMillis 20000&lt;/li&gt;
	&lt;li&gt;MinEvictableIdleTimeMillis 30000&lt;/li&gt;
	&lt;li&gt;NumTestsPerEvictionRun 3&lt;/li&gt;
	&lt;li&gt;TestWhileIdle false&lt;br/&gt;
    MinIdle 2&lt;br/&gt;
    MaxIdle 5&lt;br/&gt;
    DefaultTransactionIsolation 1&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;provides strange behaviour. &lt;br/&gt;
The testcase is simple:&lt;br/&gt;
                @Test&lt;br/&gt;
                public void testMaxIdle() throws Exception {&lt;br/&gt;
                               int MAX_ACTIVE = 8;&lt;br/&gt;
                               List&amp;lt;Connection&amp;gt; connectionList = new ArrayList&amp;lt;Connection&amp;gt;();&lt;br/&gt;
                               int i = 0;&lt;br/&gt;
                               DataSource dataSource = ...; // retrieve the datasource&lt;br/&gt;
                               Assert.assertNotNull(dataSource);&lt;/p&gt;

&lt;p&gt;                               System.out.println(&quot;*** Getting all connections ...&quot;);&lt;br/&gt;
                               for (i = 0; i &amp;lt; MAX_ACTIVE; i++) &lt;/p&gt;
{
                                               System.out.println(&quot;get connection &quot; + (i + 1));
                                               Connection con = dataSource.getConnection();
                                               Assert.assertNotNull(con);
                                               connectionList.add(con);
                               }&lt;br/&gt;
&lt;br/&gt;
                               i = 0;&lt;br/&gt;
                               System.out.println(&quot;*** Releasing all connections ...&quot;);&lt;br/&gt;
                               for (Iterator&amp;lt;Connection&amp;gt; iterator = connectionList.iterator(); iterator.hasNext()&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; {
                                               Connection connection = (Connection) iterator.next();
                                               System.out.println(&quot;close connection &quot; + (++i));
                                               connection.close();
                                               iterator.remove();
                               }&lt;br/&gt;
&lt;br/&gt;
                               i = 0;&lt;br/&gt;
                               System.out.println(&quot;*** Getting all + X connections ...&quot;);&lt;br/&gt;
                               for (i = 0; i &amp;lt; (MAX_ACTIVE + 1); i++) {                                               System.out.println(&quot;get connection &quot; + (i + 1));                                               Connection con = dataSource.getConnection();                                               Assert.assertNotNull(con);                                               connectionList.add(con);                               }

&lt;p&gt;                }&lt;/p&gt;

&lt;p&gt;First of all, after initialization, the number of real database connections established is 6 instead of 5. This due to the &quot;protected synchronized DataSource createDataSource&quot; method of the BasicDataSource object because of the validation of the ConnectionFactory. The &quot;validateConnectionFactory&quot; method creates a new jdbc connection and destroy it at the end. Nonetheless, the underlying database connection is not really closed.&lt;/p&gt;

&lt;p&gt;At the end of the above test case, we should not have more than 8 connections but we have in fact 12 of them (8 + 1 for validation + 3 because DBCP wants to close extra connection MAX_ACTIVE - MAX_IDLE). In fact, those 3 connections are not really closed.&lt;/p&gt;

&lt;p&gt;Please find attached a patch correcting this bug. This is due to the method isClosed() of the DelegatingConnection. From my point of view, the implementation of the method should be:&lt;/p&gt;

&lt;p&gt;  public boolean isClosed() throws SQLException {&lt;br/&gt;
         if(_closed &amp;amp;&amp;amp; _conn.isClosed()) &lt;/p&gt;
{ // Instead of if(_closed || _conn.isClosed())
             return true;
         }
&lt;p&gt;         return false;&lt;br/&gt;
    }&lt;/p&gt;

&lt;p&gt;From my understanding, a connection is considered as closed if and only if one of the connection chain is closed (OR in the test). But, if I&apos;m write the _closed flag of the delegating connection is set to true during the passivation. So, after returning to the pool, a connection can not be closed. The isClosed method is really important because it&apos;s used indirectly by the reallyClose method of a PoolableConnection.&lt;/p&gt;

&lt;p&gt;The behaviour is much more impressive if the evict thread of the configuration is activated because, with a testcase that simply wait after getting the datasource initialized (Thread.currentThread().sleep(600000)&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; you will see database connections growing.&lt;/p&gt;

&lt;p&gt;Finally, after applying the given patch, I faced some problems regarding DBCP TestCases:&lt;br/&gt;
In some test cases, you have a test method&lt;br/&gt;
    public void testClose() throws Exception &lt;/p&gt;
{
        ds.setAccessToUnderlyingConnectionAllowed(true);

                [...]

        // raw idle connection should now be closed
        // FIXME should be assertTrue
        assertFalse(rawIdleConnection.isClosed());

                [...]

        // both wrapper and raw active connection should be closed
        assertTrue(activeConnection.isClosed());
        assertTrue(rawActiveConnection.isClosed());
    }

&lt;p&gt;From my point of view and regarding the comment the assertFalse(rawIdleConnection.isClosed()); sould become assertTrue(rawIdleConnection.isClosed());.&lt;/p&gt;

&lt;p&gt;Moreover, the next test method fails.&lt;br/&gt;
    // Bugzilla Bug 28251:  Returning dead database connections to BasicDataSource&lt;br/&gt;
    // isClosed() failure blocks returning a connection to the pool &lt;br/&gt;
    public void testIsClosedFailure() throws SQLException {&lt;br/&gt;
        ds.setAccessToUnderlyingConnectionAllowed(true);&lt;br/&gt;
        Connection conn = ds.getConnection();&lt;br/&gt;
        assertNotNull(conn);&lt;br/&gt;
        assertEquals(1, ds.getNumActive());&lt;/p&gt;

&lt;p&gt;        // set an IO failure causing the isClosed mathod to fail&lt;br/&gt;
        TesterConnection tconn = (TesterConnection) ((DelegatingConnection)conn).getInnermostDelegate();&lt;br/&gt;
        tconn.setFailure(new IOException(&quot;network error&quot;));&lt;/p&gt;

&lt;p&gt;        try &lt;/p&gt;
{
            conn.close();
            fail(&quot;Expected SQLException&quot;);
        }
&lt;p&gt;        catch(SQLException ex) { }&lt;/p&gt;

&lt;p&gt;        assertEquals(0, ds.getNumActive());&lt;br/&gt;
    }&lt;br/&gt;
But again, looking at the AddObjectToPool of the GenericObjectPool (commons-pool), the IOException(&quot;Network error&quot;) is catch during the passivation. It implies that the underlying connection (in error) is not returned to the pool. It will be re-created by the evict thread if minIdle property is set.&lt;br/&gt;
Am I wrong ?&lt;/p&gt;

&lt;p&gt;Sorry for the little long post.&lt;br/&gt;
Kind regards,&lt;br/&gt;
Jean-Louis MONTEIRO&lt;/p&gt;</description>
                <environment>&lt;p&gt;Windows, JDK 5&lt;/p&gt;</environment>
        <key id="12398152">DBCP-269</key>
            <summary>final jdbc connection never closed --&gt; number of connections grows</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="dain">Dain Sundstrom</assignee>
                                    <reporter username="jlmonteiro">Jean-Louis Monteiro</reporter>
                        <labels>
                    </labels>
                <created>Thu, 12 Jun 2008 09:23:26 +0000</created>
                <updated>Mon, 16 Jun 2008 20:26:51 +0000</updated>
                            <resolved>Mon, 16 Jun 2008 20:26:51 +0000</resolved>
                                    <version>1.3</version>
                    <version>1.4</version>
                    <version>Nightly Builds</version>
                                    <fixVersion>1.3</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12605402" author="dain" created="Mon, 16 Jun 2008 20:26:51 +0000"  >&lt;p&gt;I didn&apos;t use the patch as is.  Instead of changing the behavior of the proxy, I changed the close logic to inspect the underlying connection to determine if the proxy should be returned to the pool or destroyed.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12383900" name="patch.txt" size="726" author="jlmonteiro" created="Thu, 12 Jun 2008 09:26:07 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114547</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            17 years, 21 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uvyn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178319</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-268] How to close connection from pool</title>
                <link>https://issues.apache.org/jira/browse/DBCP-268</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;Hi,&lt;/p&gt;

&lt;p&gt;We want to close connection from connection pool after connection is used 10 times. &lt;/p&gt;

&lt;p&gt;Please let me know is any setting availble in config file to close connection from pool.&lt;/p&gt;

&lt;p&gt;Thanks and Regards,&lt;br/&gt;
Kailas&lt;/p&gt;</description>
                <environment>&lt;p&gt;Struts 1.2.7, Oracle 10g Application server and Oracle Datasbe 10g&lt;/p&gt;</environment>
        <key id="12396387">DBCP-268</key>
            <summary>How to close connection from pool</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="6">Invalid</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="kailas_kore">Kailas Kore</reporter>
                        <labels>
                    </labels>
                <created>Tue, 20 May 2008 10:33:55 +0000</created>
                <updated>Mon, 15 Feb 2010 02:36:24 +0000</updated>
                            <resolved>Sun, 25 Jan 2009 02:55:02 +0000</resolved>
                                    <version>1.2.2</version>
                                    <fixVersion>1.2.2</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12667039" author="psteitz" created="Sun, 25 Jan 2009 02:55:02 +0000"  >&lt;p&gt;This is really a question for the user list.  IIUC the question, there is no way to do this using DBCP.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114546</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            16 years, 41 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0v0dj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>179034</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-267] Max Cursor Open</title>
                <link>https://issues.apache.org/jira/browse/DBCP-267</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;Hi,&lt;/p&gt;

&lt;p&gt;We are facing error Max Cursor Open though we have closed Statement, Resultset and Connection in java code after each procedure call.&lt;/p&gt;

&lt;p&gt;We are using below datasource settings&lt;br/&gt;
&amp;lt;data-source key=&quot;RENPOSDB&quot; type=&quot;org.apache.commons.dbcp.BasicDataSource&quot;&amp;gt;&lt;br/&gt;
&amp;lt;set-property property=&quot;driverClassName&quot; value=&quot;oracle.jdbc.driver.OracleDriver&quot; /&amp;gt;&lt;br/&gt;
&amp;lt;set-property property=&quot;url&quot; value=&quot;jdbc:oracle:thin:@l92.168.192.1:1521:ksdb2&quot; /&amp;gt;   			&lt;br/&gt;
&amp;lt;set-property property=&quot;username&quot; value=&quot;NS&quot; /&amp;gt;&lt;br/&gt;
&amp;lt;set-property property=&quot;password&quot; value=&quot;NS&quot; /&amp;gt;&lt;br/&gt;
&amp;lt;set-property property=&quot;description&quot; value=&quot;Dev&quot; /&amp;gt;&lt;br/&gt;
&amp;lt;set-property property=&quot;autoCommit&quot; value=&quot;true&quot; /&amp;gt;&lt;br/&gt;
&amp;lt;set-property property=&quot;maxCount&quot; value=&quot;100&quot; /&amp;gt;&lt;br/&gt;
&amp;lt;set-property property=&quot;minCount&quot; value=&quot;4&quot; /&amp;gt; &lt;br/&gt;
&amp;lt;/data-source&amp;gt; &lt;/p&gt;

&lt;p&gt;We are using finally block to close connection.&lt;br/&gt;
 finally{&lt;br/&gt;
          	try&lt;/p&gt;
{
            	commonMethods.closeConnection(rs,cstmt1,conn);
           	}
&lt;p&gt;catch (SQLException SQLe){}&lt;br/&gt;
     	}&lt;/p&gt;

&lt;p&gt;We have used  Implementation-Version: 1.0.1 of commons-dbcp.jar and commons-pool.jar&lt;/p&gt;

&lt;p&gt;Let us know if need to updatewith latest version&lt;/p&gt;

&lt;p&gt;Thanks and Regards,&lt;br/&gt;
Kailas&lt;/p&gt;</description>
                <environment>&lt;p&gt;Struts 1.2.7, Oracle Application Server 10g, Database Oracle 10g &lt;/p&gt;</environment>
        <key id="12396386">DBCP-267</key>
            <summary>Max Cursor Open</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="kailas_kore">Kailas Kore</reporter>
                        <labels>
                    </labels>
                <created>Tue, 20 May 2008 10:30:24 +0000</created>
                <updated>Mon, 15 Feb 2010 02:36:54 +0000</updated>
                            <resolved>Sun, 25 Jan 2009 03:42:16 +0000</resolved>
                                    <version>1.0</version>
                                    <fixVersion>1.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12667043" author="psteitz" created="Sun, 25 Jan 2009 03:42:16 +0000"  >&lt;p&gt;This is a question for the user list.  There is no 1.0.1 version of DBCP.  In any case, all versions of DBCP have used &quot;maxActive&quot; to control the number of connections allocated to the pool.  Assuming the parameters in the report are what are being used to initialize a BasicDataSource, changing &quot;maxOpen&quot; to &quot;maxActive&quot; might solve the problem  Please reopen if this really points to a bug in DBCP.  Otherwise, feel free to ask for help on the commons user list.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114545</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            16 years, 41 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uvgn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178238</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-266] connection pool is not being kept alive by dbcp</title>
                <link>https://issues.apache.org/jira/browse/DBCP-266</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;In our production environment, randomly the connection pool in Tomcat 6.0.16 collapses, no errors, just hunged.&lt;br/&gt;
You can not retrive it from context with a lookup, we can not have connections.&lt;br/&gt;
All requests hunged. We think it&apos;s closely related to db idle connection management, with idle connection closed server side due to timeout while the connection pool does not realize this.&lt;/p&gt;

&lt;p&gt;After a couple of week of investigation, we discovered this:&lt;br/&gt;
we see validation query running, but very often the time between 2 validation query runs is not timeBetweenEvictionRunsMillis.&lt;br/&gt;
It&apos;s double,  we wrote 40 seconds, it runs every 80 seconds.&lt;br/&gt;
For some reason, in some machine of our cluster (older tomcat restart?) we see validation query running every 160 seconds for all connection, 4 times timeBetweenEvictionRunsMillis, and it&apos;s stable, always 160 sec., even if we don&apos;t know if tomorrow it goes to 320sec. or it stays to 160. In our idea there is something wrong with the Timer that manage to run query validation for idle connection. Problably timeBetweenEvictionRunsMillis grows over server timeout period causing connections pool collape.&lt;/p&gt;

&lt;p&gt;Till 3 weeks ago we had Tom 5.0.x and everything was perfect.&lt;br/&gt;
After we moved to Tomcat 6.0.16 we have to restart 1-2 servers /day in a 10 serves cluster due to hunged connection pool. &lt;br/&gt;
The problem is not related to traffic because it happends night time too.&lt;/p&gt;

&lt;p&gt;I hope this can help to figure out the problem.&lt;/p&gt;

&lt;p&gt;Regards&lt;br/&gt;
Marco Boniardi&lt;/p&gt;

&lt;p&gt;    &amp;lt;Resource&lt;br/&gt;
      name=&quot;jdbc/bestprices&quot;&lt;br/&gt;
      type=&quot;javax.sql.DataSource&quot;&lt;br/&gt;
      initialSize=&quot;5&quot;&lt;br/&gt;
      maxActive=&quot;15&quot;&lt;br/&gt;
      maxIdle=&quot;15&quot;&lt;br/&gt;
      minIdle=&quot;5&quot;&lt;br/&gt;
      maxWait=&quot;5000&quot;&lt;br/&gt;
      testOnBorrow=&quot;false&quot;&lt;br/&gt;
      testWhileIdle=&quot;true&quot;&lt;br/&gt;
      timeBetweenEvictionRunsMillis=&quot;40000&quot;&lt;br/&gt;
      minEvictableIdleTimeMillis=&quot;240000&quot;&lt;br/&gt;
      validationQuery=&quot;SELECT 1&quot;&lt;br/&gt;
      username=&quot;bestprices_user&quot;&lt;br/&gt;
      password=&quot;xxxxxxxx&quot;&lt;br/&gt;
      driverClassName=&quot;com.mysql.jdbc.Driver&quot;&lt;br/&gt;
      url=&quot;jdbc:mysql://vgdb05:3306/bestprices?zeroDateTime-Behavior=convertToNull&quot;&lt;br/&gt;
    /&amp;gt;&lt;/p&gt;</description>
                <environment>&lt;p&gt;Apache Tomcat 6.0.16&lt;br/&gt;
Jdk 1.6.0_05-b13 Sun Microsystems Inc.&lt;br/&gt;
Linux   2.6.18-53.1.4.el5 amd64&lt;br/&gt;
mysql-connector-java-5.0.8-bin.jar&lt;/p&gt;</environment>
        <key id="12394374">DBCP-266</key>
            <summary>connection pool is not being kept alive by dbcp</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="4">Incomplete</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="boniarco">Marco Boniardi</reporter>
                        <labels>
                    </labels>
                <created>Sat, 19 Apr 2008 17:57:38 +0000</created>
                <updated>Mon, 15 Feb 2010 02:37:45 +0000</updated>
                            <resolved>Sat, 24 Jan 2009 22:16:23 +0000</resolved>
                                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12667006" author="psteitz" created="Sat, 24 Jan 2009 22:16:23 +0000"  >&lt;p&gt;Please reopen with relevant threads from a full thread dump showing the deadlock if this can be confirmed.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114544</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            16 years, 41 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0v0in:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>179057</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-265] Connection close handling DatabaseMetaData exceed max open cursor oracle</title>
                <link>https://issues.apache.org/jira/browse/DBCP-265</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;Hello,&lt;/p&gt;

&lt;p&gt;i was suprised by following behavior:&lt;br/&gt;
/**&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Here all is OK, the finally block closes the connection and implicit the statement and the resultset. If called repeatedly, only one cursor is used.&lt;/li&gt;
	&lt;li&gt;@throws SQLException&lt;br/&gt;
*/&lt;br/&gt;
public void test2() throws SQLException{&lt;br/&gt;
Connection con = null;&lt;br/&gt;
try{&lt;br/&gt;
con = dataSource.getConnection();&lt;br/&gt;
Statement statement = con.createStatement();&lt;br/&gt;
ResultSet resultSet = statement.executeQuery(&quot;select * from MyTable&quot;);&lt;br/&gt;
if(resultSet.next())&lt;br/&gt;
resultSet.getString(1);&lt;br/&gt;
}finally {&lt;br/&gt;
if (con != null) {&lt;br/&gt;
con.close();&lt;br/&gt;
}&lt;br/&gt;
}&lt;br/&gt;
}&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;But doing this repeatedly&lt;br/&gt;
/**&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Danger: exceeds max open cursors if called repeatedly.&lt;/li&gt;
	&lt;li&gt;@throws SQLException&lt;br/&gt;
*/&lt;br/&gt;
public void test1() throws SQLException{&lt;br/&gt;
Connection con = null;&lt;br/&gt;
try{&lt;br/&gt;
con = dataSource.getConnection();&lt;br/&gt;
DatabaseMetaData metaData = con.getMetaData();&lt;br/&gt;
ResultSet schemas = metaData.getSchemas();&lt;br/&gt;
}finally {&lt;br/&gt;
if (con != null) {&lt;br/&gt;
con.close();&lt;br/&gt;
}&lt;br/&gt;
}&lt;br/&gt;
}&lt;br/&gt;
exceeds max open cursors on the database.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;DataSource created with following block:&lt;br/&gt;
		dataSource = new BasicDataSource();&lt;br/&gt;
		dataSource.setDriverClassName(&quot;oracle.jdbc.OracleDriver&quot;);&lt;br/&gt;
		dataSource.setUsername(&quot;myuser&quot;);&lt;br/&gt;
		dataSource.setPassword(&quot;mypasswd&quot;);&lt;br/&gt;
		dataSource.setUrl(&quot;jdbc:oracle:thin:@192.168.0.1:1521:mydb&quot;);&lt;/p&gt;


&lt;p&gt;Of course, explicit closing the &apos;schemas&apos; ResultSet in the second case solves the problem.&lt;/p&gt;

&lt;p&gt;I am not certainly sure my expected behavior is conform to the jdbc spec. But without using the BasicDatasource this problem doesnt occure.&lt;/p&gt;

&lt;p&gt;I inspected the code and saw, that org.apache.commons.dbcp.BasicDataSource (or more specific, DelegatingConnection) doesnt track Connections and ResultSets created from DatabaseMetadata-Object.Only created Statements form DelegatingConnection are tracked. And in PoolableConnectionFactory.passivateObject() only these statements are closed and warnings are cleared on the underlying connection.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Windows/Unix, Oracle 10gR2, JDK 1.4, Oracle JDBC Driver 10.2.0.1. &lt;/p&gt;</environment>
        <key id="12393376">DBCP-265</key>
            <summary>Connection close handling DatabaseMetaData exceed max open cursor oracle</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="pd">pd</reporter>
                        <labels>
                    </labels>
                <created>Tue, 8 Apr 2008 08:20:32 +0000</created>
                <updated>Mon, 15 Feb 2010 02:38:12 +0000</updated>
                            <resolved>Sun, 22 Feb 2009 16:39:29 +0000</resolved>
                                    <version>1.2.1</version>
                    <version>1.2.2</version>
                                    <fixVersion>1.3</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="12592616" author="bayard" created="Sun, 27 Apr 2008 01:36:18 +0000"  >&lt;p&gt;Sounds like we need a DelegatingMetaData. &lt;/p&gt;</comment>
                            <comment id="12675670" author="markt" created="Sun, 22 Feb 2009 16:39:29 +0000"  >&lt;p&gt;This has been fixed in svn and will be included in 1.3 onwards&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114543</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            16 years, 37 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uvu7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178299</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-264] clear batch when closing statement</title>
                <link>https://issues.apache.org/jira/browse/DBCP-264</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;If a statement contains batch statements, these statements should be cleared on close. &lt;/p&gt;

&lt;p&gt;Szenario:&lt;br/&gt;
A pooled statement contains already some batch statements before an error occured. This error will be handled and finally the statement will be closed. Cause, it is a pooled statement the batch statements will be remaining in the pooled statement. On the next request the pooled statement will execute the batch statements from the first request.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12392810">DBCP-264</key>
            <summary>clear batch when closing statement</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="hbmann">Hauke Rabe</reporter>
                        <labels>
                    </labels>
                <created>Tue, 1 Apr 2008 08:22:35 +0000</created>
                <updated>Mon, 15 Feb 2010 02:38:37 +0000</updated>
                            <resolved>Mon, 16 Feb 2009 17:16:33 +0000</resolved>
                                    <version>1.2.2</version>
                                    <fixVersion>1.3</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="12584053" author="hbmann" created="Tue, 1 Apr 2008 08:31:34 +0000"  >&lt;p&gt;Add to org.apache.commons.dbcp.DelegatingStatement#close()  method call clearBatch()&lt;/p&gt;
</comment>
                            <comment id="12592614" author="bayard" created="Sun, 27 Apr 2008 01:28:05 +0000"  >&lt;p&gt;Looks like this should be looked at for 1.3.&lt;/p&gt;</comment>
                            <comment id="12667087" author="psteitz" created="Sun, 25 Jan 2009 14:14:19 +0000"  >&lt;p&gt;The logical place to insert a clearBatch is in PoolablePreparedStatement&apos;s passivate method.  The attached patch does that, but swallows any SQLException that occurs.  Since driver support for this is optional, I don&apos;t think we would want to propagate the associated SQLExceptions here; but I don&apos;t either like the swallowing and the fact that the try/throw/catch will be executed on every passivate for drivers that do not support batch processing.   Anyone have a better idea?&lt;/p&gt;</comment>
                            <comment id="12667099" author="niallp" created="Sun, 25 Jan 2009 16:05:09 +0000"  >&lt;p&gt;How about setting a flag when addBatch() is called and only trying to call clearBatch() if that flag is set?&lt;/p&gt;</comment>
                            <comment id="12667155" author="psteitz" created="Mon, 26 Jan 2009 00:36:57 +0000"  >&lt;p&gt;Second patch looks good to me.  Might want to make the flag volatile, though.&lt;/p&gt;</comment>
                            <comment id="12667843" author="niallp" created="Tue, 27 Jan 2009 22:57:26 +0000"  >&lt;p&gt;OK I committed that patch with the volatile change:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://svn.apache.org/viewvc?view=rev&amp;amp;revision=738288&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc?view=rev&amp;amp;revision=738288&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12398709" name="DBCP-264-clearBatch.patch" size="1156" author="niallp" created="Sun, 25 Jan 2009 23:53:28 +0000"/>
                            <attachment id="12398683" name="clearBatchPatch.txt" size="566" author="psteitz" created="Sun, 25 Jan 2009 14:14:19 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114542</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            16 years, 41 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uvsn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178292</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-259] defualtReadOnly not working in conncetion pooling</title>
                <link>https://issues.apache.org/jira/browse/DBCP-259</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;Hi All&lt;/p&gt;

&lt;p&gt;I am trying to set up a connection pooling using Jakarta commons-dbcp 1.2.1....&lt;/p&gt;

&lt;p&gt;When defaultReadOnly property is set to true and if my understanding is correct i would not be able to perform update,insert or delete operations.&lt;/p&gt;

&lt;p&gt;When i set defualtReadOnly as true in the constructor PoolableConnectionFactory which looks like -&lt;/p&gt;

&lt;p&gt;poolableConnectionFactory = new PoolableConnectionFactory(&lt;br/&gt;
                    connectionFactory, connectionPool, null,&lt;br/&gt;
                    &quot;sql query&quot;, true, true);&lt;/p&gt;

&lt;p&gt;But still i am able to perform the delete or insert opertations where i am expecting to throw an excpetion.&lt;br/&gt;
Am i missing some thing or is ther anything fishy???&lt;/p&gt;

&lt;p&gt;Thanks&lt;/p&gt;</description>
                <environment>&lt;p&gt;commons-pool 1.2, jdk 1.4&lt;/p&gt;</environment>
        <key id="12387598">DBCP-259</key>
            <summary>defualtReadOnly not working in conncetion pooling</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="6">Invalid</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="vamsi_nrv">Raghu</reporter>
                        <labels>
                    </labels>
                <created>Fri, 1 Feb 2008 06:19:15 +0000</created>
                <updated>Sat, 8 Mar 2008 23:18:43 +0000</updated>
                            <resolved>Sat, 8 Mar 2008 23:18:43 +0000</resolved>
                                    <version>1.2.1</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12565029" author="psteitz" created="Sat, 2 Feb 2008 05:21:50 +0000"  >&lt;p&gt;Your understanding may not be correct, depending on the JDBC driver and database.  PoolableConnectionFactory will invoke the underlying Connection&apos;s setReadOnly(true) method when a PoolableConnection with defaultReadOnly = true is activated.  What that means in practice regarding what can be done with the connection, what is optimized, etc. depends on the driver.  The driver documentation should say whether or not and how readOnly connections are supported.&lt;/p&gt;</comment>
                            <comment id="12565252" author="vamsi_nrv" created="Mon, 4 Feb 2008 03:41:15 +0000"  >&lt;p&gt;Yes Phil &lt;/p&gt;

&lt;p&gt;Thanks for you response. I got to know that the property of ReadOnly depends on the driver you are using and that is absolutely correct and well understood.&lt;/p&gt;

&lt;p&gt;Now i have a strange problem. &lt;br/&gt;
I am testing this defualt readonly property in 2 different cases.&lt;br/&gt;
1.Just trying to obtain a connection as a flat connection -&lt;/p&gt;

&lt;p&gt;		Class.forName(&quot;oracle.jdbc.driver.OracleDriver&quot;);&lt;br/&gt;
		Connection con = DriverManager.getConnection(&quot;url&quot;,&quot;user&quot;,&quot;paswd&quot;);&lt;br/&gt;
		con.setReadOnly(true);&lt;br/&gt;
		con.setAutoCommit(false);&lt;/p&gt;

&lt;p&gt;		PreparedStatement pstmt = con.prepareStatement(&quot;DELETE query&apos;&quot;);;&lt;/p&gt;

&lt;p&gt;		int x =  pstmt.executeUpdate();&lt;br/&gt;
		con.commit();&lt;br/&gt;
		con.close();&lt;br/&gt;
		System.out.println&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/error.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;; &lt;/p&gt;

&lt;p&gt;Here even when i am trying to set the readOnly to true still i am able to perform the delete or update or insert operations...but as we know that Oracle JDBC driver doesnt support that i dont have any issues here....&lt;/p&gt;

&lt;p&gt;2.In the second case i am trying to obtain a conneciton from a datasource by constructing a connection pooling....&lt;/p&gt;

&lt;p&gt;now here when i am using the constructor - &lt;/p&gt;

&lt;p&gt;poolableConnectionFactory = new PoolableConnectionFactory(&lt;br/&gt;
connectionFactory, connectionPool, null,&lt;br/&gt;
&quot;sql query&quot;, true, false);&lt;/p&gt;

&lt;p&gt;i have set the auto commit as false now when i am trying to perform an udate query it throwing the exception.(Here also i am using the Oracle JDBC driver only...)&lt;/p&gt;

&lt;p&gt;but when i am setting the constructor - &lt;/p&gt;

&lt;p&gt;poolableConnectionFactory = new PoolableConnectionFactory(&lt;br/&gt;
connectionFactory, connectionPool, null,&lt;br/&gt;
&quot;sql query&quot;, true, true);&lt;/p&gt;

&lt;p&gt;here auto commit is true....and now it is not throwing any exception.....&lt;/p&gt;

&lt;p&gt;why is this incosistency in all these 3 cases.....&lt;/p&gt;

&lt;p&gt;Thanks for reading my mail patiently..........&lt;/p&gt;

</comment>
                            <comment id="12565262" author="psteitz" created="Mon, 4 Feb 2008 04:35:39 +0000"  >&lt;p&gt;I am not an expert on how the Oracle driver handles these things, so I can&apos;t help much other than to explain what DBCP&apos;s PoolableConnectionFactory (PCF) does.  Assuming you are using a pool with PCF as the factory and the constructor mentioned above, the sequence should be &lt;/p&gt;

&lt;p&gt;1. getConnection or borrowObject directly from the pool causes a connection to get created using PCF&apos;s makeObject or returns one from the pool.  Newly created connections do not have readOnly or autoCommit set.&lt;br/&gt;
2. commons pool&apos;s borrowObject then calls the PCF activateObject method.  In that method, the autoCommit and readOnly properties are set &lt;b&gt;in that order&lt;/b&gt; - i.e. in the reverse order from what you have in you &quot;flat connection&quot; example.  &lt;/p&gt;

&lt;p&gt;If you can identify a bug in DBCP (e.g. somehow setting the properties in the order that we do is not good), we can leave this issue open and find a solution here.  Otherwise, we should close this and address further questions on the commons-user or Oracle lists.&lt;/p&gt;</comment>
                            <comment id="12565273" author="vamsi_nrv" created="Mon, 4 Feb 2008 05:12:24 +0000"  >&lt;p&gt;This is excellent Phill.....&lt;/p&gt;

&lt;p&gt;I really didnt think the setting the value of two boolean parameters can change the course of a program to this extent....&lt;/p&gt;

&lt;p&gt;when i am doing this - &lt;/p&gt;

&lt;p&gt;con.setAutoCommit(false);&lt;br/&gt;
con.setReadOnly(true);&lt;/p&gt;

&lt;p&gt;I am getting the desired exception and now i can see some consistency.......Thanks for the help where i am struggling with this for past 2 days...but do you think the order is so much important...i dont want to drag the issue..this would be my last comment....&lt;/p&gt;

&lt;p&gt;&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="12576649" author="psteitz" created="Sat, 8 Mar 2008 23:18:43 +0000"  >&lt;p&gt;This is not a DBCP bug.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114537</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            17 years, 35 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0v0av:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>179022</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-256] Useless statement</title>
                <link>https://issues.apache.org/jira/browse/DBCP-256</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;ManagedConnection.CompletionListener compares &apos;transactionContext&apos; to itself. I wonder what it was meant to be doing?&lt;/p&gt;</description>
                <environment>&lt;p&gt;Fortify&lt;/p&gt;</environment>
        <key id="12386456">DBCP-256</key>
            <summary>Useless statement</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="3">Duplicate</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="bayard">Henri Yandell</reporter>
                        <labels>
                    </labels>
                <created>Thu, 17 Jan 2008 06:38:27 +0000</created>
                <updated>Tue, 25 Mar 2008 08:15:55 +0000</updated>
                            <resolved>Tue, 25 Mar 2008 08:15:55 +0000</resolved>
                                                    <fixVersion>1.4</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12581825" author="bayard" created="Tue, 25 Mar 2008 08:15:55 +0000"  >&lt;p&gt;Duplicate of &lt;a href=&quot;https://issues.apache.org/jira/browse/DBCP-252&quot; title=&quot;Bugs found by Findbugs&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DBCP-252&quot;&gt;&lt;del&gt;DBCP-252&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114534</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            17 years, 33 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0v00f:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178975</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-255] Uninitialized read of parent field in AbandonedTrace</title>
                <link>https://issues.apache.org/jira/browse/DBCP-255</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;Seems funky - we pass &apos;parent&apos; up when constructing AbandonedTrace, but it&apos;s just null. Is that right, if it is, let&apos;s just put null.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Fortify&lt;/p&gt;</environment>
        <key id="12386454">DBCP-255</key>
            <summary>Uninitialized read of parent field in AbandonedTrace</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="bayard">Henri Yandell</reporter>
                        <labels>
                    </labels>
                <created>Thu, 17 Jan 2008 06:34:56 +0000</created>
                <updated>Mon, 15 Feb 2010 02:39:26 +0000</updated>
                            <resolved>Mon, 16 Feb 2009 15:14:28 +0000</resolved>
                                                    <fixVersion>1.3</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12559830" author="bayard" created="Thu, 17 Jan 2008 06:36:25 +0000"  >&lt;p&gt;In fact, parent is never written to; so definitely unhappy.&lt;/p&gt;

&lt;p&gt;I suspect all uses are wrapped in &apos;if-nulls&apos;, so it&apos;s never blown up.&lt;/p&gt;</comment>
                            <comment id="12667108" author="psteitz" created="Sun, 25 Jan 2009 17:30:12 +0000"  >&lt;p&gt;Looks to me like this instance field is superfluous and can be removed.  Reads of this field in get/setLastUsed are null-guarded.  Unless I am missing something, the instance field will always be null.  The attached patch removes the field.  &lt;/p&gt;</comment>
                            <comment id="12673899" author="psteitz" created="Mon, 16 Feb 2009 15:14:28 +0000"  >&lt;p&gt;Patch applied in r744932&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12398690" name="AbandonedTracePatch.txt" size="1968" author="psteitz" created="Sun, 25 Jan 2009 17:30:12 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114533</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            16 years, 38 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uxdj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178548</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-254] Possible NPE in PooledConnectionImpl</title>
                <link>https://issues.apache.org/jira/browse/DBCP-254</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;makeObject(Object) checks if key._resultSetType and _resultSetConcurrency are both null, but not if one or the other is null.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Fortify&lt;/p&gt;</environment>
        <key id="12386453">DBCP-254</key>
            <summary>Possible NPE in PooledConnectionImpl</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="2">Won&apos;t Fix</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="bayard">Henri Yandell</reporter>
                        <labels>
                    </labels>
                <created>Thu, 17 Jan 2008 06:24:24 +0000</created>
                <updated>Tue, 25 Mar 2008 08:14:16 +0000</updated>
                            <resolved>Tue, 25 Mar 2008 08:14:16 +0000</resolved>
                                                    <fixVersion>1.3</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12559823" author="bayard" created="Thu, 17 Jan 2008 06:25:36 +0000"  >&lt;p&gt;The same is true of PooledConnection&apos;s makeObject too.&lt;/p&gt;</comment>
                            <comment id="12560226" author="psteitz" created="Fri, 18 Jan 2008 05:30:22 +0000"  >&lt;p&gt;While a little smelly, I think these are both harmless.  In the second case, I assume you mean &quot;PoolingConnection. &quot; In both cases, &quot;key&quot; is a PStmtKey (inner class which each, ugh, maintains a copy of), which is immutable and impossible to initialize with one of these fields null and the other not null.&lt;/p&gt;</comment>
                            <comment id="12581824" author="bayard" created="Tue, 25 Mar 2008 08:14:16 +0000"  >&lt;p&gt;Hard to tell - they&apos;re no longer listed at Fortify &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/sad.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;Marking as WONTFIX.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114532</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            17 years, 33 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uznj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178917</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-253] Masked Field in DelegatingCallableStatement</title>
                <link>https://issues.apache.org/jira/browse/DBCP-253</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;_stmt doesn&apos;t need to be declared twice.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Fortify&lt;/p&gt;</environment>
        <key id="12386452">DBCP-253</key>
            <summary>Masked Field in DelegatingCallableStatement</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="bayard">Henri Yandell</reporter>
                        <labels>
                    </labels>
                <created>Thu, 17 Jan 2008 06:20:59 +0000</created>
                <updated>Mon, 15 Feb 2010 02:39:55 +0000</updated>
                            <resolved>Thu, 19 Feb 2009 00:29:02 +0000</resolved>
                                                    <fixVersion>1.3</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12559822" author="bayard" created="Thu, 17 Jan 2008 06:22:08 +0000"  >&lt;p&gt;In fact it&apos;s worse, it&apos;s also a masked field in DelegatingPreparedStatement.&lt;/p&gt;

&lt;p&gt;Everyone should use the one in DelegatingStatement.&lt;/p&gt;</comment>
                            <comment id="12674834" author="markt" created="Thu, 19 Feb 2009 00:29:02 +0000"  >&lt;p&gt;Thanks for the report. This has been fixed in svn and will be in the next (1.3?) release.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114531</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            16 years, 38 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uxf3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178555</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-252] Bugs found by Findbugs</title>
                <link>https://issues.apache.org/jira/browse/DBCP-252</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;ManagedConnection.java has (line 155)&lt;br/&gt;
================&lt;/p&gt;

&lt;p&gt;    protected class CompletionListener implements TransactionContextListener {&lt;br/&gt;
        public void afterCompletion(TransactionContext transactionContext, boolean commited) {&lt;br/&gt;
            if (transactionContext == transactionContext) &lt;/p&gt;
{
                transactionComplete();
            }
&lt;p&gt;        }&lt;br/&gt;
    }&lt;/p&gt;

&lt;p&gt;The transactionContext  parameter is hiding the field transactionContext.&lt;br/&gt;
The parameter should be renamed, as at present the comparison will always succeed.&lt;/p&gt;

&lt;p&gt;PoolingDriver: &lt;br/&gt;
===========&lt;br/&gt;
the following fields should be final:&lt;br/&gt;
_pools&lt;br/&gt;
MAJOR_VERSION&lt;br/&gt;
MINOR_VERSION&lt;br/&gt;
URL_PREFIX&lt;br/&gt;
URL_PREFIX_LEN&lt;br/&gt;
In fact the last four should probably be private as well&lt;/p&gt;

&lt;p&gt;toString() should not return null&lt;/p&gt;

&lt;p&gt;CPDSConnectionFactory&lt;br/&gt;
===================&lt;br/&gt;
setPool() is synch; getPool() is not. Either make both sync or make _pool volatile.&lt;br/&gt;
setRollbackAfterValidation is synch, however the field it sets - _rollbackAfterValidation - is not read using synch.&lt;br/&gt;
Either synch the read operation - or better here - drop the synch, and make the field volatile&lt;br/&gt;
Same applies to setValidationQuery() and _validationQuery&lt;/p&gt;

&lt;p&gt;KeyedCPDSConnectionFactory&lt;br/&gt;
========================&lt;br/&gt;
setRollbackAfterValidation is synch, however the field it sets - _rollbackAfterValidation - is not read using synch.&lt;br/&gt;
Either synch the read operation - or better here - drop the synch, and make the field volatile&lt;br/&gt;
Same applies to setValidationQuery() and _validationQuery&lt;/p&gt;

&lt;p&gt;PoolableConnectionFactory&lt;br/&gt;
======================&lt;br/&gt;
setPool() is synch; getPool() is not. Either make both sync or make _pool volatile.&lt;/p&gt;
</description>
                <environment></environment>
        <key id="12384257">DBCP-252</key>
            <summary>Bugs found by Findbugs</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="sebb">Sebb</reporter>
                        <labels>
                    </labels>
                <created>Sat, 8 Dec 2007 23:27:23 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:36 +0000</updated>
                            <resolved>Sun, 9 Mar 2008 06:45:32 +0000</resolved>
                                                    <fixVersion>1.3</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12576712" author="psteitz" created="Sun, 9 Mar 2008 06:45:32 +0000"  >&lt;p&gt;Fixed all identified issues other than the PoolingDriver complaints which would require backward-incompatible changes.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114530</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            17 years, 35 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uybj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178701</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-251] Dependencies list is incomplete - does not say where all dependencies can be found</title>
                <link>https://issues.apache.org/jira/browse/DBCP-251</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;&lt;a href=&quot;http://commons.apache.org/dbcp/dependencies.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://commons.apache.org/dbcp/dependencies.html&lt;/a&gt; is incomplete, as it does not say where all the jars can be found.&lt;/p&gt;

&lt;p&gt;The links should probably point to the master source of the jar, rather than generic repositories such as ibiblio, so users can find all the associated documentation if need be.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12384243">DBCP-251</key>
            <summary>Dependencies list is incomplete - does not say where all dependencies can be found</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="2">Won&apos;t Fix</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="sebb">Sebb</reporter>
                        <labels>
                    </labels>
                <created>Sat, 8 Dec 2007 14:01:32 +0000</created>
                <updated>Sat, 8 Mar 2008 23:23:55 +0000</updated>
                            <resolved>Sat, 8 Mar 2008 23:23:55 +0000</resolved>
                                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12576652" author="psteitz" created="Sat, 8 Mar 2008 23:23:55 +0000"  >&lt;p&gt;If and when the relevant maven plugin adds this information it will appear on the DBCP site.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114529</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            17 years, 35 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uzpj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178926</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-250] maxIdle limit exceeded and number does not decrease</title>
                <link>https://issues.apache.org/jira/browse/DBCP-250</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;Today, during load testing we noticed that the number of idle database connections exceeded the default value. The default values for maxIdle and maxActive are being used. After running the application with 200 users, the number of idle connection went to 18 and stayed there. &lt;/p&gt;

&lt;p&gt;Is this a bug?  Does testOnIdle need to be set to true for the idle connections to be decreased?&lt;/p&gt;</description>
                <environment></environment>
        <key id="12383484">DBCP-250</key>
            <summary>maxIdle limit exceeded and number does not decrease</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="7">Later</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="wesclark">Wes Clark</reporter>
                        <labels>
                    </labels>
                <created>Thu, 29 Nov 2007 04:55:28 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:36 +0000</updated>
                            <resolved>Mon, 3 Dec 2007 19:21:57 +0000</resolved>
                                    <version>1.2.2</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="12547360" author="psteitz" created="Sat, 1 Dec 2007 01:52:53 +0000"  >&lt;p&gt;Are you using BasicDataSource?  Pls provide configuration information and database and info on how you are observing the idle connection count.  If you are measuring idle connections from the database, it is possible that the number of idle connections from the database perspective will exceed the number of idle connections in the pool.  The number of idle connections that that pool limits via maxIdle is the number of database connections that are waiting for clients to check them out of the pool.  When a client application calls getConnection and retrieves a connection from the pool, the pool does not count this as an idle connection while the client has it checked out, even if the client is not using it and it is idle from the database engine perspective.  MaxActive, however, should not be exceeded, so you should not be seeing 18 connections open from the pool with the default maxActive setting.&lt;/p&gt;

&lt;p&gt;testOnIdle does not have to be turned on for excess idle connections to be removed when they are closed by clients.&lt;/p&gt;</comment>
                            <comment id="12547384" author="wesclark" created="Sat, 1 Dec 2007 06:45:01 +0000"  >&lt;p&gt;The behavior you describe is the behavior I expected.  We are getting connections from the JDBC driver and adding them to the pool.  We are not using the BasicDataSource (although I wish we did).  We configure the application the JDBC connection string, and pass it to the vendor&apos;s driver.  &lt;/p&gt;

&lt;p&gt;Does the proper behavior of the connection pool depend upon the use of a BasicDataSource?&lt;/p&gt;</comment>
                            <comment id="12547385" author="wesclark" created="Sat, 1 Dec 2007 06:48:27 +0000"  >&lt;p&gt;We override the org.apache.commons.dbcp.PoolableConnectionFactory.   Perhaps our adaptation of DBCP has left out some crucial processing?&lt;/p&gt;</comment>
                            <comment id="12547520" author="psteitz" created="Sat, 1 Dec 2007 21:39:40 +0000"  >&lt;p&gt;You do not need to use BasicDataSource.   If you have overriden PoolalbleConnectionFactory.makeObject and you are not returning / using PoolableConnections, then it is possible that you are not properly closing connections. If you think you have discovered a bug in one of the DBCP classes, we can investigate it here if you provide code and ideally a failing test case.  If what you are looking for is help on how to use the classes, it would be better to close this issue and ask questions on the commons user list.  (&lt;a href=&quot;http://commons.apache.org/dbcp/mail-lists.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://commons.apache.org/dbcp/mail-lists.html&lt;/a&gt;) &lt;/p&gt;</comment>
                            <comment id="12547951" author="wesclark" created="Mon, 3 Dec 2007 19:20:30 +0000"  >&lt;p&gt;I hope to be investigating this behavior in more detail at a later date.    We also plan to make testOnIdle the default behavior, which seems to fix the problem.&lt;/p&gt;</comment>
                            <comment id="12547953" author="wesclark" created="Mon, 3 Dec 2007 19:21:57 +0000"  >&lt;p&gt;Since I can&apos;t follow up on this issue immediately, I will resolve it, and re-open it later if I get better information.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114528</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            17 years, 49 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0v0sn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>179102</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-247] ResultSet returned from Statement.getGeneratedKeys has non-delegating Connection</title>
                <link>https://issues.apache.org/jira/browse/DBCP-247</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;We have a library that wraps a ResultSet and, when the client code calls ResultSet.close(), our library also closes the underlying Statement and Connection. This is very useful because it allows us to abstract out from the client code whether the Connection needs to be closed when you&apos;re done with the ResultSet (as when using DBCP) or not (as when running standalone, with classic MySQL JDBC driver connections).&lt;/p&gt;

&lt;p&gt;Here&apos;s a snippet of the library code:&lt;/p&gt;

&lt;p&gt;public class ResultSetWrapper {&lt;/p&gt;

&lt;p&gt;  private ResultSet rs;&lt;/p&gt;

&lt;p&gt;  public ResultSetWrapper(ResultSet rs) &lt;/p&gt;
{
    this.rs = rs;
  }

&lt;p&gt;  public boolean next() throws SQLException &lt;/p&gt;
{
    return rs.next();
  }

&lt;p&gt;  public int getInt(int fieldNum) throws SQLException &lt;/p&gt;
{
    return rs.getInt(fieldNum);
  }

&lt;p&gt;  // ... etc methods delegating to the underlying ResultSet&lt;/p&gt;

&lt;p&gt;  public void close() throws SQLException {&lt;br/&gt;
    Statement st = rs.getStatement();&lt;br/&gt;
    Connection conn = st.getConnection();&lt;br/&gt;
    try &lt;/p&gt;
{
      rs.close();
    }
&lt;p&gt; finally {&lt;br/&gt;
      try &lt;/p&gt;
{
        st.close();
      }
&lt;p&gt; finally &lt;/p&gt;
{
        conn.close(); // Here is where the problem lies
      }
&lt;p&gt;    }&lt;br/&gt;
  }&lt;br/&gt;
}&lt;/p&gt;

&lt;p&gt;Now, in order to test our code we are running with maxActive=1 and maxIdle=1, so we never actually use more than one JDBC connection.&lt;/p&gt;

&lt;p&gt;This works great when the ResultSetWrapper wraps a plain-old ResultSet returned from Statement.executeQuery().&lt;/p&gt;

&lt;p&gt;But when I wrap a ResultSet returned from Statement.getGeneratedKeys(), then the underlying JDBC connection is closed (at the &quot;Here is where the problem lies&quot; comment in ResultSetWrapper), not the DBCP DelegatingConnection. Here is an example:&lt;/p&gt;

&lt;p&gt;example database table:&lt;br/&gt;
CREATE TABLE test (id INT NOT NULL AUTO_INCREMENT PRIMARY KEY, name VARCHAR(50) NOT NULL);&lt;/p&gt;

&lt;p&gt;example test case:&lt;br/&gt;
public class Test {&lt;br/&gt;
  private DataSource dataSource = null;&lt;/p&gt;

&lt;p&gt;  public Test() &lt;/p&gt;
{
    // initialize the DataSource
    // ...
  }

&lt;p&gt;  public ResultSetWrapper wrapGeneratedKeysQuery() throws SQLException &lt;/p&gt;
{
    Connection conn = dataSource.getConnection();
    Statement st = conn.createStatement();
    st.execute(&quot;INSERT INTO test (name) VALUES (&apos;foo&apos;)&quot;);
    ResultSet rs = st.getGeneratedKeys();
    return new ResultSetWrapper(rs);
  }

&lt;p&gt;  public ResultSetWrapper wrapPlainQuery() throws SQLException &lt;/p&gt;
{
    Connection conn = dataSource.getConnection(); // Here is where we run out of connections in the pool
    Statement st = conn.createStatement();
    ResultSet rs = st.executeQuery(&quot;SELECT id FROM test LIMIT 1&quot;);
    ResultSetWrapper rsw = new ResultSetWrapper(rs);
    return rsw;
  }

&lt;p&gt;  public static void test() throws Exception &lt;/p&gt;
{
    Test t = new Test();

    ResultSetWrapper rsw = t.wrapGeneratedKeysQuery();
    rsw.next();
    rsw.getInt(1);
    rsw.close(); // This closes the underlying JDBC connection

    ResultSetWrapper rsw2 = t.wrapPlainQuery(); // throws an exception: DBCP connection pool is exhausted
    rsw2.next();
    rsw2.getInt(1);
    rsw2.close();
  }
&lt;p&gt;}&lt;/p&gt;

&lt;p&gt;The result: the DBCP connection is never returned to the pool. We run out of connections. wrapPlainQuery&apos;s getConnection fails because the pool (of 1 connection) has been exhausted. The statement rsw.close() closed the underlying JDBC connection and didn&apos;t return the DBCP connection to the pool.&lt;/p&gt;

&lt;p&gt;The workaround is to always carry around within the ResultSetWrapper the &quot;original&quot; Connection upon which the query was executed. But this should not be necessary.&lt;/p&gt;

&lt;p&gt;Sorry, but I can&apos;t tell what version of DBCP I&apos;m running. It&apos;s the one included in the Tomcat 5.5 bundle I&apos;m running.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Ubuntu Linux 7.10, JDK 1.5, Tomcat 5.5, MySQL 5.0.45&lt;/p&gt;</environment>
        <key id="12382293">DBCP-247</key>
            <summary>ResultSet returned from Statement.getGeneratedKeys has non-delegating Connection</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="3">Duplicate</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="shlomo.swidler">Shlomo Swidler</reporter>
                        <labels>
                    </labels>
                <created>Sun, 11 Nov 2007 20:36:14 +0000</created>
                <updated>Sat, 8 Dec 2007 03:50:13 +0000</updated>
                            <resolved>Sat, 8 Dec 2007 03:50:13 +0000</resolved>
                                    <version>1.2.1</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="12543625" author="shlomo.swidler" created="Mon, 19 Nov 2007 17:51:57 +0000"  >&lt;p&gt;I think, based on googling, that the affected version is 1.2.1. Whatever version of DBCP shipped with Tomcat 5.5, that&apos;s the one.&lt;/p&gt;</comment>
                            <comment id="12549645" author="psteitz" created="Sat, 8 Dec 2007 03:50:13 +0000"  >&lt;p&gt;This is a duplicate of &lt;a href=&quot;https://issues.apache.org/jira/browse/DBCP-11&quot; title=&quot;[dbcp] stmt.getConnection() != Connection used to create the statement&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DBCP-11&quot;&gt;&lt;del&gt;DBCP-11&lt;/del&gt;&lt;/a&gt;, which was fixed in r558332.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114526</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            17 years, 48 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0v067:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>179001</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-245] SharedPoolDataSource saves wrong password forever</title>
                <link>https://issues.apache.org/jira/browse/DBCP-245</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;The SharedPoolDataSource saves wrong password forever&lt;/p&gt;


&lt;p&gt;1. Get a connection for user1 (use username of user1 and password of user1) ---&amp;gt; connection ok&lt;br/&gt;
2. Get a connection for user2 (use username of user2 and a wrong password) --&amp;gt; connection failed&lt;br/&gt;
3. Get a connection for user2 (use username of user2 and password of user2) --&amp;gt; connection will be failed too because the wrong password is stored in the usersKey map.&lt;/p&gt;



&lt;p&gt;Bugfix&lt;br/&gt;
===================================================================&lt;/p&gt;

&lt;p&gt;   protected synchronized PooledConnectionAndInfo &lt;br/&gt;
        getPooledConnectionAndInfo(String username, String password)&lt;br/&gt;
        throws SQLException {&lt;br/&gt;
        if (pool == null) {&lt;br/&gt;
            try &lt;/p&gt;
{
                registerPool(username, password);
            }
&lt;p&gt; catch (NamingException e) &lt;/p&gt;
{
                throw new SQLNestedException(&quot;RegisterPool failed&quot;, e);
            }
&lt;p&gt;        }&lt;/p&gt;

&lt;p&gt;        PooledConnectionAndInfo info = null;&lt;br/&gt;
        UserPassKey userPassKey = null;&lt;br/&gt;
        try &lt;/p&gt;
{
        	userPassKey = getUserPassKey(username, password);
            info = (PooledConnectionAndInfo) pool
                .borrowObject(userPassKey);
        }
&lt;p&gt;        catch (Exception e) {&lt;/p&gt;

&lt;p&gt;        	if (userKeys != null &amp;amp;&amp;amp; userKeys.containsKey(username)) &lt;/p&gt;
{
        		userKeys.remove(username);
        	}

&lt;p&gt;            throw new SQLNestedException(&lt;br/&gt;
                &quot;Could not retrieve connection info from pool&quot;, e);&lt;br/&gt;
        }&lt;br/&gt;
        return info;&lt;br/&gt;
    }&lt;/p&gt;</description>
                <environment>&lt;p&gt;Use of SharedPoolDataSource see sample code&lt;/p&gt;

&lt;p&gt;	if (privSharedDS == null)&lt;br/&gt;
{&lt;br/&gt;
	privConPoolDS = new PGConnectionPoolDataSource();&lt;br/&gt;
	privConPoolDS.setServerName(privServerName);&lt;br/&gt;
	privConPoolDS.setDatabaseName(privServerDB);&lt;br/&gt;
	privConPoolDS.setUser(privUser);&lt;br/&gt;
	privConPoolDS.setPassword(privPassword);&lt;br/&gt;
	// --------------------------------------&lt;br/&gt;
	// dbcp caching via SharedPoolDataSource&lt;br/&gt;
	// --------------------------------------&lt;br/&gt;
	privSharedDS = new SharedPoolDataSource();&lt;br/&gt;
	privSharedDS.setConnectionPoolDataSource(privConPoolDS);&lt;br/&gt;
		privSharedDS.setMaxActive(10); // 0 = no limit&lt;br/&gt;
	privSharedDS.setMaxIdle(10);&lt;br/&gt;
	privSharedDS.setMinEvictableIdleTimeMillis(1000);&lt;br/&gt;
	privSharedDS.setMaxWait(1000); // -1 = no limit&lt;br/&gt;
	privSharedDS.setTimeBetweenEvictionRunsMillis(1000);&lt;br/&gt;
	privSharedDS.setTestWhileIdle(true);&lt;br/&gt;
}&lt;br/&gt;
// --------------------------------------&lt;br/&gt;
// dbcp caching via SharedPoolDataSource&lt;br/&gt;
// --------------------------------------&lt;br/&gt;
tmpCon = privSharedDS.getConnection(privUser, privPassword);&lt;/p&gt;</environment>
        <key id="12380058">DBCP-245</key>
            <summary>SharedPoolDataSource saves wrong password forever</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="md">Michael Drechsel</reporter>
                        <labels>
                    </labels>
                <created>Wed, 10 Oct 2007 13:18:26 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:36 +0000</updated>
                            <resolved>Tue, 29 Jan 2008 02:30:32 +0000</resolved>
                                    <version>1.1</version>
                    <version>1.2</version>
                    <version>1.2.1</version>
                    <version>1.2.2</version>
                                    <fixVersion>1.3</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12534190" author="psteitz" created="Fri, 12 Oct 2007 00:09:05 +0000"  >&lt;p&gt;Thanks for reporting this.  It would be great to have the code above put into a patch, with the steps to reproduce put into a test case that fails before and succeeds after the fix.&lt;/p&gt;</comment>
                            <comment id="12539844" author="md" created="Sat, 3 Nov 2007 05:42:29 +0000"  >&lt;p&gt;Hello Phil Steitz,&lt;/p&gt;

&lt;p&gt;thanks for your eMail. Here a have an test case that reproduces the bug.&lt;/p&gt;

&lt;p&gt;test case&lt;/p&gt;

&lt;p&gt;========&lt;/p&gt;

&lt;p&gt;            String serverName = &quot;localhost&quot;;&lt;br/&gt;
            String serverDB = &quot;localweb&quot;;&lt;/p&gt;

&lt;p&gt;            String user1 = &quot;doris&quot;;&lt;br/&gt;
            String password1 = &quot;doris&quot;;&lt;/p&gt;

&lt;p&gt;            String user2 = &quot;cramer&quot;;&lt;br/&gt;
            String password2 = &quot;cramer&quot;;&lt;/p&gt;


&lt;p&gt;            Connection con = null;&lt;/p&gt;


&lt;p&gt;            PGConnectionPoolDataSource ConPoolDS = new &lt;br/&gt;
PGConnectionPoolDataSource();&lt;br/&gt;
            ConPoolDS.setServerName(serverName);&lt;br/&gt;
            ConPoolDS.setDatabaseName(serverDB);&lt;br/&gt;
            ConPoolDS.setUser(user1);&lt;br/&gt;
            ConPoolDS.setPassword(password1);&lt;br/&gt;
            // --------------------------------------&lt;br/&gt;
            // dbcp caching via SharedPoolDataSource&lt;br/&gt;
            // --------------------------------------&lt;br/&gt;
            SharedPoolDataSource SharedDS = new SharedPoolDataSource();&lt;br/&gt;
            SharedDS.setConnectionPoolDataSource(ConPoolDS);&lt;br/&gt;
            SharedDS.setMaxActive(10); // 0 = no limit&lt;br/&gt;
            SharedDS.setMaxIdle(10);&lt;br/&gt;
            SharedDS.setMinEvictableIdleTimeMillis(1000);&lt;br/&gt;
            SharedDS.setMaxWait(1000); // -1 = no limit&lt;br/&gt;
            SharedDS.setTimeBetweenEvictionRunsMillis(1000);&lt;br/&gt;
            SharedDS.setTestWhileIdle(true);&lt;/p&gt;

&lt;p&gt;            try&lt;/p&gt;
            {
                con = SharedDS.getConnection(user1, password1);
            }
&lt;p&gt;            catch (Exception e)&lt;/p&gt;
            {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }&lt;br/&gt;
           &lt;br/&gt;
            try&lt;br/&gt;
            {
                con = SharedDS.getConnection(user2, &quot;wrongpassword&quot;);
            }&lt;br/&gt;
            catch (Exception e)&lt;br/&gt;
            {                // TODO Auto-generated catch block                e.printStackTrace();            }

&lt;p&gt;            try&lt;/p&gt;
            {
                // connection will fail because the wrong password is 
stored in the usersKey map.
                con = SharedDS.getConnection(user2, password2);
            }
&lt;p&gt;            catch (Exception e)&lt;/p&gt;
            {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }

&lt;p&gt;steps to reproduce&lt;/p&gt;

&lt;p&gt;================&lt;/p&gt;

&lt;p&gt;The SharedPoolDataSource saves wrong password forever&lt;br/&gt;
1. Get a connection for user1 (use username of user1 and password of user1) ---&amp;gt; connection ok&lt;br/&gt;
2. Get a connection for user2 (use username of user2 and a wrong password) --&amp;gt; connection failed&lt;br/&gt;
3. Get a connection for user2 (use username of user2 and password of user2) --&amp;gt; connection will be failed too because the wrong password is stored in the usersKey map.&lt;/p&gt;






&lt;p&gt;_________________________________________________________________________________________ &lt;/p&gt;
</comment>
                            <comment id="12563367" author="psteitz" created="Tue, 29 Jan 2008 02:30:32 +0000"  >&lt;p&gt;Slightly modified version of the suggested fix implemented in r616142.&lt;br/&gt;
Thanks!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114524</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            17 years, 41 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uzfj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178881</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-244] Connection socket hangs sporadically in DBCP 1.2.2 but not 1.2.1</title>
                <link>https://issues.apache.org/jira/browse/DBCP-244</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;I think I&apos;ve traced an exception to DBCP&apos;s code.&lt;/p&gt;

&lt;p&gt;Communication with the database is hanging sporadically in a production environment. If I don&apos;t set the socketTimeout property on the underlying connection, it will hang forever. With the socketTimeout property, I get the following exception:&lt;/p&gt;

&lt;p&gt;-------&lt;br/&gt;
com.mysql.jdbc.CommunicationsException: Communications link failure due to underlying exception:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;
	&lt;ul&gt;
		&lt;li&gt;BEGIN NESTED EXCEPTION **&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;java.net.SocketTimeoutException&lt;br/&gt;
MESSAGE: Read timed out&lt;/p&gt;

&lt;p&gt;STACKTRACE:&lt;/p&gt;

&lt;p&gt;java.net.SocketTimeoutException: Read timed out&lt;br/&gt;
       at java.net.SocketInputStream.socketRead0(Native Method)&lt;br/&gt;
       at java.net.SocketInputStream.read(SocketInputStream.java:129)&lt;br/&gt;
       at com.mysql.jdbc.util.ReadAheadInputStream.fill(ReadAheadInputStream.java:113)&lt;br/&gt;
       at com.mysql.jdbc.util.ReadAheadInputStream.readFromUnderlyingStreamIfNecessary(ReadAheadInputStream.java:160)&lt;br/&gt;
       at com.mysql.jdbc.util.ReadAheadInputStream.read(ReadAheadInputStream.java:188)&lt;br/&gt;
       at com.mysql.jdbc.MysqlIO.readFully(MysqlIO.java:1994)&lt;br/&gt;
       at com.mysql.jdbc.MysqlIO.reuseAndReadPacket(MysqlIO.java:2411)&lt;br/&gt;
       at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:2916)&lt;br/&gt;
       at com.mysql.jdbc.MysqlIO.sendCommand(MysqlIO.java:1631)&lt;br/&gt;
       at com.mysql.jdbc.MysqlIO.sqlQueryDirect(MysqlIO.java:1723)&lt;br/&gt;
       at com.mysql.jdbc.Connection.execSQL(Connection.java:3250)&lt;br/&gt;
       at com.mysql.jdbc.Statement.executeUpdate(Statement.java:1355)&lt;br/&gt;
       at com.mysql.jdbc.Statement.executeUpdate(Statement.java:1270)&lt;br/&gt;
       at org.apache.commons.dbcp.DelegatingStatement.executeUpdate(DelegatingStatement.java:228)&lt;br/&gt;
...&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;It always happens in an infrequently used JVM (not an app server handling frequent connections). So it&apos;s likely the offending connection was asleep for a long time before the exception occurs. &lt;/p&gt;

&lt;p&gt;I&apos;ve confirmed that this issue only occurs using 1.2.2 and not 1.2.1. I&apos;ve been looking through the changelogs but can&apos;t find anything that would cause this behavior.&lt;/p&gt;

&lt;p&gt;Does somebody familiar with the codebase have any idea what change (1.2.1-&amp;gt;1.2.2) could be causing this behavior? &lt;/p&gt;

&lt;p&gt;Thanks&lt;/p&gt;</description>
                <environment>&lt;p&gt;Fedora Core 3, MySQL 4.1.22. with the latest driver (5.07). Exceptions only occur in the &quot;job processing&quot; JVM, which sits idle for long periods of time and occasionally wakes up to interact with the database.&lt;/p&gt;</environment>
        <key id="12380004">DBCP-244</key>
            <summary>Connection socket hangs sporadically in DBCP 1.2.2 but not 1.2.1</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="5">Cannot Reproduce</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="os111">ori</reporter>
                        <labels>
                    </labels>
                <created>Tue, 9 Oct 2007 22:26:41 +0000</created>
                <updated>Mon, 7 Feb 2011 18:31:17 +0000</updated>
                            <resolved>Sat, 21 Feb 2009 17:29:58 +0000</resolved>
                                    <version>1.2.2</version>
                                    <fixVersion>1.3</fixVersion>
                                        <due></due>
                            <votes>1</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="12533919" author="psteitz" created="Thu, 11 Oct 2007 01:05:44 +0000"  >&lt;p&gt;Can you share the dbcp configuration that you are using?  Also, are you using DBCP 1.2.2 + Pool 1.3 and DBCP 1.2.1 + pool 1.2?   &lt;/p&gt;</comment>
                            <comment id="12534139" author="os111" created="Thu, 11 Oct 2007 19:45:20 +0000"  >&lt;p&gt;Thanks for the quick reply.&lt;/p&gt;

&lt;p&gt;The problem occurs when using DBCP 1.2.2 + Pool 1.3.&lt;/p&gt;

&lt;p&gt;It does not occur with DBCP 1.2.1 + Pool 1.2. It also does not occur with DBCP 1.2.1 + Pool 1.3.&lt;/p&gt;

&lt;p&gt;I have not tested DBCP 1.2.2. + Pool 1.2, but the above configurations indicate the issue is with DBCP 1.2.2 only.&lt;/p&gt;

&lt;p&gt;Here is the configuation:&lt;/p&gt;

&lt;p&gt;defaultAutoCommit=true&lt;br/&gt;
driverClassName=com.mysql.Driver&lt;br/&gt;
maxActive=300&lt;br/&gt;
maxIdle=30&lt;br/&gt;
minIdle=5&lt;br/&gt;
initialSize=5&lt;br/&gt;
maxWait=15000&lt;br/&gt;
removeAbandoned=false&lt;br/&gt;
logAbandoned=false&lt;br/&gt;
connectionProperties=autoReconnect=true;jdbcCompliantTruncation=false;socketTimeout=360000&lt;/p&gt;</comment>
                            <comment id="12534189" author="psteitz" created="Fri, 12 Oct 2007 00:03:43 +0000"  >&lt;p&gt;Since config for these is not listed and both are turned off by default, I assume you are not using the idle object evictor or pooling prepared statements.  Can you post the code that a) creates the connection b) creates the statement c) executes the update?  Can you see anything in the database logs that indicates deadlock / lock contention?  &lt;/p&gt;</comment>
                            <comment id="12534297" author="os111" created="Fri, 12 Oct 2007 14:15:55 +0000"  >&lt;p&gt;Correct--those are the only configuration parameters I specify.&lt;/p&gt;

&lt;p&gt;There is no indication of a lock. Furthermore, there&apos;s no indication that the query/update was ever executed. It never shows up in MySQL&apos;s &quot;SHOW PROCESSLIST&quot; command.&lt;/p&gt;

&lt;p&gt;This issue can appear on any query/statement without any pattern (MyISAM or InnoDB tables, INSERT or SELECT). &lt;/p&gt;

&lt;p&gt;I use standard JDBC programming practices when accessing statements/connections.&lt;/p&gt;

&lt;p&gt;The DataSource is created once per application like this:&lt;/p&gt;

&lt;p&gt;dataSource = org.apache.commons.dbcp.BasicDataSourceFactory.createDataSource( commonsDbProps );&lt;/p&gt;

&lt;p&gt;Connections are obtained like this:&lt;/p&gt;

&lt;p&gt;dataSource.getConnection();&lt;/p&gt;

&lt;p&gt;All JDBC calls are executed in a try/finally block that closes result sets, statments, and connections immediately after they&apos;re used in the finally block (in that order).&lt;/p&gt;

&lt;p&gt;I&apos;m confident that I&apos;m not misusing any APIs. &lt;/p&gt;

&lt;p&gt;The fact that I can eliminate this issue by switching to another version of DBCP would indicate my application code and database setup are not the problem (but I could be wrong).&lt;/p&gt;

&lt;p&gt;I think the most important clue we have is that I&apos;m using the exact same setup on my Tomcat server with DBCP 1.2.2 and have never experienced this issue. That server is under heavy load all the time so Connections never sit idle (up to 2.5M dynamic pageviews per day).&lt;/p&gt;

&lt;p&gt;The JVM having the issues is running Quartz, a scheduling library (like cron jobs but in Java) so it can sit idle for a few hours, then wake up and access the database, then sleep again.&lt;/p&gt;</comment>
                            <comment id="12547364" author="psteitz" created="Sat, 1 Dec 2007 01:55:44 +0000"  >&lt;p&gt;Need to resolve this prior to 1.3&lt;/p&gt;</comment>
                            <comment id="12563872" author="riwema" created="Wed, 30 Jan 2008 07:25:27 +0000"  >&lt;p&gt;I have the same issue with the same characteristics.&lt;/p&gt;

&lt;p&gt;Using:&lt;/p&gt;

&lt;p&gt;Windows2003,&lt;br/&gt;
MySQL 5.0.51a&lt;br/&gt;
Apache Tomcat 5.5.25&lt;br/&gt;
DBCP: 1.2.2&lt;br/&gt;
Pool: 1.3&lt;/p&gt;

&lt;p&gt;The server is not frequently used, and I have no problems when using DBCP 1.2.1&lt;/p&gt;</comment>
                            <comment id="12565034" author="psteitz" created="Sat, 2 Feb 2008 05:58:57 +0000"  >&lt;p&gt;One possibility is that this change in behavior is caused by the change to address &lt;a href=&quot;https://issues.apache.org/jira/browse/DBCP-102&quot; title=&quot;[dbcp] setReadOnly &amp;amp; setAutoCommit called too many times&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DBCP-102&quot;&gt;&lt;del&gt;DBCP-102&lt;/del&gt;&lt;/a&gt;. In 1.2.1, PoolableConnectionFactory&apos;s activate method &lt;b&gt;always&lt;/b&gt; did&lt;br/&gt;
&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/star_yellow.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; conn.setAutoCommit(_defaultAutoCommit);&lt;br/&gt;
Could be stale / timed out MySQL connections throw (quickly) on this. Pool&apos;s borrowObject would swallow this and try to get another connection, moving along. The change to address &lt;a href=&quot;https://issues.apache.org/jira/browse/DBCP-102&quot; title=&quot;[dbcp] setReadOnly &amp;amp; setAutoCommit called too many times&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DBCP-102&quot;&gt;&lt;del&gt;DBCP-102&lt;/del&gt;&lt;/a&gt; was to test the property in &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/star_yellow.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; before resetting it, because for some drivers this caused a network hit. So in 1.2.2, activate succeeds, the client gets back the stale connection and things don&apos;t go south until the connection is used.&lt;/p&gt;

&lt;p&gt;Try adding conn.setAutoCommit(true) immediately after getConnection and before using the connection after wakeup. If this throws an exception, then the hypothesis above is correct. &lt;/p&gt;
</comment>
                            <comment id="12565756" author="andrus" created="Tue, 5 Feb 2008 14:30:52 +0000"  >&lt;p&gt;I am observing a similar behavior with MySQL 5.0, dbcp-1.2.1, pool-1.2.... Also no visible deadlock in a thread dump. It happens once every few weeks, but usually simultaneously on multiple applications, so I suspect it is caused by temporary network outages... The problem of course is that the pool never recovers.&lt;/p&gt;

&lt;p&gt;Stuck threads look like this:&lt;/p&gt;

&lt;p&gt;btpool0-873&quot; prio=10 tid=0x01001c50 nid=0x26a3 runnable &lt;span class=&quot;error&quot;&gt;&amp;#91;0x679fc000..0x679ffaf0&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at java.net.SocketInputStream.socketRead0(Native Method)&lt;br/&gt;
        at java.net.SocketInputStream.read(SocketInputStream.java:129)&lt;br/&gt;
        at com.mysql.jdbc.util.ReadAheadInputStream.fill(ReadAheadInputStream.java:113)&lt;br/&gt;
        at com.mysql.jdbc.util.ReadAheadInputStream.readFromUnderlyingStreamIfNecessary(ReadAheadInputStream.java:160)&lt;br/&gt;
        at com.mysql.jdbc.util.ReadAheadInputStream.read(ReadAheadInputStream.java:188)&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;locked &amp;lt;0xab4f6b20&amp;gt; (a com.mysql.jdbc.util.ReadAheadInputStream)&lt;br/&gt;
        at com.mysql.jdbc.MysqlIO.readFully(MysqlIO.java:1902)&lt;br/&gt;
        at com.mysql.jdbc.MysqlIO.reuseAndReadPacket(MysqlIO.java:2351)&lt;br/&gt;
        at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:2862)&lt;br/&gt;
        at com.mysql.jdbc.MysqlIO.sendCommand(MysqlIO.java:1571)&lt;br/&gt;
        at com.mysql.jdbc.ServerPreparedStatement.serverExecute(ServerPreparedStatement.java:1124)&lt;/li&gt;
	&lt;li&gt;locked &amp;lt;0xac8430b0&amp;gt; (a java.lang.Object)&lt;br/&gt;
        at com.mysql.jdbc.ServerPreparedStatement.executeInternal(ServerPreparedStatement.java:676)&lt;br/&gt;
        at com.mysql.jdbc.PreparedStatement.executeQuery(PreparedStatement.java:1030)&lt;/li&gt;
	&lt;li&gt;locked &amp;lt;0xac8430b0&amp;gt; (a java.lang.Object)&lt;/li&gt;
	&lt;li&gt;locked &amp;lt;0xa69343f0&amp;gt; (a com.mysql.jdbc.ServerPreparedStatement)&lt;br/&gt;
        at org.apache.commons.dbcp.DelegatingPreparedStatement.executeQuery(DelegatingPreparedStatement.java:92)&lt;br/&gt;
        at org.apache.cayenne.access.jdbc.SelectAction.performAction(SelectAction.java:72)&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;DBCP pool is wrapped in a Cayenne decorator, but this is still a DBCP pool with the following settings:&lt;/p&gt;

&lt;p&gt;cayenne.dbcp.maxActive=8&lt;br/&gt;
cayenne.dbcp.minIdle=1&lt;br/&gt;
cayenne.dbcp.maxIdle=4&lt;br/&gt;
cayenne.dbcp.validationQuery=select 1 from nhldb.division limit 1;&lt;br/&gt;
cayenne.dbcp.testWhileIdle=true&lt;/p&gt;

&lt;p&gt;Can&apos;t even say that DBCP is here to blame, but still figured I provide this data point.&lt;/p&gt;</comment>
                            <comment id="12565760" author="andrus" created="Tue, 5 Feb 2008 14:49:45 +0000"  >&lt;p&gt;&amp;gt; dbcp.testWhileIdle=true&lt;/p&gt;

&lt;p&gt;One correction to my previous comment - I think the setting above has  no effect, since &quot;timeBetweenEvictionRunsMillis&quot; is not set.&lt;/p&gt;</comment>
                            <comment id="12567500" author="os111" created="Mon, 11 Feb 2008 01:21:42 +0000"  >&lt;p&gt;Phil,&lt;/p&gt;

&lt;p&gt;I&apos;ve tried your suggestion for about seven days in the live environment with no luck so far.&lt;/p&gt;

&lt;p&gt;Looking at the source code, it seems like an excellent guess. But I have not been able to induce the exception.&lt;/p&gt;</comment>
                            <comment id="12575434" author="os111" created="Wed, 5 Mar 2008 17:50:24 +0000"  >&lt;p&gt;Phil,&lt;/p&gt;

&lt;p&gt;In response to your suggestion on Feb 1 2008, I can now confirm that this is not the case.&lt;/p&gt;

&lt;p&gt;All connections were obtained using the code below. The exception was thrown later on a SELECT query.&lt;/p&gt;

&lt;p&gt;public static Connection getConnection()&lt;br/&gt;
        throws SQLException&lt;/p&gt;
    {
        Connection conn = dataSource.getConnection();
        conn.setAutoCommit(true);
        return conn;
    }

&lt;p&gt;&amp;#8211;&lt;/p&gt;

&lt;p&gt;Caused by: com.mysql.jdbc.CommunicationsException: Communications link failure due to underlying exception:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;
	&lt;ul&gt;
		&lt;li&gt;BEGIN NESTED EXCEPTION **&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;java.net.SocketTimeoutException&lt;br/&gt;
MESSAGE: Read timed out&lt;/p&gt;

&lt;p&gt;STACKTRACE:&lt;/p&gt;

&lt;p&gt;java.net.SocketTimeoutException: Read timed out&lt;br/&gt;
       at java.net.SocketInputStream.socketRead0(Native Method)&lt;br/&gt;
       at java.net.SocketInputStream.read(SocketInputStream.java:129)&lt;br/&gt;
       at com.mysql.jdbc.util.ReadAheadInputStream.fill(ReadAheadInputStream.java:113)&lt;br/&gt;
       at com.mysql.jdbc.util.ReadAheadInputStream.readFromUnderlyingStreamIfNecessary(ReadAheadInputStream.java:160)&lt;br/&gt;
       at com.mysql.jdbc.util.ReadAheadInputStream.read(ReadAheadInputStream.java:188)&lt;br/&gt;
       at com.mysql.jdbc.MysqlIO.readFully(MysqlIO.java:1994)&lt;br/&gt;
       at com.mysql.jdbc.MysqlIO.reuseAndReadPacket(MysqlIO.java:2464)&lt;br/&gt;
       at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:2916)&lt;br/&gt;
       at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:885)&lt;br/&gt;
       at com.mysql.jdbc.MysqlIO.nextRow(MysqlIO.java:1360)&lt;br/&gt;
       at com.mysql.jdbc.MysqlIO.readSingleRowSet(MysqlIO.java:2369)&lt;br/&gt;
       at com.mysql.jdbc.MysqlIO.getResultSet(MysqlIO.java:451)&lt;br/&gt;
       at com.mysql.jdbc.MysqlIO.readResultsForQueryOrUpdate(MysqlIO.java:2076)&lt;br/&gt;
       at com.mysql.jdbc.MysqlIO.readAllResults(MysqlIO.java:1451)&lt;br/&gt;
       at com.mysql.jdbc.MysqlIO.sqlQueryDirect(MysqlIO.java:1787)&lt;br/&gt;
       at com.mysql.jdbc.Connection.execSQL(Connection.java:3256)&lt;br/&gt;
       at com.mysql.jdbc.PreparedStatement.executeInternal(PreparedStatement.java:1313)&lt;br/&gt;
       at com.mysql.jdbc.PreparedStatement.executeQuery(PreparedStatement.java:1448)&lt;br/&gt;
       at org.apache.commons.dbcp.DelegatingPreparedStatement.executeQuery(DelegatingPreparedStatement.java:93)&lt;br/&gt;
... &lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;my application code&amp;#93;&lt;/span&gt;&lt;/p&gt;</comment>
                            <comment id="12635869" author="carlgould" created="Tue, 30 Sep 2008 21:47:33 +0000"  >&lt;p&gt;I&apos;m seeing this too. I get one thread with the following dump (see below) and then the rest all block on &lt;/p&gt;

&lt;p&gt;org.apache.commons.dbcp.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:294) &lt;/p&gt;

&lt;p&gt;This is on Windows Server 2003 Standard Ed, Java 1.5.0_11, DBCP 1.2.2, Pool 1.4 MySQL Connector/J 5.0.4 &lt;/p&gt;

&lt;p&gt;We used DBCP 1.2.1 for years, and never saw this. It seems to happen after a network drop between DBCP and the database. &lt;/p&gt;

&lt;p&gt;Of course, we upgraded to DBCP 1.2.2 to fix the bug in 1.2.1 that caused the pool to leak connections when the underlying connection closed itself due to socket error and then the framework didn&apos;t catch the &quot;already closed&quot; exception... &lt;/p&gt;

&lt;p&gt;Anyhow, I digress, the stack trace of the blocked thread is: &lt;/p&gt;

&lt;p&gt;java.net.SocketInputStream.socketRead0(Native Method) &lt;br/&gt;
java.net.SocketInputStream.read(Unknown Source) &lt;br/&gt;
com.mysql.jdbc.util.ReadAheadInputStream.fill(ReadAheadInputStream.java:113) &lt;br/&gt;
com.mysql.jdbc.util.ReadAheadInputStream.readFromUnderlyingStreamIfNecessary(ReadAheadInputStream.java:160) &lt;br/&gt;
com.mysql.jdbc.util.ReadAheadInputStream.read(ReadAheadInputStream.java:188) &lt;br/&gt;
com.mysql.jdbc.MysqlIO.readFully(MysqlIO.java:1910) &lt;br/&gt;
com.mysql.jdbc.MysqlIO.readPacket(MysqlIO.java:501) &lt;br/&gt;
com.mysql.jdbc.MysqlIO.doHandshake(MysqlIO.java:971) &lt;br/&gt;
com.mysql.jdbc.Connection.createNewIO(Connection.java:2670) &lt;br/&gt;
com.mysql.jdbc.Connection.(Connection.java:1531) &lt;br/&gt;
com.mysql.jdbc.NonRegisteringDriver.connect(NonRegisteringDriver.java:266) &lt;br/&gt;
org.apache.commons.dbcp.DriverConnectionFactory.createConnection(DriverConnectionFactory.java:38) &lt;br/&gt;
org.apache.commons.dbcp.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:294) &lt;br/&gt;
org.apache.commons.pool.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:974) &lt;br/&gt;
org.apache.commons.dbcp.AbandonedObjectPool.borrowObject(AbandonedObjectPool.java:84) &lt;br/&gt;
org.apache.commons.dbcp.PoolingDataSource.getConnection(PoolingDataSource.java:96) &lt;br/&gt;
org.apache.commons.dbcp.BasicDataSource.getConnection(BasicDataSource.java:880) &lt;br/&gt;
...[ application code ]&lt;/p&gt;</comment>
                            <comment id="12674836" author="markt" created="Thu, 19 Feb 2009 00:43:51 +0000"  >&lt;p&gt;I&apos;m not familiar enough with the changes from 1.2.1 to 1.2.2 to identify the change that caused this. However, the 1.2.2 behaviour is not unexpected. The database, or possibly a firewall, is closing the unused connections.&lt;/p&gt;

&lt;p&gt;Use of a validation query should prevent the exceptions.&lt;/p&gt;

&lt;p&gt;I can only speculate that the 1.2.1 code kept something open that perhaps it shouldn&apos;t and that was sufficient to keep the connection alive.&lt;/p&gt;

&lt;p&gt;I am closing this as invalid on the grounds that the observed behaviour is as expected.&lt;/p&gt;</comment>
                            <comment id="12675488" author="os111" created="Fri, 20 Feb 2009 22:11:11 +0000"  >&lt;p&gt;Mark I was using a validation query and still saw this.&lt;/p&gt;

&lt;p&gt;It&apos;s a real bug.&lt;/p&gt;

&lt;p&gt;But it&apos;s very difficult to hunt down. It may be an interaction specific to the MySQL driver.&lt;/p&gt;</comment>
                            <comment id="12675489" author="markt" created="Fri, 20 Feb 2009 22:17:18 +0000"  >&lt;p&gt;Re-opening based on previous comment.&lt;/p&gt;

&lt;p&gt;Can you still reproduce this?&lt;/p&gt;</comment>
                            <comment id="12675494" author="markt" created="Fri, 20 Feb 2009 22:33:55 +0000"  >&lt;p&gt;A couple more questions.&lt;/p&gt;

&lt;p&gt;1. Are you sure you were using a validation query? None of your previous configuration information included validation query settings. What settings are you using?&lt;/p&gt;

&lt;p&gt;2. When the connection is idle is it idle in the pool or has been been obtained but not used for a while?&lt;/p&gt;

&lt;p&gt;And a couple of shots in the dark:&lt;/p&gt;

&lt;p&gt;3. Does it still happen with autoReconnect=false?&lt;/p&gt;

&lt;p&gt;4. Does it still happen with the latest mySQL driver?&lt;/p&gt;</comment>
                            <comment id="12675576" author="os111" created="Sat, 21 Feb 2009 16:58:11 +0000"  >&lt;p&gt;I wasn&apos;t using the validation query when I reported my initial setup but I later added it to see if it would fix the issue. It did not.&lt;/p&gt;

&lt;p&gt;1. Yes I am sure.&lt;/p&gt;

&lt;p&gt;2. &lt;br/&gt;
url=....autoReconnect=true;jdbcCompliantTruncation=false;socketTimeout=360000&lt;/p&gt;

&lt;p&gt;defaultAutoCommit=true&lt;br/&gt;
driverClassName=com.mysql.Driver&lt;br/&gt;
maxActive=500&lt;br/&gt;
maxIdle=30&lt;br/&gt;
minIdle=5&lt;br/&gt;
initialSize=5&lt;br/&gt;
maxWait=8000&lt;br/&gt;
removeAbandoned=false&lt;br/&gt;
logAbandoned=false&lt;br/&gt;
poolPreparedStatements=false&lt;br/&gt;
maxOpenPreparedStatements=50&lt;br/&gt;
validationQuery=SELECT 1&lt;/p&gt;

&lt;p&gt;3. Not sure, I&apos;ve always used autoReconnect. It&apos;s tough for me to test without because I cannot replicate this issue easily and I have since moved on to a different configuration. But at the time I was able to isolate it to the switch from DBCP 1.2.1-&amp;gt;1.2.2. and it drove me crazy.&lt;/p&gt;

&lt;p&gt;4. Again, I&apos;m not sure. It may be resolved. Because my setup has changed since than I cannot provide any more information.&lt;/p&gt;

&lt;p&gt;You can safely leave this issue closed for now and I&apos;ll definitely keep posting information if I can. &lt;/p&gt;</comment>
                            <comment id="12675583" author="markt" created="Sat, 21 Feb 2009 17:29:58 +0000"  >&lt;p&gt;OK, I am resolving this as can&apos;t reproduce. If it surfaces again, feel free to reopen.&lt;/p&gt;</comment>
                            <comment id="12884297" author="alexeysergeev" created="Thu, 1 Jul 2010 14:33:48 +0000"  >&lt;p&gt; The probem is reproducibe  - that&apos;s for sure!&lt;br/&gt;
To reach the problem you need to reconfigure MySQL server a little. I.e. update my.ini (on Windows) or my.cnf (on Linux) and set idle conection timeout to  smaller value:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;[mysqld]
...
# use one minute timeout
wait_timeout=60 
...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Default value is 8 hours so it is not so eacsy to reproduce &quot;broken pipe&quot; error so easy (not so feasible).&lt;/p&gt;

&lt;p&gt;So if you run you application (with commons-dbcp-1.2.2.jar) on mysql configured in this way you will be able to get the exception ().&lt;/p&gt;

&lt;p&gt;I&apos;ve tried to use additional properties like maxOpenPreparedStatements, validationQuery nd etc. But it does NOT help!&lt;/p&gt;

&lt;p&gt;But one this that works ALWAYS - is using commons-dbcp-1.2.1.jar.&lt;/p&gt;

&lt;p&gt;So guys,  could you fix this REAL problem and provide new release?! Or at least explayn what has been changed in new DBCP and how exacly it could be properly configured?&lt;/p&gt;</comment>
                            <comment id="12991262" author="tangjie_0" created="Mon, 7 Feb 2011 04:44:54 +0000"  >&lt;p&gt;I have the same problem, I&apos;m using Sql Server 2005, the latest DBCP1.4 common-pool 1.54, the Sql Server&apos;s JDBC can not provide socketTime timeout, so I occasionally hang the connection, resulting in procedural paralysis, I Anxious,&lt;br/&gt;
maxActive = 150&lt;br/&gt;
maxIdle = 150&lt;br/&gt;
minIdle = 0&lt;br/&gt;
initialSize = 0&lt;br/&gt;
maxWait = 30000&lt;br/&gt;
removeAbandoned = false&lt;br/&gt;
logAbandoned = false&lt;br/&gt;
validationQuery = SELECT 1&lt;br/&gt;
testOnBorrow = true&lt;br/&gt;
testWhileIdle = false&lt;br/&gt;
timeBetweenEvictionRunsMillis = 60000&lt;br/&gt;
numTestsPerEvictionRun =- 2&lt;br/&gt;
minEvictableIdleTimeMillis = 120000&lt;/p&gt;</comment>
                            <comment id="12991345" author="psteitz" created="Mon, 7 Feb 2011 12:00:26 +0000"  >&lt;p&gt;@tangile:  What exactly do you mean by &quot;procedural paralysis?&quot;  Do you mean that the thread waiting on the hung socket stalls, or other threads as well are blocked?  If the latter, can you attach a thread dump?&lt;/p&gt;</comment>
                            <comment id="12991364" author="tangjie" created="Mon, 7 Feb 2011 12:56:48 +0000"  >&lt;p&gt;&quot;pool-1-thread-149&quot; prio=10 tid=0x00002aac442f5800 nid=0x65a3 runnable &lt;span class=&quot;error&quot;&gt;&amp;#91;0x000000004884b000&amp;#93;&lt;/span&gt;&lt;br/&gt;
   java.lang.Thread.State: RUNNABLE&lt;br/&gt;
	at java.net.SocketInputStream.socketRead0(Native Method)&lt;br/&gt;
	at java.net.SocketInputStream.read(SocketInputStream.java:129)&lt;br/&gt;
	at com.microsoft.sqlserver.jdbc.TDSChannel.read(Unknown Source)&lt;br/&gt;
	at com.microsoft.sqlserver.jdbc.TDSReader.readPacket(Unknown Source)&lt;br/&gt;
	at com.microsoft.sqlserver.jdbc.TDSReader.readPacket(Unknown Source)&lt;br/&gt;
	at com.microsoft.sqlserver.jdbc.TDSCommand.startResponse(Unknown Source)&lt;br/&gt;
	at com.microsoft.sqlserver.jdbc.SQLServerPreparedStatement.doExecutePreparedStatement(Unknown Source)&lt;br/&gt;
	at com.microsoft.sqlserver.jdbc.SQLServerPreparedStatement$PrepStmtExecCmd.doExecute(Unknown Source)&lt;br/&gt;
	at com.microsoft.sqlserver.jdbc.TDSCommand.execute(Unknown Source)&lt;br/&gt;
	at com.microsoft.sqlserver.jdbc.SQLServerConnection.executeCommand(Unknown Source)&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;locked &amp;lt;0x00002aab7ddeb8c8&amp;gt; (a com.microsoft.sqlserver.jdbc.SQLServerConnection)&lt;br/&gt;
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.executeCommand(Unknown Source)&lt;/li&gt;
	&lt;li&gt;locked &amp;lt;0x00002aab7ddec1d8&amp;gt; (a com.microsoft.sqlserver.jdbc.SQLServerPreparedStatement)&lt;br/&gt;
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.executeStatement(Unknown Source)&lt;br/&gt;
	at com.microsoft.sqlserver.jdbc.SQLServerPreparedStatement.executeUpdate(Unknown Source)&lt;br/&gt;
	at org.apache.commons.dbcp.DelegatingPreparedStatement.executeUpdate(DelegatingPreparedStatement.java:105)&lt;br/&gt;
	at org.apache.commons.dbcp.DelegatingPreparedStatement.executeUpdate(DelegatingPreparedStatement.java:105)&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="12991367" author="tangjie" created="Mon, 7 Feb 2011 12:57:54 +0000"  >&lt;p&gt;the connection  hang forever. &lt;/p&gt;</comment>
                            <comment id="12991391" author="tangjie" created="Mon, 7 Feb 2011 14:28:03 +0000"  >&lt;p&gt;pool-1-thread-247&quot; prio=10 tid=0x00002aac48112000 nid=0x7155 runnable &lt;span class=&quot;error&quot;&gt;&amp;#91;0x000000005bf3b000&amp;#93;&lt;/span&gt;&lt;br/&gt;
   java.lang.Thread.State: RUNNABLE&lt;br/&gt;
	at java.net.SocketInputStream.socketRead0(Native Method)&lt;br/&gt;
	at java.net.SocketInputStream.read(SocketInputStream.java:129)&lt;br/&gt;
	at com.microsoft.sqlserver.jdbc.TDSChannel.read(Unknown Source)&lt;br/&gt;
	at com.microsoft.sqlserver.jdbc.TDSReader.readPacket(Unknown Source)&lt;br/&gt;
	at com.microsoft.sqlserver.jdbc.TDSReader.readPacket(Unknown Source)&lt;br/&gt;
	at com.microsoft.sqlserver.jdbc.TDSCommand.startResponse(Unknown Source)&lt;br/&gt;
	at com.microsoft.sqlserver.jdbc.SQLServerPreparedStatement.doExecutePreparedStatement(Unknown Source)&lt;br/&gt;
	at com.microsoft.sqlserver.jdbc.SQLServerPreparedStatement$PrepStmtExecCmd.doExecute(Unknown Source)&lt;br/&gt;
	at com.microsoft.sqlserver.jdbc.TDSCommand.execute(Unknown Source)&lt;br/&gt;
	at com.microsoft.sqlserver.jdbc.SQLServerConnection.executeCommand(Unknown Source)&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;locked &amp;lt;0x00002aab80b55d30&amp;gt; (a com.microsoft.sqlserver.jdbc.SQLServerConnection)&lt;br/&gt;
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.executeCommand(Unknown Source)&lt;/li&gt;
	&lt;li&gt;locked &amp;lt;0x00002aab80b55e18&amp;gt; (a com.microsoft.sqlserver.jdbc.SQLServerPreparedStatement)&lt;br/&gt;
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.executeStatement(Unknown Source)&lt;br/&gt;
	at com.microsoft.sqlserver.jdbc.SQLServerPreparedStatement.execute(Unknown Source)&lt;br/&gt;
	at org.apache.commons.dbcp.DelegatingPreparedStatement.execute(DelegatingPreparedStatement.java:172)&lt;br/&gt;
	at org.apache.commons.dbcp.DelegatingPreparedStatement.execute(DelegatingPreparedStatement.java:172)&lt;/li&gt;
&lt;/ul&gt;



</comment>
                            <comment id="12991505" author="tangjie" created="Mon, 7 Feb 2011 18:31:17 +0000"  >&lt;p&gt;I have no other way I can change one of the other sql server 2005 JDBC driver, JTDS, so that you can set the socket timeout&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10020">
                    <name>Cloners</name>
                                                                <inwardlinks description="is cloned by">
                                        <issuelink>
            <issuekey id="12431529">DBCP-298</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114523</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            14 years, 39 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0v0r3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>179095</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-243] Oracle 10G loadbalanced DB - ERROR</title>
                <link>https://issues.apache.org/jira/browse/DBCP-243</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;Hi,&lt;/p&gt;

&lt;p&gt;We have changed the my db from Oracle 9i to Oracle 10G loadbalanced DB now. &lt;br/&gt;
After changing to Oracle 10G we are getting the following error some times this is not happning in Oracle 9i.&lt;/p&gt;

&lt;p&gt;Oct 3, 2007 9:15:52 AM net.sf.hibernate.transaction.JDBCTransaction commit&lt;br/&gt;
SEVERE: Commit failed&lt;br/&gt;
java.sql.SQLException: Closed Connection&lt;br/&gt;
	at oracle.jdbc.driver.DatabaseError.throwSqlException(DatabaseError.java:112)&lt;br/&gt;
	at oracle.jdbc.driver.DatabaseError.throwSqlException(DatabaseError.java:146)&lt;br/&gt;
	at oracle.jdbc.driver.DatabaseError.throwSqlException(DatabaseError.java:208)&lt;br/&gt;
	at oracle.jdbc.driver.PhysicalConnection.commit(PhysicalConnection.java:1112)&lt;br/&gt;
	at org.apache.tomcat.dbcp.dbcp.DelegatingConnection.commit(DelegatingConnection.java:238)&lt;br/&gt;
	at org.apache.tomcat.dbcp.dbcp.PoolingDataSource$PoolGuardConnectionWrapper.commit(PoolingDataSource.java:199)&lt;br/&gt;
	at net.sf.hibernate.transaction.JDBCTransaction.commit(JDBCTransaction.java:63)&lt;br/&gt;
	at com.hp.ocs.shared.filter.HibernateSessionFilter.doFilter(HibernateSessionFilter.java:64)&lt;br/&gt;
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(Unknown Source)&lt;br/&gt;
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(Unknown Source)&lt;br/&gt;
	at com.hp.websat.timber.transaction.TransactionLoggingFilter.doFilter(TransactionLoggingFilter.java:104)&lt;br/&gt;
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(Unknown Source)&lt;br/&gt;
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(Unknown Source)&lt;br/&gt;
	at org.ajaxanywhere.AAFilter.doFilter(AAFilter.java:41)&lt;br/&gt;
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(Unknown Source)&lt;br/&gt;
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(Unknown Source)&lt;br/&gt;
	at org.apache.catalina.core.StandardWrapperValve.invoke(Unknown Source)&lt;br/&gt;
	at org.apache.catalina.core.StandardContextValve.invoke(Unknown Source)&lt;br/&gt;
	at org.apache.catalina.core.StandardHostValve.invoke(Unknown Source)&lt;br/&gt;
	at org.apache.catalina.valves.ErrorReportValve.invoke(Unknown Source)&lt;br/&gt;
	at org.apache.catalina.core.StandardEngineValve.invoke(Unknown Source)&lt;br/&gt;
	at org.apache.catalina.connector.CoyoteAdapter.service(Unknown Source)&lt;br/&gt;
	at org.apache.jk.server.JkCoyoteHandler.invoke(Unknown Source)&lt;br/&gt;
	at org.apache.jk.common.HandlerRequest.invoke(Unknown Source)&lt;br/&gt;
	at org.apache.jk.common.ChannelSocket.invoke(Unknown Source)&lt;br/&gt;
	at org.apache.jk.common.ChannelSocket.processConnection(Unknown Source)&lt;br/&gt;
	at org.apache.jk.common.SocketConnection.runIt(Unknown Source)&lt;br/&gt;
	at org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run(Unknown Source)&lt;br/&gt;
	at java.lang.Thread.run(Thread.java:595)&lt;br/&gt;
Oct 3, 2007 9:15:52 AM net.sf.hibernate.transaction.JDBCTransaction toggleAutoCommit&lt;br/&gt;
SEVERE: Could not toggle autocommit&lt;br/&gt;
java.sql.SQLException: Closed Connection&lt;br/&gt;
	at oracle.jdbc.driver.DatabaseError.throwSqlException(DatabaseError.java:112)&lt;br/&gt;
	at oracle.jdbc.driver.DatabaseError.throwSqlException(DatabaseError.java:146)&lt;br/&gt;
	at oracle.jdbc.driver.DatabaseError.throwSqlException(DatabaseError.java:208)&lt;br/&gt;
	at oracle.jdbc.driver.PhysicalConnection.setAutoCommit(PhysicalConnection.java:1038)&lt;br/&gt;
	at org.apache.tomcat.dbcp.dbcp.DelegatingConnection.setAutoCommit(DelegatingConnection.java:268)&lt;br/&gt;
	at org.apache.tomcat.dbcp.dbcp.PoolingDataSource$PoolGuardConnectionWrapper.setAutoCommit(PoolingDataSource.java:293)&lt;br/&gt;
	at net.sf.hibernate.transaction.JDBCTransaction.toggleAutoCommit(JDBCTransaction.java:104)&lt;br/&gt;
	at net.sf.hibernate.transaction.JDBCTransaction.commit(JDBCTransaction.java:74)&lt;br/&gt;
	at com.hp.ocs.shared.filter.HibernateSessionFilter.doFilter(HibernateSessionFilter.java:64)&lt;br/&gt;
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(Unknown Source)&lt;br/&gt;
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(Unknown Source)&lt;br/&gt;
	at com.hp.websat.timber.transaction.TransactionLoggingFilter.doFilter(TransactionLoggingFilter.java:104)&lt;br/&gt;
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(Unknown Source)&lt;br/&gt;
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(Unknown Source)&lt;br/&gt;
	at org.ajaxanywhere.AAFilter.doFilter(AAFilter.java:41)&lt;br/&gt;
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(Unknown Source)&lt;br/&gt;
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(Unknown Source)&lt;br/&gt;
	at org.apache.catalina.core.StandardWrapperValve.invoke(Unknown Source)&lt;br/&gt;
	at org.apache.catalina.core.StandardContextValve.invoke(Unknown Source)&lt;br/&gt;
	at org.apache.catalina.core.StandardHostValve.invoke(Unknown Source)&lt;br/&gt;
	at org.apache.catalina.valves.ErrorReportValve.invoke(Unknown Source)&lt;br/&gt;
	at org.apache.catalina.core.StandardEngineValve.invoke(Unknown Source)&lt;br/&gt;
	at org.apache.catalina.connector.CoyoteAdapter.service(Unknown Source)&lt;br/&gt;
	at org.apache.jk.server.JkCoyoteHandler.invoke(Unknown Source)&lt;br/&gt;
	at org.apache.jk.common.HandlerRequest.invoke(Unknown Source)&lt;br/&gt;
	at org.apache.jk.common.ChannelSocket.invoke(Unknown Source)&lt;br/&gt;
	at org.apache.jk.common.ChannelSocket.processConnection(Unknown Source)&lt;br/&gt;
	at org.apache.jk.common.SocketConnection.runIt(Unknown Source)&lt;br/&gt;
	at org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run(Unknown Source)&lt;br/&gt;
	at java.lang.Thread.run(Thread.java:595)&lt;br/&gt;
03.10.2007 09:15:52 &lt;b&gt;ERROR&lt;/b&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;TP-Processor24&amp;#93;&lt;/span&gt; Filter: [498C0A304CA8FD8C28071ACF4B24C21B.g3u1109c, &lt;span class=&quot;error&quot;&gt;&amp;#91;None&amp;#93;&lt;/span&gt; ] Something goes wrong in a servlet !net.sf.hibernate.TransactionException: Commit failed with SQL exception: &lt;br/&gt;
	at net.sf.hibernate.transaction.JDBCTransaction.commit(JDBCTransaction.java:71)&lt;br/&gt;
	at com.hp.ocs.shared.filter.HibernateSessionFilter.doFilter(HibernateSessionFilter.java:64)&lt;br/&gt;
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(Unknown Source)&lt;br/&gt;
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(Unknown Source)&lt;br/&gt;
	at com.hp.websat.timber.transaction.TransactionLoggingFilter.doFilter(TransactionLoggingFilter.java:104)&lt;br/&gt;
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(Unknown Source)&lt;br/&gt;
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(Unknown Source)&lt;br/&gt;
	at org.ajaxanywhere.AAFilter.doFilter(AAFilter.java:41)&lt;br/&gt;
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(Unknown Source)&lt;br/&gt;
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(Unknown Source)&lt;br/&gt;
	at org.apache.catalina.core.StandardWrapperValve.invoke(Unknown Source)&lt;br/&gt;
	at org.apache.catalina.core.StandardContextValve.invoke(Unknown Source)&lt;br/&gt;
	at org.apache.catalina.core.StandardHostValve.invoke(Unknown Source)&lt;br/&gt;
	at org.apache.catalina.valves.ErrorReportValve.invoke(Unknown Source)&lt;br/&gt;
	at org.apache.catalina.core.StandardEngineValve.invoke(Unknown Source)&lt;br/&gt;
	at org.apache.catalina.connector.CoyoteAdapter.service(Unknown Source)&lt;br/&gt;
	at org.apache.jk.server.JkCoyoteHandler.invoke(Unknown Source)&lt;br/&gt;
	at org.apache.jk.common.HandlerRequest.invoke(Unknown Source)&lt;br/&gt;
	at org.apache.jk.common.ChannelSocket.invoke(Unknown Source)&lt;br/&gt;
	at org.apache.jk.common.ChannelSocket.processConnection(Unknown Source)&lt;br/&gt;
	at org.apache.jk.common.SocketConnection.runIt(Unknown Source)&lt;br/&gt;
	at org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run(Unknown Source)&lt;br/&gt;
	at java.lang.Thread.run(Thread.java:595)&lt;br/&gt;
Caused by: java.sql.SQLException: Closed Connection&lt;br/&gt;
	at oracle.jdbc.driver.DatabaseError.throwSqlException(DatabaseError.java:112)&lt;br/&gt;
	at oracle.jdbc.driver.DatabaseError.throwSqlException(DatabaseError.java:146)&lt;br/&gt;
	at oracle.jdbc.driver.DatabaseError.throwSqlException(DatabaseError.java:208)&lt;br/&gt;
	at oracle.jdbc.driver.PhysicalConnection.commit(PhysicalConnection.java:1112)&lt;br/&gt;
	at org.apache.tomcat.dbcp.dbcp.DelegatingConnection.commit(DelegatingConnection.java:238)&lt;br/&gt;
	at org.apache.tomcat.dbcp.dbcp.PoolingDataSource$PoolGuardConnectionWrapper.commit(PoolingDataSource.java:199)&lt;br/&gt;
	at net.sf.hibernate.transaction.JDBCTransaction.commit(JDBCTransaction.java:63)&lt;br/&gt;
	... 22 more&lt;br/&gt;
 (OcsLogger.java, line 124)&lt;br/&gt;
Oct 3, 2007 9:15:52 AM net.sf.hibernate.util.JDBCExceptionReporter logExceptions&lt;/p&gt;


&lt;p&gt;Here is my contax.xml:&lt;/p&gt;

&lt;p&gt;&amp;lt;Context path=&quot;/MY_WEB&quot;  allowLinking=&quot;true&quot;&amp;gt;&lt;br/&gt;
       &amp;lt;Resource name=&quot;jdbc/MYWEB_Oracle&quot;&lt;br/&gt;
                        auth=&quot;Container&quot;&lt;br/&gt;
                        type=&quot;javax.sql.DataSource&quot;&lt;br/&gt;
                        factory=&quot;org.apache.tomcat.dbcp.dbcp.BasicDataSourceFactory&quot;&lt;br/&gt;
                        username=&quot;ocsweb&quot;&lt;br/&gt;
                        password=&quot;dsa432&quot;&lt;br/&gt;
                        driverClassName=&quot;oracle.jdbc.driver.OracleDriver&quot;&lt;br/&gt;
                        url=&quot;jdbc:oracle:thin:@(DESCRIPTION= (FAILOVER=ON)(ADDRESS_LIST=(LOAD_BALANCE=ON)(ADDRESS=(PROTOCOL=TCP)(HOST=XXX)(PORT=1525))(ADDRESS=(PROTOCOL=TCP)(HOST=XXXX)(PORT=1525)))(CONNECT_DATA=(SERVER=DEDICATED) (SERVICE_NAME=MYD)))&quot;&lt;br/&gt;
                        maxWait=&quot;1000&quot;&lt;br/&gt;
                        removeAbandoned=&quot;true&quot;&lt;br/&gt;
                        maxActive=&quot;20&quot;&lt;br/&gt;
                        maxIdle=&quot;6&quot;&lt;br/&gt;
                        removeAbandonedTimeout=&quot;60&quot;&lt;br/&gt;
                        logAbandoned=&quot;true&quot;/&amp;gt;&lt;br/&gt;
		&amp;lt;!-- Allow the following of the symbolic link --&amp;gt;		&lt;br/&gt;
		&amp;lt;Resources className=&quot;org.apache.naming.resources.FileDirContext&quot; allowLinking=&quot;true&quot;  /&amp;gt;&lt;br/&gt;
&amp;lt;/Context&amp;gt;&lt;/p&gt;

&lt;p&gt;Please advise.&lt;/p&gt;</description>
                <environment>&lt;p&gt;unix&lt;/p&gt;</environment>
        <key id="12379565">DBCP-243</key>
            <summary>Oracle 10G loadbalanced DB - ERROR</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="rkpamarthi">Rama Krishna</reporter>
                        <labels>
                    </labels>
                <created>Wed, 3 Oct 2007 13:48:48 +0000</created>
                <updated>Mon, 19 Nov 2007 03:43:15 +0000</updated>
                            <resolved>Mon, 19 Nov 2007 03:43:15 +0000</resolved>
                                    <version>1.2.1</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12532978" author="psteitz" created="Sun, 7 Oct 2007 16:07:12 +0000"  >&lt;p&gt;From stack trace line numbers, looks like tomcat-bundled 1.2.1source.&lt;/p&gt;</comment>
                            <comment id="12532981" author="psteitz" created="Sun, 7 Oct 2007 16:50:45 +0000"  >&lt;p&gt;From the stack traces, it looks like the underlying physical connection is being closed without DBCP&lt;br/&gt;
initiating the close (unless this is in fact a DBCP bug).  According to the docs here:&lt;br/&gt;
&lt;a href=&quot;http://download-uk.oracle.com/docs/cd/B14117_01/java.101/b10979/fastconnfail.htm#CIHGGBBJ&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://download-uk.oracle.com/docs/cd/B14117_01/java.101/b10979/fastconnfail.htm#CIHGGBBJ&lt;/a&gt;&lt;br/&gt;
this can happen if the database is failing over.   &lt;/p&gt;</comment>
                            <comment id="12543459" author="psteitz" created="Mon, 19 Nov 2007 03:43:15 +0000"  >&lt;p&gt;See last comment.  If there is evidence that Oracle is not closing the connections, pls reopen.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114522</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            17 years, 51 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uw53:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178348</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-242] DelegatingConnection close does not complete action</title>
                <link>https://issues.apache.org/jira/browse/DBCP-242</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;The change introduced in r557176 eliminated the call to passivate() in DelegatingConnection.close()  and sets  _closed to true only if isClosed has returned false.  The passivate() call should be restored (or the contract changed, which may be inconsistent with the spec) and _closed should always be set to false by this method.  This is consistent with &amp;lt;= 1.2.2 behaviour. &lt;/p&gt;</description>
                <environment></environment>
        <key id="12378950">DBCP-242</key>
            <summary>DelegatingConnection close does not complete action</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="psteitz">Phil Steitz</reporter>
                        <labels>
                    </labels>
                <created>Sun, 23 Sep 2007 20:02:33 +0000</created>
                <updated>Mon, 15 Feb 2010 02:41:20 +0000</updated>
                            <resolved>Sun, 22 Feb 2009 03:36:48 +0000</resolved>
                                    <version>Nightly Builds</version>
                                    <fixVersion>1.3</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12675621" author="psteitz" created="Sun, 22 Feb 2009 03:36:48 +0000"  >&lt;p&gt;Fixed in r746629 by reverting to 1.2.2 version of the method&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114521</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            16 years, 37 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uxnz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178595</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-241] NPE in case of an SQLException to be thrown on checkOpen() in DelegatingConnection</title>
                <link>https://issues.apache.org/jira/browse/DBCP-241</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;I only got it from the Spring forums (&lt;a href=&quot;http://forum.springframework.org/showthread.php?t=44068&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://forum.springframework.org/showthread.php?t=44068&lt;/a&gt;). I have no idea which version or if it is already fixed. It should be easy to review.&lt;/p&gt;

&lt;p&gt;Stacktrace:&lt;/p&gt;

&lt;p&gt;java.lang.NullPointerException&lt;br/&gt;
	at org.apache.commons.dbcp.PoolingConnection.toString(PoolingConnection.java:248)&lt;br/&gt;
	at java.lang.String.valueOf(String.java:2615)&lt;br/&gt;
	at java.lang.StringBuffer.append(StringBuffer.java:220)&lt;br/&gt;
	at org.apache.commons.dbcp.DelegatingConnection.checkOpen(DelegatingConnection.java:354)&lt;br/&gt;
	at org.apache.commons.dbcp.DelegatingConnection.prepareStatement(DelegatingConnection.java:246)&lt;br/&gt;
	at org.apache.commons.dbcp.PoolingDataSource$PoolGuardConnectionWrapper.prepareStatement(PoolingDataSource.java:302)&lt;br/&gt;
	at org.hibernate.jdbc.AbstractBatcher.getPreparedStatement(AbstractBatcher.java:505)&lt;br/&gt;
	at org.hibernate.jdbc.AbstractBatcher.getPreparedStatement(AbstractBatcher.java:423)&lt;br/&gt;
	at org.hibernate.jdbc.AbstractBatcher.prepareQueryStatement(AbstractBatcher.java:139)&lt;/p&gt;

&lt;p&gt;implementation of the method:&lt;/p&gt;

&lt;p&gt;    protected void checkOpen() throws SQLException {&lt;br/&gt;
        if(_closed) &lt;/p&gt;
{
            throw new SQLException
                (&quot;Connection &quot; + _conn + &quot; is closed.&quot;);
        }
&lt;p&gt;    }&lt;/p&gt;

&lt;p&gt;Regards&lt;/p&gt;

&lt;p&gt;Joerg&lt;/p&gt;</description>
                <environment></environment>
        <key id="12378929">DBCP-241</key>
            <summary>NPE in case of an SQLException to be thrown on checkOpen() in DelegatingConnection</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="joerg.heinicke@gmx.de">J&#246;rg Heinicke</reporter>
                        <labels>
                    </labels>
                <created>Sat, 22 Sep 2007 16:39:07 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:36 +0000</updated>
                            <resolved>Sun, 23 Sep 2007 19:51:47 +0000</resolved>
                                    <version>1.2.2</version>
                                    <fixVersion>1.3</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12529692" author="psteitz" created="Sat, 22 Sep 2007 20:06:24 +0000"  >&lt;p&gt;Thanks for reporting this bug, which is a regression in 1.2.2  from &lt;a href=&quot;https://issues.apache.org/jira/browse/DBCP-187&quot; title=&quot;[dbcp] Make exceptions about closed connections and statements more easily debuggable&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DBCP-187&quot;&gt;&lt;del&gt;DBCP-187&lt;/del&gt;&lt;/a&gt;.  &lt;/p&gt;</comment>
                            <comment id="12529731" author="psteitz" created="Sun, 23 Sep 2007 05:13:13 +0000"  >&lt;p&gt;The following code reproduces this bug using DBCP 1.2.2:&lt;br/&gt;
conn = new DelegatingConnection( new PoolingConnection&lt;br/&gt;
    (delegateConn2, new GenericKeyedObjectPool()));  &lt;br/&gt;
try &lt;/p&gt;
{
    conn.close();
 }
&lt;p&gt; catch (Exception ex) {}&lt;br/&gt;
 conn.prepareStatement(&quot;&quot;);&lt;/p&gt;

&lt;p&gt;The NPE is generated by this line in PoolingConnection.toString:&lt;br/&gt;
return &quot;PoolingConnection: &quot; + _pstmtPool.toString();&lt;/p&gt;

&lt;p&gt;The &lt;a href=&quot;https://issues.apache.org/jira/browse/DBCP-187&quot; title=&quot;[dbcp] Make exceptions about closed connections and statements more easily debuggable&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DBCP-187&quot;&gt;&lt;del&gt;DBCP-187&lt;/del&gt;&lt;/a&gt; change to checkOpen in DelegatingException exposed this NPE vulnerability in PoolingConnection.  Others exist in this class as well and all should be fixed before this bug is closed.&lt;/p&gt;

&lt;p&gt;To avoid this and other NPEs, DBCP 1.x users should avoid calling prepareStatement methods on closed PoolingConnections.&lt;/p&gt;</comment>
                            <comment id="12529744" author="psteitz" created="Sun, 23 Sep 2007 15:27:58 +0000"  >&lt;p&gt;s/DelegatingException/DelegatingConnection in last comment.&lt;/p&gt;</comment>
                            <comment id="12529760" author="psteitz" created="Sun, 23 Sep 2007 19:51:47 +0000"  >&lt;p&gt;Fixed in r 578597.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>41899</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            18 years, 7 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uwbz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178379</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-240] Broken link for &apos;Naming&apos; project in docs</title>
                <link>https://issues.apache.org/jira/browse/DBCP-240</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;The page at &lt;a href=&quot;http://commons.apache.org/dbcp/guide/jndi-howto.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://commons.apache.org/dbcp/guide/jndi-howto.html&lt;/a&gt; talks about Naming, with a link to &lt;a href=&quot;http://directory.apache.org/subprojects/naming/index.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://directory.apache.org/subprojects/naming/index.html&lt;/a&gt; which gives a 404. Moreover, I couldn&apos;t find the Naming subproject from Apache Directory, it seems it doesn&apos;t exist anymore.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12377979">DBCP-240</key>
            <summary>Broken link for &apos;Naming&apos; project in docs</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="lparra">Luis Parravicini</reporter>
                        <labels>
                    </labels>
                <created>Tue, 11 Sep 2007 14:52:51 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:36 +0000</updated>
                            <resolved>Sat, 8 Mar 2008 23:32:52 +0000</resolved>
                                                    <fixVersion>1.3</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12560222" author="bayard" created="Fri, 18 Jan 2008 05:14:45 +0000"  >&lt;p&gt;Phil - did Naming die?&lt;/p&gt;

&lt;p&gt;Should we bring it into Commons?&lt;/p&gt;</comment>
                            <comment id="12560229" author="psteitz" created="Fri, 18 Jan 2008 05:42:04 +0000"  >&lt;p&gt;Naming is effectively dead and there is really no more practical need for it since the tomcat naming jars are separately available. &lt;/p&gt;</comment>
                            <comment id="12560274" author="niallp" created="Fri, 18 Jan 2008 07:54:36 +0000"  >&lt;p&gt;Its still there in directory&apos;s site structure, but something is preventing it being seen. And in svn its in their &quot;dormant-subprojects&quot; area:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://svn.apache.org/viewvc/directory/sandbox/dormant-subprojects/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc/directory/sandbox/dormant-subprojects/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="12576656" author="psteitz" created="Sat, 8 Mar 2008 23:32:52 +0000"  >&lt;p&gt;References removed in r 635113.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114520</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            17 years, 35 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uz27:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178821</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-238] The BasicDataSource setLoginTimeout and getLoginTimeout are not supported</title>
                <link>https://issues.apache.org/jira/browse/DBCP-238</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;Methods setLoginTimeout() and getLoginTimeout() are not supported.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12376935">DBCP-238</key>
            <summary>The BasicDataSource setLoginTimeout and getLoginTimeout are not supported</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="2">Won&apos;t Fix</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="joel1di1">Benoit Lafontaine</reporter>
                        <labels>
                    </labels>
                <created>Mon, 27 Aug 2007 15:29:34 +0000</created>
                <updated>Mon, 15 Feb 2010 02:42:41 +0000</updated>
                            <resolved>Wed, 25 Mar 2009 12:59:22 +0000</resolved>
                                    <version>1.2.2</version>
                                    <fixVersion>1.3</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="12523028" author="joel1di1" created="Mon, 27 Aug 2007 15:32:13 +0000"  >&lt;p&gt;The &lt;a href=&quot;https://issues.apache.org/jira/browse/DBCP-218&quot; title=&quot;basicDataSource.setLoginTimeout(n) not work?&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DBCP-218&quot;&gt;&lt;del&gt;DBCP-218&lt;/del&gt;&lt;/a&gt; is fixed by adding a Javadoc comment.&lt;/p&gt;</comment>
                            <comment id="12523032" author="joel1di1" created="Mon, 27 Aug 2007 15:40:17 +0000"  >&lt;p&gt;This patch try to add the loginTimeout feature. &lt;br/&gt;
This is made by creating another thread that will call the _driver.connect(_connectUri, _props);&lt;br/&gt;
The main thread will wait for it by using the Thread.join(timeout) method. &lt;br/&gt;
If the join method returns by timeout and the connect didn&apos;t finished, then the main method will throw an SQLException &quot;timeout&quot;. &lt;/p&gt;

&lt;p&gt;Anyway, for the moment, the second Thread will not be stopped, even if the Thread.interrupted() method is called.&lt;/p&gt;
</comment>
                            <comment id="12688038" author="psteitz" created="Sat, 21 Mar 2009 15:30:35 +0000"  >&lt;p&gt;I see four alternatives here.  If others have better ideas, please chime in.&lt;/p&gt;

&lt;p&gt;1) Apply cleaned up version of the patch.  &lt;br/&gt;
2) Add a loginTimeout property to BDS, DCF and pass it to the driver as a property. &lt;br/&gt;
3) View this as synonymous with maxWait (modulo unit difference)&lt;br/&gt;
4) WONTFIX&lt;/p&gt;

&lt;p&gt;I don&apos;t like the idea of spawning a thread in 1), 2) can already be accomplished in the connect string, 3) is redundant, so unless someone has a better idea, I think we should close as WONTFIX.&lt;/p&gt;</comment>
                            <comment id="12689101" author="markt" created="Wed, 25 Mar 2009 12:59:22 +0000"  >&lt;p&gt;I agree with Phil&apos;s analysis. Therefore, resolving as WONTFIX.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12369060">DBCP-218</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12364616" name="DBCP-238.patch" size="48823" author="joel1di1" created="Mon, 27 Aug 2007 15:40:16 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114518</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            16 years, 33 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uzkv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178905</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-237] InstanceKeyDataSource.getConnection, exception during setup Defaults()</title>
                <link>https://issues.apache.org/jira/browse/DBCP-237</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;Problem in &lt;br/&gt;
org.apache.commons.dbcp.datasources.InstanceKeyDataSource.getConnection(String username, String password)&lt;br/&gt;
if setupDefaults() throws an Exception, the connection will not get closed.&lt;br/&gt;
After a while, this will cause the following exception:&lt;br/&gt;
org.apache.commons.dbcp.SQLNestedException: Could not retrieve connection info from pool&lt;/p&gt;

&lt;p&gt;This scenario can happen for Sybase jConnect2 5.5.  The exception that may be thrown by jConnect2 is:&lt;br/&gt;
com.sybase.jdbc2.jdbc.SybConnectionDeadException: JZ0C0: Connection is already closed.&lt;/p&gt;

&lt;p&gt;More details:&lt;br/&gt;
The last lines of the method are as follows:&lt;br/&gt;
-------&lt;br/&gt;
Connection con = info.getPooledConnection().getConnection();        &lt;br/&gt;
setupDefaults(con, username);&lt;br/&gt;
con.clearWarnings();&lt;br/&gt;
return con;&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;In my case, the exception happens in the second line of this snippet,&lt;br/&gt;
so no code gets the chance close con and release the resources.&lt;/p&gt;

&lt;p&gt;I propose to change it to:&lt;/p&gt;

&lt;p&gt;-------&lt;br/&gt;
Connection con = info.getPooledConnection().getConnection();    &lt;br/&gt;
try&lt;br/&gt;
{&lt;br/&gt;
  setupDefaults(con, username);&lt;br/&gt;
  con.clearWarnings();&lt;br/&gt;
  return con;&lt;br/&gt;
}&lt;br/&gt;
catch (Exception exc)&lt;br/&gt;
{&lt;br/&gt;
  try&lt;/p&gt;
  {
    con.close();
  }
&lt;p&gt;  catch (Exception exc)&lt;/p&gt;
  {
    getLogWriter().println(&quot;ignoring exception during close: &quot; + exc);  // uncertain here.
  }
&lt;p&gt;  throw exc;&lt;br/&gt;
}&lt;/p&gt;</description>
                <environment>&lt;p&gt;Sybase jConnect2 5.5, spring framework 2.0.1&lt;/p&gt;</environment>
        <key id="12376398">DBCP-237</key>
            <summary>InstanceKeyDataSource.getConnection, exception during setup Defaults()</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="olivermatz">Oliver Matz</reporter>
                        <labels>
                    </labels>
                <created>Mon, 20 Aug 2007 11:20:23 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:36 +0000</updated>
                            <resolved>Mon, 4 Feb 2008 04:00:17 +0000</resolved>
                                    <version>1.2.1</version>
                    <version>1.2.2</version>
                                    <fixVersion>1.3</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="12565254" author="psteitz" created="Mon, 4 Feb 2008 04:00:17 +0000"  >&lt;p&gt;Patch with tests applied in r618163.&lt;br/&gt;
Thanks!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114517</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            17 years, 40 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uvqv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178284</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-236] m2 build fails under JDK 1.4</title>
                <link>https://issues.apache.org/jira/browse/DBCP-236</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;Several failures are found in the JOCL test (21 errors, 1 failure). They relate to a missing &quot;org.xml.sax.driver&quot; property. I suspect this is because JDK 1.4 packaged crimson, where Java 5 works as it packages Xerces.&lt;/p&gt;

&lt;p&gt;Adding a test dependency on xerces should correct the problem.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12375393">DBCP-236</key>
            <summary>m2 build fails under JDK 1.4</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="brett">Brett Porter</reporter>
                        <labels>
                    </labels>
                <created>Sun, 5 Aug 2007 23:25:03 +0000</created>
                <updated>Mon, 6 Aug 2007 15:35:27 +0000</updated>
                            <resolved>Mon, 6 Aug 2007 15:35:27 +0000</resolved>
                                                    <fixVersion>1.3</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12517965" author="bayard" created="Mon, 6 Aug 2007 15:32:34 +0000"  >&lt;p&gt;I removed the property in &lt;a href=&quot;http://svn.apache.org/viewvc?view=rev&amp;amp;revision=546584&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc?view=rev&amp;amp;revision=546584&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="12517966" author="bayard" created="Mon, 6 Aug 2007 15:35:27 +0000"  >&lt;p&gt;svn ci -m &quot;Fixing &lt;a href=&quot;https://issues.apache.org/jira/browse/DBCP-236&quot; title=&quot;m2 build fails under JDK 1.4&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DBCP-236&quot;&gt;&lt;del&gt;DBCP-236&lt;/del&gt;&lt;/a&gt; - applying the xerces dependency for testing purposes and putting back the old org.xml.sax.driver property&quot;&lt;/p&gt;

&lt;p&gt;Sending        pom.xml&lt;br/&gt;
Sending        src/test/org/apache/commons/dbcp/TestJOCLed.java&lt;br/&gt;
Transmitting file data ..&lt;br/&gt;
Committed revision 563171.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114516</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            18 years, 14 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0ux0f:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178489</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-235] accessToUnderlyingConnectionAllowed  flag in ManagedConnection breaks equals, hashCode and toString</title>
                <link>https://issues.apache.org/jira/browse/DBCP-235</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;The accessToUnderlyingConnectionAllowed property ManageConnection disables the getInnerMostDelegate method used by DelegatingConnection equals, hashCode, and toString.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12374406">DBCP-235</key>
            <summary>accessToUnderlyingConnectionAllowed  flag in ManagedConnection breaks equals, hashCode and toString</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="dain">Dain Sundstrom</reporter>
                        <labels>
                    </labels>
                <created>Mon, 23 Jul 2007 22:43:02 +0000</created>
                <updated>Mon, 15 Feb 2010 02:43:19 +0000</updated>
                            <resolved>Thu, 19 Feb 2009 15:46:20 +0000</resolved>
                                                    <fixVersion>1.3</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12675015" author="markt" created="Thu, 19 Feb 2009 15:46:20 +0000"  >&lt;p&gt;This has been fixed in svn and will be included in the next release.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114515</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            16 years, 37 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uxqv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178608</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-227] Some unit tests are run using maven, but not ant</title>
                <link>https://issues.apache.org/jira/browse/DBCP-227</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;The following unit tests run using maven, but not ant:&lt;br/&gt;
    TestJOCLContentHandler&lt;br/&gt;
    TestPoolingDataSource&lt;br/&gt;
    TestJndi&lt;/p&gt;

&lt;p&gt;When this is fixed, it would be nice if the junit ant task were used to run the tests so that the JUnit report can be generated.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12372874">DBCP-227</key>
            <summary>Some unit tests are run using maven, but not ant</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="gbadner">Gail Badner</reporter>
                        <labels>
                    </labels>
                <created>Tue, 3 Jul 2007 06:40:38 +0000</created>
                <updated>Thu, 12 Jul 2007 17:52:46 +0000</updated>
                            <resolved>Thu, 12 Jul 2007 17:52:46 +0000</resolved>
                                    <version>1.2.2</version>
                                    <fixVersion>1.3</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12509924" author="bayard" created="Tue, 3 Jul 2007 16:22:56 +0000"  >&lt;p&gt;Attachment: Tests added in, uses junit, fixes commons logging property.&lt;/p&gt;

&lt;p&gt;Alternatively, could use &apos;maven ant&apos;, I&apos;m not sure at first glance if dbcp is maintaining the custom ant on purpose (ie for the jdbc2/3 support). &lt;/p&gt;</comment>
                            <comment id="12512192" author="bayard" created="Thu, 12 Jul 2007 17:52:46 +0000"  >&lt;p&gt;svn ci -m &quot;Applying my patch from &lt;a href=&quot;https://issues.apache.org/jira/browse/DBCP-227&quot; title=&quot;Some unit tests are run using maven, but not ant&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DBCP-227&quot;&gt;&lt;del&gt;DBCP-227&lt;/del&gt;&lt;/a&gt; - it&apos;s easy enough to run &apos;maven ant&apos; if someone decides to do that someday, so no reason not to improve the existing build.xml in the meantime&quot; &lt;br/&gt;
Sending        build.properties.sample&lt;br/&gt;
Sending        build.xml&lt;br/&gt;
Sending        src/test/org/apache/commons/dbcp/TestAll.java&lt;br/&gt;
Sending        src/test/org/apache/commons/dbcp/TestJndi.java&lt;br/&gt;
Transmitting file data ....&lt;br/&gt;
Committed revision 555705.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12361064" name="DBCP-227.patch" size="3280" author="bayard" created="Tue, 3 Jul 2007 16:22:56 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114507</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            18 years, 17 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uwwv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178473</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-225] getConnection / borrowObject fails with NullPointerException</title>
                <link>https://issues.apache.org/jira/browse/DBCP-225</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;We use dbcp PoolingDataSource in Solaris/Oracle 10g RAC environment and our getConnection calls fail sporadically with the following stack trace (1.2.1)&lt;/p&gt;

&lt;p&gt;Caused by: org.apache.commons.dbcp.SQLNestedException: Cannot get a connection, pool exhausted&lt;br/&gt;
        at org.apache.commons.dbcp.PoolingDataSource.getConnection(PoolingDataSource.java:103)&lt;br/&gt;
        at org.apache.commons.dbcp.BasicDataSource.getConnection(BasicDataSource.java:540)&lt;br/&gt;
        ... more&lt;br/&gt;
Caused by: java.util.NoSuchElementException: Could not create a validated object, cause: null&lt;br/&gt;
        at org.apache.commons.pool.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:806)&lt;br/&gt;
        at org.apache.commons.dbcp.PoolingDataSource.getConnection(PoolingDataSource.java:95)&lt;br/&gt;
        ... 24 more&lt;/p&gt;

&lt;p&gt;This is definitely not a &quot;pool exhausted&quot; situation, it is just being reported as pool exhausted. Since NoSuchElementException that you use does not allow cause, only Exception message (null) is being printed. With some debugging I was able to recover the root exception:&lt;/p&gt;

&lt;p&gt;java.lang.NullPointerException&lt;br/&gt;
    at org.apache.commons.dbcp.DelegatingConnection.setAutoCommit(DelegatingConnection.java:268)&lt;br/&gt;
    at org.apache.commons.dbcp.PoolableConnectionFactory.activateObject(PoolableConnectionFactory.java:368)&lt;br/&gt;
    at org.apache.commons.pool.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:786)&lt;br/&gt;
    at org.apache.commons.dbcp.PoolingDataSource.getConnection(PoolingDataSource.java:95)&lt;br/&gt;
    at org.apache.commons.dbcp.BasicDataSource.getConnection(BasicDataSource.java:540)&lt;br/&gt;
...&lt;/p&gt;

&lt;p&gt;Looks like it is trying to borrow/validate DelegatingConnection which delegate is null.&lt;/p&gt;



&lt;p&gt;Hoping to resolve the issue we upgraded to 1.2.2 but it did not help. Here is is an exception stack trace from 1.2.2:&lt;/p&gt;

&lt;p&gt;org.apache.commons.dbcp.SQLNestedException: Cannot get a connection, pool error Could not create a validated object, cause: null&lt;br/&gt;
        at org.apache.commons.dbcp.PoolingDataSource.getConnection(PoolingDataSource.java:104)&lt;br/&gt;
        at org.apache.commons.dbcp.BasicDataSource.getConnection(BasicDataSource.java:880)&lt;br/&gt;
        ... more&lt;br/&gt;
Caused by: java.util.NoSuchElementException: Could not create a validated object, cause: null&lt;br/&gt;
        at org.apache.commons.pool.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:871)&lt;br/&gt;
        at org.apache.commons.dbcp.PoolingDataSource.getConnection(PoolingDataSource.java:96)&lt;br/&gt;
        ... 28 more&lt;/p&gt;


&lt;p&gt;We use the following dbcp properties:&lt;/p&gt;

&lt;p&gt;autoCommit=&quot;false&quot;&lt;br/&gt;
readOnly=&quot;false&quot;&lt;br/&gt;
maxActive=&quot;200&quot;&lt;br/&gt;
maxIdle=&quot;20&quot;&lt;br/&gt;
minIdle=&quot;10&quot;&lt;br/&gt;
minEvictableIdleIime=&quot;300000&quot;&lt;br/&gt;
maxWait=&quot;200&quot;&lt;br/&gt;
accessToUnderlyingConnectionAllowed=&quot;true&quot;&lt;br/&gt;
validationQuery=&quot;SELECT 1 FROM DUAL&quot;&lt;br/&gt;
ConnectionCachingEnabled=&quot;true&quot;&lt;br/&gt;
FastConnectionFailoverEnabled=&quot;true&quot;&lt;/p&gt;



&lt;p&gt;I could not find the existing reported dbcp/object pool bug but I see similar  reports on the web, for example &lt;br/&gt;
&lt;a href=&quot;http://forum.java.sun.com/thread.jspa?threadID=713200&amp;amp;messageID=4124915&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://forum.java.sun.com/thread.jspa?threadID=713200&amp;amp;messageID=4124915&lt;/a&gt;&lt;/p&gt;</description>
                <environment>&lt;p&gt;Solaris 10, Oracle 10g RAC&lt;/p&gt;</environment>
        <key id="12370054">DBCP-225</key>
            <summary>getConnection / borrowObject fails with NullPointerException</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="dain">Dain Sundstrom</assignee>
                                    <reporter username="asamonov">Alexei Samonov</reporter>
                        <labels>
                    </labels>
                <created>Wed, 23 May 2007 14:12:02 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:36 +0000</updated>
                            <resolved>Mon, 23 Jul 2007 19:53:39 +0000</resolved>
                                    <version>1.2.1</version>
                    <version>1.2.2</version>
                                    <fixVersion>1.3</fixVersion>
                                        <due></due>
                            <votes>1</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="12498695" author="saruman" created="Thu, 24 May 2007 16:08:15 +0000"  >&lt;p&gt;The situation is even more mysterious since the DelegatingConnection in question is PoolableConnection, and no code ever calls setDelegate(null) on PoolableConnection.&lt;/p&gt;</comment>
                            <comment id="12499420" author="psteitz" created="Sun, 27 May 2007 17:30:19 +0000"  >&lt;p&gt;Based on the stack traces, it looks like you are using pool 1.2, correct?  From the trace it looks like the NPE is occuring when a newly created connection is being validated.   Do you see any connection errors in the database logs?  These should throw SQLExceptions, though, which are not being reported.  Another thing to try is to turn off Oracle&apos;s Connection caching (I assume that is what ConnectionCachingEnabled=&quot;true&quot;  means). &lt;/p&gt;</comment>
                            <comment id="12500165" author="asamonov" created="Wed, 30 May 2007 15:29:01 +0000"  >&lt;p&gt;Yes we were using 1.2 , then we upgraded to 1.3 which did not  help. We have to use OracleConnection caching because it is a prerequisite to Oracle&apos;s RAC Fast Connection Failure (fcf). We will try to play with Oracle cache parameters such as MaxLimit - it was set to 5 and we will try 200 that would match the max dbcp pool size. I will report test results once I have them.&lt;/p&gt;</comment>
                            <comment id="12514073" author="dain" created="Fri, 20 Jul 2007 01:45:31 +0000"  >&lt;p&gt;This patch checks for null returned from connection factory and throws an IllegalStateException.  We may want to go with a SQLException instead.&lt;/p&gt;

&lt;p&gt;I don&apos;t think this will fix Alexei&apos;s problem, but at least will cause a fast failure instead of getting a strange &quot;hollow&quot; connection.  Alternatively, if we just need to ask Oracle again for a connection, we could put a retry loop in the connection factory.&lt;/p&gt;</comment>
                            <comment id="12514761" author="dain" created="Mon, 23 Jul 2007 19:53:39 +0000"  >&lt;p&gt;Sending        src/java/org/apache/commons/dbcp/PoolableConnectionFactory.java&lt;br/&gt;
Sending        src/java/org/apache/commons/dbcp/datasources/CPDSConnectionFactory.java&lt;br/&gt;
Sending        src/java/org/apache/commons/dbcp/datasources/KeyedCPDSConnectionFactory.java&lt;br/&gt;
Transmitting file data ...&lt;br/&gt;
Committed revision 558846.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                            <outwardlinks description="duplicates">
                                        <issuelink>
            <issuekey id="12369945">DBCP-224</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12362188" name="DBCP-225.patch" size="2370" author="dain" created="Fri, 20 Jul 2007 01:45:31 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114505</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            18 years, 16 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uvpz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178280</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-224] Null delegate possible</title>
                <link>https://issues.apache.org/jira/browse/DBCP-224</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;java.lang.NullPointerException&lt;br/&gt;
   at org.apache.commons.dbcp.DelegatingConnection.setAutoCommit(DelegatingConnection.java:268)&lt;br/&gt;
   at org.apache.commons.dbcp.PoolableConnectionFactory.activateObject(PoolableConnectionFactory.java:368)&lt;br/&gt;
   at org.apache.commons.pool.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:786)&lt;br/&gt;
   at org.apache.commons.dbcp.PoolingDataSource.getConnection(PoolingDataSource.java:95)&lt;br/&gt;
   at org.apache.commons.dbcp.BasicDataSource.getConnection(BasicDataSource.java:540)&lt;br/&gt;
   at com.gfigroup.fmk.spine.db.NamedDBCPDataSource.getConnection(NamedDBCPDataSource.java:123)&lt;br/&gt;
   at com.gfigroup.fmk.spine.tx.TransactionContext.createConnection(TransactionContext.java:99)&lt;br/&gt;
   at com.gfigroup.fmk.spine.tx.TransactionContext.getConnection(TransactionContext.java:75)&lt;br/&gt;
   at com.gfigroup.fmk.spine.tx.TransactionContext.getConnectionFacility(TransactionContext.java:91)&lt;br/&gt;
   at com.gfigroup.fmk.spine.tx.AbstractTxObject.getConnectionFacility(AbstractTxObject.java:47)&lt;br/&gt;
   at com.gfigroup.ts.credit.service.feed.btc.BTCTradeTxObjectImpl.insertTrade(BTCTradeTxObjectImpl.java:104)&lt;br/&gt;
   at sun.reflect.GeneratedMethodAccessor49.invoke(Unknown Source)&lt;br/&gt;
   at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)&lt;br/&gt;
   at java.lang.reflect.Method.invoke(Unknown Source)&lt;br/&gt;
   at com.gfigroup.fmk.spine.tx.TxObjectService$TxObjectStub.invoke(TxObjectService.java:319)&lt;br/&gt;
   at $Proxy15.insertTrade(Unknown Source)&lt;br/&gt;
   at com.gfigroup.ts.credit.service.feed.btc.BTCListenerService.handleTrade(BTCListenerService.java:323)&lt;br/&gt;
   at com.gfigroup.ts.credit.service.feed.btc.BTCListenerService.handleTradeMessage(BTCListenerService.java:308)&lt;br/&gt;
   at com.gfigroup.ts.credit.service.feed.btc.BTCListenerService.access$800(BTCListenerService.java:37)&lt;br/&gt;
   at com.gfigroup.ts.credit.service.feed.btc.BTCListenerService$ProcessTradeMessageTask.run(BTCListenerService.java:512)&lt;br/&gt;
   at edu.oswego.cs.dl.util.concurrent.QueuedExecutor$RunLoop.run(QueuedExecutor.java:88)&lt;br/&gt;
   at java.lang.Thread.run(Unknown Source)&lt;/p&gt;

&lt;p&gt;This happens intermittently and very mysteriously. Eventually our pool becomes clogged with &quot;undead&quot; connections like this. &lt;/p&gt;</description>
                <environment></environment>
        <key id="12369945">DBCP-224</key>
            <summary>Null delegate possible</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="3">Duplicate</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="saruman">Anatoliy Salistra</reporter>
                        <labels>
                    </labels>
                <created>Tue, 22 May 2007 14:36:06 +0000</created>
                <updated>Sun, 27 May 2007 17:57:51 +0000</updated>
                            <resolved>Thu, 24 May 2007 15:13:41 +0000</resolved>
                                    <version>1.2.2</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12498678" author="bayard" created="Thu, 24 May 2007 15:13:41 +0000"  >&lt;p&gt;Thanks for the report Anatoliy.&lt;/p&gt;

&lt;p&gt;I&apos;m closing this in favour of the slightly newer &lt;a href=&quot;https://issues.apache.org/jira/browse/DBCP-225&quot; title=&quot;getConnection / borrowObject fails with NullPointerException&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DBCP-225&quot;&gt;&lt;del&gt;DBCP-225&lt;/del&gt;&lt;/a&gt; as they appear to be the same issue and that issue has more information.&lt;/p&gt;</comment>
                            <comment id="12499421" author="psteitz" created="Sun, 27 May 2007 17:57:51 +0000"  >&lt;p&gt;Stack traces are from dbcp 1.2.1, pool 1.2&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="12370054">DBCP-225</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114504</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            18 years, 24 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0v01r:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178981</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-222] Does DBCP closes unclosed PreparedStatement or resultset?</title>
                <link>https://issues.apache.org/jira/browse/DBCP-222</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;this is more of a question. I cannot find any doc on the Apache site. Sorry if this is not a right place to ask the question.&lt;/p&gt;

&lt;p&gt;We maintain a big web site and there are lots of legacy code where there are unclosed preparedstatements / resultsets. Does the DBCP closes these forgotten unclosed statements and result sets automatically when an connection is returned? Inceasing number of statements and results could slow down our database significantly.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Windows, Linux&lt;/p&gt;</environment>
        <key id="12369065">DBCP-222</key>
            <summary>Does DBCP closes unclosed PreparedStatement or resultset?</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="6">Invalid</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="bliu">Bill Liu</reporter>
                        <labels>
                    </labels>
                <created>Fri, 11 May 2007 00:09:42 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:36 +0000</updated>
                            <resolved>Fri, 11 May 2007 05:09:02 +0000</resolved>
                                    <version>1.2.2</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12494958" author="psteitz" created="Fri, 11 May 2007 05:09:02 +0000"  >&lt;p&gt;Questions such as this should be directed to the commons-user mailing list.  I am closing the issue to keep Jira tidy, but to answer your question, in general the answer is no, don&apos;t count on it, but if you use PoolingConnections with prepared statement pooling turned on, the PoolingConnection will try to close the pooled statements in its cache when it is closed.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114502</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            18 years, 26 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0v0e7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>179037</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-221] How to close the connection pool without shutting down the JVM while there are connections being used?</title>
                <link>https://issues.apache.org/jira/browse/DBCP-221</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;Suppose there are several connections being used now by different servlets. calling the basicDataSource,close() does not have any impact on the connection pool. I expect that after these servlet return the connections the pool should be shut down immediately. I also expect that any more requests to borrow connections from the pool should not be fulfilled. However, my experiment does not seem to support my expectations. Calling basicDataSource.close() seems to be ignored while there are connections being used.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12369064">DBCP-221</key>
            <summary>How to close the connection pool without shutting down the JVM while there are connections being used?</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="dain">Dain Sundstrom</assignee>
                                    <reporter username="bliu">Bill Liu</reporter>
                        <labels>
                    </labels>
                <created>Fri, 11 May 2007 00:04:41 +0000</created>
                <updated>Wed, 25 Jan 2012 14:19:24 +0000</updated>
                            <resolved>Mon, 23 Jul 2007 22:29:42 +0000</resolved>
                                    <version>1.2.2</version>
                                    <fixVersion>1.3</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="12494956" author="psteitz" created="Fri, 11 May 2007 04:57:13 +0000"  >&lt;p&gt;Behavior here is determined by the underlying pool.  In the case of commons pool&apos;s GenericObjectPool, which BasicDataSource uses, the close method only closes &lt;b&gt;idle&lt;/b&gt; connections in the pool.  The BasicDataSource Javadoc should be improved to make it clear that only idle connections are closed when close is invoked on the BasicDataSource.&lt;/p&gt;</comment>
                            <comment id="12495092" author="bliu" created="Fri, 11 May 2007 16:39:46 +0000"  >&lt;p&gt;Thanks Phil.&lt;/p&gt;

&lt;p&gt;So what is the appropriate way to shut down (forcefully) a connection pool, assuming we have a serious db issue?&lt;/p&gt;</comment>
                            <comment id="12514804" author="dain" created="Mon, 23 Jul 2007 22:29:42 +0000"  >&lt;p&gt;BasicDataSource.close() now permanently marks the data source as closed.  No new connections can be obtained from a closed data source.  At close all idle connections are destroyed and the method returns.  As existing active connections are closed, they are destroyed.&lt;/p&gt;</comment>
                            <comment id="12768151" author="roshang" created="Wed, 21 Oct 2009 09:41:48 +0000"  >&lt;p&gt;I agree with the change of behaviour of close() so that its permanently closed. &lt;/p&gt;

&lt;p&gt;However we relied on the current behaviour as a way of restarting the Connection Pool after changing its properties without a full JVM restart. (e.g. change the Database URL). I agree this is a hack and there is no guarantee it will continue to work. &lt;/p&gt;

&lt;p&gt;But I think you might agree, is a useful feature to have. Looking at the source code, I spotted a restart() method which is currently private and not used, which just calls close(). &lt;/p&gt;

&lt;p&gt;Will it make sense to expose this method and have an overloaded method close(boolean permanent) which controls if its a permanent close or not. &lt;/p&gt;

&lt;p&gt;If you agree, I am happy to submit a patch. &lt;/p&gt;








</comment>
                            <comment id="12768637" author="psteitz" created="Thu, 22 Oct 2009 10:43:26 +0000"  >&lt;p&gt;The problem with supporting restart is that you either have to force close the connections that are checked out to clients (not generally a happy scenario) or you no longer have a uniform pool of connections.  Deciding how to handle the latter problem from the pool&apos;s perspective is probably what stalled the implementation of &quot;restart&quot;.  If you have ideas about how to implement this without adding too much complexity for the user or dbcp iteslf, we should discuss them on the dev list.&lt;/p&gt;</comment>
                            <comment id="13192968" author="metatech" created="Wed, 25 Jan 2012 10:18:49 +0000"  >&lt;p&gt;If you wish to terminate active connections as well, you can try the following code.  &lt;br/&gt;
Note : the BasicDataSource must be created with the property &quot;removeAbandoned&quot; set to true.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;ds.setRemoveAbandonedTimeout(1);
ds.setMaxActive(1);
Connection conn = ds.getConnection();
ds.close();
conn.close();
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;However, with the Oracle JDBC driver, the code can fail when the active connection waits for a database lock, because of a Java lock in the JDBC driver. &lt;/p&gt;</comment>
                            <comment id="13193053" author="metatech" created="Wed, 25 Jan 2012 14:19:24 +0000"  >&lt;p&gt;The &quot;lock&quot; problem happens because the cancel() must first be called on java.sql.Statement being executed (which is allowed to be called from another thread).&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114501</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            13 years, 41 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uvxr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178315</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-218] basicDataSource.setLoginTimeout(n) not work?</title>
                <link>https://issues.apache.org/jira/browse/DBCP-218</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;Hi:&lt;/p&gt;

&lt;p&gt;We tried to set the login timeout value of the basic data source but got the exception. Is this feature (Login timeout is not supported.)? We want the connection pool not to wait forever if the database is too busy. Any ideas? Thanks.&lt;/p&gt;

&lt;p&gt;In the code:&lt;br/&gt;
BasicDataSource bds = new BasicDataSource();&lt;br/&gt;
bds.setDriverClassName(&quot;oracle.jdbc.driver.OracleDriver&quot;);&lt;br/&gt;
bds.setUsername(&quot;my username&quot;);&lt;br/&gt;
bds.setPassword(&quot;my password&quot;);&lt;br/&gt;
bds.setUrl(&quot;jdbc:oracle:thin:@mrhost:1521:test&quot;);&lt;br/&gt;
bds.setMaxActive(2);&lt;br/&gt;
bds.setLoginTimeout(5);&lt;/p&gt;

&lt;p&gt;Result:&lt;br/&gt;
Exception in thread &quot;main&quot; java.lang.UnsupportedOperationException: Login timeout is not supported.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Windows&lt;/p&gt;</environment>
        <key id="12369060">DBCP-218</key>
            <summary>basicDataSource.setLoginTimeout(n) not work?</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="bliu">Bill Liu</reporter>
                        <labels>
                    </labels>
                <created>Thu, 10 May 2007 23:24:06 +0000</created>
                <updated>Mon, 27 Aug 2007 15:32:13 +0000</updated>
                            <resolved>Tue, 12 Jun 2007 18:25:51 +0000</resolved>
                                    <version>1.1</version>
                    <version>1.2</version>
                    <version>1.2.1</version>
                    <version>1.2.2</version>
                                    <fixVersion>1.3</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12494931" author="psteitz" created="Fri, 11 May 2007 02:33:43 +0000"  >&lt;p&gt;Unfortunately, the PoolingDataSource that BasicDataSource wraps does not support the loginTimeout parameter.   The BasicDataSource javadoc should be fixed to indicate that.&lt;/p&gt;

&lt;p&gt;Marking as 1.3 fix version.  Javadoc (or enhancement) patches welcome.&lt;/p&gt;

&lt;p&gt;If what you want is for the datasource to timeout rather than waiting indefinitely on a connection when all connections in the pool are busy, you can set the maxWait property, which is a pool property that controls how long the pool will wait for a an object to become available to return to the client.  If what you really want is for the driver to timeout when the pool uses it to open a physical connection, you could try setting the loginTimeout in the connection URL provided to setUrl.  It looks like the Oracle driver supports that, though I have not tried this.&lt;/p&gt;</comment>
                            <comment id="12495093" author="bliu" created="Fri, 11 May 2007 16:53:40 +0000"  >&lt;p&gt;Thanks Phil.&lt;/p&gt;

&lt;p&gt;We actually wanted the first scenario: the datasource to time out if there are no connections available from the pool and the max active has been reached. I did not know the default value of maxWait was -1 and did not check it. Yes I set it to be 5 seconds and it worked.&lt;/p&gt;</comment>
                            <comment id="12503958" author="bayard" created="Tue, 12 Jun 2007 18:25:51 +0000"  >&lt;p&gt;svn ci -m &quot;Adding the Javadoc to state that getLoginTimeout and setLoginTimeout are NOT supported by BasicDataSource  as per &lt;a href=&quot;https://issues.apache.org/jira/browse/DBCP-218&quot; title=&quot;basicDataSource.setLoginTimeout(n) not work?&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DBCP-218&quot;&gt;&lt;del&gt;DBCP-218&lt;/del&gt;&lt;/a&gt;&quot; src/java/org/apache/commons/dbcp/BasicDataSource.java&lt;/p&gt;

&lt;p&gt;Sending        src/java/org/apache/commons/dbcp/BasicDataSource.java&lt;br/&gt;
Transmitting file data .&lt;br/&gt;
Committed revision 546583.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12376935">DBCP-238</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114498</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            18 years, 22 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uwzz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178487</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-217] Closing of underlaying connection instead of the PoolGuardConnectionWrapper</title>
                <link>https://issues.apache.org/jira/browse/DBCP-217</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>
&lt;p&gt;Is state:&lt;br/&gt;
If I obtain the Connection of a Statement (stmt.getConnection()), created with dbcp,&lt;br/&gt;
the returned Object is the underlaying pooled connection. &lt;br/&gt;
Closing this connection multiple times may close the connection of another process.&lt;/p&gt;

&lt;p&gt;It should be:&lt;br/&gt;
The Wrapper over the connection PoolGuardConnectionWrapper should be returned instead.&lt;/p&gt;
</description>
                <environment></environment>
        <key id="12367258">DBCP-217</key>
            <summary>Closing of underlaying connection instead of the PoolGuardConnectionWrapper</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="asteban">Sebastian Mancke</reporter>
                        <labels>
                    </labels>
                <created>Mon, 16 Apr 2007 08:52:16 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:36 +0000</updated>
                            <resolved>Mon, 23 Jul 2007 19:11:12 +0000</resolved>
                                    <version>1.2.2</version>
                                    <fixVersion>1.3</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12489049" author="asteban" created="Mon, 16 Apr 2007 09:07:10 +0000"  >
&lt;p&gt;This patch sets the wrapper (instance of PoolGuardConnectionWrapper)&lt;br/&gt;
as the connection of every created statement.&lt;/p&gt;</comment>
                            <comment id="12514740" author="dain" created="Mon, 23 Jul 2007 19:11:12 +0000"  >&lt;p&gt;Fixed as part of &lt;a href=&quot;https://issues.apache.org/jira/browse/DBCP-11&quot; title=&quot;[dbcp] stmt.getConnection() != Connection used to create the statement&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DBCP-11&quot;&gt;&lt;del&gt;DBCP-11&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12355594" name="connectionCloseFix.patch" size="6028" author="asteban" created="Mon, 16 Apr 2007 09:07:10 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114497</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            18 years, 16 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0ux8n:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178526</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-215] DBCP&apos;s initialSize doesn&apos;t work as expected</title>
                <link>https://issues.apache.org/jira/browse/DBCP-215</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;I&apos;ve configured a datasource on Tomcat 5.0.28 using DBCP.&lt;br/&gt;
Reading it&apos;s documentation i found out a parameter to specify the datasource&apos;s initial number of connections, the &quot;initialSize&quot; parameter. We want this configured so the first users of our system don&apos;t have to wait for the datasource to open the first connections to the database.&lt;/p&gt;

&lt;p&gt;When put it to work, it didn&apos;t initialize the connections as defined on the &quot;initialSize&quot; parameter.&lt;br/&gt;
I&apos;ve made a lot of tests using the &quot;minIdle&quot; parameter as well, but the connections are created only when the first user hits the application.&lt;/p&gt;

&lt;p&gt;The BasicDataSourceFactory class initializes the datasources parameters and the BasicDataSource class just create the initial connections when called according to the DataSource interface (most likely on the getConnection() method). IMHO, this way the initialSize parameter doesn&apos;t work as expected.&lt;/p&gt;

&lt;p&gt;The &lt;a href=&quot;https://issues.apache.org/jira/browse/DBCP-147&quot; title=&quot;add initialSize parameter to do pre-loading of the connection pool&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DBCP-147&quot;&gt;&lt;del&gt;DBCP-147&lt;/del&gt;&lt;/a&gt; issue changed the BasicDataSource class to include the loop that create the initial connections, but the patch don&apos;t really create the connections when the datasource is created, only when it is called.&lt;/p&gt;

&lt;p&gt;My suggestion is: before the BasicDataSourceFactory.createDataSource() method returns it should ask the datasource to connect to create the initial connections according to the initialSize parameter.&lt;/p&gt;

&lt;p&gt;#1 One way could be to make the BasicDataSource.createDataSource() method public and, if the initialSize parameter is higher than zero, call it at the end of the BasicDataSourceFactory.createDataSource() method.&lt;/p&gt;

&lt;p&gt;#2 Another possibility could be to create a initialize() method on BasicDataSource. According to its parameters it could create the initial connections to the database.&lt;/p&gt;

&lt;p&gt;#3 To avoid changes to BasicDataSource, one could create a subclass of BasicDataSource (lets call it X) with a constructor that receives an instance of the superclass. On this constructor X&apos;d copy all the attributes from the superclass to it and call the inherited createDataSource() method. At the end of the BasicDataSourceFactory.createDataSource() method, if the initialSize parameter is higher than zero the factory would return a new instance of X passing as parameter the BasicDataSource instance that was initialized with the datasource&apos;s parameters.&lt;/p&gt;

&lt;p&gt;I&apos;ve created as a bug since the &quot;initialSize&quot; parameter doesn&apos;t work as expected.&lt;/p&gt;

&lt;p&gt;What do you guys think of this issue?&lt;/p&gt;

&lt;p&gt;Thanks in advance for your time!&lt;/p&gt;</description>
                <environment>&lt;p&gt;Windows XP, jsdk1.4.2_07, Tomcat 5.0.28, commons-dbcp-1.2.2, commons-pool-1.3, hibernate 2.1.7c, mysql-connector-java-5.0.5, MySQL 5.1.11 &lt;/p&gt;</environment>
        <key id="12366986">DBCP-215</key>
            <summary>DBCP&apos;s initialSize doesn&apos;t work as expected</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="leite">Rafael Leite</reporter>
                        <labels>
                    </labels>
                <created>Wed, 11 Apr 2007 13:23:47 +0000</created>
                <updated>Mon, 15 Feb 2010 04:08:30 +0000</updated>
                            <resolved>Thu, 19 Feb 2009 15:57:47 +0000</resolved>
                                    <version>1.2.2</version>
                                    <fixVersion>1.3</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12488264" author="psteitz" created="Thu, 12 Apr 2007 06:06:05 +0000"  >&lt;p&gt;I agree that the BasicDataSourceFactory should return an initialized pool, based on the properties set and I don&apos;t understand why it was not implemented to do that.  I will do some research in the archives to see if this was discussed when the the initialSize parameter was introduced.  Anyone who can give a reason why this should not be done, please chime in here.  By just calling getConnection, or even getLoginTimeout or getLogWriter at the end of the method, the factory&apos;s creatDataSource impl could be made to initialize the pool.  Patches welcome.&lt;/p&gt;</comment>
                            <comment id="12675018" author="markt" created="Thu, 19 Feb 2009 15:57:47 +0000"  >&lt;p&gt;This has been fixed in svn and will be included in the next release.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114495</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            16 years, 37 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uzev:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178878</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-214] Basic datasource should respect the context classloader</title>
                <link>https://issues.apache.org/jira/browse/DBCP-214</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;I tried to use DBCP in an OSGi environment. This this not possible at the moment, as OSGi uses different classloaders and DBCP does not respect this.&lt;br/&gt;
The easiest way to solve this problem would be to use the contextclassloader in case of a ClassNotFoundException&lt;/p&gt;</description>
                <environment></environment>
        <key id="12366910">DBCP-214</key>
            <summary>Basic datasource should respect the context classloader</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="berndkolb">Bernd Kolb</reporter>
                        <labels>
                    </labels>
                <created>Tue, 10 Apr 2007 16:33:39 +0000</created>
                <updated>Mon, 15 Feb 2010 04:09:05 +0000</updated>
                            <resolved>Sun, 15 Mar 2009 22:13:17 +0000</resolved>
                                    <version>1.2.2</version>
                                    <fixVersion>1.3</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="12488265" author="psteitz" created="Thu, 12 Apr 2007 06:08:07 +0000"  >&lt;p&gt;Patches welcome&lt;/p&gt;</comment>
                            <comment id="12495894" author="berndkolb" created="Tue, 15 May 2007 08:33:08 +0000"  >&lt;p&gt;Version: 1.2.2&lt;br/&gt;
Class: org.apache.commons.dbcp.BasicDataSouce&lt;br/&gt;
Method: protected synchronized DataSource createDataSource() (changes made between //### START CHANGE ### and //### END CHANGE ###&lt;/p&gt;

&lt;p&gt;Changed code:&lt;br/&gt;
        //### START CHANGE ###&lt;br/&gt;
        Class driverFromCCL = null;&lt;br/&gt;
        if (driverClassName != null) {&lt;br/&gt;
            try {&lt;br/&gt;
            	try &lt;/p&gt;
{
                Class.forName(driverClassName);
            	}
&lt;p&gt;catch (ClassNotFoundException e) &lt;/p&gt;
{
            		driverFromCCL = Thread.currentThread().getContextClassLoader().loadClass(driverClassName);
				}

&lt;p&gt;            } catch (Throwable t) &lt;/p&gt;
{
                String message = &quot;Cannot load JDBC driver class &apos;&quot; +
                    driverClassName + &quot;&apos;&quot;;
                logWriter.println(message);
                t.printStackTrace(logWriter);
                throw new SQLNestedException(message, t);
            }
&lt;p&gt;        }&lt;/p&gt;

&lt;p&gt;        // Create a JDBC driver instance&lt;br/&gt;
        Driver driver = null;&lt;br/&gt;
        try {&lt;br/&gt;
        	if (driverFromCCL!= null) {&lt;br/&gt;
        		// Usage of drivermanager is not possible, as it does not respect the ContextClassLoader&lt;br/&gt;
        		driver = (Driver) driverFromCCL.newInstance();&lt;br/&gt;
        		if (!driver.acceptsURL(url)) &lt;/p&gt;
{
        			new SQLException(&quot;No suitable driver&quot;, &quot;08001&quot;);
        		}
&lt;p&gt;        	}else &lt;/p&gt;
{
        		driver = DriverManager.getDriver(url);
        	}
&lt;p&gt;       	//### END CHANGE ###&lt;/p&gt;

&lt;p&gt;If you need more information, please let me know&lt;/p&gt;

&lt;p&gt;Cheers,&lt;/p&gt;

&lt;p&gt;Bernd&lt;/p&gt;</comment>
                            <comment id="12522170" author="berndkolb" created="Thu, 23 Aug 2007 15:10:28 +0000"  >&lt;p&gt;Any updates on that?&lt;/p&gt;

&lt;p&gt;Thanks&lt;/p&gt;

&lt;p&gt;Bernd&lt;/p&gt;</comment>
                            <comment id="12682182" author="markt" created="Sun, 15 Mar 2009 22:13:17 +0000"  >&lt;p&gt;Thanks for the patch. Sorry it it has been a while. Your patch has been applied.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12357361" name="BasicDataSource.java" size="44860" author="berndkolb" created="Tue, 15 May 2007 08:33:08 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114494</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            16 years, 34 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uvov:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178275</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-213] DBCP causes tomcat to hang under moderate load</title>
                <link>https://issues.apache.org/jira/browse/DBCP-213</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;It appears that the problem in this case is with DBCP, so I am logging this here. If i reload my web page rapidly a few times ( 5-6 times to be exact) it causes tomcat to hang. A thread dump of tomcat shows multiple threads blocked at this line. &lt;br/&gt;
I am using following options for - org.apache.commons.dbcp.BasicDataSource&lt;/p&gt;

&lt;p&gt;    &amp;lt;property name=&quot;maxActive&quot; value=&quot;25&quot;/&amp;gt;&lt;br/&gt;
    &amp;lt;property name=&quot;maxIdle&quot; value=&quot;10&quot;/&amp;gt;&lt;br/&gt;
    &amp;lt;property name=&quot;maxOpenPreparedStatements&quot; value=&quot;50&quot;/&amp;gt;&lt;br/&gt;
    &amp;lt;property name=&quot;poolPreparedStatements&quot; value=&quot;true&quot;/&amp;gt;&lt;/p&gt;

&lt;p&gt;Not sure if its a bug or a misconfiguration. &lt;/p&gt;


&lt;p&gt;&quot;http-8080-2&quot; daemon prio=5 tid=0x00567a20 nid=0x1951600 in Object.wait() &lt;span class=&quot;error&quot;&gt;&amp;#91;0xf1599000..0xf159bab0&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at java.lang.Object.wait(Native Method)&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;waiting on &amp;lt;0x2709d0e8&amp;gt; (a org.apache.commons.pool.impl.GenericObjectPool)&lt;br/&gt;
        at java.lang.Object.wait(Object.java:474)&lt;br/&gt;
        at org.apache.commons.pool.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:748)&lt;/li&gt;
	&lt;li&gt;locked &amp;lt;0x2709d0e8&amp;gt; (a org.apache.commons.pool.impl.GenericObjectPool)&lt;br/&gt;
        at org.apache.commons.dbcp.PoolingDataSource.getConnection(PoolingDataSource.java:96)&lt;br/&gt;
        at org.apache.commons.dbcp.BasicDataSource.getConnection(BasicDataSource.java:880)&lt;br/&gt;
        at org.springframework.orm.hibernate3.LocalDataSourceConnectionProvider.getConnection(LocalDataSourceConnectionProvider.java:81)&lt;br/&gt;
        at org.hibernate.jdbc.ConnectionManager.openConnection(ConnectionManager.java:421)&lt;br/&gt;
        at org.hibernate.jdbc.ConnectionManager.getConnection(ConnectionManager.java:144)&lt;br/&gt;
        at org.hibernate.jdbc.AbstractBatcher.prepareQueryStatement(AbstractBatcher.java:139)&lt;br/&gt;
        at org.hibernate.loader.Loader.prepareQueryStatement(Loader.java:1538)&lt;br/&gt;
        at org.hibernate.loader.Loader.doQuery(Loader.java:661)&lt;br/&gt;
        at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:224)&lt;br/&gt;
        at org.hibernate.loader.Loader.doList(Loader.java:2211)&lt;br/&gt;
        at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2095)&lt;br/&gt;
        at org.hibernate.loader.Loader.list(Loader.java:2090)&lt;br/&gt;
        at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:375)&lt;br/&gt;
        at org.hibernate.hql.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:338)&lt;br/&gt;
        at org.hibernate.engine.query.HQLQueryPlan.performList(HQLQueryPlan.java:172)&lt;br/&gt;
        at org.hibernate.impl.SessionImpl.list(SessionImpl.java:1121)&lt;br/&gt;
        at org.hibernate.impl.QueryImpl.list(QueryImpl.java:79)&lt;br/&gt;
        at org.springframework.orm.hibernate3.HibernateTemplate$29.doInHibernate(HibernateTemplate.java:844)&lt;br/&gt;
        at org.springframework.orm.hibernate3.HibernateTemplate.execute(HibernateTemplate.java:367)&lt;br/&gt;
        at org.springframework.orm.hibernate3.HibernateTemplate.find(HibernateTemplate.java:835)&lt;/li&gt;
&lt;/ul&gt;
</description>
                <environment></environment>
        <key id="12366785">DBCP-213</key>
            <summary>DBCP causes tomcat to hang under moderate load</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="6">Invalid</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="sanjay.dahiya">Sanjay Dahiya</reporter>
                        <labels>
                    </labels>
                <created>Sun, 8 Apr 2007 21:06:18 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:36 +0000</updated>
                            <resolved>Mon, 9 Apr 2007 13:13:25 +0000</resolved>
                                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12487461" author="psteitz" created="Sun, 8 Apr 2007 22:05:36 +0000"  >&lt;p&gt;What versions of commons-dbcp and commons-pool are your running?&lt;/p&gt;</comment>
                            <comment id="12487474" author="sanjay.dahiya" created="Mon, 9 Apr 2007 05:23:46 +0000"  >&lt;p&gt;I am using commons-dbcp-1.2.2.jar, commons-pool-1.2.jar. Tried with commons-dbcp-1.2.1 as well with same result.&lt;/p&gt;</comment>
                            <comment id="12487486" author="psteitz" created="Mon, 9 Apr 2007 07:25:59 +0000"  >&lt;p&gt;Thanks for the info.  You should run pool 1.3 with DBCP 1.2.2, but that is not likely to change anything here, as it looks to me from the stack traces that what is going on is the pool is exhausted and unless you or Hibernate (unlikely) are changing the settings somewhere, the default behavior for commons pool is to block (indefinitely) when the pool is exhausted.  You can address this in a couple of ways.  First,  make sure you are closing connections so they get returned to the pool and that maxActive is set high enough to handle your concurrent load.  Second,  set the maxWait property of the BasicDataSource (should be able to do this via Hibernate config) to a positive number (must be &amp;gt;0), which is the number of milliseconds that  a thread waiting for an available object from the pool will wait before throwing an exception.  &lt;/p&gt;</comment>
                            <comment id="12487544" author="sanjay.dahiya" created="Mon, 9 Apr 2007 13:13:10 +0000"  >&lt;p&gt;Using high values for timeout/max connections takes care of the problem for now. &lt;br/&gt;
thanks. marking it as invalid issue for now. &lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114493</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            18 years, 31 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0v07z:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>179009</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-209] Is DataSource.getConnection(user, pass) working the way it is suppose to?</title>
                <link>https://issues.apache.org/jira/browse/DBCP-209</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;In Tomcat&apos;s server.xml, I create a DataSource resource using the FACTORY org.apache.commons.dbcp.BasicDataSourceFactory and I also provide a  URL and a DRIVERCLASSNAME.  However I do not provide USERNAME or PASSWORD because I want to use DataSource.getConnection(user, pass) in my application.  When I call DataSource.getConnection(user, pass) I get the following exception, java.sql.SQLException: invalid arguments in call, which was unexpected.  I dug into the source code for BasicDataSource and I found what I think is the source of the problem.  First, the method getConnection(user, pass) call the createDataSource() method.  The createDataSource() method creates a Properties object and tries to put the username and password into the properties object.  However, because the server.xml file does contain a username or password, this Properties object (named connectionProperties in the code) is empty.  The createDataSource() the proceeds to call the validateConnectionFactory() method.  This method then tries to get a Connection object!! This attempt fails because the Properties object has no username or password in it hence the Oracle driver complains about being passed invalid arguments.  My question is why is the code working this way?  Why does the createDataSource() and validateConnectionFactory() methods assume the username and password have been set in server.xml and then attempt to try to return a Connection object with the username and password passed to the getConnection(user, pass) method?  It would seem to me the createDataSource() and validateConnectionFactory() methods should be aware of the username and password passed to the getConnection(user, pass) if this method is used.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12361198">DBCP-209</key>
            <summary>Is DataSource.getConnection(user, pass) working the way it is suppose to?</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="6">Invalid</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="mjremijan">Michael Remijan</reporter>
                        <labels>
                    </labels>
                <created>Wed, 24 Jan 2007 18:34:33 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:36 +0000</updated>
                            <resolved>Thu, 19 Jul 2007 23:04:12 +0000</resolved>
                                    <version>1.2.1</version>
                                    <fixVersion>1.3</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12467235" author="psteitz" created="Thu, 25 Jan 2007 04:06:43 +0000"  >&lt;p&gt;The problem with getConnection(user, pass)  is that  this call makes it look like authentication is happening at connection retrieval time and the actual parameters are properties of the connection.  DBCP&apos;s BasicDataSource provides connections from a connection pool and the username and password properties are properties of the pool - i.e., all connections returned by this datasource share these properties, along with the URL and other connection properties.  Authentication happens when the pool invokes the underlying connection factory&apos;s makeObject method,  not when connections are retrieved by BasicDataSource clients.&lt;/p&gt;

&lt;p&gt;The current code (in RC now for 1.2.2) throws an UnsupportedOperationException when getConnection is invoked with username and password specified, which is less confusing to the client.&lt;/p&gt;

&lt;p&gt;If you want to delay specification of the username and password for the pool until the first connection retrieval, you can do this by using the setPassword and setUsername properties before the first connection retrieval is attempted.&lt;/p&gt;

&lt;p&gt;I am leaving this open, since if what you want is to have getConnection(user, pass) have the effect of setting these properties on the pool (closing and reinitializing if the pool has been initialized and the actual parameters are different from current values), we can talk about implementing that.  Personally, I think it is best to force use of pool properties as above to handle this, though.&lt;/p&gt;</comment>
                            <comment id="12467239" author="mjremijan" created="Thu, 25 Jan 2007 04:37:09 +0000"  >&lt;p&gt;This make sense, but what about considering this.  In Tomcat a datasource is configured with something like this:&lt;/p&gt;

&lt;p&gt;&amp;lt;Resource &lt;br/&gt;
  name=&quot;jdbc/TestDB&quot;&lt;br/&gt;
  auth=&quot;Container&quot;&lt;br/&gt;
  type=&quot;javax.sql.DataSource&quot;&lt;br/&gt;
/&amp;gt;&lt;/p&gt;

&lt;p&gt;Now &quot;auth&quot; can have the values Container or Application.  According to the Tomcat documentation if auth=&quot;Container&quot; then Tomcat will take care of handling logging in.  In this case the username and password of &amp;lt;ResourceParams /&amp;gt; makes sense.  But if auth=&quot;Application&quot; then the application is suppose to handle login. So I interpret this as using the getConnection(username, password) method.  This make any sense?&lt;/p&gt;</comment>
                            <comment id="12467241" author="psteitz" created="Thu, 25 Jan 2007 04:58:20 +0000"  >&lt;p&gt;Yes, that makes sense, but the way to do it is to have the application set properties on the &lt;b&gt;pool&lt;/b&gt;  - using setUsername, setPassword, instead of trying to do it &lt;b&gt;per connection&lt;/b&gt; using getConnection(user, pass).&lt;/p&gt;</comment>
                            <comment id="12514033" author="dain" created="Thu, 19 Jul 2007 22:48:50 +0000"  >&lt;p&gt;I believe that Michael should be using either the SharedPoolDataSource or the PerUserPoolDataSource which support the getConnection(user, pass) method.  This pool keeps track of connection credentials, so when a connection is created, it can locate a connection authorized for the specified user.&lt;/p&gt;

&lt;p&gt;I think this issue should be closed as invalid.&lt;/p&gt;</comment>
                            <comment id="12514037" author="psteitz" created="Thu, 19 Jul 2007 23:04:12 +0000"  >&lt;p&gt;I agree with Dain.  For BasicDataSource, the username and password are pool properties.  &lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114489</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            18 years, 16 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0v0f3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>179041</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-208] URL Parsing Bug</title>
                <link>https://issues.apache.org/jira/browse/DBCP-208</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;Hello,&lt;/p&gt;

&lt;p&gt;I think there&apos;s a bug at the org.apache.tomcat.dbcp.dbcp.BasicDataSourceFactory at the time of parsing a certain MySQL url. When the connection url contains the &quot;sessionVariables&quot; property alone, everything works ok. However, when other properties are specified in addition to &quot;sessionVariables&quot;, then an Exception is thrown when trying to establish a new connection. If the same url is specified using a Connection object inside my code, then NO error is thrown. It only happens when that same url is set at the Resource config of the server.xml file. I include some examples to reproduce the error:&lt;/p&gt;

&lt;p&gt;Everything goes fine when this is the config of the resource (note that the important part is the url):&lt;/p&gt;

&lt;p&gt;&amp;lt;Resource name=&quot;jdbc/db&quot; auth=&quot;Container&quot; type=&quot;javax.sql.DataSource&quot;&lt;br/&gt;
     factory=&quot;org.apache.tomcat.dbcp.dbcp.BasicDataSourceFactory&quot;&lt;br/&gt;
     maxActive=&quot;15&quot;&lt;br/&gt;
     maxIdle=&quot;5&quot;&lt;br/&gt;
     validationQuery=&quot;SELECT 1&quot;&lt;br/&gt;
     testOnBorrow=&quot;false&quot;&lt;br/&gt;
     testWhileIdle=&quot;true&quot;&lt;br/&gt;
     timeBetweenEvictionRunsMillis=&quot;10000&quot;&lt;br/&gt;
     minEvictableIdleTimeMillis=&quot;60000&quot;&lt;br/&gt;
     username=&quot;user&quot;&lt;br/&gt;
     password=&quot;pass&quot;&lt;br/&gt;
     driverClassName=&quot;com.mysql.jdbc.Driver&quot;&lt;br/&gt;
     url=&quot;jdbc:mysql://localhost:3316/db?sessionVariables=@date=&apos;0&apos;,@version=&apos;1.0&apos;;&quot;&lt;br/&gt;
/&amp;gt;&lt;/p&gt;

&lt;p&gt;However, if we set this other url in the previous example, an error will be printed on the tomcat&apos;s log file:&lt;/p&gt;

&lt;p&gt;jdbc:mysql://localhost:3316/db?transformedBitIsBoolean=true&amp;amp;sessionVariables=@date=&apos;0&apos;,@version=&apos;1.0&apos;;&lt;/p&gt;

&lt;p&gt;It seems to be a bug when sessionVariables is specified in addition to other&lt;br/&gt;
properties, like transformedBitIsBoolean in the previous example.&lt;/p&gt;

&lt;p&gt;As I mentioned above, when this same url is set using a Connection object inside my application, no Exception is thrown, so I think the bug is located at the BasicDataSourceFactory class.&lt;/p&gt;

&lt;p&gt;This is the exception thrown:&lt;/p&gt;

&lt;p&gt;org.xml.sax.SAXParseException: The reference to entity &quot;sessionVariables&quot; must end with the &apos;;&apos; delimiter.&lt;br/&gt;
	at org.apache.xerces.util.ErrorHandlerWrapper.createSAXParseException(Unknown Source)&lt;br/&gt;
	at org.apache.xerces.util.ErrorHandlerWrapper.fatalError(Unknown Source)&lt;br/&gt;
	at org.apache.xerces.impl.XMLErrorReporter.reportError(Unknown Source)&lt;br/&gt;
	at org.apache.xerces.impl.XMLErrorReporter.reportError(Unknown Source)&lt;br/&gt;
	at org.apache.xerces.impl.XMLScanner.reportFatalError(Unknown Source)&lt;br/&gt;
	at org.apache.xerces.impl.XMLScanner.scanAttributeValue(Unknown Source)&lt;br/&gt;
	at org.apache.xerces.impl.XMLDocumentFragmentScannerImpl.scanAttribute(Unknown Source)&lt;br/&gt;
	at org.apache.xerces.impl.XMLDocumentFragmentScannerImpl.scanStartElement(Unknown Source)&lt;br/&gt;
	at org.apache.xerces.impl.XMLDocumentFragmentScannerImpl$FragmentContentDispatcher.dispatch(Unknown Source)&lt;br/&gt;
	at org.apache.xerces.impl.XMLDocumentFragmentScannerImpl.scanDocument(Unknown Source)&lt;br/&gt;
	at org.apache.xerces.parsers.XML11Configuration.parse(Unknown Source)&lt;br/&gt;
	at org.apache.xerces.parsers.XML11Configuration.parse(Unknown Source)&lt;br/&gt;
	at org.apache.xerces.parsers.XMLParser.parse(Unknown Source)&lt;br/&gt;
	at org.apache.xerces.parsers.AbstractSAXParser.parse(Unknown Source)&lt;br/&gt;
	at org.apache.xerces.jaxp.SAXParserImpl$JAXPSAXParser.parse(Unknown Source)&lt;br/&gt;
	at org.apache.tomcat.util.digester.Digester.parse(Digester.java:1561)&lt;br/&gt;
	at org.apache.catalina.startup.Catalina.load(Catalina.java:489)&lt;br/&gt;
	at org.apache.catalina.startup.Catalina.start(Catalina.java:543)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)&lt;br/&gt;
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)&lt;br/&gt;
	at java.lang.reflect.Method.invoke(Unknown Source)&lt;br/&gt;
	at org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:294)&lt;br/&gt;
	at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:432)&lt;/p&gt;


&lt;p&gt;This is the code I&apos;ve used to test the same URL, but establishing a new Connection object inside my application:&lt;/p&gt;

&lt;p&gt;Class.forName(&quot;com.mysql.jdbc.Driver&quot;).newInstance();&lt;br/&gt;
Connection connection=DriverManager.getConnection(&quot;jdbc:mysql://localhost:3316/db?transformedBitIsBoolean=true&amp;amp;sessionVariables=@date=&apos;0&apos;,@version=&apos;1.0&apos;;&quot;);&lt;/p&gt;

&lt;p&gt;As you can see, the URL is the same in both cases. However, now that I&apos;m looking at the Exception in detail, the bug seems to be at the org.apache.tomcat.util.digester.Digester.parse method and not in the DBCP. Sorry if that&apos;s the case.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Tomcat DBCP&lt;/p&gt;</environment>
        <key id="12360961">DBCP-208</key>
            <summary>URL Parsing Bug</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="6">Invalid</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="hander3@terra.com">R</reporter>
                        <labels>
                    </labels>
                <created>Sun, 21 Jan 2007 20:30:00 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:36 +0000</updated>
                            <resolved>Tue, 23 Jan 2007 20:52:29 +0000</resolved>
                                                    <fixVersion>1.3</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12466360" author="psteitz" created="Sun, 21 Jan 2007 21:51:22 +0000"  >&lt;p&gt;DBCP should just pass the URL unchanged to the driver&apos;s connect() method.  Can you post or more fully describe the code in your application that works?  Also, the relevant bits of a stack trace showing where the exception is thrown would help. &lt;/p&gt;</comment>
                            <comment id="12466735" author="hander3@terra.com" created="Tue, 23 Jan 2007 13:54:26 +0000"  >&lt;p&gt;Hi Phil,&lt;/p&gt;

&lt;p&gt;I&apos;ve modified the original issue to include the Exceptions and the code I&apos;ve used inside my application to test if the URL was valid.&lt;/p&gt;

&lt;p&gt;Thank you!&lt;/p&gt;</comment>
                            <comment id="12466739" author="niallp" created="Tue, 23 Jan 2007 13:57:13 +0000"  >&lt;p&gt;So it looks like you need to encode the amersand in your XML configuration, otherwise the XML parser thinks sessionVariables is an encoded entity - try changing the &quot;&amp;amp;&quot; to &quot;&amp;amp;&quot;&lt;/p&gt;

&lt;p&gt;jdbc:mysql://localhost:3316/db?transformedBitIsBoolean=true&amp;amp;sessionVariables=@date=&apos;0&apos;,@version=&apos;1.0&apos;; &lt;/p&gt;</comment>
                            <comment id="12466820" author="hander3@terra.com" created="Tue, 23 Jan 2007 20:51:29 +0000"  >&lt;p&gt;Niall &amp;amp; Phil,&lt;/p&gt;

&lt;p&gt;Absolutely, that was the problem! Thank you very much and sorry for the time lost in this issue.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114488</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            18 years, 42 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0v0fj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>179043</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-207] DBCP 1.2.1 incompatible with Informix (driver doesn&apos;t support setReadOnly(...))</title>
                <link>https://issues.apache.org/jira/browse/DBCP-207</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;I recieved an error using commons-dbcp-1.2.1.jar and ifxjdbc.jar for my informix driver: &lt;/p&gt;

&lt;p&gt;org.apache.commons.dbcp.SQLNestedException: Cannot get a connection, pool exhausted &lt;br/&gt;
at org.apache.commons.dbcp.PoolingDriver.connect(PoolingDriver.java:183) &lt;br/&gt;
at java.sql.DriverManager.getConnection(DriverManager.java:539) &lt;br/&gt;
at java.sql.DriverManager.getConnection(DriverManager.java:211) &lt;br/&gt;
at ConnectionPoolingTest.main(ConnectionPoolingTest.java:105) &lt;br/&gt;
Caused by: java.util.NoSuchElementException: Could not create a validated object, cause: Read only mode not supported &lt;br/&gt;
at org.apache.commons.pool.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:806) &lt;br/&gt;
at org.apache.commons.dbcp.PoolingDriver.connect(PoolingDriver.java:175) &lt;/p&gt;

&lt;p&gt;I will look into the comment provided by Dirk in bug ID &lt;a href=&quot;https://issues.apache.org/jira/browse/DBCP-127&quot; title=&quot;DBCP 1.1 incompatible with Informix (driver doesn&amp;#39;t support setReadOnly(...))&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DBCP-127&quot;&gt;&lt;del&gt;DBCP-127&lt;/del&gt;&lt;/a&gt; (version 1.1), but it appears this bug still has an impact in the 1.2.1 version. If anyone has any other suggestions, they would be greatly appreciated. &lt;/p&gt;</description>
                <environment>&lt;p&gt;using the pooling driver component with an informix driver&lt;/p&gt;</environment>
        <key id="12359729">DBCP-207</key>
            <summary>DBCP 1.2.1 incompatible with Informix (driver doesn&apos;t support setReadOnly(...))</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="dain">Dain Sundstrom</assignee>
                                    <reporter username="kimberlybaer">Kimberly Baer</reporter>
                        <labels>
                    </labels>
                <created>Wed, 3 Jan 2007 20:04:14 +0000</created>
                <updated>Wed, 10 Feb 2010 19:16:34 +0000</updated>
                            <resolved>Mon, 23 Jul 2007 20:03:35 +0000</resolved>
                                    <version>1.2.1</version>
                                    <fixVersion>1.3</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="12514058" author="dain" created="Fri, 20 Jul 2007 00:34:23 +0000"  >&lt;p&gt;Already fixed for PoolingDataSource, but PerUserDataSource and SharedPoolDataSource still always set this value.  These data sources use a primitives for the read only,  transaction isolation and auto commit default values so there is not way to see if the value was not set.  This patch checks if the read-only and auto-commit values are already set before changing them which should setReadOnly from being called. &lt;/p&gt;</comment>
                            <comment id="12514765" author="dain" created="Mon, 23 Jul 2007 20:03:35 +0000"  >&lt;p&gt;Committed a fix for this specific problem, and created a JIRA for converting all default values to non-primitive types.  This way only configured default values will be set.&lt;/p&gt;

&lt;p&gt;Sending        src/java/org/apache/commons/dbcp/datasources/PerUserPoolDataSource.java&lt;br/&gt;
Sending        src/java/org/apache/commons/dbcp/datasources/SharedPoolDataSource.java&lt;br/&gt;
Transmitting file data ..&lt;br/&gt;
Committed revision 558850.&lt;/p&gt;</comment>
                            <comment id="12832135" author="manoj@castiron.com" created="Wed, 10 Feb 2010 19:16:34 +0000"  >&lt;p&gt;Is there a workaround for this one since 1.3 is not released yet.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12362181" name="DBCP-207.patch" size="1280" author="dain" created="Fri, 20 Jul 2007 00:34:22 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114487</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            15 years, 39 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uvof:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178273</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-206] DBCP high performance contention point</title>
                <link>https://issues.apache.org/jira/browse/DBCP-206</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;From mail to commons-dev from Michael.Veprinsky@dig.com on 29-Nov-06&lt;/p&gt;

&lt;p&gt;Hello!&lt;br/&gt;
I am using DBCP for very light weight queries and it seems that I came&lt;br/&gt;
across synchronization bottleneck. I am not sure, maybe I am doing&lt;br/&gt;
something wrong or maybe there is an easy workaround.&lt;/p&gt;

&lt;p&gt;It seems that both on DataSource.getConnection and on Connection.close()&lt;br/&gt;
there are synchronized blocks (for .close() it&apos;s in GenericObjectPool.&lt;br/&gt;
returnObject and for getConnection it&apos;s in borrowObject)&lt;br/&gt;
Seems that primary reason for contention is setAutocommit that occurs&lt;br/&gt;
both on borrow and on return. I am trying to reduce number of&lt;br/&gt;
setAutocommits going over the network on driver level but a) it only&lt;br/&gt;
reduces problem and b) does not seem like a solid long term solution.&lt;/p&gt;

&lt;p&gt;Contention happens at ~2-3 k/sec. If I remove pool from the equation I&lt;br/&gt;
get 30k+. Have anybody else seen this problem? Are there standard ways&lt;br/&gt;
to deal with it (pools with threadlocal, different pool implementations&lt;br/&gt;
that deal with passivate/activate outside of synchronized blocks, etc)?&lt;/p&gt;

&lt;p&gt;Example: seem below (very end). If I move getConnection() and .close()&lt;br/&gt;
outside of the main loop I get ~ order of magnitude performance boost.&lt;/p&gt;

&lt;p&gt;My setup:&lt;br/&gt;
Java 5, Linux RHEL 4.3 (although same thing happens on Windows) DBCP&lt;br/&gt;
1.2.1, commons-pool 1.3, MySQL 4 &amp;amp; drivers 3.1.6.&lt;/p&gt;

&lt;p&gt;Configuration for DBCP:&lt;br/&gt;
username=...&lt;br/&gt;
password=...&lt;br/&gt;
maxActive=900&lt;br/&gt;
maxIdle=900&lt;br/&gt;
url=jdbc:mysql://hostname/disl?elideSetAutoCommits=true&amp;amp;useLocalSessionS&lt;br/&gt;
tate=true&amp;amp;poolPreparedStatements=true&lt;br/&gt;
driverClassName=com.mysql.jdbc.Driver&lt;/p&gt;

&lt;p&gt;Test source (runs in multiple threads):&lt;br/&gt;
for(int i=0;i&amp;lt;lcount;i++){&lt;br/&gt;
       Connection conn1= ds.getConnection();&lt;br/&gt;
       String sql= &quot;select value from user_permission where user_id=?&lt;br/&gt;
and permission_id=1&quot;;&lt;br/&gt;
       PreparedStatement stmt=conn1.prepareStatement(sql);&lt;br/&gt;
       stmt.setInt(1, UsernameGenerator.getUserId(id, lcount, i));&lt;br/&gt;
       ResultSet res=stmt.executeQuery();&lt;br/&gt;
       stmt.close();&lt;br/&gt;
       conn1.close();&lt;br/&gt;
}&lt;/p&gt;</description>
                <environment>&lt;p&gt;Java 5, Linux RHEL 4.3 (although same thing happens on Windows) DBCP&lt;br/&gt;
1.2.1, commons-pool 1.3, MySQL 4 &amp;amp; drivers 3.1.6.&lt;/p&gt;</environment>
        <key id="12359069">DBCP-206</key>
            <summary>DBCP high performance contention point</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="3">Duplicate</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="psteitz">Phil Steitz</reporter>
                        <labels>
                    </labels>
                <created>Tue, 19 Dec 2006 20:58:45 +0000</created>
                <updated>Mon, 16 Feb 2009 15:54:08 +0000</updated>
                            <resolved>Mon, 16 Feb 2009 15:54:08 +0000</resolved>
                                    <version>1.2.1</version>
                                    <fixVersion>1.2.2</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="12673910" author="psteitz" created="Mon, 16 Feb 2009 15:54:08 +0000"  >&lt;p&gt;The set autocommit traffic issue duplicates &lt;a href=&quot;https://issues.apache.org/jira/browse/DBCP-102&quot; title=&quot;[dbcp] setReadOnly &amp;amp; setAutoCommit called too many times&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DBCP-102&quot;&gt;&lt;del&gt;DBCP-102&lt;/del&gt;&lt;/a&gt;, which was resolved in 1.2.2.  The borrow/return synchronization contention was resolved by the upgrade to pool 1.4&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10032">
                    <name>Blocker</name>
                                                                <inwardlinks description="is blocked by">
                                        <issuelink>
            <issuekey id="12382363">POOL-108</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114486</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            16 years, 38 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uzz3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178969</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-205] Intermittently getting &quot;Could not retrieve connection info from pool&quot; when under load</title>
                <link>https://issues.apache.org/jira/browse/DBCP-205</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt; I have a Tomcat servlet that uses a connection pool with the following settings:&lt;/p&gt;

&lt;p&gt;MaxActive=30&lt;br/&gt;
MaxIdle=3&lt;br/&gt;
MaxWait=50000 milliseconds&lt;br/&gt;
IdleTimeOut=3600 seconds&lt;br/&gt;
LoginTimeOut=100 seconds&lt;br/&gt;
TimeBetweenEvictionRunsMills=-1&lt;/p&gt;

&lt;p&gt;Under load, I get the following exception:&lt;/p&gt;

&lt;p&gt;org.apache.commons.dbcp.SQLNestedException: Could not retrieve connection info from pool&lt;br/&gt;
	at org.apache.commons.dbcp.datasources.SharedPoolDataSource.getPooledConnectionAndInfo(SharedPoolDataSource.java:171)&lt;br/&gt;
	at org.apache.commons.dbcp.datasources.InstanceKeyDataSource.getConnection(InstanceKeyDataSource.java:662)&lt;br/&gt;
	at org.apache.commons.dbcp.datasources.InstanceKeyDataSource.getConnection(InstanceKeyDataSource.java:646)&lt;/p&gt;

&lt;p&gt;Caused by: com.microsoft.sqlserver.jdbc.SQLServerException: The TCP/IP connection to the host  has failed. java.net.BindException: Address already in use: connect&lt;br/&gt;
	at com.microsoft.sqlserver.jdbc.SQLServerException.makeFromDriverError(Unknown Source)&lt;br/&gt;
	at com.microsoft.sqlserver.jdbc.SQLServerConnection.connect(Unknown Source)&lt;br/&gt;
	at com.microsoft.sqlserver.jdbc.SQLServerDriver.connect(Unknown Source)&lt;br/&gt;
	at java.sql.DriverManager.getConnection(Unknown Source)&lt;br/&gt;
	at java.sql.DriverManager.getConnection(Unknown Source)&lt;br/&gt;
	at org.apache.commons.dbcp.cpdsadapter.DriverAdapterCPDS.getPooledConnection(DriverAdapterCPDS.java:177)&lt;br/&gt;
	at org.apache.commons.dbcp.cpdsadapter.DriverAdapterCPDS.getPooledConnection(DriverAdapterCPDS.java:132)&lt;br/&gt;
	at org.apache.commons.dbcp.datasources.KeyedCPDSConnectionFactory.makeObject(KeyedCPDSConnectionFactory.java:158)&lt;br/&gt;
	at org.apache.commons.pool.impl.GenericKeyedObjectPool.borrowObject(GenericKeyedObjectPool.java:747)&lt;br/&gt;
	at org.apache.commons.dbcp.datasources.SharedPoolDataSource.getPooledConnectionAndInfo(SharedPoolDataSource.java:167)&lt;/p&gt;

</description>
                <environment>&lt;p&gt;JRE 1.4.2_03, commons_dbcp20061206, commons-pool-1.2, Microsoft SQL Server 2005 JDBC Driver (sqljdbc_1.0.809.102)&lt;/p&gt;</environment>
        <key id="12358185">DBCP-205</key>
            <summary>Intermittently getting &quot;Could not retrieve connection info from pool&quot; when under load</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="rida">Rida Ligurs</reporter>
                        <labels>
                    </labels>
                <created>Sat, 9 Dec 2006 12:57:21 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:35 +0000</updated>
                            <resolved>Sat, 8 Mar 2008 23:49:29 +0000</resolved>
                                    <version>1.2.2</version>
                                    <fixVersion>1.3</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12457146" author="psteitz" created="Sat, 9 Dec 2006 23:06:56 +0000"  >&lt;p&gt;Do you see anything in the Windows event log on the SQL Server box?  Is Tomcat running on the same box?  That error could happen if the OS is unable to assign a (client) port for a new connection.  Your config should be limiting the number of db connections from the servlet.  Are there other clients hitting the SQL server concurrently?  If not, can you verify that there are no more than 30 open at a given time?  &lt;/p&gt;

&lt;p&gt;This is not likely related to your problem, but if you are using a recent dbcp nightly, you should be using pool 1.3 (release version) rather than 1.2.&lt;/p&gt;

&lt;p&gt;If your load is variable, the low maxIdle setting above could be causing a lot of connection churn which might be part of the problem.  Try increasing that setting to 8 or 10.&lt;/p&gt;</comment>
                            <comment id="12457739" author="rida" created="Tue, 12 Dec 2006 14:43:24 +0000"  >&lt;p&gt;Hi Phil,&lt;/p&gt;

&lt;p&gt;Thanks for your response.  I tried your suggestion of increasing maxIdle&lt;br/&gt;
to 10 and it worked.  I really didn&apos;t want to have 10 connections&lt;br/&gt;
sitting idle.  Is this a bug?  In my case, under regular load it only&lt;br/&gt;
gets to a maximum of 4 or 5 active connections.  For those rare&lt;br/&gt;
instances where there are significantly more active connections, I would&lt;br/&gt;
want them to be release as soon as they are no longer needed.&lt;/p&gt;

&lt;p&gt;Rida&lt;/p&gt;

</comment>
                            <comment id="12466366" author="psteitz" created="Sun, 21 Jan 2007 22:07:30 +0000"  >&lt;p&gt;Moving this to 1.3 fix version - though I don&apos;t know if this is something that we can fix in dbcp.  It does not look like the actual bug report ed is DBCP-related.  More likely this is the result of heavy socket open/close activity when a loaded server is trying to keep maxIdle very low.  What is really being requested here is an adaptive / more advanced pool management capability - create headroom during loaded periods, but then quiesce when load abates.   &lt;/p&gt;</comment>
                            <comment id="12467713" author="bayard" created="Fri, 26 Jan 2007 00:54:25 +0000"  >&lt;p&gt;Agreed - seems to be that the JDBC driver/db just doesn&apos;t like the amount of activity.&lt;/p&gt;

&lt;p&gt;Not that I grok how the driver could be running out of client side ports to connect from; there&apos;re tons of those aren&apos;t there?&lt;/p&gt;

&lt;p&gt;Might be a SQL Server driver specific bit I guess if it&apos;s trying to define the actual port to connect from and it&apos;s getting screwed up for some reason.&lt;/p&gt;</comment>
                            <comment id="12576662" author="psteitz" created="Sat, 8 Mar 2008 23:49:29 +0000"  >&lt;p&gt;The lock contention issue here should be resolved by the changes in pool 1.4.  I don&apos;t see a remaining dbcp bug here.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12366645">DBCP-212</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114485</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            17 years, 35 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uyan:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178697</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-202] Deadlock creating/closing PreparedStatement</title>
                <link>https://issues.apache.org/jira/browse/DBCP-202</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;Hi!&lt;br/&gt;
I&#180;m using DBCP in a multi-threaded app. Sometimes a few threads share the same connection (obtained from the same BasicDatasource) and quite often the application just hangs. Looking a bit further i found out that it hangs when one thread is creating a PreparedStatement and the other one is closing another PreparedStatement.&lt;br/&gt;
I connected to my app with jConsole and i was able to see the stacktrace for two threads that blocked one another. Here is:&lt;/p&gt;

&lt;p&gt;Name: pool-1-thread-1&lt;br/&gt;
State: BLOCKED on org.apache.commons.pool.impl.GenericKeyedObjectPool@15c13ef owned by: pool-1-thread-2&lt;br/&gt;
Total blocked: 137  Total waited: 1&lt;/p&gt;

&lt;p&gt;Stack trace: &lt;br/&gt;
org.apache.commons.pool.impl.GenericKeyedObjectPool.borrowObject(GenericKeyedObjectPool.java:767)&lt;br/&gt;
org.apache.commons.dbcp.PoolingConnection.prepareStatement(PoolingConnection.java:87)&lt;br/&gt;
org.apache.commons.dbcp.DelegatingConnection.prepareStatement(DelegatingConnection.java:185)&lt;br/&gt;
org.apache.commons.dbcp.PoolingDataSource$PoolGuardConnectionWrapper.prepareStatement(PoolingDataSource.java:278)&lt;br/&gt;
dmview.common.Database.prepareStatement(Database.java:829)&lt;br/&gt;
dmview.monitor.polling.ProxyUpdater.insertAllSlotPortsIntoDb(ProxyUpdater.java:801)&lt;br/&gt;
dmview.monitor.polling.ProxyUpdater.insertSlotIntoDb(ProxyUpdater.java:718)&lt;br/&gt;
dmview.monitor.polling.ProxyUpdater.updateDevice(ProxyUpdater.java:296)&lt;br/&gt;
dmview.monitor.polling.ProxyUpdater.update(ProxyUpdater.java:81)&lt;br/&gt;
dmview.monitor.polling.Poller.run(Poller.java:183)&lt;br/&gt;
java.util.concurrent.ThreadPoolExecutor$Worker.runTask(Unknown Source)&lt;br/&gt;
java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)&lt;br/&gt;
java.lang.Thread.run(Unknown Source)&lt;/p&gt;

&lt;p&gt;The stacktrace for the second thread : &lt;br/&gt;
Name: pool-1-thread-2&lt;br/&gt;
State: BLOCKED on org.apache.commons.dbcp.PoolingConnection@442c76 owned by: pool-1-thread-1&lt;br/&gt;
Total blocked: 107  Total waited: 1&lt;/p&gt;

&lt;p&gt;Stack trace: &lt;br/&gt;
org.apache.commons.dbcp.AbandonedTrace.removeTrace(AbandonedTrace.java:221)&lt;br/&gt;
org.apache.commons.dbcp.PoolablePreparedStatement.passivate(PoolablePreparedStatement.java:100)&lt;br/&gt;
org.apache.commons.dbcp.PoolingConnection.passivateObject(PoolingConnection.java:239)&lt;br/&gt;
org.apache.commons.pool.impl.GenericKeyedObjectPool.returnObject(GenericKeyedObjectPool.java:970)&lt;br/&gt;
org.apache.commons.dbcp.PoolablePreparedStatement.close(PoolablePreparedStatement.java:78)&lt;br/&gt;
org.apache.commons.dbcp.DelegatingStatement.close(DelegatingStatement.java:165)&lt;br/&gt;
dmview.monitor.polling.ProxyUpdater.insertAllSlotPortsIntoDb(ProxyUpdater.java:883)&lt;br/&gt;
dmview.monitor.polling.ProxyUpdater.insertSlotIntoDb(ProxyUpdater.java:718)&lt;br/&gt;
dmview.monitor.polling.ProxyUpdater.updateDevice(ProxyUpdater.java:296)&lt;br/&gt;
dmview.monitor.polling.ProxyUpdater.update(ProxyUpdater.java:81)&lt;br/&gt;
dmview.monitor.polling.Poller.run(Poller.java:183)&lt;br/&gt;
java.util.concurrent.ThreadPoolExecutor$Worker.runTask(Unknown Source)&lt;br/&gt;
java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)&lt;br/&gt;
java.lang.Thread.run(Unknown Source)&lt;/p&gt;

&lt;p&gt;The line 829 from method Database.prepareStatement (last one from my app before DBCP, in first stacktrace) is :&lt;br/&gt;
PreparedStatement ret = conexao.prepareStatement(sql);&lt;br/&gt;
where &quot;conexao&quot; is a java.sql.Connection obtained from the pool.&lt;br/&gt;
The line 883 in method ProxyUpdater.insertAllSlotPortsIntoDb (last one from my app before DBCP, in second stacktrace) is :&lt;br/&gt;
insertPortTest.close();&lt;br/&gt;
where insertPortTest is a PreparedStatement.&lt;br/&gt;
It all seems to me that creating/closing PreparedStatements using the same connection from a BasicDatasource instance can cause a racing condition where two (or more) threads may block one another. Am i correct? Is this really a bug?&lt;br/&gt;
Thanks in advance!&lt;/p&gt;</description>
                <environment></environment>
        <key id="12356581">DBCP-202</key>
            <summary>Deadlock creating/closing PreparedStatement</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="gmauch">Gustavo Huff Mauch</reporter>
                        <labels>
                    </labels>
                <created>Fri, 24 Nov 2006 20:18:58 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:35 +0000</updated>
                            <resolved>Mon, 22 Jan 2007 04:48:37 +0000</resolved>
                                    <version>1.2.2</version>
                                    <fixVersion>1.2.2</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="12463735" author="filesdir" created="Wed, 10 Jan 2007 22:21:32 +0000"  >&lt;p&gt;In a multi-thread environment that can open and close PreparedStatement at the same time, one thread may try to obtain a PreparedStatment (eventually called to PoolingConnection.prepareStatement), this will lock on the Connection object and trying to wait for statement pool object, but if at the same time another thread that is executing the PreparedStatment.close() method (eventually called to PoolablePreparedStatement.close),  then it will lock on the statement pool object and try to obtain a Connection object lock.  As a result, both threads will cause a dead lock.&lt;/p&gt;

&lt;p&gt;The possible solution is to removed the synchronized keyword in the PoolingConnection.prepareStatement() as it does not modify / access any other critical resources other than the statement pool.&lt;/p&gt;

&lt;p&gt;The above testing and fixing is based on common-dbcp-1.2.1&lt;/p&gt;</comment>
                            <comment id="12466388" author="psteitz" created="Mon, 22 Jan 2007 04:48:37 +0000"  >&lt;p&gt;Fixed in r498524 by removing synchronization in prepareStatement methods.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10032">
                    <name>Blocker</name>
                                            <outwardlinks description="blocks">
                                        <issuelink>
            <issuekey id="12342100">DBCP-44</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12342202">DBCP-65</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114482</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            18 years, 42 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uvnb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178268</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-201] Statement closing due to unprovoked rollback</title>
                <link>https://issues.apache.org/jira/browse/DBCP-201</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;have seen closed statement errors sporadically occurring and I can&apos;t get it under control. Even when the last execution of the statement is successful in a recursive loop reusing the statement, I can still see this happen. The stack and code is below. I am very curious how the rollback is getting called. There are several more places in the code where this is occurring. It is odd that it only happens sporadically and I have only identified 2 places out of a couple of dozen that actually causes this to occur.&lt;/p&gt;

&lt;p&gt;*************&lt;b&gt;CONFIG&lt;/b&gt;*******************&lt;br/&gt;
&amp;lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&amp;gt;&lt;br/&gt;
&amp;lt;!DOCTYPE hibernate-configuration PUBLIC&lt;br/&gt;
&quot;-//Hibernate/Hibernate Configuration DTD 3.0//EN&quot;&lt;br/&gt;
&quot;http://hibernate.sourceforge.net/hibernate-configuration-3.0.dtd&quot;&amp;gt;&lt;br/&gt;
&amp;lt;hibernate-configuration&amp;gt;&lt;br/&gt;
    &amp;lt;session-factory&amp;gt;&lt;br/&gt;
        &amp;lt;property name=&quot;hibernate.connection.driver_class&quot;&amp;gt;org.postgresql.Driver&amp;lt;/property&amp;gt;&lt;br/&gt;
        &amp;lt;property name=&quot;hibernate.connection.password&quot;&amp;gt;password&amp;lt;/property&amp;gt;&lt;br/&gt;
        &amp;lt;property name=&quot;hibernate.connection.url&quot;&amp;gt;jdbc:postgresql://localhost/myDB&amp;lt;/property&amp;gt;&lt;br/&gt;
        &amp;lt;property name=&quot;hibernate.connection.username&quot;&amp;gt;user&amp;lt;/property&amp;gt;&lt;br/&gt;
        &amp;lt;property name=&quot;hibernate.dialect&quot;&amp;gt;org.hibernate.dialect.PostgreSQLDialect&amp;lt;/property&amp;gt;&lt;br/&gt;
        &amp;lt;property name=&quot;hibernate.transaction.factory_class &quot;&amp;gt;org.hibernate.transaction.JDBCTransactionFactory&amp;lt;/property&amp;gt;&lt;br/&gt;
        &amp;lt;property name=&quot;hibernate.current_session_context_class&quot;&amp;gt;thread&amp;lt;/property&amp;gt;&lt;/p&gt;

&lt;p&gt;        &amp;lt;property name=&quot;hibernate.connection.provider_class&quot;&amp;gt;org.hibernate.connection.DBCPConnectionProvider&amp;lt;/property&amp;gt;&lt;br/&gt;
        &amp;lt;!-- Not specified with 3rd party connection pool &amp;lt;property name=&quot;connection.pool_size&quot;&amp;gt;20&amp;lt;/property&amp;gt;--&amp;gt;&lt;br/&gt;
        &amp;lt;property name=&quot;hibernate.dbcp.maxActive&quot;&amp;gt;3&amp;lt;/property&amp;gt;&lt;br/&gt;
        &amp;lt;property name=&quot;hibernate.dbcp.maxIdle&quot;&amp;gt;3&amp;lt;/property&amp;gt;&lt;br/&gt;
        &amp;lt;property name=&quot;hibernate.dbcp.max Wait&quot;&amp;gt;60000&amp;lt;/property&amp;gt;&lt;br/&gt;
&amp;lt;property name=&quot;hibernate.dbcp.whenExhaustedAction&quot;&amp;gt;1&amp;lt;/property&amp;gt;&lt;br/&gt;
&amp;lt;property name=&quot;hibernate.dbcp.ps.maxActive&quot;&amp;gt;3&amp;lt;/property&amp;gt;&lt;br/&gt;
&amp;lt;property name=&quot;hibernate.dbcp.ps.maxIdle&quot;&amp;gt;3&amp;lt;/property&amp;gt;&lt;br/&gt;
&amp;lt;property name=&quot;hibernate.dbcp.ps.maxWait&quot;&amp;gt;1000*20&amp;lt;/property&amp;gt;&lt;br/&gt;
&amp;lt;property name=&quot;hibernate.dbcp.ps.whenExhaustedAction&quot;&amp;gt;1&amp;lt;/property&amp;gt;&lt;br/&gt;
&amp;lt;property name=&quot;hibernate.connection.release_mode&quot;&amp;gt;after_transaction&amp;lt;/property&amp;gt;&lt;br/&gt;
&amp;lt;property name=&quot;hibernate.dbcp.poolPreparedStatements&quot;&amp;gt;true&amp;lt;/property&amp;gt;&lt;br/&gt;
    &amp;lt;/session-factory&amp;gt;&lt;br/&gt;
&amp;lt;/hibernate-configuration&amp;gt;&lt;br/&gt;
*******************&lt;b&gt;CODE&lt;/b&gt;*************&lt;/p&gt;

&lt;p&gt;private synchronized HashMap&amp;lt;Integer, LeadDeliveryPreferences&amp;gt; queryForPreferences() throws SQLException{&lt;/p&gt;

&lt;p&gt;// we open a session because this quartz group seems to have an&lt;br/&gt;
// issue retrieving the session on the first job execution&lt;br/&gt;
Session hibSession = HibernateUtil.getSessionFactory().openSession();&lt;br/&gt;
hibSession.beginTransaction();&lt;br/&gt;
Connection conn = hibSession.connection();&lt;br/&gt;
HashMap&amp;lt;Integer, LeadDeliveryPreferences&amp;gt; allMap =&lt;br/&gt;
new HashMap&amp;lt;Integer, LeadDeliveryPreferences&amp;gt;();&lt;br/&gt;
try{&lt;br/&gt;
PreparedStatement stmt = conn.prepareStatement(QUERY_ALL_PREF);&lt;br/&gt;
ResultSet rs = stmt.executeQuery();&lt;/p&gt;

&lt;p&gt;//Query for lead delivery preferences&lt;br/&gt;
while(rs.next()){&lt;br/&gt;
LeadDeliveryPreferences lp = new LeadDeliveryPreferences();&lt;br/&gt;
lp.setCampaignID(rs.getInt(LeadDeliveryPreferences.DB_CAMPAIGN_ID));&lt;br/&gt;
lp.setCronSchedule(rs.getString(LeadDeliveryPreferences.DB_CRON_SCHEDULE));&lt;br/&gt;
lp.setEmail(rs.getString(LeadDeliveryPreferences.DB_EMAIL));&lt;br/&gt;
lp.setDeliveryEnabled(rs.getBoolean(LeadDeliveryPreferences.DB_DELIVERY_ENABLED));&lt;br/&gt;
lp.setDeliveryTransformer(rs.getString(LeadDeliveryPreferences.DB_DELIVERY_TRANSFORMER));&lt;br/&gt;
lp.setReportEnabled(rs.getBoolean(LeadDeliveryPreferences.DB_REPORT_ENABLED));&lt;br/&gt;
lp.setReportType(rs.getString(LeadDeliveryPreferences.DB_REPORT_TYPE));&lt;br/&gt;
lp.setSource(rs.getString(LeadDeliveryPreferences.DB_SOURCE));&lt;br/&gt;
allMap.put(rs.getInt(LeadDeliveryPreferences.DB_CAMPAIGN_ID), lp);&lt;br/&gt;
log_.debug(&quot;Picked up schedule for campaign: &quot; + rs.getInt(LeadDeliveryPreferences.DB_CAMPAIGN_ID));&lt;br/&gt;
}&lt;br/&gt;
//prepare statement object for re-use&lt;br/&gt;
//stmt.clearParameters();&lt;/p&gt;

&lt;p&gt;//Query for crosswalk values&lt;br/&gt;
Iterator it = allMap.keySet().iterator();&lt;br/&gt;
ArrayList&amp;lt;Integer&amp;gt; idList = new ArrayList&amp;lt;Integer&amp;gt;();&lt;br/&gt;
while(it.hasNext()){&lt;br/&gt;
idList.add((Integer)it.next());&lt;br/&gt;
}&lt;br/&gt;
PreparedStatement stmt2 = conn.prepareStatement(QUERY_TRANSLATIONS);&lt;br/&gt;
for(int i=0;i&amp;lt;idList.size();i++){&lt;br/&gt;
log_.debug(&quot;Getting crosswalk for --&amp;gt; &quot; + idList.get&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/information.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;);&lt;br/&gt;
stmt2.setInt(1,idList.get&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/information.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;);&lt;br/&gt;
ResultSet rs2 = stmt2.executeQuery();&lt;br/&gt;
LeadDeliveryPreferences lp = allMap.get(idList.get&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/information.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;);&lt;/p&gt;

&lt;p&gt;while(rs2.next()){&lt;br/&gt;
LeadCrosswalk lc = new LeadCrosswalk();&lt;br/&gt;
log_.debug(&quot;got key --&amp;gt; &quot; + rs2.getString(LeadCrosswalk.DB_NAME_COL_NM));&lt;br/&gt;
lc.setName(rs2.getString(LeadCrosswalk.DB_NAME_COL_NM));&lt;br/&gt;
lc.setIsMethod(rs2.getBoolean(LeadCrosswalk.DB_IS_METHOD_COL_NM));&lt;br/&gt;
lc.setNameTranslation(rs2.getString(LeadCrosswalk.DB_NAME_TRANSLATION_COL_NM));&lt;br/&gt;
lc.setIsRequired(rs2.getBoolean(LeadCrosswalk.DB_IS_REQUIRED_COL_NM));&lt;br/&gt;
lp.addCrosswalk(lc.getName(), lc);&lt;br/&gt;
}&lt;br/&gt;
// prepare statement object for re-use&lt;br/&gt;
stmt2.clearParameters();&lt;br/&gt;
allMap.remove(idList.get&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/information.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;);&lt;br/&gt;
allMap.put(idList.get&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/information.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;, lp);&lt;br/&gt;
}&lt;/p&gt;

&lt;p&gt;//Query for phone ranges&lt;br/&gt;
PreparedStatement stmt3 = conn.prepareStatement(QUERY_PHONE_RANGES);&lt;br/&gt;
for(int i=0;i&amp;lt;idList.size();i++){&lt;br/&gt;
stmt3.setInt(1, idList.get&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/information.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;);&lt;br/&gt;
rs = stmt3.executeQuery();&lt;br/&gt;
LeadDeliveryPreferences lp = allMap.get(idList.get&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/information.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;);&lt;br/&gt;
while(rs.next())&lt;/p&gt;
{
LeadDeliveryClientPhoneRanges phoneRange = new LeadDeliveryClientPhoneRanges();
phoneRange.setLow(rs.getInt(LeadDeliveryClientPhoneRanges.DB_LOW));
phoneRange.setHigh(rs.getInt(LeadDeliveryClientPhoneRanges.DB_HIGH));
phoneRange.setLabel(rs.getString(LeadDeliveryClientPhoneRanges.DB_LABEL));
log_.debug(&quot;Added phone range &quot; + phoneRange.getLabel());
lp.addPhoneRange(phoneRange);
}
allMap.remove(idList.get(i));
allMap.put(idList.get(i), lp);

}
&lt;p&gt;hibSession.getTransaction().commit();&lt;br/&gt;
}&lt;br/&gt;
catch(SQLException se){&lt;br/&gt;
hibSession.getTransaction().rollback();&lt;br/&gt;
log_.error(&quot;SQLException occured querying for crosswalk&quot;, se);&lt;br/&gt;
RuntimeErrorEmailHelper.addMessage(&quot;Error creating cron trigger&quot;);&lt;br/&gt;
throw se;&lt;br/&gt;
}&lt;br/&gt;
return allMap;&lt;br/&gt;
}&lt;/p&gt;

&lt;p&gt;***************&lt;b&gt;STACK&lt;/b&gt;*****************&lt;br/&gt;
2006-11-15 13:56:02,892 &lt;span class=&quot;error&quot;&gt;&amp;#91;DefaultQuartzScheduler_Worker-8&amp;#93;&lt;/span&gt; DEBUG leads.delivery.LeadDeliveryPreferencesService - Getting crosswalk for --&amp;gt; 200&lt;br/&gt;
2006-11-15 13:56:02,899 &lt;span class=&quot;error&quot;&gt;&amp;#91;DefaultQuartzScheduler_Worker-8&amp;#93;&lt;/span&gt; DEBUG hibernate.transaction.JDBCTransaction - rollback&lt;br/&gt;
2006-11-15 13:56:02,912 &lt;span class=&quot;error&quot;&gt;&amp;#91;DefaultQuartzScheduler_Worker-8&amp;#93;&lt;/span&gt; DEBUG hibernate.transaction.JDBCTransaction - rolled back JDBC Connection&lt;br/&gt;
2006-11-15 13:56:02,912 &lt;span class=&quot;error&quot;&gt;&amp;#91;DefaultQuartzScheduler_Worker-8&amp;#93;&lt;/span&gt; DEBUG hibernate.jdbc.JDBCContext - after transaction completion&lt;br/&gt;
2006-11-15 13:56:02,912 &lt;span class=&quot;error&quot;&gt;&amp;#91;DefaultQuartzScheduler_Worker-8&amp;#93;&lt;/span&gt; DEBUG hibernate.jdbc.ConnectionManager - aggressively releasing JDBC connection&lt;br/&gt;
2006-11-15 13:56:02,912 &lt;span class=&quot;error&quot;&gt;&amp;#91;DefaultQuartzScheduler_Worker-8&amp;#93;&lt;/span&gt; DEBUG hibernate.jdbc.ConnectionManager - releasing JDBC connection [ (open PreparedStatements: 0, globally: 1) (open ResultSets: 0, globally: 0)]&lt;br/&gt;
2006-11-15 13:56:02,913 &lt;span class=&quot;error&quot;&gt;&amp;#91;DefaultQuartzScheduler_Worker-8&amp;#93;&lt;/span&gt; INFO hibernate.connection.DBCPConnectionProvider - active: 3 (max: 3) idle: 0(max: 3)&lt;br/&gt;
2006-11-15 13:56:02,913 &lt;span class=&quot;error&quot;&gt;&amp;#91;DefaultQuartzScheduler_Worker-8&amp;#93;&lt;/span&gt; DEBUG hibernate.impl.SessionImpl - after transaction completion&lt;br/&gt;
2006-11-15 13:56:02,915 &lt;span class=&quot;error&quot;&gt;&amp;#91;DefaultQuartzScheduler_Worker-8&amp;#93;&lt;/span&gt; ERROR leads.delivery.LeadDeliveryPreferencesService - SQLException occured querying for crosswalk&lt;br/&gt;
2006-11-15 13:56:02,920 &lt;span class=&quot;error&quot;&gt;&amp;#91;DefaultQuartzScheduler_Worker-8&amp;#93;&lt;/span&gt; INFO quartz.core.JobRunShell - Job LEAD_PREFERENCES.PREFERENCES_UPDATE_JOB threw a JobExecutionException:&lt;/p&gt;

&lt;p&gt;org.quartz.JobExecutionException: org.postgresql.util.PSQLException: This statement has been closed. [See nested exception: org.postgresql.util.PSQLExcepti&lt;br/&gt;
on: This statement has been closed.]&lt;br/&gt;
        at com.tippit.service.leads.delivery.LeadDeliveryPreferencesService.execute(LeadDeliveryPreferencesService.java:185)&lt;br/&gt;
        at org.quartz.core.JobRunShell.run(JobRunShell.java:195)&lt;br/&gt;
        at org.quartz.simpl.SimpleThreadPool$WorkerThread.run(SimpleThreadPool.java:520)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Nested Exception (Underlying Cause) ---------------&lt;br/&gt;
org.postgresql.util.PSQLException: This statement has been closed.&lt;br/&gt;
        at org.postgresql.jdbc2.AbstractJdbc2Statement.checkClosed(AbstractJdbc2Statement.java:2308)&lt;br/&gt;
        at org.postgresql.jdbc2.AbstractJdbc2Statement.setInt(AbstractJdbc2Statement.java:1070)&lt;br/&gt;
        at org.apache.commons.dbcp.DelegatingPreparedStatement.setInt(DelegatingPreparedStatement.java:116)&lt;br/&gt;
        at org.apache.commons.dbcp.DelegatingPreparedStatement.setInt(DelegatingPreparedStatement.java:116)&lt;br/&gt;
        at com.tippit.service.leads.delivery.LeadDeliveryPreferencesService.queryForPreferences(LeadDeliveryPreferencesService.java:116)&lt;br/&gt;
        at com.tippit.service.leads.delivery.LeadDeliveryPreferencesService.load(LeadDeliveryPreferencesService.java:61)&lt;br/&gt;
        at com.tippit.service.leads.delivery.LeadDeliveryPreferencesService.execute(LeadDeliveryPreferencesService.java:181)&lt;br/&gt;
        at org.quartz.core.JobRunShell.run(JobRunShell.java:195)&lt;br/&gt;
        at org.quartz.simpl.SimpleThreadPool$WorkerThread.run(SimpleThreadPool.java:520) &lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;*********&lt;b&gt;WORKAROUND&lt;/b&gt;*************************&lt;br/&gt;
I think I kind of resolved the symptom although I still feel there are several issues in play here.&lt;/p&gt;

&lt;p&gt;1. No more statement closed exceptions are being thrown. These exceptions were being thrown because:&lt;br/&gt;
   a. Run out of statements\connections in pool (I think that is what is forcing the rollback bc it doesn&apos;t happen when the pool is not starved).&lt;br/&gt;
   b. Using getCurrentSession() instead of openSession() when using a pool of threads (Quartz and Mule threads). Good advice at &lt;a href=&quot;http://opensource.atlassian.com/projects/hibernate/browse/HHH-2243&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://opensource.atlassian.com/projects/hibernate/browse/HHH-2243&lt;/a&gt; when using hibernate.current_session_context_class=thread for transaction demarcation with plain JDBC for applications with thread pools.&lt;/p&gt;

&lt;p&gt;2. I tried configuring the whenExhaustedAction for connections and statements, even if I configure 2 to grow the pool for both... these issues still occur when the pool is starved.&lt;/p&gt;

&lt;p&gt;3. Configuring 20 connection threads and 30 statement threads has resolved the issue (1a) although I don&apos;t understand why #2 above does not work. This causes the application to be very volatile especially since you can&apos;t tell the statement was closed until you try to set a parameter (not when you prepare the statement)&lt;/p&gt;</description>
                <environment>&lt;p&gt;Linux, Hibernate, Java 5, DBCP&lt;/p&gt;</environment>
        <key id="12356021">DBCP-201</key>
            <summary>Statement closing due to unprovoked rollback</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="treefield">Theresa Field</reporter>
                        <labels>
                    </labels>
                <created>Fri, 17 Nov 2006 18:27:39 +0000</created>
                <updated>Thu, 2 May 2013 02:29:11 +0000</updated>
                            <resolved>Sat, 8 Mar 2008 23:44:48 +0000</resolved>
                                    <version>1.2.1</version>
                                    <fixVersion>1.3</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12466362" author="psteitz" created="Sun, 21 Jan 2007 21:56:11 +0000"  >&lt;p&gt;What versions of DBCP and Pool are you running?&lt;/p&gt;</comment>
                            <comment id="12525745" author="bayard" created="Fri, 7 Sep 2007 15:30:50 +0000"  >&lt;p&gt;There&apos;s a bit more info on this in the comments at:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://opensource.atlassian.com/projects/hibernate/browse/HHH-2243&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://opensource.atlassian.com/projects/hibernate/browse/HHH-2243&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This issue feels a bit like &lt;a href=&quot;https://issues.apache.org/jira/browse/DBCP-212&quot; title=&quot;PoolingDataSource closes physical connections&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DBCP-212&quot;&gt;&lt;del&gt;DBCP-212&lt;/del&gt;&lt;/a&gt;, though that&apos;s connection so maybe not.&lt;/p&gt;</comment>
                            <comment id="12535074" author="hbmann" created="Tue, 16 Oct 2007 06:35:48 +0000"  >&lt;p&gt;see&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/POOL-106&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/POOL-106&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="12535076" author="hbmann" created="Tue, 16 Oct 2007 06:37:25 +0000"  >&lt;p&gt;the wrong element is destroyed. In this case the statement will be closed&lt;/p&gt;</comment>
                            <comment id="12549763" author="psteitz" created="Sat, 8 Dec 2007 23:33:44 +0000"  >&lt;p&gt;Should be resolved on release of pool 1.4.   Originally reported as &lt;a href=&quot;https://issues.apache.org/jira/browse/POOL-85&quot; title=&quot;GenericKeyedObjectPool.getNumIdle() corrupted under high load&quot; class=&quot;issue-link&quot; data-issue-key=&quot;POOL-85&quot;&gt;&lt;del&gt;POOL-85&lt;/del&gt;&lt;/a&gt;, the problem in &lt;a href=&quot;https://issues.apache.org/jira/browse/POOL-106&quot; title=&quot;Usage of System.currentTimeMillis() as key for a TreeMap&quot; class=&quot;issue-link&quot; data-issue-key=&quot;POOL-106&quot;&gt;&lt;del&gt;POOL-106&lt;/del&gt;&lt;/a&gt; has been fixed in pool trunk svn.&lt;/p&gt;</comment>
                            <comment id="12576660" author="psteitz" created="Sat, 8 Mar 2008 23:44:48 +0000"  >&lt;p&gt;Pool 1.4 has been released.  Please reopen if this issue recurs after upgrading to pool 1.4&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10032">
                    <name>Blocker</name>
                                                                <inwardlinks description="is blocked by">
                                        <issuelink>
            <issuekey id="12380501">POOL-106</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10001">
                    <name>dependent</name>
                                            <outwardlinks description="depends upon">
                                        <issuelink>
            <issuekey id="12380501">POOL-106</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114481</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            17 years, 35 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0ux0v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178491</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-198] PoolingDataSource.PoolGuardConnectionWrapper equals() implementation incorrect</title>
                <link>https://issues.apache.org/jira/browse/DBCP-198</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;The Object.equals( Object ) implementation in PoolingDataSource.PoolGuardConnectionWrapper is broken because it does not attempt to test if the outermost objects are equal.  It should be replaced with something like:&lt;/p&gt;

&lt;p&gt;public boolean equals(Object obj) {&lt;br/&gt;
  if ( obj == this ) return true;&lt;br/&gt;
  if ( obj instanceof PoolGuardConnectionWrapper ) {&lt;br/&gt;
    return delegate.equals( ((PoolGuardConnectionWrapper) obj).delegate );&lt;br/&gt;
  return false;&lt;br/&gt;
}&lt;/p&gt;

&lt;p&gt;The current implementation prevents putting PoolGuardConenctionWrapper objects in Collections and using the standard contains( Object ) or remove( Object ) methods.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12348071">DBCP-198</key>
            <summary>PoolingDataSource.PoolGuardConnectionWrapper equals() implementation incorrect</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="kruland">Kevin Ruland</reporter>
                        <labels>
                    </labels>
                <created>Wed, 16 Aug 2006 15:26:47 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:35 +0000</updated>
                            <resolved>Sat, 9 Sep 2006 20:17:28 +0000</resolved>
                                    <version>1.2.1</version>
                                    <fixVersion>1.2.2</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12433643" author="psteitz" created="Sat, 9 Sep 2006 20:17:28 +0000"  >&lt;p&gt;This bug only manifests when wrapped connections are not DelegatingConnections.  The implementation of equals in DelegatingConnection masks the problem in this subclass.&lt;/p&gt;

&lt;p&gt;Fixed in r441852.&lt;/p&gt;</comment>
                            <comment id="12445464" author="psteitz" created="Sun, 29 Oct 2006 21:49:17 +0000"  >&lt;p&gt;Additional tests and fix to handle the case where accessToUnderlyingConnection is false committed in r469008.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114478</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            19 years, 2 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uw9j:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178368</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-197] Incorrect parameter descriptions for maxIdle and minIdle, at http://jakarta.apache.org/commons/dbcp/configuration.html</title>
                <link>https://issues.apache.org/jira/browse/DBCP-197</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;The parameter descriptions for maxIdle and minIdle incorrectly refer to active connections:&lt;/p&gt;

&lt;p&gt;Parameter	Default	Description&lt;br/&gt;
initialSize 	0 	The initial number of connections that are created when the pool is started.&lt;br/&gt;
maxActive 	8 	The maximum number of active connections that can be allocated from this pool at the same time, or negative for no limit.&lt;br/&gt;
maxIdle 	8 	The maximum number of active connections that can remain idle in the pool, without extra ones being released, or zero for no limit.&lt;br/&gt;
minIdle 	0 	The minimum number of active connections that can remain idle in the pool, without extra ones being created, or zero to create none.&lt;/p&gt;

&lt;p&gt;A connection cannot be both active and idle by definition.&lt;/p&gt;

&lt;p&gt;svn diff attached.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12347708">DBCP-197</key>
            <summary>Incorrect parameter descriptions for maxIdle and minIdle, at http://jakarta.apache.org/commons/dbcp/configuration.html</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="heuermh">Michael Heuer</reporter>
                        <labels>
                    </labels>
                <created>Thu, 10 Aug 2006 14:53:50 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:35 +0000</updated>
                            <resolved>Sun, 20 Aug 2006 17:13:24 +0000</resolved>
                                    <version>1.2.1</version>
                                    <fixVersion>1.2.2</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12429277" author="psteitz" created="Sun, 20 Aug 2006 17:13:24 +0000"  >&lt;p&gt;Patch applied.  Thanks!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12338602" name="ASF.LICENSE.NOT.GRANTED--diff.txt" size="787" author="heuermh" created="Thu, 10 Aug 2006 14:53:50 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114477</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            19 years, 12 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uyo7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178758</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-195] Bad performance in PoolableConnectionFactory</title>
                <link>https://issues.apache.org/jira/browse/DBCP-195</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;the activateObject() method in PoolableConnectionFactory has bad performance using the oracle.jdbc.driver.OracleDriver driver.&lt;br/&gt;
conn.setAutoCommit(_defaultAutoCommit); is always called. This issues a sotred procedure in oracle.jdbc.dbacces.DBAccess.setAutoCommit().&lt;br/&gt;
conn.setReadOnly(_defaultReadOnly.booleanValue()); creates a prepared statement and executes it in oracle.jdbc.driver.OracleConnection.setReadOnly()&lt;/p&gt;

&lt;p&gt;I tried to avoid this behavior by doing conditionally, only if the property changed: &lt;br/&gt;
Connection conn = (Connection)obj;&lt;br/&gt;
if ( _defaultAutoCommit != conn.getAutoCommit ( ) )&lt;br/&gt;
{&lt;br/&gt;
	conn.setAutoCommit(_defaultAutoCommit);&lt;br/&gt;
}&lt;br/&gt;
if ( (_defaultTransactionIsolation != -1) &amp;amp;&amp;amp; conn.getTransactionIsolation ( ) != _defaultTransactionIsolation )&lt;br/&gt;
{&lt;br/&gt;
	conn.setTransactionIsolation(_defaultTransactionIsolation);&lt;br/&gt;
}			&lt;br/&gt;
if ( (_defaultReadOnly != null) &amp;amp;&amp;amp; ! _defaultReadOnly.equals (  Boolean.valueOf ( conn.isReadOnly ( ) ) ) )&lt;br/&gt;
{&lt;br/&gt;
	conn.setReadOnly(_defaultReadOnly.booleanValue());&lt;br/&gt;
}&lt;br/&gt;
if ( _defaultCatalog != null &amp;amp;&amp;amp; ! conn.getCatalog ( ).equals ( _defaultCatalog ) )&lt;br/&gt;
{&lt;br/&gt;
	conn.setCatalog(_defaultCatalog);&lt;br/&gt;
}&lt;/p&gt;

&lt;p&gt;When running 30 threads this solution takes 10 millis per getConnection(), while the current version takes 90 millis.&lt;br/&gt;
Do you think this solution can cause any problems?&lt;/p&gt;

&lt;p&gt;Thanks,&lt;br/&gt;
Oded&lt;/p&gt;</description>
                <environment>&lt;p&gt;Windows XP pro, Sun solaris.&lt;br/&gt;
Oracle 10g DB. oracle.jdbc.driver.OracleDriver driver.&lt;/p&gt;</environment>
        <key id="12345496">DBCP-195</key>
            <summary>Bad performance in PoolableConnectionFactory</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="3">Duplicate</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="odedpeer">oded peer</reporter>
                        <labels>
                    </labels>
                <created>Thu, 6 Jul 2006 20:12:17 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:35 +0000</updated>
                            <resolved>Sat, 9 Dec 2006 23:35:01 +0000</resolved>
                                                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="12424297" author="david.illsley" created="Sat, 29 Jul 2006 14:35:20 +0000"  >&lt;p&gt;Moved from WS-Commons &apos;cos it looked out of place. Apologies if this is not the correct destination.&lt;/p&gt;</comment>
                            <comment id="12457150" author="psteitz" created="Sat, 9 Dec 2006 23:35:01 +0000"  >&lt;p&gt;This is a duplicate of &lt;a href=&quot;https://issues.apache.org/jira/browse/DBCP-102&quot; title=&quot;[dbcp] setReadOnly &amp;amp; setAutoCommit called too many times&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DBCP-102&quot;&gt;&lt;del&gt;DBCP-102&lt;/del&gt;&lt;/a&gt;, which has been fixed.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114476</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            18 years, 48 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uzyn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178967</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-194] BasicDataSource.setLogWriter should not do createDataSource</title>
                <link>https://issues.apache.org/jira/browse/DBCP-194</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;The code for setLogWriter is:&lt;/p&gt;

&lt;p&gt;    public void setLogWriter(PrintWriter logWriter) throws SQLException &lt;/p&gt;
{
        createDataSource().setLogWriter(logWriter);
        this.logWriter = logWriter;
    }

&lt;p&gt;This means that before a custom log writer is set a datasource is created. Any logging happening while creating the datasource is directed to stdout / stderr.&lt;/p&gt;

&lt;p&gt;I think the purpose of setting a log writer is to prevent this, at least that is what I am trying to achieve.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12345940">DBCP-194</key>
            <summary>BasicDataSource.setLogWriter should not do createDataSource</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="kdekooter">Kees de Kooter</reporter>
                        <labels>
                    </labels>
                <created>Thu, 13 Jul 2006 21:58:58 +0000</created>
                <updated>Mon, 23 Jul 2007 19:02:28 +0000</updated>
                            <resolved>Mon, 23 Jul 2007 19:02:28 +0000</resolved>
                                    <version>1.2</version>
                                    <fixVersion>1.3</fixVersion>
                                        <due></due>
                            <votes>1</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="12453942" author="kdekooter" created="Tue, 28 Nov 2006 15:04:41 +0000"  >&lt;p&gt;Unfortunately this does not solve my problem. I want to get rid of the text &quot;AbandonedObjectPool is used&quot; that is printed to stdout each time I start the pool.&lt;/p&gt;

&lt;p&gt;The root cause is in AbandonedObjectPool itself, in the constructor:&lt;/p&gt;

&lt;p&gt;        System.out.println(&quot;AbandonedObjectPool is used (&quot; + this + &quot;)&quot;);&lt;br/&gt;
        System.out.println(&quot;   LogAbandoned: &quot; + config.getLogAbandoned());&lt;br/&gt;
        System.out.println(&quot;   RemoveAbandoned: &quot; + config.getRemoveAbandoned());&lt;br/&gt;
        System.out.println(&quot;   RemoveAbandonedTimeout: &quot; + config.getRemoveAbandonedTimeout());&lt;/p&gt;

&lt;p&gt;This should at least be written to a configurable (Print)Writer. And preferably to a configurable logger of course.&lt;/p&gt;</comment>
                            <comment id="12453946" author="kdekooter" created="Tue, 28 Nov 2006 15:10:43 +0000"  >&lt;p&gt;System.out is also used in AbandonedTrace&lt;/p&gt;</comment>
                            <comment id="12453949" author="kdekooter" created="Tue, 28 Nov 2006 15:14:31 +0000"  >&lt;p&gt;Patched AbandonedObjectPool&lt;/p&gt;</comment>
                            <comment id="12457151" author="psteitz" created="Sat, 9 Dec 2006 23:36:06 +0000"  >&lt;p&gt;This will be part of the logging cleanup in 1.3&lt;/p&gt;</comment>
                            <comment id="12514732" author="dain" created="Mon, 23 Jul 2007 19:02:28 +0000"  >&lt;p&gt;Fixed some time ago.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12345934" name="AbandonedObjectPool.patch" size="679" author="kdekooter" created="Tue, 28 Nov 2006 15:14:31 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114475</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            18 years, 16 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uvmn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178265</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-193] BasicDataSource returns negative values for NumActive when Oracle Driver Connection#isClosed return true (End of file communication on CHannel)</title>
                <link>https://issues.apache.org/jira/browse/DBCP-193</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;Hello,&lt;br/&gt;
This bug occurs if the following conditions are met:&lt;br/&gt;
A End of File communication on CHannel occurs &lt;br/&gt;
Oracle Driver 10G will return true for Connection#isClosed()&lt;/p&gt;

&lt;p&gt;Related bugs:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/DBCP-3&quot; title=&quot;[dbcp] PoolableConnection.close() won&amp;#39;t allow multiple close&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DBCP-3&quot;&gt;&lt;del&gt;DBCP-3&lt;/del&gt;&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/DBCP-28&quot; title=&quot;[dbcp][PATCH] Connection leak in PoolableConnection.close() (Oracle 10g driver)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DBCP-28&quot;&gt;&lt;del&gt;DBCP-28&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Case 1:&lt;br/&gt;
The client calls isClosed() before closing a connection since commons-dbcp does not allow double close without throwing (see &lt;a href=&quot;https://issues.apache.org/jira/browse/DBCP-3&quot; title=&quot;[dbcp] PoolableConnection.close() won&amp;#39;t allow multiple close&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DBCP-3&quot;&gt;&lt;del&gt;DBCP-3&lt;/del&gt;&lt;/a&gt;)&lt;br/&gt;
=&amp;gt; The problem is that since he calls isClosed, he encounters the same bug reported in &lt;a href=&quot;https://issues.apache.org/jira/browse/DBCP-28&quot; title=&quot;[dbcp][PATCH] Connection leak in PoolableConnection.close() (Oracle 10g driver)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DBCP-28&quot;&gt;&lt;del&gt;DBCP-28&lt;/del&gt;&lt;/a&gt; because conn.isClosed() will return true and the client will not call close.&lt;br/&gt;
if (!conn.isClosed())&lt;br/&gt;
{&lt;br/&gt;
try{&lt;br/&gt;
conn.close();&lt;br/&gt;
}catch(Exception e){}&lt;br/&gt;
}&lt;br/&gt;
see what happens if the isClosed() in PoolableConnection returns true : ShowsLeaksIfCheckForIsClosed.java&lt;/p&gt;

&lt;p&gt;Case2:&lt;br/&gt;
The client tries to find a solution, and calls conn.close() without checking isClosed(), but the problem is that the client is in a Persistence fwk and the client may have already called close, so he ends up calling close() twice, see what happens if the isClosed() in PoolableConnection returns true : ShowsBasicDataSourceBadNumActiveIfNoCheckForIsClosedAndDoubleClose.java&lt;/p&gt;</description>
                <environment>&lt;p&gt;Windows / Oracle 10G JDBC driver / Oracle 10G / JDK 1.4.2_08 / Commons-dbcp-1.2.1.jar / COmmons-pool-1.3.jar&lt;/p&gt;</environment>
        <key id="12345888">DBCP-193</key>
            <summary>BasicDataSource returns negative values for NumActive when Oracle Driver Connection#isClosed return true (End of file communication on CHannel)</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="p.mouawad@ubik-ingenierie.com">Philippe Mouawad</reporter>
                        <labels>
                    </labels>
                <created>Thu, 13 Jul 2006 04:29:23 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:35 +0000</updated>
                            <resolved>Sun, 29 Jul 2007 15:39:15 +0000</resolved>
                                    <version>1.2.1</version>
                    <version>1.2.2</version>
                                    <fixVersion>1.3</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12420735" author="p.mouawad@ubik-ingenierie.com" created="Thu, 13 Jul 2006 04:31:01 +0000"  >&lt;p&gt;To work, the call isClosed() in PoolableConnection.java must return true (Case of an End of communication on channel in Oracle):&lt;br/&gt;
public synchronized void close() throws SQLException {&lt;br/&gt;
        boolean isClosed = false;&lt;br/&gt;
        try {&lt;br/&gt;
            isClosed = isClosed();&lt;/p&gt;</comment>
                            <comment id="12455452" author="bayard" created="Mon, 4 Dec 2006 23:27:37 +0000"  >&lt;p&gt;Changing links to just be the keys so we get the nice strikethroughs to show things are fixed.&lt;/p&gt;</comment>
                            <comment id="12455453" author="bayard" created="Mon, 4 Dec 2006 23:27:54 +0000"  >&lt;p&gt;Does &lt;a href=&quot;https://issues.apache.org/jira/browse/DBCP-28&quot; title=&quot;[dbcp][PATCH] Connection leak in PoolableConnection.close() (Oracle 10g driver)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DBCP-28&quot;&gt;&lt;del&gt;DBCP-28&lt;/del&gt;&lt;/a&gt; being fixed invalidate this issue as a problem?&lt;/p&gt;</comment>
                            <comment id="12457147" author="psteitz" created="Sat, 9 Dec 2006 23:20:36 +0000"  >&lt;p&gt;No (Hen), I think this remains a problem and will be fixed when we fix close semantics in 1.3&lt;/p&gt;</comment>
                            <comment id="12466858" author="bayard" created="Tue, 23 Jan 2007 23:43:52 +0000"  >&lt;p&gt;From the description - when &lt;a href=&quot;https://issues.apache.org/jira/browse/DBCP-3&quot; title=&quot;[dbcp] PoolableConnection.close() won&amp;#39;t allow multiple close&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DBCP-3&quot;&gt;&lt;del&gt;DBCP-3&lt;/del&gt;&lt;/a&gt; is resolved, it looks like this issue becomes a non-issue.&lt;/p&gt;</comment>
                            <comment id="12516227" author="psteitz" created="Sun, 29 Jul 2007 15:39:15 +0000"  >&lt;p&gt;Related multiple close bugs are fixed, so this issue should be resolved.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10001">
                    <name>dependent</name>
                                            <outwardlinks description="depends upon">
                                        <issuelink>
            <issuekey id="12340970">DBCP-3</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12336772" name="ShowsBasicDataSourceBadNumActiveIfNoCheckForIsClosedAndDoubleClose.java" size="1555" author="p.mouawad@ubik-ingenierie.com" created="Thu, 13 Jul 2006 04:31:01 +0000"/>
                            <attachment id="12336773" name="ShowsLeaksIfCheckForIsClosed.java" size="1722" author="p.mouawad@ubik-ingenierie.com" created="Thu, 13 Jul 2006 04:31:01 +0000"/>
                            <attachment id="12336774" name="TestUtils.java" size="1505" author="p.mouawad@ubik-ingenierie.com" created="Thu, 13 Jul 2006 04:31:01 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114474</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            18 years, 15 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uv3z:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178181</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-192] Fails to build under JDK 1.6</title>
                <link>https://issues.apache.org/jira/browse/DBCP-192</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;    &lt;span class=&quot;error&quot;&gt;&amp;#91;javac&amp;#93;&lt;/span&gt; Compiling 39 source files to /home/hen/apache/jakarta/commons-proper/dbcp/target/classes&lt;br/&gt;
/home/hen/apache/jakarta/commons-proper/dbcp/src/java/org/apache/commons/dbcp/cpdsadapter/DriverAdapterCPDS.java:85: org.apache.commons.dbcp.cpdsadapter.DriverAdapterCPDS is not abstract and does not override abstract method getQueryObjectGenerator() in javax.sql.CommonDataSource&lt;br/&gt;
public class DriverAdapterCPDS&lt;br/&gt;
       ^&lt;br/&gt;
/home/hen/apache/jakarta/commons-proper/dbcp/src/java/org/apache/commons/dbcp/cpdsadapter/ConnectionImpl.java:40: org.apache.commons.dbcp.cpdsadapter.ConnectionImpl is not abstract and does not override abstract method createStruct(java.lang.String,java.lang.Object[]) in java.sql.Connection&lt;br/&gt;
class ConnectionImpl implements Connection {&lt;br/&gt;
^&lt;br/&gt;
/home/hen/apache/jakarta/commons-proper/dbcp/src/java/org/apache/commons/dbcp/cpdsadapter/PooledConnectionImpl.java:42: org.apache.commons.dbcp.cpdsadapter.PooledConnectionImpl is not abstract and does not override abstract method removeStatementEventListener(javax.sql.StatementEventListener) in javax.sql.PooledConnection&lt;br/&gt;
class PooledConnectionImpl &lt;br/&gt;
^&lt;br/&gt;
/home/hen/apache/jakarta/commons-proper/dbcp/src/java/org/apache/commons/dbcp/DelegatingConnection.java:50: org.apache.commons.dbcp.DelegatingConnection is not abstract and does not override abstract method createStruct(java.lang.String,java.lang.Object[]) in java.sql.Connection&lt;br/&gt;
public class DelegatingConnection extends AbandonedTrace&lt;br/&gt;
       ^&lt;br/&gt;
/home/hen/apache/jakarta/commons-proper/dbcp/src/java/org/apache/commons/dbcp/DelegatingStatement.java:45: org.apache.commons.dbcp.DelegatingStatement is not abstract and does not override abstract method isPoolable() in java.sql.Statement&lt;br/&gt;
public class DelegatingStatement extends AbandonedTrace implements Statement {&lt;br/&gt;
       ^&lt;br/&gt;
/home/hen/apache/jakarta/commons-proper/dbcp/src/java/org/apache/commons/dbcp/DelegatingStatement.java:130: isClosed() in org.apache.commons.dbcp.DelegatingStatement cannot implement isClosed() in java.sql.Statement; attempting to assign weaker access privileges; was public&lt;br/&gt;
    protected boolean isClosed() {&lt;br/&gt;
                      ^&lt;br/&gt;
/home/hen/apache/jakarta/commons-proper/dbcp/src/java/org/apache/commons/dbcp/DelegatingPreparedStatement.java:49: org.apache.commons.dbcp.DelegatingPreparedStatement is not abstract and does not override abstract method setCharacterStream(int,java.io.Reader,long) in java.sql.PreparedStatement&lt;br/&gt;
public class DelegatingPreparedStatement extends DelegatingStatement&lt;br/&gt;
       ^&lt;br/&gt;
/home/hen/apache/jakarta/commons-proper/dbcp/src/java/org/apache/commons/dbcp/PoolablePreparedStatement.java:40: org.apache.commons.dbcp.PoolablePreparedStatement is not abstract and does not override abstract method setCharacterStream(int,java.io.Reader,long) in java.sql.PreparedStatement&lt;br/&gt;
public class PoolablePreparedStatement extends DelegatingPreparedStatement implements PreparedStatement {&lt;br/&gt;
       ^&lt;br/&gt;
/home/hen/apache/jakarta/commons-proper/dbcp/src/java/org/apache/commons/dbcp/cpdsadapter/PoolablePreparedStatementStub.java:33: isClosed() in org.apache.commons.dbcp.DelegatingStatement cannot implement isClosed() in java.sql.Statement; attempting to assign weaker access privileges; was public&lt;br/&gt;
class PoolablePreparedStatementStub extends PoolablePreparedStatement {&lt;br/&gt;
^&lt;br/&gt;
/home/hen/apache/jakarta/commons-proper/dbcp/src/java/org/apache/commons/dbcp/datasources/PerUserPoolDataSource.java:51: org.apache.commons.dbcp.datasources.PerUserPoolDataSource is not abstract and does not override abstract method &amp;lt;T&amp;gt;createQueryObject(java.lang.Class&amp;lt;T&amp;gt;,javax.sql.DataSource) in javax.sql.DataSource&lt;br/&gt;
public class PerUserPoolDataSource&lt;br/&gt;
       ^&lt;br/&gt;
/home/hen/apache/jakarta/commons-proper/dbcp/src/java/org/apache/commons/dbcp/datasources/SharedPoolDataSource.java:45: org.apache.commons.dbcp.datasources.SharedPoolDataSource is not abstract and does not override abstract method &amp;lt;T&amp;gt;createQueryObject(java.lang.Class&amp;lt;T&amp;gt;,javax.sql.DataSource) in javax.sql.DataSource&lt;br/&gt;
public class SharedPoolDataSource&lt;br/&gt;
       ^&lt;br/&gt;
/home/hen/apache/jakarta/commons-proper/dbcp/src/java/org/apache/commons/dbcp/DelegatingCallableStatement.java:52: org.apache.commons.dbcp.DelegatingCallableStatement is not abstract and does not override abstract method setCharacterStream(java.lang.String,java.io.Reader,long) in java.sql.CallableStatement&lt;br/&gt;
public class DelegatingCallableStatement extends DelegatingPreparedStatement&lt;br/&gt;
       ^&lt;br/&gt;
/home/hen/apache/jakarta/commons-proper/dbcp/src/java/org/apache/commons/dbcp/DelegatingResultSet.java:54: org.apache.commons.dbcp.DelegatingResultSet is not abstract and does not override abstract method updateNClob(java.lang.String,java.io.Reader,long) in java.sql.ResultSet&lt;br/&gt;
public class DelegatingResultSet extends AbandonedTrace implements ResultSet {&lt;br/&gt;
       ^&lt;br/&gt;
/home/hen/apache/jakarta/commons-proper/dbcp/src/java/org/apache/commons/dbcp/PoolingDataSource.java:44: org.apache.commons.dbcp.PoolingDataSource is not abstract and does not override abstract method &amp;lt;T&amp;gt;createQueryObject(java.lang.Class&amp;lt;T&amp;gt;,javax.sql.DataSource) in javax.sql.DataSource&lt;br/&gt;
public class PoolingDataSource implements DataSource {&lt;br/&gt;
       ^&lt;br/&gt;
/home/hen/apache/jakarta/commons-proper/dbcp/src/java/org/apache/commons/dbcp/PoolingConnection.java:41: org.apache.commons.dbcp.PoolingConnection is not abstract and does not override abstract method createStruct(java.lang.String,java.lang.Object[]) in java.sql.Connection&lt;br/&gt;
public class PoolingConnection extends DelegatingConnection implements Connection, KeyedPoolableObjectFactory {&lt;br/&gt;
       ^&lt;br/&gt;
/home/hen/apache/jakarta/commons-proper/dbcp/src/java/org/apache/commons/dbcp/BasicDataSource.java:43: org.apache.commons.dbcp.BasicDataSource is not abstract and does not override abstract method &amp;lt;T&amp;gt;createQueryObject(java.lang.Class&amp;lt;T&amp;gt;,javax.sql.DataSource) in javax.sql.DataSource&lt;br/&gt;
public class BasicDataSource implements DataSource {&lt;/p&gt;</description>
                <environment></environment>
        <key id="12345623">DBCP-192</key>
            <summary>Fails to build under JDK 1.6</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="3">Duplicate</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="bayard">Henri Yandell</reporter>
                        <labels>
                    </labels>
                <created>Sun, 9 Jul 2006 00:01:26 +0000</created>
                <updated>Mon, 10 Jul 2006 12:45:51 +0000</updated>
                            <resolved>Mon, 10 Jul 2006 12:45:51 +0000</resolved>
                                                    <fixVersion>1.3</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12419960" author="psteitz" created="Mon, 10 Jul 2006 12:45:51 +0000"  >&lt;p&gt;Duplicates &lt;a href=&quot;https://issues.apache.org/jira/browse/DBCP-191&quot; title=&quot;[dbcp] does not compile under the latest unreleased jdk 1.6 / JDBC 4.0&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DBCP-191&quot;&gt;&lt;del&gt;DBCP-191&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114473</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            19 years, 18 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0v033:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178987</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-190] NPE in SharedPoolDataSource.close() if pool was not created</title>
                <link>https://issues.apache.org/jira/browse/DBCP-190</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;SharedPoolDataSource.close() raises NPE if getConnection() was never called on this data source.&lt;br/&gt;
close() should check if( pool != null ) before calling pool.close()&lt;/p&gt;</description>
                <environment></environment>
        <key id="12344741">DBCP-190</key>
            <summary>NPE in SharedPoolDataSource.close() if pool was not created</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="3">Duplicate</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="masf">Fedor Bokov</reporter>
                        <labels>
                    </labels>
                <created>Thu, 22 Jun 2006 00:47:40 +0000</created>
                <updated>Thu, 22 Jun 2006 01:47:58 +0000</updated>
                            <resolved>Thu, 22 Jun 2006 01:47:58 +0000</resolved>
                                    <version>1.2</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12417157" author="psteitz" created="Thu, 22 Jun 2006 01:47:58 +0000"  >&lt;p&gt;This has been resolved as of 12-march-06 in svn trunk.   This is a duplicate of &lt;a href=&quot;http://issues.apache.org/jira/browse/DBCP-39&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/browse/DBCP-39&lt;/a&gt;.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114472</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            19 years, 21 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uzw7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178956</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-189] [dbcp] Threads do not get a Connection in FIFO mode</title>
                <link>https://issues.apache.org/jira/browse/DBCP-189</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;hi,&lt;br/&gt;
the SharedPoolDataSource class uses the class GenericKeyedObjectPool which has a FIFO behavior.&lt;br/&gt;
the problem is that when all connections in the pool are used, the synchronised method SharedPoolDataSource.getPooledConnectionAndInfo &lt;br/&gt;
calls the borrowObject() blocking method and does not release its monitor.&lt;br/&gt;
as a result, all other threads asking for a connection get blocked trying to get the monitor&lt;br/&gt;
and  will get a connection later in a non-FIFO mode.&lt;br/&gt;
i think the fix is to synchronized only the code block :&lt;br/&gt;
        if (pool == null) {&lt;br/&gt;
            try &lt;/p&gt;
{
                registerPool(username, password);
            }
&lt;p&gt; catch (NamingException e) &lt;/p&gt;
{
                throw new SQLNestedException(&quot;RegisterPool failed&quot;, e);
            }
&lt;p&gt;        }&lt;br/&gt;
instead of synchronizing the whole method.&lt;/p&gt;

&lt;p&gt;thanks&lt;br/&gt;
rodolphe&lt;/p&gt;</description>
                <environment>&lt;p&gt;commons-dbcp-1.2.1.jar&lt;/p&gt;</environment>
        <key id="12343671">DBCP-189</key>
            <summary>[dbcp] Threads do not get a Connection in FIFO mode</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="2">Won&apos;t Fix</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="dossen29">rod</reporter>
                        <labels>
                    </labels>
                <created>Tue, 30 May 2006 20:48:09 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:35 +0000</updated>
                            <resolved>Sat, 9 Dec 2006 23:29:16 +0000</resolved>
                                    <version>1.2.2</version>
                                                        <due></due>
                            <votes>1</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="12414031" author="dossen29" created="Wed, 31 May 2006 18:17:16 +0000"  >&lt;p&gt;however, getUserPassKey should be made synchronized cos the LRUMap is not Thread Safe.&lt;br/&gt;
rodolphe&lt;/p&gt;</comment>
                            <comment id="12416884" author="lacostej" created="Tue, 20 Jun 2006 17:47:33 +0000"  >&lt;p&gt;Patch that implements the requested changes. Only unit tested. Didn&apos;t add a regression test.&lt;/p&gt;</comment>
                            <comment id="12457149" author="psteitz" created="Sat, 9 Dec 2006 23:29:16 +0000"  >&lt;p&gt;The dbcp API makes no commitments regarding preserving invariants of the underlying pool, other than that the exposed parameters work as advertised and the pool API is used to borrow and return objects.  In particular, the FIFO behavior of commons-pool is not guaranteed to be preserved by dbcp.&lt;br/&gt;
If there is more to this ticket than that (i.e., if there is a performance or concurrency problem here as well), please reopen.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12335660" name="DBCP-189.txt" size="1776" author="lacostej" created="Tue, 20 Jun 2006 17:47:33 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114471</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            18 years, 48 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uzjr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178900</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-188] maxActive in configuration.html is documented incorrectly</title>
                <link>https://issues.apache.org/jira/browse/DBCP-188</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;Copied from: &lt;a href=&quot;https://issues.apache.org/jira/browse/POOL-38&quot; title=&quot;Deadlock&quot; class=&quot;issue-link&quot; data-issue-key=&quot;POOL-38&quot;&gt;&lt;del&gt;POOL-38&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;MISTAKE at &lt;a href=&quot;http://jakarta.apache.org/commons/dbcp/configuration.html:&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://jakarta.apache.org/commons/dbcp/configuration.html:&lt;/a&gt;&lt;br/&gt;
maxActive = &quot;The maximum number of active connections that can be allocated from this pool at the same time, or zero for no limit. &quot; - should be -1 instead of &apos;zero for no limit&apos;. However, it does not help if I need to limit number of objects in a pool... &lt;/p&gt;</description>
                <environment></environment>
        <key id="12343301">DBCP-188</key>
            <summary>maxActive in configuration.html is documented incorrectly</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="sandymac">Sandy McArthur Jr</assignee>
                                    <reporter username="sandymac">Sandy McArthur Jr</reporter>
                        <labels>
                    </labels>
                <created>Sat, 20 May 2006 21:53:20 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:35 +0000</updated>
                            <resolved>Sat, 20 May 2006 22:55:01 +0000</resolved>
                                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12412640" author="sandymac" created="Sat, 20 May 2006 22:55:01 +0000"  >&lt;p&gt;Fix committed to svn.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114470</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            19 years, 25 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uz5b:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178835</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-144] [dbcp] Examples links on website are broken; CVS-&gt;SVN ...</title>
                <link>https://issues.apache.org/jira/browse/DBCP-144</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;The links to the examples on the DBCP pages don&apos;t work now that the code is in &lt;br/&gt;
SVN&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: other&lt;br/&gt;
Platform: Other&lt;/p&gt;</environment>
        <key id="12342954">DBCP-144</key>
            <summary>[dbcp] Examples links on website are broken; CVS-&gt;SVN ...</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="sebb">Sebb</reporter>
                        <labels>
                    </labels>
                <created>Tue, 7 Mar 2006 03:58:54 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:34 +0000</updated>
                            <resolved>Tue, 25 Mar 2008 08:11:34 +0000</resolved>
                                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12411555" author="dennisl@apache.org" created="Tue, 7 Mar 2006 06:26:42 +0000"  >&lt;p&gt;Thanks for the report. I have fixed this in SVN. It will be reflected on the&lt;br/&gt;
site the next time it is published.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>38870</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114427</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            19 years, 36 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uw6f:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178354</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-143] [dbcp] SQLNestedException thrown by server causes client ClassNotFoundException.</title>
                <link>https://issues.apache.org/jira/browse/DBCP-143</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;This is a GUI client / application server / database server application.&lt;/p&gt;

&lt;p&gt;On the GUI client side, we see java.lang.ClassNotFoundException:&lt;br/&gt;
org.apache.commons.dbcp.SQLNestedException.&lt;/p&gt;

&lt;p&gt;This happens when the database server is down, DBCP cannot connect to the&lt;br/&gt;
database, and throws a org.apache.commons.dbcp.SQLNestedException.&lt;/p&gt;

&lt;p&gt;Our application server code sends the java.sql.SQLException it sees to the&lt;br/&gt;
client via RMI.&lt;/p&gt;

&lt;p&gt;However, on the client, we have not provided commons-dbcp.jar.&lt;/p&gt;

&lt;p&gt;And I don&apos;t think we should - DBCP is server code.&lt;/p&gt;

&lt;p&gt;But, when the client does not have SQLNestedException&apos;s class file, the attempt&lt;br/&gt;
to de-serialize it results in the ClassNotFoundException we&apos;ve been seeing.&lt;/p&gt;

&lt;p&gt;Even old &lt;a href=&quot;http://java.sun.com/j2se/1.3/docs/api/java/sql/SQLException.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://java.sun.com/j2se/1.3/docs/api/java/sql/SQLException.html&lt;/a&gt; has&lt;br/&gt;
the facilities that SQLNestedExcepion offers: It is able to chain another&lt;br/&gt;
SQLException to itself. So while SQLNestedException clearly causes problems, I&lt;br/&gt;
don&apos;t understand what DBCP gains from it.&lt;/p&gt;

&lt;p&gt;What would we loose if it were scratched?&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: other&lt;br/&gt;
Platform: Other&lt;/p&gt;</environment>
        <key id="12342650">DBCP-143</key>
            <summary>[dbcp] SQLNestedException thrown by server causes client ClassNotFoundException.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="andreas.krueger@dv-ratio.com">Andreas Kr&#252;ger</reporter>
                        <labels>
                    </labels>
                <created>Thu, 20 Oct 2005 20:18:34 +0000</created>
                <updated>Tue, 24 Feb 2015 03:23:18 +0000</updated>
                            <resolved>Tue, 23 Jul 2013 23:09:43 +0000</resolved>
                                                    <fixVersion>2.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12480228" author="bayard" created="Mon, 12 Mar 2007 23:52:33 +0000"  >&lt;p&gt;It was there in 1.2 too. &lt;/p&gt;

&lt;p&gt;Looking at the source, the only part of SQLNestedException used is the SQLNestedException(String,Throwable). However sometimes that latter argument is not a SQLException; which would be one reason not to use the setNextException message.&lt;/p&gt;

&lt;p&gt;Another alternative would be to bring the minimum JDK up to 1.4 and switch to standard exception chaining.&lt;/p&gt;</comment>
                            <comment id="12514808" author="dain" created="Mon, 23 Jul 2007 22:54:01 +0000"  >&lt;p&gt;This patch replaces:&lt;/p&gt;

&lt;p&gt;   new SQLNestedException(msg, e);&lt;/p&gt;

&lt;p&gt;with:&lt;/p&gt;

&lt;p&gt;  (SQLException) new SQLException(msg).initCause(e);&lt;/p&gt;
</comment>
                            <comment id="12515035" author="dain" created="Tue, 24 Jul 2007 17:27:45 +0000"  >&lt;p&gt;SQLNestedException has been deprecated in 1.3 and will be removed in 1.4&lt;/p&gt;</comment>
                            <comment id="12682183" author="markt" created="Sun, 15 Mar 2009 22:20:56 +0000"  >&lt;p&gt;Removing the SQLNestedException would be an API breaking change so it would have to wait until a DBCP 2.0 release. To be perfectly honest, I don&apos;t see a 2.0 release on the horizon right now. However, I am not closing this as WONTFIX as it is always possible that there will be a 2.0 release at some point but please be aware that this is some time (possibly years) away.&lt;/p&gt;</comment>
                            <comment id="12682184" author="markt" created="Sun, 15 Mar 2009 22:23:33 +0000"  >&lt;p&gt;Forgot to include this:&lt;/p&gt;

&lt;p&gt;See &lt;a href=&quot;http://markmail.org/thread/qd2mowgifkka2gkd&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://markmail.org/thread/qd2mowgifkka2gkd&lt;/a&gt; for further discussion on this very topic.&lt;/p&gt;</comment>
                            <comment id="13717745" author="markt" created="Tue, 23 Jul 2013 23:09:43 +0000"  >&lt;p&gt;SQLNestedException has been removed in trunk as part of the work towards &lt;a href=&quot;https://issues.apache.org/jira/browse/DBCP-2&quot; title=&quot;referenced UserPassKey instances get erroneously returned to the pool and subsequently reinitialized&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DBCP-2&quot;&gt;&lt;del&gt;DBCP-2&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12441864">DBCP-310</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12362384" name="DBCP-143.patch" size="24332" author="dain" created="Mon, 23 Jul 2007 22:54:01 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>37181</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114426</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 15 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0fu4n:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>90479</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-142] DriverManager.getConnection() throws DbcpException</title>
                <link>https://issues.apache.org/jira/browse/DBCP-142</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;Why DbcpException ? &lt;br/&gt;
getConnection should throw SQLException, when calling DriverManager.getConnection&lt;br/&gt;
I expecting only SQLException when invoking getConnection (or Exception if there&lt;br/&gt;
are some critical bugs in code). &lt;br/&gt;
In some circumstances I can&apos;t handle DbcpException.&lt;/p&gt;

&lt;p&gt;DriverManagerConnectionFactory:&lt;/p&gt;

&lt;p&gt;public Connection createConnection() {&lt;br/&gt;
        try {&lt;br/&gt;
            if(null == _props) {&lt;br/&gt;
                if((_uname == null) || (_passwd == null)) &lt;/p&gt;
{
                    return DriverManager.getConnection(_connectUri);
                }
&lt;p&gt; else &lt;/p&gt;
{
                    return DriverManager.getConnection(_connectUri,_uname,_passwd);
                }
&lt;p&gt;            } else &lt;/p&gt;
{
                return DriverManager.getConnection(_connectUri,_props);
            }
&lt;p&gt;        } catch(SQLException e) &lt;/p&gt;
{
            throw new DbcpException(e); &amp;lt;---------------------- !!!
        }
&lt;p&gt;    }&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: other&lt;br/&gt;
Platform: All&lt;/p&gt;</environment>
        <key id="12340956">DBCP-142</key>
            <summary>DriverManager.getConnection() throws DbcpException</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="rew@simple.com.pl">Remigiusz Weska</reporter>
                        <labels>
                    </labels>
                <created>Wed, 10 Sep 2003 22:05:29 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:34 +0000</updated>
                            <resolved>Tue, 25 Mar 2008 08:11:34 +0000</resolved>
                                    <version>1.0</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12405032" author="dirkv" created="Sun, 14 Sep 2003 05:51:38 +0000"  >&lt;p&gt;Already fixed in nightly builds.&lt;/p&gt;

&lt;p&gt;Committed on 2003/08/11 14:49:33&lt;br/&gt;
&lt;a href=&quot;http://cvs.apache.org/viewcvs.cgi/jakarta-commons/dbcp/src/java/org/apache/commons/dbcp/DriverManagerConnectionFactory.java.diff?r1=1.3&amp;amp;r2=1.4&amp;amp;diff_format=h&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://cvs.apache.org/viewcvs.cgi/jakarta-commons/dbcp/src/java/org/apache/commons/dbcp/DriverManagerConnectionFactory.java.diff?r1=1.3&amp;amp;r2=1.4&amp;amp;diff_format=h&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>23066</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114425</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            22 years, 9 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uw47:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178344</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-141] PerUserPoolDataSource.getConnection(username, pw) may return connection under wrong username</title>
                <link>https://issues.apache.org/jira/browse/DBCP-141</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;There appears to be a problem with PerUserPoolDataSource. For all usernames not&lt;br/&gt;
set with &quot;setPerUserMaxActive&quot;, the first &quot;getConnection(String, String)&lt;br/&gt;
sets the username under which all subsequent connections are created.&lt;/p&gt;

&lt;p&gt;For example, in the fragment below connections are gotten under the usernames&lt;/p&gt;
{&quot;mkh&quot;, &quot;hanafey&quot;, &quot;jsmith&quot;}, but only &quot;jsmith&quot; has an associated&lt;br/&gt;
&quot;setPerUserMaxActive&quot;. The first two connections are BOTH created under&lt;br/&gt;
username &quot;mkh&quot;. (The &quot;getUsername&quot; method below just runs a query that selects&lt;br/&gt;
the username, which in Sybase is just &quot;select username=suser_name()&quot;)&lt;br/&gt;
&lt;br/&gt;
This is the output:&lt;br/&gt;
&lt;br/&gt;
Tried:mkh got:mkh&lt;br/&gt;
Tried:hanafey got:mkh&lt;br/&gt;
Tried:jsmith got:jsmith&lt;br/&gt;
&lt;br/&gt;
If &quot;mkh&quot; and &quot;jsmith&quot; are permuted, the output is:&lt;br/&gt;
&lt;br/&gt;
Tried:jsmith got:jsmith&lt;br/&gt;
Tried:hanafey got:hanafey&lt;br/&gt;
Tried:mkh got:hanafey&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
This is the code fragment:&lt;br/&gt;
&lt;br/&gt;
        PerUserPoolDataSource puds = new PerUserPoolDataSource();&lt;br/&gt;
        puds.setConnectionPoolDataSource(ds);&lt;br/&gt;
        puds.setPerUserMaxActive(&quot;jsmith&quot;, new Integer(2));&lt;br/&gt;
        try {&lt;br/&gt;
            String[] users = {&quot;mkh&quot;, &quot;hanafey&quot;, &quot;jsmith&quot;}
&lt;p&gt;;&lt;br/&gt;
            String pw = &quot;...&quot;;&lt;br/&gt;
            Connection[] c = new Connection&lt;span class=&quot;error&quot;&gt;&amp;#91;users.length&amp;#93;&lt;/span&gt;;&lt;br/&gt;
            for (int i = 0; i &amp;lt; users.length; i++) &lt;/p&gt;
{
                c[i] = puds.getConnection(users[i], pw);
            }&lt;br/&gt;
            for (int i = 0; i &amp;lt; users.length; i++) {
                System.out.println(&quot;Tried:&quot;+users[i]+&quot; got:&quot;+getUsername(c[i]));
            }&lt;br/&gt;
        &lt;br/&gt;
Given this code from PerUserPoolDataSource, the &quot;if&quot; statement explains the&lt;br/&gt;
behaviour, given that data source name and username determine the subpool:&lt;br/&gt;
&lt;br/&gt;
    private PoolKey getPoolKey(String username) {&lt;br/&gt;
        PoolKey key = null;&lt;br/&gt;
&lt;br/&gt;
        if (username != null &amp;amp;&amp;amp; (perUserMaxActive == null &lt;br/&gt;
                || !perUserMaxActive.containsKey(username))) {
            username = null;
        }&lt;br/&gt;
&lt;br/&gt;
It appears that this &quot;if&quot; should just be removed.&lt;br/&gt;
&lt;br/&gt;
There appears to be a problem with PerUserPoolDataSource. For all usernames not&lt;br/&gt;
set with &quot;setPerUserMaxActive&quot;, the first &quot;getConnection(String, String)&lt;br/&gt;
sets the username under which all subsequent connections are created.&lt;br/&gt;
&lt;br/&gt;
For example, in the fragment below connections are gotten under the usernames
{&quot;mkh&quot;, &quot;hanafey&quot;, &quot;jsmith&quot;}, but only &quot;jsmith&quot; has an associated&lt;br/&gt;
&quot;setPerUserMaxActive&quot;. The first two connections are BOTH created under&lt;br/&gt;
username &quot;mkh&quot;. (The &quot;getUsername&quot; method below just runs a query that selects&lt;br/&gt;
the username, which in Sybase is just &quot;select username=suser_name()&quot;)&lt;br/&gt;
&lt;br/&gt;
This is the output:&lt;br/&gt;
&lt;br/&gt;
Tried:mkh got:mkh&lt;br/&gt;
Tried:hanafey got:mkh&lt;br/&gt;
Tried:jsmith got:jsmith&lt;br/&gt;
&lt;br/&gt;
If &quot;mkh&quot; and &quot;jsmith&quot; are permuted, the output is:&lt;br/&gt;
&lt;br/&gt;
Tried:jsmith got:jsmith&lt;br/&gt;
Tried:hanafey got:hanafey&lt;br/&gt;
Tried:mkh got:hanafey&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
This is the code fragment:&lt;br/&gt;
&lt;br/&gt;
        PerUserPoolDataSource puds = new PerUserPoolDataSource();&lt;br/&gt;
        puds.setConnectionPoolDataSource(ds);&lt;br/&gt;
        puds.setPerUserMaxActive(&quot;jsmith&quot;, new Integer(2));&lt;br/&gt;
        try {&lt;br/&gt;
            String[] users = {&quot;mkh&quot;, &quot;hanafey&quot;, &quot;jsmith&quot;};&lt;br/&gt;
            String pw = &quot;...&quot;;&lt;br/&gt;
            Connection[] c = new Connection&lt;span class=&quot;error&quot;&gt;&amp;#91;users.length&amp;#93;&lt;/span&gt;;&lt;br/&gt;
            for (int i = 0; i &amp;lt; users.length; i++) {                c[i] = puds.getConnection(users[i], pw);            }
&lt;p&gt;            for (int i = 0; i &amp;lt; users.length; i++) &lt;/p&gt;
{
                System.out.println(&quot;Tried:&quot;+users[i]+&quot; got:&quot;+getUsername(c[i]));
            }

&lt;p&gt;Given this code from PerUserPoolDataSource, the &quot;if&quot; statement explains the&lt;br/&gt;
behaviour, given that data source name and username determine the subpool:&lt;/p&gt;

&lt;p&gt;    private PoolKey getPoolKey(String username) {&lt;br/&gt;
        PoolKey key = null;&lt;/p&gt;

&lt;p&gt;        if (username != null &amp;amp;&amp;amp; (perUserMaxActive == null &lt;/p&gt;
&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; !perUserMaxActive.containsKey(username))) 
{
            username = null;
        }&lt;br/&gt;
&lt;br/&gt;
It appears that this &quot;if&quot; should just be removed.&lt;br/&gt;
&lt;br/&gt;
There appears to be a problem with PerUserPoolDataSource. For all usernames not&lt;br/&gt;
set with &quot;setPerUserMaxActive&quot;, the first &quot;getConnection(String, String)&lt;br/&gt;
sets the username under which all subsequent connections are created.&lt;br/&gt;
&lt;br/&gt;
For example, in the fragment below connections are gotten under the usernames
{&quot;mkh&quot;, &quot;hanafey&quot;, &quot;jsmith&quot;}, but only &quot;jsmith&quot; has an associated&lt;br/&gt;
&quot;setPerUserMaxActive&quot;. The first two connections are BOTH created under&lt;br/&gt;
username &quot;mkh&quot;. (The &quot;getUsername&quot; method below just runs a query that selects&lt;br/&gt;
the username, which in Sybase is just &quot;select username=suser_name()&quot;)&lt;br/&gt;
&lt;br/&gt;
This is the output:&lt;br/&gt;
&lt;br/&gt;
Tried:mkh got:mkh&lt;br/&gt;
Tried:hanafey got:mkh&lt;br/&gt;
Tried:jsmith got:jsmith&lt;br/&gt;
&lt;br/&gt;
If &quot;mkh&quot; and &quot;jsmith&quot; are permuted, the output is:&lt;br/&gt;
&lt;br/&gt;
Tried:jsmith got:jsmith&lt;br/&gt;
Tried:hanafey got:hanafey&lt;br/&gt;
Tried:mkh got:hanafey&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
This is the code fragment:&lt;br/&gt;
&lt;br/&gt;
        PerUserPoolDataSource puds = new PerUserPoolDataSource();&lt;br/&gt;
        puds.setConnectionPoolDataSource(ds);&lt;br/&gt;
        puds.setPerUserMaxActive(&quot;jsmith&quot;, new Integer(2));&lt;br/&gt;
        try {&lt;br/&gt;
            String[] users = {&quot;mkh&quot;, &quot;hanafey&quot;, &quot;jsmith&quot;};&lt;br/&gt;
            String pw = &quot;...&quot;;&lt;br/&gt;
            Connection[] c = new Connection&lt;span class=&quot;error&quot;&gt;&amp;#91;users.length&amp;#93;&lt;/span&gt;;&lt;br/&gt;
            for (int i = 0; i &amp;lt; users.length; i++) {
                c[i] = puds.getConnection(users[i], pw);
            }&lt;br/&gt;
            for (int i = 0; i &amp;lt; users.length; i++) {
                System.out.println(&quot;Tried:&quot;+users[i]+&quot; got:&quot;+getUsername(c[i]));
            }&lt;br/&gt;
        &lt;br/&gt;
Given this code from PerUserPoolDataSource, the &quot;if&quot; statement explains the&lt;br/&gt;
behaviour, given that data source name and username determine the subpool:&lt;br/&gt;
&lt;br/&gt;
    private PoolKey getPoolKey(String username) {&lt;br/&gt;
        PoolKey key = null;&lt;br/&gt;
&lt;br/&gt;
        if (username != null &amp;amp;&amp;amp; (perUserMaxActive == null &lt;br/&gt;
                || !perUserMaxActive.containsKey(username))) {            username = null;        }&lt;/th&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;


&lt;p&gt;It appears that this &quot;if&quot; should just be removed.&lt;/p&gt;


&lt;p&gt;There also appears to be need to set pool property defaults for the &lt;br/&gt;
connection under the default name. Currently the defaults for a named user&lt;br/&gt;
and the default user are the same. It seems that it will almost always be&lt;br/&gt;
true that the pool for &quot;getConnection()&quot; will be need to be larger than the&lt;br/&gt;
pool for &quot;getConnection(username, pw)&quot;, but if there is a large set of possible&lt;br/&gt;
&quot;username&quot;s it is not practical to configure each username explicitly.&lt;/p&gt;

&lt;p&gt;Currently calls like &quot;setPerUserMaxActive(null, Integer(16))&quot; would set the&lt;br/&gt;
property for the default connection, but this behaviour is not documented.&lt;br/&gt;
Maybe methods like &quot;setPerUserMaxActive(Interger(16))&quot; should be added.&lt;br/&gt;
There appears to be a problem with PerUserPoolDataSource. For all usernames not&lt;br/&gt;
set with &quot;setPerUserMaxActive&quot;, the first &quot;getConnection(String, String)&lt;br/&gt;
sets the username under which all subsequent connections are created.&lt;/p&gt;

&lt;p&gt;For example, in the fragment below connections are gotten under the usernames&lt;/p&gt;
{&quot;mkh&quot;, &quot;hanafey&quot;, &quot;jsmith&quot;}, but only &quot;jsmith&quot; has an associated&lt;br/&gt;
&quot;setPerUserMaxActive&quot;. The first two connections are BOTH created under&lt;br/&gt;
username &quot;mkh&quot;. (The &quot;getUsername&quot; method below just runs a query that selects&lt;br/&gt;
the username, which in Sybase is just &quot;select username=suser_name()&quot;)&lt;br/&gt;
&lt;br/&gt;
This is the output:&lt;br/&gt;
&lt;br/&gt;
Tried:mkh got:mkh&lt;br/&gt;
Tried:hanafey got:mkh&lt;br/&gt;
Tried:jsmith got:jsmith&lt;br/&gt;
&lt;br/&gt;
If &quot;mkh&quot; and &quot;jsmith&quot; are permuted, the output is:&lt;br/&gt;
&lt;br/&gt;
Tried:jsmith got:jsmith&lt;br/&gt;
Tried:hanafey got:hanafey&lt;br/&gt;
Tried:mkh got:hanafey&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
This is the code fragment:&lt;br/&gt;
&lt;br/&gt;
        PerUserPoolDataSource puds = new PerUserPoolDataSource();&lt;br/&gt;
        puds.setConnectionPoolDataSource(ds);&lt;br/&gt;
        puds.setPerUserMaxActive(&quot;jsmith&quot;, new Integer(2));&lt;br/&gt;
        try {&lt;br/&gt;
            String[] users = {&quot;mkh&quot;, &quot;hanafey&quot;, &quot;jsmith&quot;}
&lt;p&gt;;&lt;br/&gt;
            String pw = &quot;...&quot;;&lt;br/&gt;
            Connection[] c = new Connection&lt;span class=&quot;error&quot;&gt;&amp;#91;users.length&amp;#93;&lt;/span&gt;;&lt;br/&gt;
            for (int i = 0; i &amp;lt; users.length; i++) &lt;/p&gt;
{
                c[i] = puds.getConnection(users[i], pw);
            }
&lt;p&gt;            for (int i = 0; i &amp;lt; users.length; i++) &lt;/p&gt;
{
                System.out.println(&quot;Tried:&quot;+users[i]+&quot; got:&quot;+getUsername(c[i]));
            }

&lt;p&gt;Given this code from PerUserPoolDataSource, the &quot;if&quot; statement explains the&lt;br/&gt;
behaviour, given that data source name and username determine the subpool:&lt;/p&gt;

&lt;p&gt;    private PoolKey getPoolKey(String username) {&lt;br/&gt;
        PoolKey key = null;&lt;/p&gt;

&lt;p&gt;        if (username != null &amp;amp;&amp;amp; (perUserMaxActive == null &lt;/p&gt;
&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; !perUserMaxActive.containsKey(username))) 
{
            username = null;
        }&lt;/th&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;


&lt;p&gt;It appears that this &quot;if&quot; should just be removed.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: All&lt;br/&gt;
Platform: All&lt;/p&gt;</environment>
        <key id="12341035">DBCP-141</key>
            <summary>PerUserPoolDataSource.getConnection(username, pw) may return connection under wrong username</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="hanafey@dna.es.dupont.com">Mike Hanafey</reporter>
                        <labels>
                    </labels>
                <created>Wed, 15 Oct 2003 22:46:15 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:34 +0000</updated>
                            <resolved>Tue, 25 Mar 2008 08:11:34 +0000</resolved>
                                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12405297" author="jmcnally" created="Mon, 20 Oct 2003 07:50:31 +0000"  >&lt;p&gt;The code from the above comment:&lt;/p&gt;

&lt;p&gt;    private PoolKey getPoolKey(String username) {&lt;br/&gt;
        PoolKey key = null;&lt;/p&gt;

&lt;p&gt;        if (username != null &amp;amp;&amp;amp; (perUserMaxActive == null &lt;/p&gt;
&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; !perUserMaxActive.containsKey(username))) 
{
            username = null;
        }&lt;/th&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;


&lt;p&gt;    &quot;It appears that this &quot;if&quot; should just be removed.&quot;&lt;/p&gt;

&lt;p&gt;was a left over from Jdbc2PoolDataSource and should have been removed, so the&lt;br/&gt;
suggestion was followed.&lt;/p&gt;



</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>23843</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114424</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            22 years, 4 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uv7j:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178197</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-140] Memory-leak like behaviour in DBCP due to warnings chained to connections in the pool</title>
                <link>https://issues.apache.org/jira/browse/DBCP-140</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;We have recently migrated a web application from using poolman to DBCP. The&lt;br/&gt;
db driver used for this application is the current version of jconnect &lt;br/&gt;
(Sybsase).&lt;/p&gt;

&lt;p&gt;During some long-term tests, we observed a memory-leak like behaviour, caused &lt;br/&gt;
by a growing number of objects on the heap which could not be garbage &lt;br/&gt;
collected. After some investigation we found out that the memory is consumed &lt;br/&gt;
by SQLWarnings, chained to connections in the pool. The SQLWarnings are &lt;br/&gt;
generated when calling setReadOnly() on the underlying Connection (which is &lt;br/&gt;
done regularly when taking an object from the pool). These warnings never get &lt;br/&gt;
cleared.&lt;/p&gt;

&lt;p&gt;We feel the application should not have to worry about that, but instead the &lt;br/&gt;
pool should provide a Connection without any &quot;old&quot; SQLWarnings attached to it. &lt;br/&gt;
We have therefore introduced a patch into DBCP. A modified version of &lt;br/&gt;
PoolableConnectionFactory.passivateObject(Object obj) that is clearing the old &lt;br/&gt;
SQLWarnings when returning a connection to the pool might look like this:&lt;/p&gt;

&lt;p&gt;public void passivateObject(Object obj) throws Exception {&lt;br/&gt;
    if(obj instanceof Connection) {&lt;br/&gt;
        Connection conn = (Connection)obj;&lt;br/&gt;
        if(!conn.getAutoCommit()) &lt;/p&gt;
{
            conn.rollback();
        }
&lt;p&gt;        try &lt;/p&gt;
{
            conn.clearWarnings();
        }
&lt;p&gt; catch(Exception e) {}&lt;br/&gt;
    }&lt;/p&gt;

&lt;p&gt;    if(obj instanceof DelegatingConnection) &lt;/p&gt;
{
        ((DelegatingConnection)obj).passivate();
    }
&lt;p&gt;}&lt;/p&gt;

&lt;p&gt;We would be glad to see this or a similar solution incorporated into the&lt;br/&gt;
DBCP source tree.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: All&lt;br/&gt;
Platform: All&lt;/p&gt;</environment>
        <key id="12340834">DBCP-140</key>
            <summary>Memory-leak like behaviour in DBCP due to warnings chained to connections in the pool</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="joachim.schuler@epecon.de">Joachim Schuler</reporter>
                        <labels>
                    </labels>
                <created>Wed, 2 Jul 2003 19:03:32 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:33 +0000</updated>
                            <resolved>Tue, 25 Mar 2008 08:11:33 +0000</resolved>
                                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12404660" author="dirkv" created="Tue, 12 Aug 2003 06:52:13 +0000"  >&lt;p&gt;Added the conn.clearWarnings(); but not the try/catch.&lt;br/&gt;
We want to know when there is a problem with the connection.&lt;/p&gt;

&lt;p&gt;Also added junit test TestBasicDataSource.testClearWarnings&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>21273</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114423</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            22 years, 14 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uxy7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178641</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-139] BasicDataSource.close() throws NPE</title>
                <link>https://issues.apache.org/jira/browse/DBCP-139</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;If a BasicDataSource is closed without having been used, the connectionPool &lt;br/&gt;
will not have been initialised and a NPE will be thrown in line 486.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: All&lt;br/&gt;
Platform: All&lt;/p&gt;</environment>
        <key id="12340859">DBCP-139</key>
            <summary>BasicDataSource.close() throws NPE</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="aaron.knauf@vodafone.co.nz">Aaron Knauf</reporter>
                        <labels>
                    </labels>
                <created>Mon, 21 Jul 2003 05:07:56 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:33 +0000</updated>
                            <resolved>Tue, 25 Mar 2008 08:11:33 +0000</resolved>
                                    <version>1.0</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                        <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>21748</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114422</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            22 years, 17 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uwcn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178382</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-138] memory leak in KeyedCPDSConnectionFactory</title>
                <link>https://issues.apache.org/jira/browse/DBCP-138</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;The WeakHashmap in KeyedCPDSConnectionFactory.java seems to be leaking a small&lt;br/&gt;
amount of memory.  Our 12 and 24 hour stress tests (300 concurrent users&lt;br/&gt;
inserting lots of data)  were running out of memory after about 8+ hours.  After&lt;br/&gt;
some tests we determined that it was DBCP.  This determination was made by&lt;br/&gt;
switching out the commons connection pooling and using an application server&lt;br/&gt;
(Weblogic 8.1) connection pooling.  Using the application server connection&lt;br/&gt;
pooling memory was not leaked.  So doing some debugging with some long running&lt;br/&gt;
tests in my dev environment (using OptimizeIt), I determined that the&lt;br/&gt;
KeyedCPDSConnectionFactory.java was leaking memory with the WeakHashMap (class&lt;br/&gt;
member pcMap).  I don&apos;t understand why this should leak because the jdk&lt;br/&gt;
documentation indicates that the keys in the map are weak referenced and when&lt;br/&gt;
the keys are removed, the object is removed from the map.  Nonetheless, I made&lt;br/&gt;
the following code change (diff is in attachment) and reran my dev tests and no&lt;br/&gt;
leak occurred and we reran our stress tests in the performance lab and no leak&lt;br/&gt;
occurred there either.  Perhaps some version of the JDK is causing this but I&lt;br/&gt;
suspect others may run into this as well.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: All&lt;br/&gt;
Platform: Other&lt;/p&gt;</environment>
        <key id="12341306">DBCP-138</key>
            <summary>memory leak in KeyedCPDSConnectionFactory</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="toddc@concur.com">Todd Carmichael</reporter>
                        <labels>
                    </labels>
                <created>Fri, 5 Mar 2004 14:42:47 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:33 +0000</updated>
                            <resolved>Fri, 24 Nov 2006 20:48:48 +0000</resolved>
                                    <version>1.1</version>
                                                        <due></due>
                            <votes>1</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12406152" author="toddc@concur.com" created="Fri, 5 Mar 2004 14:44:11 +0000"  >&lt;p&gt;Created an attachment (id=10670)&lt;br/&gt;
patch that fixes the memory leak&lt;/p&gt;</comment>
                            <comment id="12406153" author="dirkv" created="Sun, 7 Mar 2004 19:21:09 +0000"  >&lt;p&gt;Patch applied&lt;/p&gt;

&lt;p&gt;KeyedCPDSConnectionFactory   Revision : 1.6   Date : 2004/3/7 11:19:25&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12332774" name="ASF.LICENSE.NOT.GRANTED--patch_memleak.txt" size="3053" author="toddc@concur.com" created="Fri, 5 Mar 2004 14:44:11 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>27465</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114421</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            21 years, 36 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uxsv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178617</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-137] NullpointerException when no driverClassName is specified</title>
                <link>https://issues.apache.org/jira/browse/DBCP-137</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;When no driverClassName is specified you get a NullpointerException in Class.forName&lt;/p&gt;

&lt;p&gt;It is possible to use a command line parameter to load the driver:&lt;br/&gt;
-Djdbc.drivers=foo.bah.Driver&lt;/p&gt;

&lt;p&gt;Anyway the message from DriverManager.getDriver is more userfriendly&lt;br/&gt;
java.sql.SQLException: No suitable driver&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: All&lt;br/&gt;
Platform: All&lt;/p&gt;</environment>
        <key id="12340989">DBCP-137</key>
            <summary>NullpointerException when no driverClassName is specified</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="dirkv">Dirk Verbeeck</reporter>
                        <labels>
                    </labels>
                <created>Sun, 21 Sep 2003 20:43:08 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:33 +0000</updated>
                            <resolved>Tue, 25 Mar 2008 08:11:33 +0000</resolved>
                                    <version>Nightly Builds</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12405152" author="dirkv" created="Sun, 21 Sep 2003 20:46:18 +0000"  >&lt;p&gt;fixed in BasicDataSource revision: 1.29&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>23304</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114420</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            22 years, 8 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uxbz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178541</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-136] java.lang.ClassNotFoundException: org.apache.commons.pool.StackKeyedObjectPoolFactory</title>
                <link>https://issues.apache.org/jira/browse/DBCP-136</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;I&apos;m getting this error&lt;/p&gt;

&lt;p&gt;org.apache.jasper.JasperException: java.lang.ClassNotFoundException:&lt;br/&gt;
org.apache.commons.pool.StackKeyedObjectPoolFactory&lt;/p&gt;

&lt;p&gt;I put commons-dbcp.jar and commons-pool.jar in my classpath. I open the&lt;br/&gt;
commons-pool.jar and I found StackKeyedObjectPoolFactory inside&lt;br/&gt;
org.apache.commons.pool.impl not inside org.apache.commons.pool&lt;/p&gt;

&lt;p&gt;I thought, well maybe it&apos;s a bug.&lt;/p&gt;

&lt;p&gt;DBCP version: 1.0&lt;br/&gt;
Pool version: 1.0.1&lt;/p&gt;

&lt;p&gt;Thanks!!!&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: Windows XP&lt;br/&gt;
Platform: PC&lt;/p&gt;</environment>
        <key id="12340630">DBCP-136</key>
            <summary>java.lang.ClassNotFoundException: org.apache.commons.pool.StackKeyedObjectPoolFactory</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="4">Incomplete</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="glurrea@yahoo.com">Germ&#225;n Leonardo Largo Urrea</reporter>
                        <labels>
                    </labels>
                <created>Mon, 31 Mar 2003 04:07:45 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:33 +0000</updated>
                            <resolved>Tue, 25 Mar 2008 08:11:33 +0000</resolved>
                                    <version>1.0</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                        <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>18502</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114419</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            22 years, 33 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0v0gv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>179049</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-135] PoolableConnectionFactory has incomplete javadoc on validationQuery</title>
                <link>https://issues.apache.org/jira/browse/DBCP-135</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;The constructors in PoolableConnectionFactory have a validationQuery parameter. &lt;br/&gt;
The javadoc states that its value can be null, but it doesn&apos;t define the meaning &lt;br/&gt;
of null (e.g. it turns off validation / it can be null only if validation is &lt;br/&gt;
turned off by other means / it uses a default validation query). After looking &lt;br/&gt;
at the source the correct answer is that if null is supplied then it doesn&apos;t &lt;br/&gt;
send a validation query, it only checks connection.isClosed(). (Btw. the 2.x &lt;br/&gt;
mysql driver itself sent a validation query in isClosed()).&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: other&lt;br/&gt;
Platform: Other&lt;/p&gt;</environment>
        <key id="12341441">DBCP-135</key>
            <summary>PoolableConnectionFactory has incomplete javadoc on validationQuery</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="hontvari2@solware.com">Hontvari Jozsef</reporter>
                        <labels>
                    </labels>
                <created>Tue, 11 May 2004 13:25:53 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:33 +0000</updated>
                            <resolved>Tue, 25 Mar 2008 08:11:33 +0000</resolved>
                                    <version>1.1</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12406586" author="dirkv" created="Thu, 13 May 2004 01:31:30 +0000"  >&lt;p&gt;javadoc updated:&lt;br/&gt;
Using null turns off validation.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>28893</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114418</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            21 years, 27 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uz4f:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178831</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-134] [dbcp] DelegatingConnection.close() throws exception</title>
                <link>https://issues.apache.org/jira/browse/DBCP-134</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;Closing connections that were obtained from PoolingDataSource und wrapped with a &lt;br/&gt;
DelegatingConnection throws a &apos;java.sql.SQLException: Already closed&apos; when calling close() on them in &lt;br/&gt;
order to return the connection to the underlying pool.&lt;/p&gt;

&lt;p&gt;The reason is code in DelegatingConnection.passivate() the motivation for which I don&apos;t completely &lt;br/&gt;
understand.&lt;/p&gt;

&lt;p&gt;At any rate, here is what happens. DelegatingConnection.close() calls passivate() before actually closing &lt;br/&gt;
the delegate: &lt;/p&gt;

&lt;p&gt;    /**&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Closes the underlying connection, and close&lt;/li&gt;
	&lt;li&gt;any Statements that were not explicitly closed.&lt;br/&gt;
     */&lt;br/&gt;
    public void close() throws SQLException
    {
        passivate();
        _conn.close();
    }&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;DelegatingConnection.passivate() in turn cleans up statements and, if the delegate is a &lt;br/&gt;
DelegatingConnection too, calls passivate() on the delegate. Finally, the instance variable _closed is set &lt;br/&gt;
to true:&lt;/p&gt;

&lt;p&gt;    protected void passivate() throws SQLException {&lt;br/&gt;
        try {&lt;br/&gt;
            // ... some statement clean up work, then: &lt;br/&gt;
            if(_conn instanceof DelegatingConnection) &lt;/p&gt;
{
                ((DelegatingConnection)_conn).passivate();
            }
&lt;p&gt;        }&lt;br/&gt;
        finally &lt;/p&gt;
{
            _closed = true;
        }
&lt;p&gt;    }&lt;/p&gt;

&lt;p&gt;When this finishes and the delegate is indeed itself a delegating connection, close() will call &lt;br/&gt;
_conn.close(). If DelegatingConnection were final this would even work, but it is not (on purpose). A &lt;br/&gt;
notable derived class is PoolableConnection, which overrides close() and throws an exception if it is &lt;br/&gt;
called when isClosed() returns true. isClosed() returns true if the _closed instance variable is true. &lt;br/&gt;
BUMMER.&lt;/p&gt;

&lt;p&gt;The problem surfaces as soon as one tries to wrap the connection returned by PoolingDataSource with &lt;br/&gt;
another DelegatingConnections, which happens to be what I do.&lt;/p&gt;

&lt;p&gt;I noticed this when I upgraded from 1.1 to 1.2.1, and it&apos;s still there in the nightly snapshot.&lt;/p&gt;

&lt;p&gt;There are several design decisions that I think deserve a critical look:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;why does passivate() set a variable that effectively decides whether a connection is considered&lt;br/&gt;
closed or not? shouldn&apos;t only close() be doing that?&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;why does DelegatingConnection even bother to clean up statements when those statements by&lt;br/&gt;
definition must have come from the delegate (or its delegate and so forth) and so are the responsibility &lt;br/&gt;
of the delegate (creator) to clean up&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;by propagating passivate() in the same method to the delegate if the delegate delegates itself&lt;br/&gt;
DelegatingConnection is making assumptions that may be (and in fact are) easily violated if someone &lt;br/&gt;
sub-classes DelegatingConnection and the delegate is now a subclass with possibly altered behavior. &lt;br/&gt;
Why does it not suffice to expect that calling close() on the delegate will give the delegate enough &lt;br/&gt;
chance to clean up itself, regardless of the implementing class of the delegate.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;I&apos;d be thrilled if this can be fixed quickly, and fixing any of the problems pinpointed above will fix the &lt;br/&gt;
issue. Or so I think.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: Mac OS X 10.3&lt;br/&gt;
Platform: Macintosh&lt;/p&gt;</environment>
        <key id="12342105">DBCP-134</key>
            <summary>[dbcp] DelegatingConnection.close() throws exception</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="hlapp@gnf.org">Hilmar Lapp</reporter>
                        <labels>
                    </labels>
                <created>Thu, 10 Mar 2005 14:17:37 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:33 +0000</updated>
                            <resolved>Wed, 18 Jul 2007 06:48:02 +0000</resolved>
                                    <version>Nightly Builds</version>
                                    <fixVersion>1.3</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12513452" author="psteitz" created="Wed, 18 Jul 2007 06:48:02 +0000"  >&lt;p&gt;Fixed in r 557176.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>33945</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114417</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            18 years, 17 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uvdj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178224</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-133] DBCP Fails silently in many cases</title>
                <link>https://issues.apache.org/jira/browse/DBCP-133</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;One problem with much of the pooling code (and also other Jakarta code) is its &lt;br/&gt;
unfortunate &amp;ldquo;fail silently&amp;rdquo; behavior.  What this means is that when errors or &lt;br/&gt;
unexpected conditions are detected, the code just &amp;ldquo;swallows&amp;rdquo; the error &#150; no &lt;br/&gt;
exception, no logging, nada.  Needless to say this is rarely good for the &lt;br/&gt;
application and can make debugging very difficult.&lt;/p&gt;

&lt;p&gt;Looking through the code I saw a number of places where the code just swallows &lt;br/&gt;
errors.  Some of these were important things I felt I wanted to know about.  &lt;br/&gt;
The pooling code not only can throw exceptions, but also has the JDBC trace &lt;br/&gt;
log available to it (DriverManager.setLogWriter()).  Unfortunately much of the &lt;br/&gt;
code does neither.  We modified the code in several places to throw (or at &lt;br/&gt;
least not swallow) exceptions, especially those related to connection close &lt;br/&gt;
problems (e.g., GenericObjectPool.returnObject()(2 places), &lt;br/&gt;
PoolableConnectionFactory.destroyObject(), DelegatingConnection.checkOpen() &lt;br/&gt;
should check the real connection, DelegatingConnection.activate() should check &lt;br/&gt;
for alrady activated, DelegatingConnection.passivate() should check for &lt;br/&gt;
already closed, and PoolableConnection.close() should check for already &lt;br/&gt;
closed).&lt;/p&gt;

&lt;p&gt;I&apos;m sure there are other places.  I just happened to be focusing on close().&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: Windows XP&lt;br/&gt;
Platform: PC&lt;/p&gt;</environment>
        <key id="12340588">DBCP-133</key>
            <summary>DBCP Fails silently in many cases</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="flawlor@athensgroup.com">Frank Lawlor</reporter>
                        <labels>
                    </labels>
                <created>Thu, 6 Mar 2003 00:49:03 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:33 +0000</updated>
                            <resolved>Tue, 25 Mar 2008 08:11:33 +0000</resolved>
                                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12403798" author="dgraham@apache.org" created="Tue, 1 Apr 2003 14:00:06 +0000"  >&lt;p&gt;It&apos;s confusing why a method like PoolableConnectionFactory.passivateObject() &lt;br/&gt;
declares that it throws Exception and then proceeds to swallow the &lt;br/&gt;
SQLExceptions.  Is there a valid reason that it should swallow them?  IMO, any &lt;br/&gt;
code like:&lt;/p&gt;


&lt;p&gt;} catch(SQLException e) {&lt;/p&gt;


&lt;p&gt;    ; // ignored&lt;/p&gt;


&lt;p&gt;}&lt;/p&gt;


&lt;p&gt;should be refactored to throw or log the exception.&lt;/p&gt;</comment>
                            <comment id="12403799" author="rwaldhoff@apache.org" created="Wed, 2 Apr 2003 08:51:57 +0000"  >&lt;p&gt;David,&lt;/p&gt;

&lt;p&gt;Agreed.  Most of these:&lt;/p&gt;

&lt;p&gt;} catch(SomeException e) {&lt;br/&gt;
  // ignored&lt;br/&gt;
}&lt;/p&gt;

&lt;p&gt;cases are an artifact of the earlier versions of commons-pool not allowing&lt;br/&gt;
checked exceptions to be thrown.  The commons-pool interface was changed, and&lt;br/&gt;
the corresponding signatures changed in commons-dbcp, but not all of the&lt;br/&gt;
swallowed exceptions were cleaned up.&lt;/p&gt;

&lt;p&gt;I&apos;ve fixed all the places the were explicitly marked as &quot;ignored&quot;, save for&lt;br/&gt;
those that looked like they were reasonably ignored.  We&apos;ll see if this&lt;br/&gt;
introduces any new issues in practice.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>17678</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114416</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            22 years, 33 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uy2v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178662</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-132] Jdbc2PoolDataSource throws a RuntimeException when database can&apos;t be found.</title>
                <link>https://issues.apache.org/jira/browse/DBCP-132</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;Jdbc2PoolDataSource throws a java.lang.RuntimeException when a database cannot&lt;br/&gt;
be found.  It should throw an SQLException or some other checked exception.  &lt;/p&gt;

&lt;p&gt;It appears that the root cause is that KeyedCPDSConnectionFactory.makeObject()&lt;br/&gt;
catches the SQLException and re-throws it as a RuntimeException.  It shouldn&apos;t&lt;br/&gt;
catch the exception at all.  The interface&lt;br/&gt;
KeyedPoolableObjectFactory.makeObject() throws Exception, so this shouldn&apos;t be a&lt;br/&gt;
problem.&lt;/p&gt;

&lt;p&gt;Here is the stack trace:&lt;br/&gt;
&amp;#8211;&lt;br/&gt;
java.lang.RuntimeException: General error,  message from server: &quot;Unknown&lt;br/&gt;
database &apos;mnet_22_routing_c&apos;&quot;&lt;br/&gt;
	at&lt;br/&gt;
org.apache.commons.dbcp.jdbc2pool.KeyedCPDSConnectionFactory.makeObject(KeyedCPDSConnectionFactory.java:173)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.commons.pool.impl.GenericKeyedObjectPool.borrowObject(GenericKeyedObjectPool.java:760)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.commons.dbcp.jdbc2pool.Jdbc2PoolDataSource.getConnection(Jdbc2PoolDataSource.java:1096)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.commons.dbcp.jdbc2pool.Jdbc2PoolDataSource.getConnection(Jdbc2PoolDataSource.java:1028)&lt;br/&gt;
&amp;#8211;&lt;/p&gt;

&lt;p&gt;Thanks in advance!&lt;br/&gt;
Coln Evans&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: other&lt;br/&gt;
Platform: Other&lt;/p&gt;</environment>
        <key id="12340647">DBCP-132</key>
            <summary>Jdbc2PoolDataSource throws a RuntimeException when database can&apos;t be found.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="cevans@mobilesys.com">Colin Evans</reporter>
                        <labels>
                    </labels>
                <created>Wed, 9 Apr 2003 03:49:51 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:33 +0000</updated>
                            <resolved>Tue, 25 Mar 2008 08:11:33 +0000</resolved>
                                    <version>Nightly Builds</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12403996" author="dgraham@apache.org" created="Wed, 9 Apr 2003 07:36:12 +0000"  >&lt;p&gt;That exception handling logic was flawed.  It now throws an SQLException.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>18834</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114415</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            22 years, 32 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uxav:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178536</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-131] Connectionpool&apos;s connections always returns same hashCode</title>
                <link>https://issues.apache.org/jira/browse/DBCP-131</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;When we tried to implement a PreparedStatement cache we discovered that the &lt;br/&gt;
hashCode method on a connection always returns the same id. It did so even if &lt;br/&gt;
we got a new connection from the pool.&lt;br/&gt;
The prepared statements are cached for each connection and therefore we need a &lt;br/&gt;
unique id for the connection. Usually the method hashCode generates one for us.&lt;br/&gt;
The problem exists in both version 1.0 and 1.1.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: Linux&lt;br/&gt;
Platform: PC&lt;/p&gt;</environment>
        <key id="12341277">DBCP-131</key>
            <summary>Connectionpool&apos;s connections always returns same hashCode</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="5">Cannot Reproduce</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="niklas@ticnet.se">Niklas Hjort</reporter>
                        <labels>
                    </labels>
                <created>Mon, 16 Feb 2004 17:01:03 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:33 +0000</updated>
                            <resolved>Tue, 25 Mar 2008 08:11:33 +0000</resolved>
                                    <version>1.1</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12406033" author="dirkv" created="Sat, 21 Feb 2004 21:31:22 +0000"  >&lt;p&gt;I have made a testcase: TestConnectionPool.testHashCode&lt;br/&gt;
&lt;a href=&quot;http://cvs.apache.org/viewcvs.cgi/jakarta-commons/dbcp/src/test/org/apache/commons/dbcp/TestConnectionPool.java?rev=1.12&amp;amp;view=auto&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://cvs.apache.org/viewcvs.cgi/jakarta-commons/dbcp/src/test/org/apache/commons/dbcp/TestConnectionPool.java?rev=1.12&amp;amp;view=auto&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;and it works for me.&lt;/p&gt;

&lt;p&gt;Can you give me more info about your DBCP configuration,&lt;br/&gt;
and maybe a testcase showing the error.&lt;/p&gt;</comment>
                            <comment id="12406034" author="dirkv" created="Sat, 21 Feb 2004 21:41:21 +0000"  >&lt;ul&gt;
	&lt;li&gt;
	&lt;ul&gt;
		&lt;li&gt;
		&lt;ul&gt;
			&lt;li&gt;*** Bug 26907 has been marked as a duplicate of this bug. *** has been marked as a duplicate of this bug. ***&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>26966</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114414</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            21 years, 38 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0v0rz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>179099</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-130] impossible to turn off all validation tests when a validationQuery is present</title>
                <link>https://issues.apache.org/jira/browse/DBCP-130</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;The testOnBorrow should be enabled by default and turned off when&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;testOnBorrow == false&lt;/li&gt;
	&lt;li&gt;validationQuery == null&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;The following test can be removed:&lt;br/&gt;
        if (validationQuery != null &amp;amp;&amp;amp; !testOnReturn &amp;amp;&amp;amp; !testWhileIdle) &lt;/p&gt;
{
            connectionPool.setTestOnBorrow(true);
        }</description>
                <environment>&lt;p&gt;Operating System: All&lt;br/&gt;
Platform: All&lt;/p&gt;</environment>
        <key id="12340986">DBCP-130</key>
            <summary>impossible to turn off all validation tests when a validationQuery is present</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="dirkv">Dirk Verbeeck</reporter>
                        <labels>
                    </labels>
                <created>Sat, 20 Sep 2003 22:22:50 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:33 +0000</updated>
                            <resolved>Tue, 25 Mar 2008 08:11:33 +0000</resolved>
                                    <version>Nightly Builds</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12405137" author="dirkv" created="Sun, 21 Sep 2003 00:35:13 +0000"  >&lt;p&gt;fixed in BasicDataSource revision: 1.28&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>23291</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114413</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            22 years, 8 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0ux9r:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178531</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-129] [dbcp] SAXParseException when supplying more than one property in the url parameter</title>
                <link>https://issues.apache.org/jira/browse/DBCP-129</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;DBCP 1.2.1 throws a SAXParseException when supplying more than one db property in the url &lt;br/&gt;
parameter:&lt;/p&gt;

&lt;p&gt;&amp;lt;parameter&amp;gt;&lt;br/&gt;
&amp;lt;name&amp;gt;url&amp;lt;/name&amp;gt;&lt;br/&gt;
&amp;lt;value&amp;gt;jdbc:mysql://localhost:3306/ECOM2?autoReconnect=true&amp;amp;useServerPrepStmts=false&amp;lt;/value&amp;gt;&lt;br/&gt;
&amp;lt;/parameter&amp;gt;&lt;/p&gt;

&lt;p&gt;org.apache.commons.digester.Digester fatalError&lt;br/&gt;
SEVERE: Parse Fatal Error at line 1079 column 85: The reference to entity &quot;autoReconnect&quot; must end &lt;br/&gt;
with the &apos;;&apos; delimiter.&lt;br/&gt;
org.xml.sax.SAXParseException: The reference to entity &quot;autoReconnect&quot; must end with the &apos;;&apos; delimiter.&lt;br/&gt;
        at org.apache.xerces.util.ErrorHandlerWrapper.createSAXParseException(Unknown Source)&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: All&lt;br/&gt;
Platform: All&lt;/p&gt;</environment>
        <key id="12341993">DBCP-129</key>
            <summary>[dbcp] SAXParseException when supplying more than one property in the url parameter</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="4">Incomplete</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="axelmuench@spectodesign.com">Axel Muench</reporter>
                        <labels>
                    </labels>
                <created>Wed, 12 Jan 2005 05:14:08 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:33 +0000</updated>
                            <resolved>Tue, 25 Mar 2008 08:11:33 +0000</resolved>
                                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12408538" author="germuska" created="Wed, 12 Jan 2005 05:30:49 +0000"  >&lt;p&gt;Unescaped &amp;amp; characters are invalid XML.  You should replace them with &amp;amp; or&lt;br/&gt;
enclose them in CDATA wrappers.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>33053</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114412</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            20 years, 44 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0v0h3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>179050</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-128] [dbcp] BasicDataSource.getConnection() Connections don&apos;t work as hashtable keys -- test case provided</title>
                <link>https://issues.apache.org/jira/browse/DBCP-128</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;Code I&apos;m working with uses a Connection as a key in a Hashtable, and while I was&lt;br/&gt;
trying to move from DbConnectionBroker to DBCP, I ran into some problems.&lt;/p&gt;

&lt;p&gt;When retrieving the value from the Hashtable using the Connection originally&lt;br/&gt;
returned by BasicDataSource.getConnection(), I don&apos;t get the value back that was&lt;br/&gt;
inserted into the Hashtable. I get null instead.&lt;/p&gt;

&lt;p&gt;I&apos;ve provided a patch to BasicDataSourceExample.java that can be used as a very&lt;br/&gt;
basic test case. For the purposes of the test, I set up HSQLDB (originally this&lt;br/&gt;
was discovered using JSQLConnect to connect to a MS SQL Server DB), and, using&lt;br/&gt;
the HSQLDB&apos;s DatabaseManager, populated a database with the test data (Options&lt;br/&gt;
-&amp;gt; Insert test data).&lt;/p&gt;

&lt;p&gt;The patch to BasicDataSourceExample.java the will get a connection, use it to&lt;br/&gt;
insert a string into a Hashtable, then do some tests that show the problem,&lt;br/&gt;
while still succssfully retrieving data from the database.&lt;/p&gt;

&lt;p&gt;Also in the patch are changes so you can provide all the arguments at the&lt;br/&gt;
command line.&lt;/p&gt;

&lt;p&gt;I tested this with DBCP 1.2.1 with it&apos;s dependencies and with the nightly dump&lt;br/&gt;
&lt;a href=&quot;http://cvs.apache.org/builds/jakarta-commons/nightly/commons-dbcp/commons-dbcp-20060509.tar.gz&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://cvs.apache.org/builds/jakarta-commons/nightly/commons-dbcp/commons-dbcp-20060509.tar.gz&lt;/a&gt;,&lt;br/&gt;
with the latest releases of commons-collections and commons-pool. For both tests&lt;br/&gt;
the j2ee.jar was version 1.4 and hsqldb.jar was version 1.8.0.2.&lt;/p&gt;

&lt;p&gt;Here&apos;s the output from the session with the latest nightly build:&lt;br/&gt;
805: www@animal $-&amp;gt; javac -cp&lt;br/&gt;
/home/www/hsqldb/j2ee.jar:/www/classes/commons-collections-3.1.jar:/www/classes/commons-pool-1.3.jar:/home/www/hsqldb/dbcp/commons-dbcp/commons-dbcp.jar:/usr/share/java/hsqldb-1.8.0.2.jar&lt;br/&gt;
BasicDataSourceExample.java&lt;br/&gt;
806: www@animal $-&amp;gt; java -cp&lt;br/&gt;
/home/www/hsqldb/j2ee.jar:/www/classes/commons-collections-3.1.jar:/www/classes/commons-pool-1.3.jar:/home/www/hsqldb/dbcp/commons-dbcp/commons-dbcp.jar:/usr/share/java/hsqldb-1.8.0.2.jar:&lt;br/&gt;
BasicDataSourceExample &quot;org.hsqldb.jdbcDriver&quot;&lt;br/&gt;
&quot;jdbc:hsqldb:&lt;a href=&quot;file:/home/www/hsqldb/test&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;file:/home/www/hsqldb/test&lt;/a&gt;&quot; &quot;sa&quot; &quot;&quot; &quot;SELECT FIRSTNAME, LASTNAME&lt;br/&gt;
FROM CUSTOMER&quot;&lt;br/&gt;
Setting up data source.&lt;br/&gt;
Done.&lt;br/&gt;
Creating connection.&lt;br/&gt;
Hash contains key: jdbc:hsqldb:&lt;a href=&quot;file:/home/www/hsqldb/test&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;file:/home/www/hsqldb/test&lt;/a&gt;, UserName=SA, HSQL&lt;br/&gt;
Database Engine Driver ? false&lt;br/&gt;
Hash value for key: jdbc:hsqldb:&lt;a href=&quot;file:/home/www/hsqldb/test&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;file:/home/www/hsqldb/test&lt;/a&gt;, UserName=SA, HSQL&lt;br/&gt;
Database Engine Driver ? null&lt;br/&gt;
Hash contains value: test ? true&lt;br/&gt;
Creating statement.&lt;br/&gt;
Executing statement.&lt;br/&gt;
Results:&lt;br/&gt;
        Laura   Steel&lt;br/&gt;
        Susanne King&lt;br/&gt;
        Anne    Miller&lt;br/&gt;
        Michael Clancy&lt;br/&gt;
        Sylvia  Ringer&lt;br/&gt;
        Laura   Miller&lt;br/&gt;
        Laura   White&lt;br/&gt;
        James   Peterson&lt;br/&gt;
        Andrew  Miller&lt;br/&gt;
        James   Schneider&lt;br/&gt;
        Anne    Fuller&lt;br/&gt;
        Julia   White&lt;br/&gt;
        George  Ott&lt;br/&gt;
        Laura   Ringer&lt;br/&gt;
        Bill    Karsen&lt;br/&gt;
        Bill    Clancy&lt;br/&gt;
        John    Fuller&lt;br/&gt;
        Laura   Ott&lt;br/&gt;
        Sylvia  Fuller&lt;br/&gt;
        Susanne Heiniger&lt;br/&gt;
        Janet   Schneider&lt;br/&gt;
        Julia   Clancy&lt;br/&gt;
        Bill    Ott&lt;br/&gt;
        Julia   Heiniger&lt;br/&gt;
        James   Sommer&lt;br/&gt;
        Sylvia  Steel&lt;br/&gt;
        James   Clancy&lt;br/&gt;
        Bob     Sommer&lt;br/&gt;
        Susanne White&lt;br/&gt;
        Andrew  Smith&lt;br/&gt;
        Bill    Sommer&lt;br/&gt;
        Bob     Ringer&lt;br/&gt;
        Michael Ott&lt;br/&gt;
        Mary    King&lt;br/&gt;
        Julia   May&lt;br/&gt;
        George  Karsen&lt;br/&gt;
        John    Steel&lt;br/&gt;
        Michael Clancy&lt;br/&gt;
        Andrew  Heiniger&lt;br/&gt;
        Mary    Karsen&lt;br/&gt;
        Susanne Miller&lt;br/&gt;
        Bill    King&lt;br/&gt;
        Robert  Ott&lt;br/&gt;
        Susanne Smith&lt;br/&gt;
        Sylvia  Ott&lt;br/&gt;
        Janet   May&lt;br/&gt;
        Andrew  May&lt;br/&gt;
        Janet   Fuller&lt;br/&gt;
        Robert  White&lt;br/&gt;
        George  Fuller&lt;br/&gt;
807: www@animal $-&amp;gt;&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: Linux&lt;br/&gt;
Platform: PC&lt;/p&gt;</environment>
        <key id="12343072">DBCP-128</key>
            <summary>[dbcp] BasicDataSource.getConnection() Connections don&apos;t work as hashtable keys -- test case provided</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="vegandy@gmail.com">vegandy</reporter>
                        <labels>
                    </labels>
                <created>Wed, 10 May 2006 05:54:23 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:33 +0000</updated>
                            <resolved>Mon, 25 Sep 2006 05:13:50 +0000</resolved>
                                    <version>1.2.1</version>
                                    <fixVersion>1.2.2</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12411866" author="vegandy@gmail.com" created="Wed, 10 May 2006 05:56:04 +0000"  >&lt;p&gt;Created an attachment (id=18252)&lt;br/&gt;
patch to use BasicDataSourceExample as a simple test case&lt;/p&gt;

&lt;p&gt;This is the patch I used to BasicDataSourceExample for provide a testcase for&lt;br/&gt;
this bug.&lt;/p&gt;</comment>
                            <comment id="12411867" author="sandymac@apache.org" created="Wed, 10 May 2006 23:38:02 +0000"  >&lt;p&gt;Skimming the source I think this may stem from DelegatingConnection having&lt;br/&gt;
equals() and hashCode() implementations that don&apos;t obey the equals &amp;amp; hashCode&lt;br/&gt;
contracts. My initial impressions is those methods should just be removed but&lt;br/&gt;
I&apos;m not sure if this will have a negative side effects elsewhere.&lt;/p&gt;</comment>
                            <comment id="12433669" author="psteitz" created="Sun, 10 Sep 2006 05:33:44 +0000"  >&lt;p&gt;Fix version should have been 1.3, affects 1.2.1&lt;/p&gt;</comment>
                            <comment id="12433670" author="psteitz" created="Sun, 10 Sep 2006 05:35:59 +0000"  >&lt;p&gt;Removing equals / hashcode impls would have side effects.  Agree they should be fixed.&lt;/p&gt;</comment>
                            <comment id="12433876" author="bayard" created="Mon, 11 Sep 2006 15:13:06 +0000"  >&lt;p&gt;What kind of side effects?&lt;/p&gt;

&lt;p&gt;If you mean binary incompatibility; then how about public boolean equals(Object o) &lt;/p&gt;
{ return super.equals(o); }
&lt;p&gt; to keep things working? Then we could remove that later on in 2.0.&lt;/p&gt;</comment>
                            <comment id="12437454" author="psteitz" created="Mon, 25 Sep 2006 05:13:50 +0000"  >&lt;p&gt;This was fixed in r441852.  &lt;br/&gt;
The change to make equals reflexive in PoolGuardConnectionWrapper to resolve &lt;a href=&quot;https://issues.apache.org/jira/browse/DBCP-198&quot; title=&quot;PoolingDataSource.PoolGuardConnectionWrapper equals() implementation incorrect&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DBCP-198&quot;&gt;&lt;del&gt;DBCP-198&lt;/del&gt;&lt;/a&gt; resolved this bug as well.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12334146" name="ASF.LICENSE.NOT.GRANTED--BasicDataSourceExample.java.patch" size="2910" author="vegandy@gmail.com" created="Wed, 10 May 2006 05:56:04 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>39537</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114411</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            19 years, 7 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uxbb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178538</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-127] DBCP 1.1 incompatible with Informix (driver doesn&apos;t support setReadOnly(...))</title>
                <link>https://issues.apache.org/jira/browse/DBCP-127</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;DBCP 1.1 is more strict about Exceptions thrown by setReadOnly method of the&lt;br/&gt;
database drivers.&lt;br/&gt;
This results in the following issue with the Informix database driver as&lt;br/&gt;
reported by Andrew Peirson.&lt;/p&gt;

&lt;p&gt;For details see commons-user mailing list 24-2-2004.&lt;/p&gt;

&lt;p&gt;=========================================================================&lt;br/&gt;
Creating connection.&lt;br/&gt;
org.apache.commons.dbcp.SQLNestedException: Cannot get a connection, pool &lt;br/&gt;
exhausted&lt;br/&gt;
        at &lt;br/&gt;
org.apache.commons.dbcp.PoolingDataSource.getConnection(PoolingDataSource.java:148)&lt;br/&gt;
        at &lt;br/&gt;
ManualPoolingDataSourceExample.main(ManualPoolingDataSourceExample.java:169)&lt;br/&gt;
Caused by: java.util.NoSuchElementException: Could not create a validated &lt;br/&gt;
object, cause: Read only mode not supported&lt;br/&gt;
        at &lt;br/&gt;
org.apache.commons.pool.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:851)&lt;br/&gt;
        at &lt;br/&gt;
org.apache.commons.dbcp.PoolingDataSource.getConnection(PoolingDataSource.java:140)&lt;br/&gt;
        ... 1 more&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: All&lt;br/&gt;
Platform: All&lt;/p&gt;</environment>
        <key id="12341294">DBCP-127</key>
            <summary>DBCP 1.1 incompatible with Informix (driver doesn&apos;t support setReadOnly(...))</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="dirkv">Dirk Verbeeck</reporter>
                        <labels>
                    </labels>
                <created>Sun, 29 Feb 2004 06:21:58 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:33 +0000</updated>
                            <resolved>Tue, 25 Mar 2008 08:11:33 +0000</resolved>
                                    <version>1.1</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12406096" author="dirkv" created="Mon, 1 Mar 2004 04:19:55 +0000"  >&lt;p&gt;The solution I implemented is to allow 3 values for the defaultReadOnly parameter:&lt;br/&gt;
true, false and notset.&lt;br/&gt;
When the parameter isn&apos;t set then the Connection.setReadOnly method will not be&lt;br/&gt;
called on activate.&lt;/p&gt;

&lt;p&gt;BasicDataSource.java revision: 1.35&lt;br/&gt;
PoolableConnectionFactory.java revision: 1.20&lt;/p&gt;</comment>
                            <comment id="12406097" author="megadix@yahoo.it" created="Thu, 22 Jul 2004 18:08:39 +0000"  >&lt;ul&gt;
	&lt;li&gt;
	&lt;ul&gt;
		&lt;li&gt;
		&lt;ul&gt;
			&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/DBCP-42&quot; title=&quot;pool exhausted Tomcat - Informix&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DBCP-42&quot;&gt;&lt;del&gt;COM-1436&lt;/del&gt;&lt;/a&gt; has been marked as a duplicate of this bug. ***&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="12462040" author="kimberlybaer" created="Wed, 3 Jan 2007 19:48:10 +0000"  >&lt;p&gt;I recieved an error using commons-dbcp-1.2.1.jar and ifxjdbc.jar for my informix driver:&lt;/p&gt;

&lt;p&gt;org.apache.commons.dbcp.SQLNestedException: Cannot get a connection, pool exhausted&lt;br/&gt;
	at org.apache.commons.dbcp.PoolingDriver.connect(PoolingDriver.java:183)&lt;br/&gt;
	at java.sql.DriverManager.getConnection(DriverManager.java:539)&lt;br/&gt;
	at java.sql.DriverManager.getConnection(DriverManager.java:211)&lt;br/&gt;
	at ConnectionPoolingTest.main(ConnectionPoolingTest.java:105)&lt;br/&gt;
Caused by: java.util.NoSuchElementException: Could not create a validated object, cause: Read only mode not supported&lt;br/&gt;
	at org.apache.commons.pool.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:806)&lt;br/&gt;
	at org.apache.commons.dbcp.PoolingDriver.connect(PoolingDriver.java:175)&lt;/p&gt;

&lt;p&gt;I will look into the comment provided by Dirk, but it appears this bug still has an impact.  If anyone has any other suggestions, they would be greatly appreciated.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>27320</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114410</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            18 years, 45 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0ux5r:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178513</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-126] [DBCP] testOnBorrow fails if setAutoCommit() throws an exception</title>
                <link>https://issues.apache.org/jira/browse/DBCP-126</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;&quot;Extance, Paul&quot; &amp;lt;paul.extance@spirent.com&amp;gt; has reported this bug and proposed a solution at &lt;br/&gt;
commons-user.&lt;/p&gt;

&lt;p&gt;Kyrill Alyoshin &amp;lt;Kyrill.Alyoshin@Sun.COM&amp;gt; has proposes an improved &lt;br/&gt;
fix.&lt;/p&gt;

&lt;p&gt;Neither wanted to enter this to Bugzilla themselves &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: other&lt;br/&gt;
Platform: Other&lt;/p&gt;</environment>
        <key id="12340880">DBCP-126</key>
            <summary>[DBCP] testOnBorrow fails if setAutoCommit() throws an exception</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="tagunov@motor.ru">tagunov</reporter>
                        <labels>
                    </labels>
                <created>Sat, 2 Aug 2003 13:14:47 +0000</created>
                <updated>Thu, 2 May 2013 02:28:34 +0000</updated>
                            <resolved>Fri, 24 Nov 2006 20:44:56 +0000</resolved>
                                    <version>1.2</version>
                                                        <due></due>
                            <votes>1</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12404775" author="tagunov@motor.ru" created="Sat, 2 Aug 2003 13:17:23 +0000"  >&lt;p&gt;Created an attachment (id=7624)&lt;br/&gt;
Pauls&apos;s mail&lt;/p&gt;</comment>
                            <comment id="12404776" author="tagunov@motor.ru" created="Sat, 2 Aug 2003 13:18:36 +0000"  >&lt;p&gt;Created an attachment (id=7625)&lt;br/&gt;
Kyrill&apos;s mail&lt;/p&gt;</comment>
                            <comment id="12404777" author="dirkv" created="Tue, 12 Aug 2003 07:14:54 +0000"  >&lt;ul&gt;
	&lt;li&gt;
	&lt;ul&gt;
		&lt;li&gt;
		&lt;ul&gt;
			&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/DBCP-6&quot; title=&quot;Broken pipe despite validation query set&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DBCP-6&quot;&gt;&lt;del&gt;COM-672&lt;/del&gt;&lt;/a&gt; has been marked as a duplicate of this bug. ***&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="12404778" author="dirkv" created="Wed, 13 Aug 2003 05:52:59 +0000"  >&lt;p&gt;I went for Pauls&apos;s solution and not changing the order the activate/validate.&lt;/p&gt;

&lt;p&gt;New behaviour:&lt;br/&gt;
If activateObject throws an Exception and the object wasn&apos;t newly created &lt;br/&gt;
the Exception is now ignored, activation errors on new objects continue to &lt;br/&gt;
throw NoSuchElementException&lt;/p&gt;</comment>
                            <comment id="12404779" author="sandymac@apache.org" created="Mon, 6 Mar 2006 14:57:27 +0000"  >&lt;ul&gt;
	&lt;li&gt;
	&lt;ul&gt;
		&lt;li&gt;
		&lt;ul&gt;
			&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/POOL-37&quot; title=&quot;[pool] Killed user connection causes the setautocomit to fail&quot; class=&quot;issue-link&quot; data-issue-key=&quot;POOL-37&quot;&gt;&lt;del&gt;COM-2801&lt;/del&gt;&lt;/a&gt; has been marked as a duplicate of this bug. ***&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10001">
                    <name>dependent</name>
                                                                <inwardlinks description="is depended upon by">
                                        <issuelink>
            <issuekey id="12342953">POOL-37</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12332441" name="ASF.LICENSE.NOT.GRANTED--1.txt" size="7668" author="tagunov@motor.ru" created="Sat, 2 Aug 2003 13:17:23 +0000"/>
                            <attachment id="12332442" name="ASF.LICENSE.NOT.GRANTED--2.txt" size="10515" author="tagunov@motor.ru" created="Sat, 2 Aug 2003 13:18:36 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>22078</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114409</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            19 years, 36 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uwdr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178387</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-125] [dbcp] Improvements to maven build</title>
                <link>https://issues.apache.org/jira/browse/DBCP-125</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;The following is an improvement to the project.xml of commons-dbcp 1.2 and 1.2.1&lt;/p&gt;

&lt;p&gt;After that could you please publish it again to :&lt;br/&gt;
&lt;a href=&quot;http://www.apache.org/dist/java-repository/commons-dbcp/poms/commons-dbcp-1.2.pom&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.apache.org/dist/java-repository/commons-dbcp/poms/commons-dbcp-1.2.pom&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;http://www.apache.org/dist/java-repository/commons-dbcp/poms/commons-dbcp-1.2.1.pom&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.apache.org/dist/java-repository/commons-dbcp/poms/commons-dbcp-1.2.1.pom&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This is related to: &lt;a href=&quot;http://jira.codehaus.org/browse/MEV-107&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://jira.codehaus.org/browse/MEV-107&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Dependencies section:&lt;/p&gt;

&lt;p&gt;  &amp;lt;dependencies&amp;gt;&lt;br/&gt;
    &amp;lt;dependency&amp;gt;&lt;br/&gt;
      &amp;lt;groupId&amp;gt;commons-collections&amp;lt;/groupId&amp;gt;&lt;br/&gt;
      &amp;lt;artifactId&amp;gt;commons-collections&amp;lt;/artifactId&amp;gt;&lt;br/&gt;
      &amp;lt;version&amp;gt;2.1&amp;lt;/version&amp;gt;&lt;br/&gt;
    &amp;lt;/dependency&amp;gt;&lt;br/&gt;
    &amp;lt;dependency&amp;gt;&lt;br/&gt;
      &amp;lt;groupId&amp;gt;commons-pool&amp;lt;/groupId&amp;gt;&lt;br/&gt;
      &amp;lt;artifactId&amp;gt;commons-pool&amp;lt;/artifactId&amp;gt;&lt;br/&gt;
      &amp;lt;version&amp;gt;1.2&amp;lt;/version&amp;gt;&lt;br/&gt;
    &amp;lt;/dependency&amp;gt;&lt;br/&gt;
    &amp;lt;dependency&amp;gt;&lt;br/&gt;
      &amp;lt;groupId&amp;gt;javax.sql&amp;lt;/groupId&amp;gt;&lt;br/&gt;
      &amp;lt;artifactId&amp;gt;jdbc-stdext&amp;lt;/artifactId&amp;gt;&lt;br/&gt;
      &amp;lt;version&amp;gt;2.0&amp;lt;/version&amp;gt;&lt;br/&gt;
    &amp;lt;/dependency&amp;gt;&lt;br/&gt;
    &amp;lt;dependency&amp;gt;&lt;br/&gt;
      &amp;lt;groupId&amp;gt;junit&amp;lt;/groupId&amp;gt;&lt;br/&gt;
      &amp;lt;artifactId&amp;gt;junit&amp;lt;/artifactId&amp;gt;&lt;br/&gt;
      &amp;lt;version&amp;gt;3.8.1&amp;lt;/version&amp;gt;&lt;br/&gt;
      &amp;lt;properties&amp;gt;&lt;br/&gt;
        &amp;lt;scope&amp;gt;test&amp;lt;/scope&amp;gt;&lt;br/&gt;
      &amp;lt;/properties&amp;gt;&lt;br/&gt;
    &amp;lt;/dependency&amp;gt;&lt;/p&gt;

&lt;p&gt;    &amp;lt;!-- these two are required by maven --&amp;gt;&lt;br/&gt;
    &amp;lt;dependency&amp;gt;&lt;br/&gt;
      &amp;lt;groupId&amp;gt;xml-apis&amp;lt;/groupId&amp;gt;&lt;br/&gt;
      &amp;lt;artifactId&amp;gt;xml-apis&amp;lt;/artifactId&amp;gt;&lt;br/&gt;
      &amp;lt;version&amp;gt;2.0.2&amp;lt;/version&amp;gt;&lt;br/&gt;
    &amp;lt;/dependency&amp;gt;&lt;br/&gt;
    &amp;lt;!-- actually dbcp&apos;s tests need this too --&amp;gt;&lt;br/&gt;
    &amp;lt;dependency&amp;gt;&lt;br/&gt;
      &amp;lt;groupId&amp;gt;xerces&amp;lt;/groupId&amp;gt;&lt;br/&gt;
      &amp;lt;artifactId&amp;gt;xerces&amp;lt;/artifactId&amp;gt;&lt;br/&gt;
      &amp;lt;version&amp;gt;2.0.2&amp;lt;/version&amp;gt;&lt;br/&gt;
    &amp;lt;/dependency&amp;gt;&lt;br/&gt;
    &amp;lt;!-- /these two are required by maven --&amp;gt;&lt;br/&gt;
  &amp;lt;/dependencies&amp;gt;&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: other&lt;br/&gt;
Platform: Other&lt;/p&gt;</environment>
        <key id="12342612">DBCP-125</key>
            <summary>[dbcp] Improvements to maven build</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="carlos">Carlos Sanchez Gonzalez</reporter>
                        <labels>
                    </labels>
                <created>Tue, 11 Oct 2005 07:05:54 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:33 +0000</updated>
                            <resolved>Tue, 25 Mar 2008 08:11:33 +0000</resolved>
                                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12410559" author="carlos" created="Tue, 11 Oct 2005 07:58:40 +0000"  >&lt;p&gt;Created an attachment (id=16644)&lt;br/&gt;
A patch for current code in svn&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12333838" name="ASF.LICENSE.NOT.GRANTED--dbcp.patch" size="2198" author="carlos" created="Tue, 11 Oct 2005 07:58:40 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>37007</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114408</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            20 years, 5 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0ux87:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178524</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-124] [dbcp] NullPointerException thrown by PoolableConnectionFactory</title>
                <link>https://issues.apache.org/jira/browse/DBCP-124</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;I have been developing a simple application that will access an Oracle 8i &lt;br/&gt;
database.&lt;/p&gt;

&lt;p&gt;I am developing the application using Eclipse 3.0.1 using the Exadel software &lt;br/&gt;
package on top of it in order to fulfil the webapp development requirement I &lt;br/&gt;
have.&lt;/p&gt;

&lt;p&gt;I am able to successfully look up the DataSource through JNDI - the DataSource &lt;br/&gt;
object has all the attributes I set in the server.xml file.  When I call the &lt;br/&gt;
getConnection() method on the DataSource object a NullPointerException is &lt;br/&gt;
thrown.&lt;/p&gt;

&lt;p&gt;I&apos;ve used a decompiler to add trace statements to the classes that are involved &lt;br/&gt;
in the process.  It would seem that the NullPointerException is thrown in &lt;br/&gt;
org.apache.commons.dbcp.PoolableConnectionFactory - specifically the &lt;br/&gt;
activateObject() method.&lt;/p&gt;

&lt;p&gt;If I catch the exception and continue processing when I next come to call &lt;br/&gt;
getConnection() a org.apache.commons.dbcp.SQLNestedException: Cannot get a &lt;br/&gt;
connection, pool exhausted is thrown.&lt;/p&gt;

&lt;p&gt;I have carried out some investigation with regards to the configuration of the &lt;br/&gt;
server.xml file.  It seems that altering the url has no effect on the outcome &lt;br/&gt;
of the test - if I supply an invalid url or invalid username or password &lt;br/&gt;
details this is not detected.&lt;/p&gt;

&lt;p&gt;I&apos;ve looked on a number of websites for a solution to this problem but haven&apos;t &lt;br/&gt;
found any as of yet.&lt;/p&gt;

&lt;p&gt;This error makes it impossible to carry out any kind of database activity - &lt;br/&gt;
hence the P1 priority.  Apologies if this is the wrong priority to raise the &lt;br/&gt;
bug at.&lt;/p&gt;

&lt;p&gt;I greatly look forward to your help regarding this matter.&lt;/p&gt;

&lt;p&gt;My server.xml file is as follows:-&lt;/p&gt;

&lt;p&gt;&amp;lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&amp;gt;&lt;br/&gt;
&amp;lt;Server port=&quot;8005&quot; shutdown=&quot;SHUTDOWN&quot; debug=&quot;0&quot;&amp;gt;&lt;br/&gt;
  &amp;lt;!-- Comment these entries out to disable JMX MBeans support --&amp;gt;&lt;br/&gt;
  &amp;lt;!-- You may also configure custom components (e.g. Valves/Realms) by &lt;br/&gt;
       including your own mbean-descriptor file(s), and setting the &lt;br/&gt;
       &quot;descriptors&quot; attribute to point to a &apos;;&apos; seperated list of paths&lt;br/&gt;
       (in the ClassLoader sense) of files to add to the default list.&lt;br/&gt;
       e.g. descriptors=&quot;/com/myfirm/mypackage/mbean-descriptor.xml&quot;&lt;br/&gt;
  --&amp;gt;&lt;br/&gt;
  &amp;lt;Listener&lt;br/&gt;
    className=&quot;org.apache.catalina.mbeans.ServerLifecycleListener&quot; debug=&quot;0&quot;/&amp;gt;&lt;br/&gt;
  &amp;lt;Listener&lt;br/&gt;
    className=&quot;org.apache.catalina.mbeans.GlobalResourcesLifecycleListener&quot; &lt;br/&gt;
debug=&quot;0&quot;/&amp;gt;&lt;br/&gt;
  &amp;lt;!-- Global JNDI resources --&amp;gt;&lt;br/&gt;
  &amp;lt;GlobalNamingResources&amp;gt;&lt;br/&gt;
    &amp;lt;!-- Test entry for demonstration purposes --&amp;gt;&lt;br/&gt;
    &amp;lt;Environment name=&quot;simpleValue&quot; type=&quot;java.lang.Integer&quot; value=&quot;30&quot;/&amp;gt;&lt;br/&gt;
    &amp;lt;!-- Editable user database that can also be used by&lt;br/&gt;
         UserDatabaseRealm to authenticate users --&amp;gt;&lt;br/&gt;
    &amp;lt;Resource name=&quot;UserDatabase&quot; auth=&quot;Container&quot;&lt;br/&gt;
      type=&quot;org.apache.catalina.UserDatabase&quot; description=&quot;User database that &lt;br/&gt;
can be updated and saved&quot;/&amp;gt;&lt;br/&gt;
    &amp;lt;ResourceParams name=&quot;UserDatabase&quot;&amp;gt;&lt;br/&gt;
      &amp;lt;parameter&amp;gt;&lt;br/&gt;
        &amp;lt;name&amp;gt;factory&amp;lt;/name&amp;gt;&lt;br/&gt;
        &amp;lt;value&amp;gt;org.apache.catalina.users.MemoryUserDatabaseFactory&amp;lt;/value&amp;gt;&lt;br/&gt;
      &amp;lt;/parameter&amp;gt;&lt;br/&gt;
      &amp;lt;parameter&amp;gt;&lt;br/&gt;
        &amp;lt;name&amp;gt;pathname&amp;lt;/name&amp;gt;&lt;br/&gt;
        &amp;lt;value&amp;gt;conf/tomcat-users.xml&amp;lt;/value&amp;gt;&lt;br/&gt;
      &amp;lt;/parameter&amp;gt;&lt;br/&gt;
    &amp;lt;/ResourceParams&amp;gt;&lt;br/&gt;
  &amp;lt;/GlobalNamingResources&amp;gt;&lt;br/&gt;
  &amp;lt;!-- A &quot;Service&quot; is a collection of one or more &quot;Connectors&quot; that share&lt;br/&gt;
       a single &quot;Container&quot; (and therefore the web applications visible&lt;br/&gt;
       within that Container).  Normally, that Container is an &quot;Engine&quot;,&lt;br/&gt;
       but this is not required.&lt;/p&gt;

&lt;p&gt;       Note:  A &quot;Service&quot; is not itself a &quot;Container&quot;, so you may not&lt;br/&gt;
       define subcomponents such as &quot;Valves&quot; or &quot;Loggers&quot; at this level.&lt;br/&gt;
   --&amp;gt;&lt;br/&gt;
  &amp;lt;!-- Define the Tomcat Stand-Alone Service --&amp;gt;&lt;br/&gt;
  &amp;lt;Service name=&quot;Catalina&quot;&amp;gt;&lt;br/&gt;
    &amp;lt;!-- A &quot;Connector&quot; represents an endpoint by which requests are received&lt;br/&gt;
         and responses are returned.  Each Connector passes requests on to the&lt;br/&gt;
         associated &quot;Container&quot; (normally an Engine) for processing.&lt;/p&gt;

&lt;p&gt;         By default, a non-SSL HTTP/1.1 Connector is established on port 8080.&lt;br/&gt;
         You can also enable an SSL HTTP/1.1 Connector on port 8443 by&lt;br/&gt;
         following the instructions below and uncommenting the second Connector&lt;br/&gt;
         entry.  SSL support requires the following steps (see the SSL Config&lt;br/&gt;
         HOWTO in the Tomcat 5 documentation bundle for more detailed&lt;br/&gt;
         instructions):&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;If your JDK version 1.3 or prior, download and install JSSE 1.0.2 or&lt;br/&gt;
           later, and put the JAR files into &quot;$JAVA_HOME/jre/lib/ext&quot;.&lt;/li&gt;
	&lt;li&gt;Execute:&lt;br/&gt;
             %JAVA_HOME%\bin\keytool -genkey -alias tomcat -keyalg RSA (Windows)&lt;br/&gt;
             $JAVA_HOME/bin/keytool -genkey -alias tomcat -keyalg RSA  (Unix)&lt;br/&gt;
           with a password value of &quot;changeit&quot; for both the certificate and&lt;br/&gt;
           the keystore itself.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;         By default, DNS lookups are enabled when a web application calls&lt;br/&gt;
         request.getRemoteHost().  This can have an adverse impact on&lt;br/&gt;
         performance, so you can disable it by setting the&lt;br/&gt;
         &quot;enableLookups&quot; attribute to &quot;false&quot;.  When DNS lookups are disabled,&lt;br/&gt;
         request.getRemoteHost() will return the String version of the&lt;br/&gt;
         IP address of the remote client.&lt;br/&gt;
    --&amp;gt;&lt;br/&gt;
    &amp;lt;!-- Define a non-SSL Coyote HTTP/1.1 Connector on the port specified&lt;br/&gt;
         during installation  --&amp;gt;&lt;br/&gt;
    &amp;lt;Connector port=&quot;8080&quot; maxThreads=&quot;150&quot; minSpareThreads=&quot;25&quot;&lt;br/&gt;
      maxSpareThreads=&quot;75&quot; enableLookups=&quot;false&quot; redirectPort=&quot;8443&quot;&lt;br/&gt;
      acceptCount=&quot;100&quot; debug=&quot;0&quot; connectionTimeout=&quot;20000&quot; &lt;br/&gt;
disableUploadTimeout=&quot;true&quot;/&amp;gt;&lt;br/&gt;
    &amp;lt;!-- Note : To disable connection timeouts, set connectionTimeout value&lt;br/&gt;
     to 0 --&amp;gt;&lt;br/&gt;
    &amp;lt;!-- Note : To use gzip compression you could set the following properties :&lt;/p&gt;

&lt;p&gt;			   compression=&quot;on&quot; &lt;br/&gt;
			   compressionMinSize=&quot;2048&quot; &lt;br/&gt;
			   noCompressionUserAgents=&quot;gozilla, traviata&quot; &lt;br/&gt;
			   compressableMimeType=&quot;text/html,text/xml&quot;&lt;br/&gt;
	--&amp;gt;&lt;br/&gt;
    &amp;lt;!-- Define a SSL Coyote HTTP/1.1 Connector on port 8443 --&amp;gt;&lt;br/&gt;
    &amp;lt;!--&lt;br/&gt;
    &amp;lt;Connector port=&quot;8443&quot; &lt;br/&gt;
               maxThreads=&quot;150&quot; minSpareThreads=&quot;25&quot; maxSpareThreads=&quot;75&quot;&lt;br/&gt;
               enableLookups=&quot;false&quot; disableUploadTimeout=&quot;true&quot;&lt;br/&gt;
               acceptCount=&quot;100&quot; debug=&quot;0&quot; scheme=&quot;https&quot; secure=&quot;true&quot;&lt;br/&gt;
               clientAuth=&quot;false&quot; sslProtocol=&quot;TLS&quot; /&amp;gt;&lt;br/&gt;
    --&amp;gt;&lt;br/&gt;
    &amp;lt;!-- Define a Coyote/JK2 AJP 1.3 Connector on port 8009 --&amp;gt;&lt;br/&gt;
    &amp;lt;Connector port=&quot;8009&quot; enableLookups=&quot;false&quot; redirectPort=&quot;8443&quot;&lt;br/&gt;
      debug=&quot;0&quot; protocol=&quot;AJP/1.3&quot;/&amp;gt;&lt;br/&gt;
    &amp;lt;!-- Define a Proxied HTTP/1.1 Connector on port 8082 --&amp;gt;&lt;br/&gt;
    &amp;lt;!-- See proxy documentation for more information about using this. --&amp;gt;&lt;br/&gt;
    &amp;lt;!--&lt;br/&gt;
    &amp;lt;Connector port=&quot;8082&quot; &lt;br/&gt;
               maxThreads=&quot;150&quot; minSpareThreads=&quot;25&quot; maxSpareThreads=&quot;75&quot;&lt;br/&gt;
               enableLookups=&quot;false&quot;&lt;br/&gt;
               acceptCount=&quot;100&quot; debug=&quot;0&quot; connectionTimeout=&quot;20000&quot;&lt;br/&gt;
               proxyPort=&quot;80&quot; disableUploadTimeout=&quot;true&quot; /&amp;gt;&lt;br/&gt;
    --&amp;gt;&lt;br/&gt;
    &amp;lt;!-- An Engine represents the entry point (within Catalina) that processes&lt;br/&gt;
         every request.  The Engine implementation for Tomcat stand alone&lt;br/&gt;
         analyzes the HTTP headers included with the request, and passes them&lt;br/&gt;
         on to the appropriate Host (virtual host). --&amp;gt;&lt;br/&gt;
    &amp;lt;!-- You should set jvmRoute to support load-balancing via JK/JK2 ie :&lt;br/&gt;
    &amp;lt;Engine name=&quot;Standalone&quot; defaultHost=&quot;localhost&quot; debug=&quot;0&quot; &lt;br/&gt;
jvmRoute=&quot;jvm1&quot;&amp;gt;         &lt;br/&gt;
    --&amp;gt;&lt;br/&gt;
    &amp;lt;!-- Define the top level container in our container hierarchy --&amp;gt;&lt;br/&gt;
    &amp;lt;Engine name=&quot;Catalina&quot; defaultHost=&quot;localhost&quot; debug=&quot;0&quot;&amp;gt;&lt;br/&gt;
      &amp;lt;!-- The request dumper valve dumps useful debugging information about&lt;br/&gt;
           the request headers and cookies that were received, and the response&lt;br/&gt;
           headers and cookies that were sent, for all requests received by&lt;br/&gt;
           this instance of Tomcat.  If you care only about requests to a&lt;br/&gt;
           particular virtual host, or a particular application, nest this&lt;br/&gt;
           element inside the corresponding &amp;lt;Host&amp;gt; or &amp;lt;Context&amp;gt; entry instead.&lt;/p&gt;

&lt;p&gt;           For a similar mechanism that is portable to all Servlet 2.4&lt;br/&gt;
           containers, check out the &quot;RequestDumperFilter&quot; Filter in the&lt;br/&gt;
           example application (the source for this filter may be found in&lt;br/&gt;
           &quot;$CATALINA_HOME/webapps/examples/WEB-INF/classes/filters&quot;).&lt;/p&gt;

&lt;p&gt;           Request dumping is disabled by default.  Uncomment the following&lt;br/&gt;
           element to enable it. --&amp;gt;&lt;br/&gt;
      &amp;lt;!--&lt;br/&gt;
      &amp;lt;Valve className=&quot;org.apache.catalina.valves.RequestDumperValve&quot;/&amp;gt;&lt;br/&gt;
      --&amp;gt;&lt;br/&gt;
      &amp;lt;!-- Global logger unless overridden at lower levels --&amp;gt;&lt;br/&gt;
      &amp;lt;Logger className=&quot;org.apache.catalina.logger.FileLogger&quot;&lt;br/&gt;
        prefix=&quot;catalina_log.&quot; suffix=&quot;.txt&quot; timestamp=&quot;true&quot;/&amp;gt;&lt;br/&gt;
      &amp;lt;!-- Because this Realm is here, an instance will be shared globally --&amp;gt;&lt;br/&gt;
      &amp;lt;!-- This Realm uses the UserDatabase configured in the global JNDI&lt;br/&gt;
           resources under the key &quot;UserDatabase&quot;.  Any edits&lt;br/&gt;
           that are performed against this UserDatabase are immediately&lt;br/&gt;
           available for use by the Realm.  --&amp;gt;&lt;br/&gt;
      &amp;lt;Realm className=&quot;org.apache.catalina.realm.UserDatabaseRealm&quot;&lt;br/&gt;
        debug=&quot;0&quot; resourceName=&quot;UserDatabase&quot;/&amp;gt;&lt;br/&gt;
      &amp;lt;!-- Comment out the old realm but leave here for now in case we&lt;br/&gt;
           need to go back quickly --&amp;gt;&lt;br/&gt;
      &amp;lt;!--&lt;br/&gt;
      &amp;lt;Realm className=&quot;org.apache.catalina.realm.MemoryRealm&quot; /&amp;gt;&lt;br/&gt;
      --&amp;gt;&lt;br/&gt;
      &amp;lt;!-- Replace the above Realm with one of the following to get a Realm&lt;br/&gt;
           stored in a database and accessed via JDBC --&amp;gt;&lt;br/&gt;
      &amp;lt;!--&lt;br/&gt;
      &amp;lt;Realm  className=&quot;org.apache.catalina.realm.JDBCRealm&quot; debug=&quot;99&quot;&lt;br/&gt;
             driverName=&quot;org.gjt.mm.mysql.Driver&quot;&lt;br/&gt;
          connectionURL=&quot;jdbc:mysql://localhost/authority&quot;&lt;br/&gt;
         connectionName=&quot;test&quot; connectionPassword=&quot;test&quot;&lt;br/&gt;
              userTable=&quot;users&quot; userNameCol=&quot;user_name&quot; userCredCol=&quot;user_pass&quot;&lt;br/&gt;
          userRoleTable=&quot;user_roles&quot; roleNameCol=&quot;role_name&quot; /&amp;gt;&lt;br/&gt;
      --&amp;gt;&lt;br/&gt;
      &amp;lt;!--&lt;br/&gt;
      &amp;lt;Realm  className=&quot;org.apache.catalina.realm.JDBCRealm&quot; debug=&quot;99&quot;&lt;br/&gt;
             driverName=&quot;oracle.jdbc.driver.OracleDriver&quot;&lt;br/&gt;
          connectionURL=&quot;jdbc:oracle:thin:@ntserver:1521:ORCL&quot;&lt;br/&gt;
         connectionName=&quot;scott&quot; connectionPassword=&quot;tiger&quot;&lt;br/&gt;
              userTable=&quot;users&quot; userNameCol=&quot;user_name&quot; userCredCol=&quot;user_pass&quot;&lt;br/&gt;
          userRoleTable=&quot;user_roles&quot; roleNameCol=&quot;role_name&quot; /&amp;gt;&lt;br/&gt;
      --&amp;gt;&lt;br/&gt;
      &amp;lt;!--&lt;br/&gt;
      &amp;lt;Realm  className=&quot;org.apache.catalina.realm.JDBCRealm&quot; debug=&quot;99&quot;&lt;br/&gt;
             driverName=&quot;sun.jdbc.odbc.JdbcOdbcDriver&quot;&lt;br/&gt;
          connectionURL=&quot;jdbc:odbc:CATALINA&quot;&lt;br/&gt;
              userTable=&quot;users&quot; userNameCol=&quot;user_name&quot; userCredCol=&quot;user_pass&quot;&lt;br/&gt;
          userRoleTable=&quot;user_roles&quot; roleNameCol=&quot;role_name&quot; /&amp;gt;&lt;br/&gt;
      --&amp;gt;&lt;br/&gt;
      &amp;lt;!-- Define the default virtual host&lt;br/&gt;
           Note: XML Schema validation will not work with Xerces 2.2.&lt;br/&gt;
       --&amp;gt;&lt;br/&gt;
      &amp;lt;Host name=&quot;localhost&quot; debug=&quot;0&quot; appBase=&quot;webapps&quot;&lt;br/&gt;
        unpackWARs=&quot;true&quot; autoDeploy=&quot;true&quot; xmlValidation=&quot;false&quot; &lt;br/&gt;
xmlNamespaceAware=&quot;false&quot;&amp;gt;&lt;br/&gt;
        &amp;lt;!-- Defines a cluster for this node,&lt;br/&gt;
             By defining this element, means that every manager will be changed.&lt;br/&gt;
             So when running a cluster, only make sure that you have webapps in &lt;br/&gt;
there&lt;br/&gt;
             that need to be clustered and remove the other ones.&lt;br/&gt;
             A cluster has the following parameters:&lt;/p&gt;

&lt;p&gt;             className = the fully qualified name of the cluster class&lt;/p&gt;

&lt;p&gt;             name = a descriptive name for your cluster, can be anything&lt;/p&gt;

&lt;p&gt;             debug = the debug level, higher means more output&lt;/p&gt;

&lt;p&gt;             mcastAddr = the multicast address, has to be the same for all the &lt;br/&gt;
nodes&lt;/p&gt;

&lt;p&gt;             mcastPort = the multicast port, has to be the same for all the &lt;br/&gt;
nodes&lt;/p&gt;

&lt;p&gt;             mcastFrequency = the number of milliseconds in between sending &lt;br/&gt;
a &quot;I&apos;m alive&quot; heartbeat&lt;/p&gt;

&lt;p&gt;             mcastDropTime = the number a milliseconds before a node is &lt;br/&gt;
considered &quot;dead&quot; if no heartbeat is received&lt;/p&gt;

&lt;p&gt;             tcpThreadCount = the number of threads to handle incoming &lt;br/&gt;
replication requests, optimal would be the same amount of threads as nodes &lt;/p&gt;

&lt;p&gt;             tcpListenAddress = the listen address (bind address) for TCP &lt;br/&gt;
cluster request on this host, &lt;br/&gt;
                                in case of multiple ethernet cards.&lt;br/&gt;
                                auto means that address becomes&lt;br/&gt;
                                InetAddress.getLocalHost().getHostAddress()&lt;/p&gt;

&lt;p&gt;             tcpListenPort = the tcp listen port&lt;/p&gt;

&lt;p&gt;             tcpSelectorTimeout = the timeout (ms) for the Selector.select() &lt;br/&gt;
method in case the OS&lt;br/&gt;
                                  has a wakup bug in java.nio. Set to 0 for no &lt;br/&gt;
timeout&lt;/p&gt;

&lt;p&gt;             printToScreen = true means that managers will also print to std.out&lt;/p&gt;

&lt;p&gt;             expireSessionsOnShutdown = true means that &lt;/p&gt;

&lt;p&gt;             useDirtyFlag = true means that we only replicate a session after &lt;br/&gt;
setAttribute,removeAttribute has been called.&lt;br/&gt;
                            false means to replicate the session after each &lt;br/&gt;
request.&lt;br/&gt;
                            false means that replication would work for the &lt;br/&gt;
following piece of code:&lt;br/&gt;
                            &amp;lt;%&lt;br/&gt;
                            HashMap map = (HashMap)session.getAttribute(&quot;map&quot;);&lt;br/&gt;
                            map.put(&quot;key&quot;,&quot;value&quot;);&lt;br/&gt;
                            %&amp;gt;&lt;br/&gt;
             replicationMode = can be either &apos;pooled&apos;, &apos;synchronous&apos; &lt;br/&gt;
or &apos;asynchronous&apos;.&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Pooled means that the replication happens&lt;br/&gt;
using several sockets in a synchronous way. Ie, the data gets replicated, then &lt;br/&gt;
the request return. This is the same as the &apos;synchronous&apos; setting except it &lt;br/&gt;
uses a pool of sockets, hence it is multithreaded. This is the fastest and &lt;br/&gt;
safest configuration. To use this, also increase the nr of tcp threads that you &lt;br/&gt;
have dealing with replication.&lt;/li&gt;
	&lt;li&gt;Synchronous means that the thread that&lt;br/&gt;
executes the request, is also the&lt;br/&gt;
                               thread the replicates the data to the other &lt;br/&gt;
nodes, and will not return until all&lt;br/&gt;
                               nodes have received the information.&lt;/li&gt;
	&lt;li&gt;Asynchronous means that there is a&lt;br/&gt;
specific &apos;sender&apos; thread for each cluster node,&lt;br/&gt;
                               so the request thread will queue the replication &lt;br/&gt;
request into a &quot;smart&quot; queue,&lt;br/&gt;
                               and then return to the client.&lt;br/&gt;
                               The &quot;smart&quot; queue is a queue where when a &lt;br/&gt;
session is added to the queue, and the same session&lt;br/&gt;
                               already exists in the queue from a previous &lt;br/&gt;
request, that session will be replaced&lt;br/&gt;
                               in the queue instead of replicating two &lt;br/&gt;
requests. This almost never happens, unless there is a &lt;br/&gt;
                               large network delay.&lt;br/&gt;
        --&amp;gt;&lt;br/&gt;
        &amp;lt;!--&lt;br/&gt;
            When configuring for clustering, you also add in a valve to catch &lt;br/&gt;
all the requests&lt;br/&gt;
            coming in, at the end of the request, the session may or may not be &lt;br/&gt;
replicated.&lt;br/&gt;
            A session is replicated if and only if all the conditions are met:&lt;br/&gt;
            1. useDirtyFlag is true or setAttribute or removeAttribute has been &lt;br/&gt;
called AND&lt;br/&gt;
            2. a session exists (has been created)&lt;br/&gt;
            3. the request is not trapped by the &quot;filter&quot; attribute&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;            The filter attribute is to filter out requests that could not &lt;br/&gt;
modify the session,&lt;br/&gt;
            hence we don&apos;t replicate the session after the end of this request.&lt;br/&gt;
            The filter is negative, ie, anything you put in the filter, you &lt;br/&gt;
mean to filter out,&lt;br/&gt;
            ie, no replication will be done on requests that match one of the &lt;br/&gt;
filters.&lt;br/&gt;
            The filter attribute is delimited by ;, so you can&apos;t escape out ; &lt;br/&gt;
even if you wanted to.&lt;/p&gt;

&lt;p&gt;            filter=&quot;.&lt;b&gt;\.gif;.&lt;/b&gt;\.js;&quot; means that we will not replicate the &lt;br/&gt;
session after requests with the URI&lt;br/&gt;
            ending with .gif and .js are intercepted.&lt;br/&gt;
        --&amp;gt;&lt;br/&gt;
        &amp;lt;!--&lt;br/&gt;
        &amp;lt;Cluster className=&quot;org.apache.catalina.cluster.tcp.SimpleTcpCluster&quot;&lt;/p&gt;

&lt;p&gt;managerClassName=&quot;org.apache.catalina.cluster.session.DeltaManager&quot;&lt;br/&gt;
                 expireSessionsOnShutdown=&quot;false&quot;&lt;br/&gt;
                 useDirtyFlag=&quot;true&quot;&amp;gt;&lt;/p&gt;

&lt;p&gt;            &amp;lt;Membership &lt;br/&gt;
                className=&quot;org.apache.catalina.cluster.mcast.McastService&quot;&lt;br/&gt;
                mcastAddr=&quot;228.0.0.4&quot;&lt;br/&gt;
                mcastPort=&quot;45564&quot;&lt;br/&gt;
                mcastFrequency=&quot;500&quot;&lt;br/&gt;
                mcastDropTime=&quot;3000&quot;/&amp;gt;&lt;/p&gt;

&lt;p&gt;            &amp;lt;Receiver &lt;br/&gt;
                className=&quot;org.apache.catalina.cluster.tcp.ReplicationListener&quot;&lt;br/&gt;
                tcpListenAddress=&quot;auto&quot;&lt;br/&gt;
                tcpListenPort=&quot;4001&quot;&lt;br/&gt;
                tcpSelectorTimeout=&quot;100&quot;&lt;br/&gt;
                tcpThreadCount=&quot;6&quot;/&amp;gt;&lt;/p&gt;

&lt;p&gt;            &amp;lt;Sender&lt;/p&gt;

&lt;p&gt;className=&quot;org.apache.catalina.cluster.tcp.ReplicationTransmitter&quot;&lt;br/&gt;
                replicationMode=&quot;pooled&quot;/&amp;gt;&lt;/p&gt;

&lt;p&gt;            &amp;lt;Valve className=&quot;org.apache.catalina.cluster.tcp.ReplicationValve&quot;&lt;br/&gt;
                   filter=&quot;.&lt;b&gt;\.gif;.&lt;/b&gt;\.js;.&lt;b&gt;\.jpg;.&lt;/b&gt;\.htm;.&lt;b&gt;\.html;.&lt;/b&gt;\.txt;&quot;/&amp;gt;&lt;br/&gt;
        &amp;lt;/Cluster&amp;gt;&lt;br/&gt;
        --&amp;gt;&lt;br/&gt;
        &amp;lt;!-- Normally, users must authenticate themselves to each web app&lt;br/&gt;
             individually.  Uncomment the following entry if you would like&lt;br/&gt;
             a user to be authenticated the first time they encounter a&lt;br/&gt;
             resource protected by a security constraint, and then have that&lt;br/&gt;
             user identity maintained across &lt;b&gt;all&lt;/b&gt; web applications contained&lt;br/&gt;
             in this virtual host. --&amp;gt;&lt;br/&gt;
        &amp;lt;!--&lt;br/&gt;
        &amp;lt;Valve className=&quot;org.apache.catalina.authenticator.SingleSignOn&quot;&lt;br/&gt;
                   debug=&quot;0&quot;/&amp;gt;&lt;br/&gt;
        --&amp;gt;&lt;br/&gt;
        &amp;lt;!-- Access log processes all requests for this virtual host.  By&lt;br/&gt;
             default, log files are created in the &quot;logs&quot; directory relative to&lt;br/&gt;
             $CATALINA_HOME.  If you wish, you can specify a different&lt;br/&gt;
             directory with the &quot;directory&quot; attribute.  Specify either a &lt;br/&gt;
relative&lt;br/&gt;
             (to $CATALINA_HOME) or absolute path to the desired directory.&lt;br/&gt;
        --&amp;gt;&lt;br/&gt;
        &amp;lt;!--&lt;br/&gt;
        &amp;lt;Valve className=&quot;org.apache.catalina.valves.AccessLogValve&quot;&lt;br/&gt;
                 directory=&quot;logs&quot;  prefix=&quot;localhost_access_log.&quot; suffix=&quot;.txt&quot;&lt;br/&gt;
                 pattern=&quot;common&quot; resolveHosts=&quot;false&quot;/&amp;gt;&lt;br/&gt;
        --&amp;gt;&lt;br/&gt;
        &amp;lt;!-- Logger shared by all Contexts related to this virtual host.  By&lt;br/&gt;
             default (when using FileLogger), log files are created in &lt;br/&gt;
the &quot;logs&quot;&lt;br/&gt;
             directory relative to $CATALINA_HOME.  If you wish, you can specify&lt;br/&gt;
             a different directory with the &quot;directory&quot; attribute.  Specify &lt;br/&gt;
either a&lt;br/&gt;
             relative (to $CATALINA_HOME) or absolute path to the desired&lt;br/&gt;
             directory.--&amp;gt;&lt;br/&gt;
        &amp;lt;Logger className=&quot;org.apache.catalina.logger.FileLogger&quot;&lt;br/&gt;
          directory=&quot;logs&quot; prefix=&quot;localhost_log.&quot; suffix=&quot;.txt&quot; &lt;br/&gt;
timestamp=&quot;true&quot;/&amp;gt;&lt;br/&gt;
        &amp;lt;Context path=&quot;/weblog&quot;&lt;br/&gt;
          docBase=&quot;C:/eclipse3.0.1_exadel/eclipse/workspace/weblog/WebContent&quot;&lt;br/&gt;
          debug=&quot;0&quot; reloadable=&quot;true&quot;&amp;gt;&lt;br/&gt;
          &amp;lt;!-- User entered database schema global resource --&amp;gt;&lt;br/&gt;
          &amp;lt;Resource name=&quot;jdbc/weblog&quot; auth=&quot;Container&quot; &lt;br/&gt;
type=&quot;javax.sql.DataSource&quot;/&amp;gt;&lt;br/&gt;
          &amp;lt;ResourceParams name=&quot;jdbc/weblog&quot;&amp;gt;&lt;br/&gt;
            &amp;lt;parameter&amp;gt;&lt;br/&gt;
              &amp;lt;name&amp;gt;factory&amp;lt;/name&amp;gt;&lt;br/&gt;
              &amp;lt;value&amp;gt;org.apache.commons.dbcp.BasicDataSourceFactory&amp;lt;/value&amp;gt;&lt;br/&gt;
            &amp;lt;/parameter&amp;gt;&lt;br/&gt;
            &amp;lt;parameter&amp;gt;&lt;br/&gt;
              &amp;lt;name&amp;gt;driverClassName&amp;lt;/name&amp;gt;&lt;br/&gt;
              &amp;lt;value&amp;gt;oracle.jdbc.driver.OracleDriver&amp;lt;/value&amp;gt;&lt;br/&gt;
            &amp;lt;/parameter&amp;gt;&lt;br/&gt;
            &amp;lt;parameter&amp;gt;&lt;br/&gt;
              &amp;lt;name&amp;gt;url&amp;lt;/name&amp;gt;&lt;br/&gt;
              &amp;lt;value&amp;gt;jdbc:oracle:thin:TOGA53B@&lt;span class=&quot;error&quot;&gt;&amp;#91;my ip&amp;#93;&lt;/span&gt;:1521:TOGA2&amp;lt;/value&amp;gt;&lt;br/&gt;
            &amp;lt;/parameter&amp;gt;&lt;br/&gt;
            &amp;lt;parameter&amp;gt;&lt;br/&gt;
              &amp;lt;name&amp;gt;username&amp;lt;/name&amp;gt;&lt;br/&gt;
              &amp;lt;value&amp;gt;TOGA53B&amp;lt;/value&amp;gt;&lt;br/&gt;
            &amp;lt;/parameter&amp;gt;&lt;br/&gt;
            &amp;lt;parameter&amp;gt;&lt;br/&gt;
              &amp;lt;name&amp;gt;password&amp;lt;/name&amp;gt;&lt;br/&gt;
              &amp;lt;value&amp;gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;my password&amp;#93;&lt;/span&gt;&amp;lt;/value&amp;gt;&lt;br/&gt;
            &amp;lt;/parameter&amp;gt;&lt;br/&gt;
            &amp;lt;parameter&amp;gt;&lt;br/&gt;
              &amp;lt;name&amp;gt;maxActive&amp;lt;/name&amp;gt;&lt;br/&gt;
              &amp;lt;value&amp;gt;20&amp;lt;/value&amp;gt;&lt;br/&gt;
            &amp;lt;/parameter&amp;gt;&lt;br/&gt;
            &amp;lt;parameter&amp;gt;&lt;br/&gt;
              &amp;lt;name&amp;gt;maxIdle&amp;lt;/name&amp;gt;&lt;br/&gt;
              &amp;lt;value&amp;gt;10&amp;lt;/value&amp;gt;&lt;br/&gt;
            &amp;lt;/parameter&amp;gt;&lt;br/&gt;
            &amp;lt;parameter&amp;gt;&lt;br/&gt;
              &amp;lt;name&amp;gt;validationQuery&amp;lt;/name&amp;gt;&lt;br/&gt;
              &amp;lt;value&amp;gt;select 1 from dual&amp;lt;/value&amp;gt;&lt;br/&gt;
            &amp;lt;/parameter&amp;gt;&lt;br/&gt;
          &amp;lt;/ResourceParams&amp;gt;&lt;br/&gt;
        &amp;lt;/Context&amp;gt;&lt;br/&gt;
      &amp;lt;/Host&amp;gt;&lt;br/&gt;
    &amp;lt;/Engine&amp;gt;&lt;br/&gt;
  &amp;lt;/Service&amp;gt;&lt;br/&gt;
&amp;lt;/Server&amp;gt;&lt;/p&gt;

&lt;p&gt;My web.xml file is as follows:-&lt;/p&gt;

&lt;p&gt;&amp;lt;?xml version=&quot;1.0&quot; encoding=&quot;ISO-8859-1&quot;?&amp;gt;&lt;br/&gt;
&amp;lt;!DOCTYPE web-app PUBLIC &quot;-//Sun Microsystems, Inc.//DTD Web Application &lt;br/&gt;
2.3//EN&quot;&lt;br/&gt;
                         &quot;http://java.sun.com/dtd/web-app_2_3.dtd&quot;&amp;gt;&lt;br/&gt;
&amp;lt;web-app&amp;gt;&lt;br/&gt;
 &amp;lt;servlet&amp;gt;&lt;br/&gt;
  &amp;lt;servlet-name&amp;gt;action&amp;lt;/servlet-name&amp;gt;&lt;br/&gt;
  &amp;lt;servlet-class&amp;gt;org.apache.struts.action.ActionServlet&amp;lt;/servlet-class&amp;gt;&lt;br/&gt;
  &amp;lt;init-param&amp;gt;&lt;br/&gt;
   &amp;lt;param-name&amp;gt;config&amp;lt;/param-name&amp;gt;&lt;br/&gt;
   &amp;lt;param-value&amp;gt;/WEB-INF/struts-config.xml&amp;lt;/param-value&amp;gt;&lt;br/&gt;
  &amp;lt;/init-param&amp;gt;&lt;br/&gt;
  &amp;lt;load-on-startup&amp;gt;1&amp;lt;/load-on-startup&amp;gt;&lt;br/&gt;
 &amp;lt;/servlet&amp;gt;&lt;br/&gt;
 &amp;lt;servlet-mapping&amp;gt;&lt;br/&gt;
  &amp;lt;servlet-name&amp;gt;action&amp;lt;/servlet-name&amp;gt;&lt;br/&gt;
  &amp;lt;url-pattern&amp;gt;*.do&amp;lt;/url-pattern&amp;gt;&lt;br/&gt;
 &amp;lt;/servlet-mapping&amp;gt;&lt;br/&gt;
 &amp;lt;welcome-file-list&amp;gt;&lt;br/&gt;
  &amp;lt;welcome-file&amp;gt;index.jsp&amp;lt;/welcome-file&amp;gt;&lt;br/&gt;
 &amp;lt;/welcome-file-list&amp;gt;&lt;br/&gt;
 &amp;lt;taglib&amp;gt;&lt;br/&gt;
  &amp;lt;taglib-uri&amp;gt;/WEB-INF/struts-bean&amp;lt;/taglib-uri&amp;gt;&lt;br/&gt;
  &amp;lt;taglib-location&amp;gt;/WEB-INF/struts-bean.tld&amp;lt;/taglib-location&amp;gt;&lt;br/&gt;
 &amp;lt;/taglib&amp;gt;&lt;br/&gt;
 &amp;lt;taglib&amp;gt;&lt;br/&gt;
  &amp;lt;taglib-uri&amp;gt;/WEB-INF/struts-logic&amp;lt;/taglib-uri&amp;gt;&lt;br/&gt;
  &amp;lt;taglib-location&amp;gt;/WEB-INF/struts-logic.tld&amp;lt;/taglib-location&amp;gt;&lt;br/&gt;
 &amp;lt;/taglib&amp;gt;&lt;br/&gt;
 &amp;lt;taglib&amp;gt;&lt;br/&gt;
  &amp;lt;taglib-uri&amp;gt;/WEB-INF/struts-html&amp;lt;/taglib-uri&amp;gt;&lt;br/&gt;
  &amp;lt;taglib-location&amp;gt;/WEB-INF/struts-html.tld&amp;lt;/taglib-location&amp;gt;&lt;br/&gt;
 &amp;lt;/taglib&amp;gt;&lt;br/&gt;
 &amp;lt;taglib&amp;gt;&lt;br/&gt;
  &amp;lt;taglib-uri&amp;gt;/WEB-INF/struts-tiles&amp;lt;/taglib-uri&amp;gt;&lt;br/&gt;
  &amp;lt;taglib-location&amp;gt;/WEB-INF/struts-tiles.tld&amp;lt;/taglib-location&amp;gt;&lt;br/&gt;
 &amp;lt;/taglib&amp;gt;&lt;br/&gt;
 &amp;lt;taglib&amp;gt;&lt;br/&gt;
  &amp;lt;taglib-uri&amp;gt;/WEB-INF/struts-nested&amp;lt;/taglib-uri&amp;gt;&lt;br/&gt;
  &amp;lt;taglib-location&amp;gt;/WEB-INF/struts-nested.tld&amp;lt;/taglib-location&amp;gt;&lt;br/&gt;
 &amp;lt;/taglib&amp;gt;&lt;br/&gt;
 &amp;lt;taglib&amp;gt;&lt;br/&gt;
  &amp;lt;taglib-uri&amp;gt;/WEB-INF/sql&amp;lt;/taglib-uri&amp;gt;&lt;br/&gt;
  &amp;lt;taglib-location&amp;gt;/WEB-INF/sql.tld&amp;lt;/taglib-location&amp;gt;&lt;br/&gt;
 &amp;lt;/taglib&amp;gt;&lt;br/&gt;
 &amp;lt;taglib&amp;gt;&lt;br/&gt;
  &amp;lt;taglib-uri&amp;gt;/WEB-INF/fmt&amp;lt;/taglib-uri&amp;gt;&lt;br/&gt;
  &amp;lt;taglib-location&amp;gt;/WEB-INF/fmt.tld&amp;lt;/taglib-location&amp;gt;&lt;br/&gt;
 &amp;lt;/taglib&amp;gt;&lt;br/&gt;
 &amp;lt;taglib&amp;gt;&lt;br/&gt;
  &amp;lt;taglib-uri&amp;gt;/WEB-INF/c&amp;lt;/taglib-uri&amp;gt;&lt;br/&gt;
  &amp;lt;taglib-location&amp;gt;/WEB-INF/c.tld&amp;lt;/taglib-location&amp;gt;&lt;br/&gt;
 &amp;lt;/taglib&amp;gt;&lt;br/&gt;
 &amp;lt;taglib&amp;gt;&lt;br/&gt;
  &amp;lt;taglib-uri&amp;gt;/WEB-INF/x&amp;lt;/taglib-uri&amp;gt;&lt;br/&gt;
  &amp;lt;taglib-location&amp;gt;/WEB-INF/x.tld&amp;lt;/taglib-location&amp;gt;&lt;br/&gt;
 &amp;lt;/taglib&amp;gt;&lt;br/&gt;
 &amp;lt;resource-ref&amp;gt;&lt;br/&gt;
  &amp;lt;description&amp;gt;Oracle Datasource example&amp;lt;/description&amp;gt;&lt;br/&gt;
  &amp;lt;res-ref-name&amp;gt;jdbc/weblog&amp;lt;/res-ref-name&amp;gt;&lt;br/&gt;
  &amp;lt;res-type&amp;gt;javax.sql.DataSource&amp;lt;/res-type&amp;gt;&lt;br/&gt;
  &amp;lt;res-auth&amp;gt;Container&amp;lt;/res-auth&amp;gt;&lt;br/&gt;
 &amp;lt;/resource-ref&amp;gt; &lt;br/&gt;
&amp;lt;/web-app&amp;gt;&lt;/p&gt;


&lt;p&gt;The code that access the DataSource is as follows:-&lt;/p&gt;

&lt;p&gt;ds = (DataSource) initialContext.lookup(&quot;java:comp/env/jdbc/weblog&quot;);&lt;br/&gt;
Connection conn = ds.getConnection();&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: Windows NT&lt;br/&gt;
Platform: PC&lt;/p&gt;</environment>
        <key id="12342226">DBCP-124</key>
            <summary>[dbcp] NullPointerException thrown by PoolableConnectionFactory</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="4">Incomplete</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="nharvey@sopragroup.com">Neil</reporter>
                        <labels>
                    </labels>
                <created>Fri, 6 May 2005 01:10:19 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:33 +0000</updated>
                            <resolved>Tue, 25 Mar 2008 08:11:33 +0000</resolved>
                                    <version>1.0</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12409285" author="dirkv@apache.org" created="Fri, 6 May 2005 15:44:31 +0000"  >&lt;p&gt;This is a commons-dbcp issue and is best handled on the commons-user mailing list:&lt;br/&gt;
&lt;a href=&quot;http://jakarta.apache.org/site/mail2.html#Commons&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://jakarta.apache.org/site/mail2.html#Commons&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Try removing the TOGA53B from and connection url and test again&lt;br/&gt;
jdbc:oracle:thin:TOGA53B@&lt;span class=&quot;error&quot;&gt;&amp;#91;my ip&amp;#93;&lt;/span&gt;:1521:TOGA2&lt;/p&gt;

&lt;p&gt;Otherwise please send you problem to the mailing list, don&apos;t forget to specify&lt;br/&gt;
the DBCP version you are using and the stackstrace of the first exception.&lt;/p&gt;</comment>
                            <comment id="12409286" author="yoavs@computer.org" created="Wed, 1 Jun 2005 11:03:02 +0000"  >&lt;p&gt;As Dirk said, a DBCP issue.&lt;/p&gt;</comment>
                            <comment id="12409287" author="dirkv@apache.org" created="Sat, 18 Jun 2005 20:26:28 +0000"  >&lt;p&gt;Closing issue as invalid (configuration error), contact mailing list if more&lt;br/&gt;
info is needed.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>34765</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114407</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            20 years, 21 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0v0gf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>179047</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-123] DBCP: org.apache.commons.dbcp.cpdsadapter.PooledConnectionImpl.close() does not always close physical connection</title>
                <link>https://issues.apache.org/jira/browse/DBCP-123</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;The code in file revision 1.2 of &lt;br/&gt;
org.apache.commons.dbcp.cpdsadapter.PooledConnectionImpl for the close() method &lt;br/&gt;
is:&lt;/p&gt;

&lt;p&gt;    /**&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Closes the physical connection and marks this&lt;/li&gt;
	&lt;li&gt;&amp;lt;code&amp;gt;PooledConnection&amp;lt;/code&amp;gt; so that it may not be used&lt;/li&gt;
	&lt;li&gt;to generate any more logical &amp;lt;code&amp;gt;Connection&amp;lt;/code&amp;gt;s.&lt;br/&gt;
     *&lt;/li&gt;
	&lt;li&gt;@exception SQLException if an error occurs&lt;br/&gt;
     */&lt;br/&gt;
    public void close()&lt;br/&gt;
        throws SQLException&lt;br/&gt;
    {        &lt;br/&gt;
        assertOpen();&lt;br/&gt;
        isClosed = true;&lt;br/&gt;
        if (pstmtPool != null) &lt;br/&gt;
        {&lt;br/&gt;
            try
            &lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {                try                {
                    pstmtPool.close();
                }&lt;br/&gt;
                finally&lt;br/&gt;
                {
                    pstmtPool = null;
                    connection.close();
                }&lt;br/&gt;
            }&lt;br/&gt;
            catch (Exception e)&lt;br/&gt;
            {&lt;br/&gt;
                if (e instanceof RuntimeException) &lt;br/&gt;
                {
                    throw (RuntimeException)e;
                }&lt;br/&gt;
                else &lt;br/&gt;
                {
                    throw new SQLException(e.getMessage());
                }&lt;br/&gt;
            }&lt;br/&gt;
        }&lt;br/&gt;
    }&lt;br/&gt;
_____________________________&lt;br/&gt;
&lt;br/&gt;
I am not using prepared statement pooling, so in my case&lt;br/&gt;
connection.close();&lt;br/&gt;
never gets called.&lt;br/&gt;
The connections are marked as closed however, so the number of physical &lt;br/&gt;
connections goes up and up and up...&lt;br/&gt;
&lt;br/&gt;
I modified the close() method in the following way.&lt;br/&gt;
&lt;br/&gt;
    /**&lt;br/&gt;
     * Closes the physical connection and marks this &lt;br/&gt;
     * &amp;lt;code&amp;gt;PooledConnection&amp;lt;/code&amp;gt; so that it may not be used &lt;br/&gt;
     * to generate any more logical &amp;lt;code&amp;gt;Connection&amp;lt;/code&amp;gt;s.&lt;br/&gt;
     *&lt;br/&gt;
     * @exception SQLException if an error occurs&lt;br/&gt;
     */&lt;br/&gt;
    public void close()&lt;br/&gt;
        throws SQLException&lt;br/&gt;
    {        &lt;br/&gt;
        assertOpen();&lt;br/&gt;
        isClosed = true;&lt;br/&gt;
        try&lt;br/&gt;
        {&lt;br/&gt;
			if (pstmtPool != null) &lt;br/&gt;
			{&lt;br/&gt;
                try&lt;br/&gt;
                {                    pstmtPool.close();                }                finally                {
                    pstmtPool = null;
                }			}&lt;/span&gt; &lt;/div&gt;
&lt;p&gt;        }&lt;br/&gt;
        catch (Exception e)&lt;/p&gt;
        &lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {            if (e instanceof RuntimeException)             {
                throw (RuntimeException)e;
            }            else             {
                throw new SQLException(e.getMessage());
            }        }&lt;/span&gt; &lt;/div&gt;
&lt;p&gt;		finally&lt;/p&gt;
		{
			connection.close();
		}
&lt;p&gt;    }&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;___________________&lt;br/&gt;
I would welcome comments, remarks, improvements on this patch.&lt;br/&gt;
And if my changed are judged to be correct, can someone submit this to cvs?&lt;/p&gt;

&lt;p&gt;Regards,&lt;/p&gt;

&lt;p&gt;Remke Rutgers&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: All&lt;br/&gt;
Platform: All&lt;/p&gt;</environment>
        <key id="12340560">DBCP-123</key>
            <summary>DBCP: org.apache.commons.dbcp.cpdsadapter.PooledConnectionImpl.close() does not always close physical connection</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="remke.rutgers@brightalley.nl">Remke Rutgers</reporter>
                        <labels>
                    </labels>
                <created>Wed, 19 Feb 2003 21:10:11 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:33 +0000</updated>
                            <resolved>Tue, 25 Mar 2008 08:11:33 +0000</resolved>
                                    <version>Nightly Builds</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12403673" author="rwaldhoff@apache.org" created="Thu, 6 Mar 2003 23:12:17 +0000"  >&lt;p&gt;Change applied.  Thanks Remke.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>17200</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114406</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            22 years, 36 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uxa7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178533</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-122] dbcp build fails with java 1.4</title>
                <link>https://issues.apache.org/jira/browse/DBCP-122</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;The DBCP build fails with java 1.4, here are the errors generated by ant/javac.&lt;/p&gt;

&lt;p&gt;init:&lt;/p&gt;

&lt;p&gt;build-java:&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;javac&amp;#93;&lt;/span&gt; Compiling 17 source files to&lt;br/&gt;
/export/home/staff/glenn/jakarta/jakarta-commons/dbcp/dist/classes&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;javac&amp;#93;&lt;/span&gt;&lt;br/&gt;
/export/home/staff/glenn/jakarta/jakarta-commons/dbcp/src/java/org/apache/commons/dbcp/DelegatingConnection.java:78:&lt;br/&gt;
org.apache.commons.dbcp.DelegatingConnection should be declared abstract; it&lt;br/&gt;
does not define setHoldability(int) in&lt;br/&gt;
org.apache.commons.dbcp.DelegatingConnection&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;javac&amp;#93;&lt;/span&gt; public class DelegatingConnection implements Connection {&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;javac&amp;#93;&lt;/span&gt;        ^&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;javac&amp;#93;&lt;/span&gt;&lt;br/&gt;
/export/home/staff/glenn/jakarta/jakarta-commons/dbcp/src/java/org/apache/commons/dbcp/DelegatingPreparedStatement.java:80:&lt;br/&gt;
org.apache.commons.dbcp.DelegatingPreparedStatement should be declared abstract;&lt;br/&gt;
it does not define getMoreResults(int) in&lt;br/&gt;
org.apache.commons.dbcp.DelegatingPreparedStatement&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;javac&amp;#93;&lt;/span&gt; public class DelegatingPreparedStatement implements&lt;br/&gt;
PreparedStatement {&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;javac&amp;#93;&lt;/span&gt;        ^&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;javac&amp;#93;&lt;/span&gt;&lt;br/&gt;
/export/home/staff/glenn/jakarta/jakarta-commons/dbcp/src/java/org/apache/commons/dbcp/DelegatingPreparedStatement.java:80:&lt;br/&gt;
warning: setUnicodeStream(int,java.io.InputStream,int) in&lt;br/&gt;
java.sql.PreparedStatement has been deprecated&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;javac&amp;#93;&lt;/span&gt; public class DelegatingPreparedStatement implements&lt;br/&gt;
PreparedStatement {&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;javac&amp;#93;&lt;/span&gt;        ^&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;javac&amp;#93;&lt;/span&gt;&lt;br/&gt;
/export/home/staff/glenn/jakarta/jakarta-commons/dbcp/src/java/org/apache/commons/dbcp/DelegatingPreparedStatement.java:178:&lt;br/&gt;
warning: setUnicodeStream(int,java.io.InputStream,int) in&lt;br/&gt;
java.sql.PreparedStatement has been deprecated&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;javac&amp;#93;&lt;/span&gt;     public void setUnicodeStream(int parameterIndex,&lt;br/&gt;
java.io.InputStream x, int length) throws SQLException &lt;/p&gt;
{ checkOpen();
_stmt.setUnicodeStream(parameterIndex,x,length);}

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;javac&amp;#93;&lt;/span&gt;                                                                                                                                &lt;br/&gt;
^&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;javac&amp;#93;&lt;/span&gt;&lt;br/&gt;
/export/home/staff/glenn/jakarta/jakarta-commons/dbcp/src/java/org/apache/commons/dbcp/DelegatingStatement.java:76:&lt;br/&gt;
org.apache.commons.dbcp.DelegatingStatement should be declared abstract; it does&lt;br/&gt;
not define getMoreResults(int) in org.apache.commons.dbcp.DelegatingStatement&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;javac&amp;#93;&lt;/span&gt; public class DelegatingStatement implements Statement {&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;javac&amp;#93;&lt;/span&gt;        ^&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;javac&amp;#93;&lt;/span&gt;&lt;br/&gt;
/export/home/staff/glenn/jakarta/jakarta-commons/dbcp/src/java/org/apache/commons/dbcp/PoolablePreparedStatement.java:79:&lt;br/&gt;
warning: setUnicodeStream(int,java.io.InputStream,int) in&lt;br/&gt;
java.sql.PreparedStatement has been deprecated&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;javac&amp;#93;&lt;/span&gt; public class PoolablePreparedStatement extends&lt;br/&gt;
DelegatingPreparedStatement implements PreparedStatement {&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;javac&amp;#93;&lt;/span&gt;        ^&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;javac&amp;#93;&lt;/span&gt; 3 errors&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;javac&amp;#93;&lt;/span&gt; 3 warnings&lt;/p&gt;

&lt;p&gt;BUILD FAILED&lt;/p&gt;

&lt;p&gt;This failure has also been identified with GUMP.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://nagoya.apache.org/~rubys/gump/java14/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://nagoya.apache.org/~rubys/gump/java14/&lt;/a&gt;&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: Solaris&lt;br/&gt;
Platform: Sun&lt;/p&gt;</environment>
        <key id="12340174">DBCP-122</key>
            <summary>dbcp build fails with java 1.4</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="glenn@apache.org">Glenn Nielsen</reporter>
                        <labels>
                    </labels>
                <created>Mon, 25 Feb 2002 22:39:56 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:33 +0000</updated>
                            <resolved>Tue, 25 Mar 2008 08:11:33 +0000</resolved>
                                    <version>Nightly Builds</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12402524" author="rwaldhof@us.britannica.com" created="Mon, 25 Feb 2002 23:04:25 +0000"  >&lt;p&gt;As you may know, this is caused by JDK 1.4/JDK 1.3 JDBC incompatiblities.&lt;/p&gt;

&lt;p&gt;I suppose one solution would be to add the new methods and throw &lt;br/&gt;
UnsupportedOperationException when invoked.  This would get around the compile-&lt;br/&gt;
time errors, but DBCP still wouldn&apos;t support JDK 1.4 fully.&lt;/p&gt;

&lt;p&gt;We may also be able to do this via reflection, or create a distinct JDK 1.4 &lt;br/&gt;
compatible build.&lt;/p&gt;

&lt;p&gt;Thoughts?  Feel free to reply to commons-dev@jakarta.apache.org&lt;/p&gt;</comment>
                            <comment id="12402525" author="rwaldhof@us.britannica.com" created="Tue, 23 Apr 2002 07:30:48 +0000"  >&lt;p&gt;fixed (not by me)&lt;/p&gt;</comment>
                            <comment id="12402526" author="rwaldhof@us.britannica.com" created="Tue, 23 Apr 2002 07:31:29 +0000"  >&lt;p&gt;(sorry trying to set this to resolved/fixed)&lt;/p&gt;</comment>
                            <comment id="12402527" author="rwaldhof@us.britannica.com" created="Tue, 23 Apr 2002 07:32:10 +0000"  >&lt;p&gt;(sorry, trying to set this to resolved-fixed)&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>6650</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114405</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            23 years, 30 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uwgf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178399</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-121] SharedPoolDataSource getConnection() throws ClassCastException</title>
                <link>https://issues.apache.org/jira/browse/DBCP-121</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;Hi there,&lt;br/&gt;
I am trying to develop a database webapplication using tomcat 5.0.16 with mysql &lt;br/&gt;
3.23.54 on redhat 9 linux.&lt;/p&gt;

&lt;p&gt;BasicDataSource works just fine until I try to swith the user credintials, i.e. &lt;br/&gt;
getConnection(String username, String password) does not work. It throws &lt;br/&gt;
UnsupportedOperation exception by definition.&lt;/p&gt;

&lt;p&gt;That is when I browsed the commons-dbcp looking for something else to find &lt;br/&gt;
SharedPoolDataSource that, as far as I understood, works on top of other pool &lt;br/&gt;
like BasicDataSource. When I tried to implement this, I got the following &lt;br/&gt;
exception when trying to call getConnection():&lt;br/&gt;
java.lang.ClassCastException&lt;br/&gt;
	org.apache.commons.dbcp.datasources.InstanceKeyDataSource.testCPDS&lt;br/&gt;
(InstanceKeyDataSource.java:738)&lt;br/&gt;
	org.apache.commons.dbcp.datasources.SharedPoolDataSource.registerPool&lt;br/&gt;
(SharedPoolDataSource.java:236)&lt;br/&gt;
	org.apache.commons.dbcp.datasources.SharedPoolDataSource.getPooledConnec&lt;br/&gt;
tionAndInfo(SharedPoolDataSource.java:205)&lt;br/&gt;
	org.apache.commons.dbcp.datasources.InstanceKeyDataSource.getConnection&lt;br/&gt;
(InstanceKeyDataSource.java:676)&lt;br/&gt;
	org.apache.commons.dbcp.datasources.InstanceKeyDataSource.getConnection&lt;br/&gt;
(InstanceKeyDataSource&lt;/p&gt;

&lt;p&gt;which is, obviously, internal to commons-dbcp. The JNDI lookup works just fine. &lt;br/&gt;
It is only the getConnection().&lt;/p&gt;

&lt;p&gt;I am using a BasicDataSourceFactory to generate DataSource objects which I use, &lt;br/&gt;
in turn, as dataSourcName parameter to the SharedPoolDataSourceFactory &lt;br/&gt;
generating SharedPoolDataSource objects. I look up only the &lt;br/&gt;
SharedPoolDataSource object and call its getConnection() method and there you &lt;br/&gt;
go. ClassCastException!&lt;/p&gt;

&lt;p&gt;PS. If there is another way of being able to swith connection credintials it &lt;br/&gt;
would be helpful, too.&lt;/p&gt;

&lt;p&gt;Thanks,&lt;br/&gt;
Ahmad&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: Linux&lt;br/&gt;
Platform: PC&lt;/p&gt;</environment>
        <key id="12341173">DBCP-121</key>
            <summary>SharedPoolDataSource getConnection() throws ClassCastException</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="akhayyat@ccse.kfupm.edu.sa">Ahmad Khayyat</reporter>
                        <labels>
                    </labels>
                <created>Fri, 26 Dec 2003 10:36:29 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:33 +0000</updated>
                            <resolved>Tue, 25 Mar 2008 08:11:33 +0000</resolved>
                                    <version>1.1</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12405714" author="dirkv" created="Fri, 26 Dec 2003 21:24:06 +0000"  >&lt;p&gt;The underlying datasource providing the physical connections to the&lt;br/&gt;
PerUserPoolDataSource &amp;amp; SharedPoolDataSource should implement the&lt;br/&gt;
javax.sql.ConnectionPoolDataSource interface.&lt;br/&gt;
BasicDataSource doesn&apos;t implement this interface and therefor cannot be used in&lt;br/&gt;
this configuration.&lt;br/&gt;
I have improved the error message when this illegal configuration is detected.&lt;/p&gt;

&lt;p&gt;The actual solution is to use the cpdsadapter. &lt;br/&gt;
See:&lt;br/&gt;
&lt;a href=&quot;http://jakarta.apache.org/commons/dbcp/apidocs/org/apache/commons/dbcp/datasources/package-summary.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://jakarta.apache.org/commons/dbcp/apidocs/org/apache/commons/dbcp/datasources/package-summary.html&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;http://jakarta.apache.org/commons/dbcp/apidocs/org/apache/commons/dbcp/cpdsadapter/package-summary.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://jakarta.apache.org/commons/dbcp/apidocs/org/apache/commons/dbcp/cpdsadapter/package-summary.html&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>25762</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114404</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            21 years, 46 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uxv3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178627</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-120] DBCP - Bad DB Validation Query Hangs Everything</title>
                <link>https://issues.apache.org/jira/browse/DBCP-120</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;If the ValidationQuery assigned to a BasicDataSource is bogus (or typed wrong), &lt;br/&gt;
the getConnection()  will just hang, and hang, and hang...  For example, try&lt;br/&gt;
SELECT * FROM X&lt;br/&gt;
or SELECT * FROM DUAL;   &amp;lt;=  note the semicolon which is invalid&lt;/p&gt;

&lt;p&gt;I am running against an Oracle 9i DB with the thinODBC Oracle driver.&lt;/p&gt;

&lt;p&gt;Thanks,&lt;br/&gt;
Ann&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: All&lt;br/&gt;
Platform: PC&lt;/p&gt;</environment>
        <key id="12340957">DBCP-120</key>
            <summary>DBCP - Bad DB Validation Query Hangs Everything</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="ahorton@ix.netcom.com">Ann Horton</reporter>
                        <labels>
                    </labels>
                <created>Thu, 11 Sep 2003 03:00:21 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:33 +0000</updated>
                            <resolved>Tue, 25 Mar 2008 08:11:33 +0000</resolved>
                                    <version>1.0</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12405033" author="dirkv" created="Sun, 14 Sep 2003 07:28:58 +0000"  >&lt;p&gt;I added an extra test during the creation of the BasicDataSource to validate if&lt;br/&gt;
the validationQuery and other properties are valid. &lt;/p&gt;

&lt;p&gt;See method validateConnectionFactory&lt;br/&gt;
&lt;a href=&quot;http://cvs.apache.org/viewcvs.cgi/jakarta-commons/dbcp/src/java/org/apache/commons/dbcp/BasicDataSource.java.diff?r1=1.24&amp;amp;r2=1.25&amp;amp;diff_format=h&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://cvs.apache.org/viewcvs.cgi/jakarta-commons/dbcp/src/java/org/apache/commons/dbcp/BasicDataSource.java.diff?r1=1.24&amp;amp;r2=1.25&amp;amp;diff_format=h&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="12405034" author="dirkv" created="Sat, 20 Sep 2003 19:08:44 +0000"  >&lt;ul&gt;
	&lt;li&gt;
	&lt;ul&gt;
		&lt;li&gt;
		&lt;ul&gt;
			&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/DBCP-94&quot; title=&quot;SQLTransformer.java - infinite loop in getConnection&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DBCP-94&quot;&gt;&lt;del&gt;COM-29&lt;/del&gt;&lt;/a&gt; has been marked as a duplicate of this bug. ***&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>23081</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114403</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            22 years, 8 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uwpb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178439</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-119] DelegatingStatement.getResultSet() never returns null</title>
                <link>https://issues.apache.org/jira/browse/DBCP-119</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;The API documentation of java.sql.Statement.getResultSet() states: &quot;Returns: &lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;...&amp;#93;&lt;/span&gt; null if the result is an update count or there are no more results&quot;&lt;/p&gt;

&lt;p&gt;getResultSet() of DelegatingStatement always returns an instance of &lt;br/&gt;
DelegatingResultSet even if the delegate&apos;s ResultSet is null.&lt;br/&gt;
GetResultSet() should return null, if the delegate&apos;s ResultSet is null.&lt;/p&gt;

&lt;p&gt;The same applies to DelegatingPreparedStatement.&lt;/p&gt;

&lt;p&gt;Now to the good news: DelegatingCallableStatement.getResultSet() handles this &lt;br/&gt;
case correctly by calling DelegatingResultSet.wrapResultSet(). This method &lt;br/&gt;
checks the delegate&apos;s ResultSet.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: All&lt;br/&gt;
Platform: PC&lt;/p&gt;</environment>
        <key id="12341093">DBCP-119</key>
            <summary>DelegatingStatement.getResultSet() never returns null</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="4">Incomplete</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="r_jacobs@gmx.de">Ralph Jacobs</reporter>
                        <labels>
                    </labels>
                <created>Thu, 13 Nov 2003 17:50:28 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:33 +0000</updated>
                            <resolved>Tue, 25 Mar 2008 08:11:33 +0000</resolved>
                                    <version>1.1</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12405450" author="r_jacobs@gmx.de" created="Thu, 13 Nov 2003 23:02:45 +0000"  >&lt;p&gt;Additional info: If a DelegatingResultSet is created with the parameter &lt;br/&gt;
ResultSet set to null it will be added to the DelegatingStatement&apos;s trace.&lt;/p&gt;

&lt;p&gt;Upon closing the statement, close() of DelegatingResultSet calls _res.close() &lt;br/&gt;
with _res == null. Another NullPointerException will be generated.&lt;/p&gt;

&lt;p&gt;Instantiating a DelegatingResultSet with parameter ResultSet = null should be &lt;br/&gt;
treated as an error.&lt;/p&gt;</comment>
                            <comment id="12405451" author="r_jacobs@gmx.de" created="Thu, 13 Nov 2003 23:08:49 +0000"  >&lt;p&gt;And finally here&apos;s the test for the Statement:&lt;/p&gt;

&lt;p&gt;Call new DelegatingStatement(...).getResultSet().getWarnings();&lt;/p&gt;

&lt;p&gt;If the DelegatingResultSet has a ResultSet of null, a NullPointerException is &lt;br/&gt;
thrown by the method getWarnings().&lt;/p&gt;</comment>
                            <comment id="12405452" author="dirkv" created="Sat, 15 Nov 2003 07:04:50 +0000"  >&lt;p&gt;Both DelegatingStatement.getResultSet() and&lt;br/&gt;
DelegatingPreparedStatement.getResultSet() are using the&lt;br/&gt;
DelegatingResultSet.wrapResultSet method and are therefor protected against nulls.&lt;/p&gt;

&lt;p&gt;This was introduced on 2002/10/31 21:14:32 as a fix for issue 12733 and is&lt;br/&gt;
included in v1.1&lt;/p&gt;

&lt;p&gt;Please reopen only if you have a testcase against v1.1&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>24678</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114402</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            22 years, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0v0lr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>179071</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-118] Binary distribution missing package</title>
                <link>https://issues.apache.org/jira/browse/DBCP-118</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;The binary distributions of dbcp 1.0 appear to be missing the package &lt;br/&gt;
org.apache.commons.dbcp.jdbc2pool. I&apos;ve check both the .zip and the .tar.gz&lt;/p&gt;

&lt;p&gt;The source distro appears to have the package source included.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: other&lt;br/&gt;
Platform: PC&lt;/p&gt;</environment>
        <key id="12340662">DBCP-118</key>
            <summary>Binary distribution missing package</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="4">Incomplete</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="rduncan@bds.com">Rich Duncan</reporter>
                        <labels>
                    </labels>
                <created>Mon, 14 Apr 2003 08:07:53 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:32 +0000</updated>
                            <resolved>Tue, 25 Mar 2008 08:11:32 +0000</resolved>
                                    <version>1.0</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12404089" author="mohankishore@yahoo.com" created="Mon, 14 Apr 2003 08:43:36 +0000"  >&lt;p&gt;Seems to be delibrate??&lt;/p&gt;

&lt;p&gt;   &amp;lt;target name=&quot;copy-src&quot; depends=&quot;init&quot;&amp;gt;&lt;br/&gt;
      &amp;lt;mkdir dir=&quot;${dest.src}&quot;/&amp;gt;&lt;br/&gt;
      &amp;lt;!-- the source code directory --&amp;gt;&lt;br/&gt;
      &amp;lt;copy todir=&quot;${dest.src}&quot; filtering=&quot;yes&quot;&amp;gt;&lt;br/&gt;
         &amp;lt;fileset dir=&quot;${source.src.java}&quot; defaultexcludes=&quot;no&quot;&amp;gt;&lt;br/&gt;
            &amp;lt;include name=&quot;*&lt;b&gt;/&lt;/b&gt;.java&quot;/&amp;gt;&lt;br/&gt;
            &amp;lt;include name=&quot;*&lt;b&gt;/&lt;/b&gt;.xml&quot;/&amp;gt;&lt;br/&gt;
            &amp;lt;include name=&quot;*&lt;b&gt;/&lt;/b&gt;.properties&quot;/&amp;gt;&lt;br/&gt;
            &amp;lt;include name=&quot;**/package.html&quot;/&amp;gt;&lt;br/&gt;
            &amp;lt;!-- Temporarily omit &quot;jdbc2pool&quot; package --&amp;gt;&lt;br/&gt;
            &amp;lt;exclude name=&quot;*&lt;b&gt;/jdbc2pool/&lt;/b&gt;.java&quot;/&amp;gt;&lt;br/&gt;
         &amp;lt;/fileset&amp;gt;&lt;br/&gt;
      &amp;lt;/copy&amp;gt;&lt;br/&gt;
   &amp;lt;/target&amp;gt;&lt;/p&gt;</comment>
                            <comment id="12404090" author="mohankishore@yahoo.com" created="Mon, 14 Apr 2003 10:09:31 +0000"  >&lt;p&gt;The cvs commit message from rev 1.12:&lt;br/&gt;
Temporarily comment out compilation and documentation of the&lt;br/&gt;
&quot;org.apache.commons.dbcp.jdbc2pool&quot; package so that a 1.0 release of&lt;br/&gt;
&quot;dbcp&quot; can be created without a dependency on commons-lang.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>18982</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114401</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            22 years, 31 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0v0kf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>179065</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-117] Couldn&apos;t get connection (Jdbc2PoolDataSource)</title>
                <link>https://issues.apache.org/jira/browse/DBCP-117</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;This is a behaviour when using Jdbc2PoolDataSource.&lt;br/&gt;
When the first request to the ConnectionPool is given with a bad password. It &lt;br/&gt;
fails. But when the next request is given with the correct password, it still &lt;br/&gt;
gives a Login failed exception. I have a feeling that its retaining the old &lt;br/&gt;
connection.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: All&lt;br/&gt;
Platform: PC&lt;/p&gt;</environment>
        <key id="12340652">DBCP-117</key>
            <summary>Couldn&apos;t get connection (Jdbc2PoolDataSource)</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="srinath5177@hotmail.com">Srinath Narasimhan</reporter>
                        <labels>
                    </labels>
                <created>Thu, 10 Apr 2003 22:53:30 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:32 +0000</updated>
                            <resolved>Tue, 25 Mar 2008 08:11:32 +0000</resolved>
                                    <version>Nightly Builds</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12404014" author="dgraham@apache.org" created="Thu, 10 Apr 2003 23:06:23 +0000"  >&lt;p&gt;If the first request failed, there&apos;s no connection for it to be holding onto.&lt;/p&gt;</comment>
                            <comment id="12404015" author="srinath5177@hotmail.com" created="Thu, 10 Apr 2003 23:11:39 +0000"  >&lt;p&gt;May be not. That was just a thought. Do you have any idea why the second &lt;br/&gt;
request with the correct password is failing. May be the first request&apos;s &lt;br/&gt;
password is cached and that is used ? &lt;br/&gt;
Here is some more information, if it would help, if the first request is &lt;br/&gt;
correct, the second one is wrong password it fails, but the third one with the &lt;br/&gt;
right password succeeds. &lt;/p&gt;</comment>
                            <comment id="12404016" author="mohankishore@yahoo.com" created="Mon, 14 Apr 2003 05:43:49 +0000"  >&lt;p&gt;Created an attachment (id=5815)&lt;br/&gt;
Test class to verify the problem&lt;/p&gt;</comment>
                            <comment id="12404017" author="mohankishore@yahoo.com" created="Mon, 14 Apr 2003 06:00:17 +0000"  >&lt;p&gt;The Jdbc2PoolDataSource class uses the GenericKeyedObjectPool (in turn backed &lt;br/&gt;
by KeyedCPDSConnectionFactory) to get the connections when a &lt;br/&gt;
ConnectionPoolDataSource is used (i.e. as opposed to the case when the &lt;br/&gt;
DataSourceName is used to fetch from JNDI).&lt;/p&gt;

&lt;p&gt;In this case, the Jdbc2PoolDataSource create a UserPassKey based on the &lt;br/&gt;
username and password. But surprisingly, the equals() method in this class only &lt;br/&gt;
considers the username.&lt;/p&gt;

&lt;p&gt;Hence, if the initial login (with a particular username) is wrong, all &lt;br/&gt;
subsequent login attempts with that username keep failing - as the correponding &lt;br/&gt;
passwords are totally ignored.&lt;/p&gt;

&lt;p&gt;On the other hand, if the first login succeeds, all subsequent logins with the &lt;br/&gt;
same username succeed TO A POINT. After getting a connection, the code checks &lt;br/&gt;
to see that the new supplied password is the same as the old cached one, and &lt;br/&gt;
throws an exception if not.&lt;/p&gt;

&lt;p&gt;The fix would be to include the password in equals() method. And to ensure that &lt;br/&gt;
the getUserPassKey() method returns the correct object...&lt;/p&gt;</comment>
                            <comment id="12404018" author="mohankishore@yahoo.com" created="Mon, 14 Apr 2003 06:23:09 +0000"  >&lt;p&gt;Created an attachment (id=5816)&lt;br/&gt;
Implementation for the patch suggested&lt;/p&gt;</comment>
                            <comment id="12404019" author="dgraham@apache.org" created="Tue, 15 Apr 2003 08:39:03 +0000"  >&lt;p&gt;Fixed with the proposed solution.&lt;/p&gt;</comment>
                            <comment id="12404020" author="dgraham@apache.org" created="Tue, 15 Apr 2003 09:01:05 +0000"  >&lt;p&gt;The solution broke the test cases.  I added a test mimicing the reported &lt;br/&gt;
behavior but it ran fine.&lt;/p&gt;</comment>
                            <comment id="12404021" author="mohankishore@yahoo.com" created="Wed, 30 Apr 2003 00:04:04 +0000"  >&lt;p&gt;FYI&lt;/p&gt;

&lt;p&gt;Had investigated a little more on this. There are 2 problems with the test &lt;br/&gt;
setup:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;The TestDriver does not check for user/password i.e. it always returns a&lt;br/&gt;
valid connection. &lt;/li&gt;
	&lt;li&gt;The order in which the tests are run is very important. To test the reported&lt;br/&gt;
problem, this particular user should not have been used before. And then, the &lt;br/&gt;
first attempt should be with an incorrect password, followed by a correct one.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Feel the patch might be valid - but definitely needs a once over from someone &lt;br/&gt;
more familiar with the codebase...&lt;/p&gt;</comment>
                            <comment id="12404022" author="tagunov@motor.ru" created="Fri, 6 Jun 2003 16:49:29 +0000"  >&lt;p&gt;Just a quick glance examination:&lt;/p&gt;

&lt;p&gt;Jdbc2PoolDataSource.java&lt;/p&gt;

&lt;p&gt;    private UserPassKey &lt;br/&gt;
getUserPassKey(String username, String password)&lt;br/&gt;
    {&lt;br/&gt;
        UserPassKey key = &lt;br/&gt;
(UserPassKey)userKeys.get(username);&lt;br/&gt;
        if (key == null) &lt;/p&gt;
        {
            key = new 
UserPassKey(username, password);
            userKeys.put(username, key);
        }
&lt;p&gt;        return key;&lt;br/&gt;
    }&lt;/p&gt;


&lt;p&gt;It&apos;s here that you loose password.&lt;br/&gt;
The first time&lt;/p&gt;

&lt;p&gt;    getUserPassKey( &apos;user&apos;, &apos;bad-pass&apos; &lt;br/&gt;
)&lt;/p&gt;

&lt;p&gt;is invoked for &apos;user&apos; new UserPassKey( &apos;user&apos;, &apos;bad-pass&apos; ) is created.&lt;/p&gt;

&lt;p&gt;The next &lt;br/&gt;
time&lt;/p&gt;

&lt;p&gt;    getUserPassKey( &apos;user&apos;, &apos;good-pass&apos; )&lt;/p&gt;

&lt;p&gt;is invoked userKeys.get( &apos;user&apos; ) returns &lt;br/&gt;
the same object,&lt;br/&gt;
UserPassKey( &apos;user&apos;, &apos;bad-pass&apos; );&lt;/p&gt;

&lt;p&gt;That&apos;s how a stale password popps &lt;br/&gt;
up.&lt;br/&gt;
So either &lt;br/&gt;
1) a new UserPassKey should be created here, or&lt;br/&gt;
2) setPassword() method &lt;br/&gt;
should be added to UserPassKey.&lt;br/&gt;
   However I do not, probably some thread synchronization&lt;/p&gt;

&lt;p&gt;issues require UserPassKey being the key in a &lt;br/&gt;
   GenericKeyedObjectPool to be immutable, then &lt;br/&gt;
only 1)&lt;br/&gt;
   suits&lt;/p&gt;

&lt;p&gt;WBR, Anton&lt;/p&gt;</comment>
                            <comment id="12404023" author="tagunov@motor.ru" created="Fri, 6 Jun 2003 16:55:09 +0000"  >&lt;p&gt;Since there still is only one UserPassKey per user I personally would do two&lt;br/&gt;
things:&lt;/p&gt;

&lt;p&gt;1) &lt;br/&gt;
revert the prev patch and make UserPassKey.equals() still compare only&lt;br/&gt;
on the username&lt;/p&gt;

&lt;p&gt;2) &lt;br/&gt;
would probably nuke username and password member fields from&lt;br/&gt;
PooledConnectionAndInfo &amp;#8211; why &lt;br/&gt;
have them there since the same fields are accessible via .upkey.getUsername() and &lt;br/&gt;
.upkey.getPassword()&lt;/p&gt;

&lt;p&gt;?&lt;/p&gt;</comment>
                            <comment id="12404024" author="tagunov@motor.ru" created="Sun, 8 Jun 2003 15:12:48 +0000"  >&lt;p&gt;Implementing&lt;/p&gt;

&lt;p&gt;    getConnection( user, passwd )&lt;/p&gt;

&lt;p&gt;is a complicated thing with a &lt;br/&gt;
pooling&lt;br/&gt;
DataSource.&lt;/p&gt;

&lt;p&gt;The difficulty is what to do in&lt;br/&gt;
the following &lt;br/&gt;
situation:&lt;/p&gt;

&lt;p&gt;1)&lt;/p&gt;

&lt;p&gt;    getConnection( &quot;foo&quot;, &quot;bar&quot; );&lt;/p&gt;

&lt;p&gt;    The database allowes user &quot;foo&quot;&lt;/p&gt;

&lt;p&gt;with password &quot;bar&quot;&lt;/p&gt;

&lt;p&gt;2)&lt;/p&gt;

&lt;p&gt;    The connection is returned to pool&lt;/p&gt;

&lt;p&gt;3)    &lt;/p&gt;

&lt;p&gt;    getConnection( &lt;br/&gt;
&quot;foo&quot;, &quot;baz&quot; );&lt;/p&gt;

&lt;p&gt;What to do now?&lt;/p&gt;

&lt;p&gt;Basically there are three options:&lt;/p&gt;

&lt;p&gt;I)&lt;/p&gt;

&lt;p&gt;   Use &lt;br/&gt;
KeyedObjectPool and make the&lt;br/&gt;
   &lt;/p&gt;
{user,passwd}
&lt;p&gt; the key.&lt;/p&gt;

&lt;p&gt;II)&lt;/p&gt;

&lt;p&gt;   Consider that a user may have &lt;br/&gt;
only&lt;br/&gt;
   one correct password and refuse&lt;br/&gt;
   the second getConnection()&lt;/p&gt;

&lt;p&gt;III)&lt;/p&gt;

&lt;p&gt;   Always &lt;br/&gt;
attempt to create a connection&lt;br/&gt;
   when a new password for a user is&lt;br/&gt;
   supplied. Keep tract of &lt;br/&gt;
previously&lt;br/&gt;
   successfull passwords. (Last 100 for&lt;br/&gt;
   instance).&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;Clearly I) is not very &lt;br/&gt;
good. We may&lt;br/&gt;
have 10 connectons ready for &lt;/p&gt;
{&quot;foo&quot;,&quot;bar&quot;}
&lt;p&gt;and we will still create a new one &lt;br/&gt;
for&lt;/p&gt;
{&quot;foo&quot;, &quot;baz&quot;}
&lt;p&gt;.&lt;/p&gt;

&lt;p&gt;II) is very good, &lt;em&gt;if&lt;/em&gt; the assumption is&lt;br/&gt;
correct&lt;/p&gt;

&lt;p&gt;III) has its own &lt;br/&gt;
drawbacks: we will create&lt;br/&gt;
connections even when we do not need to.&lt;/p&gt;


&lt;hr /&gt;

&lt;p&gt;Also III) will &lt;br/&gt;
require a rewrite to KeyedObjectPool,&lt;br/&gt;
but this is an implementation issue.&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;It looks &lt;br/&gt;
that before fixing JDBC2DataSource we&lt;br/&gt;
should decide which of I), II), III) we want.&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;As &lt;br/&gt;
additional remarks: the current code in&lt;br/&gt;
JDBC2DataSource has caused some surprise &lt;br/&gt;
from&lt;br/&gt;
me:&lt;/p&gt;

&lt;p&gt;a) why use the master HashMap and an instaceId?&lt;br/&gt;
   Just to implement closeAll()?&lt;/p&gt;


&lt;p&gt;   But that is done easier: have a pool in instance&lt;br/&gt;
   variable, like m_pool and chain all &lt;br/&gt;
instance&lt;br/&gt;
   together via a LinkedList() or just via&lt;br/&gt;
   m_next pointer.&lt;/p&gt;

&lt;p&gt;b) why an ordianry, not &lt;br/&gt;
keyed, ObjectPool is sometimes&lt;br/&gt;
   created?  If we&apos;re enforcing (username, password)&lt;br/&gt;
   check, it &lt;br/&gt;
is impossible to implement also&lt;br/&gt;
   getConnection() in the same DataSource!&lt;/p&gt;

</comment>
                            <comment id="12404025" author="jmcnally" created="Mon, 9 Jun 2003 23:30:59 +0000"  >&lt;p&gt;I think option II, one password per user, is acceptable.  Is there a database&lt;br/&gt;
that allows multiple passwords per username?  It does not seem like a good&lt;br/&gt;
security policy.&lt;/p&gt;

&lt;p&gt;On the question of the master instance map, it is to allow for matching up of a&lt;br/&gt;
given instance of the datasource to the pooled connections.  If two places in&lt;br/&gt;
your code are requesting the datasource from jndi and are expecting connections&lt;br/&gt;
to the same db.  It is possible for jndi to return different objects to those&lt;br/&gt;
two lookups. &lt;/p&gt;</comment>
                            <comment id="12404026" author="tagunov@motor.ru" created="Tue, 10 Jun 2003 14:31:10 +0000"  >&lt;p&gt;I imagine we could configure f.e. MySQL to accept &lt;em&gt;any&lt;/em&gt; password for a given user, or am I &lt;br/&gt;
wrong?&lt;/p&gt;

&lt;p&gt;Yes, II make things &lt;em&gt;so&lt;/em&gt; much easier!&lt;/p&gt;

&lt;p&gt;Well, I did not look into the code deep &lt;br/&gt;
enough, maybe it is really necessary to have this master map and ids, but then there&apos;s apparently a &lt;br/&gt;
problem with synchronization: first registXXX synchronizes on this but it should synchronize &lt;br/&gt;
on this.getClass() I guess, to be proper. Then all the fetch operations from this common HashMap &lt;br/&gt;
must be synchronized. Or some *Bucket*HashMap from collections should be used that is fast yet &lt;br/&gt;
thread safe.&lt;/p&gt;

&lt;p&gt;And, is it possible to obtain a new id via&lt;/p&gt;

&lt;p&gt;final int newId;&lt;br/&gt;
synchronized( &lt;br/&gt;
this.getClass() )&lt;br/&gt;
{&lt;br/&gt;
     newId = _staticCounter++;&lt;br/&gt;
}&lt;/p&gt;

&lt;p&gt;instead of examining the existing &lt;br/&gt;
set of instances?&lt;/p&gt;</comment>
                            <comment id="12404027" author="dirkv" created="Mon, 11 Aug 2003 21:12:17 +0000"  >&lt;p&gt;Jdbc2PoolDataSource.registerPool didn&apos;t check if the supplied username/password&lt;br/&gt;
was correct. A broken pool was registered and the next call to getConnection&lt;br/&gt;
always used this pool.&lt;/p&gt;

&lt;p&gt;Now registerPool tries to connect and returns the SQLException if it fails.&lt;br/&gt;
(this fix solved the 3 testcases that were failing for me)&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12332225" name="ASF.LICENSE.NOT.GRANTED--B.java" size="1116" author="mohankishore@yahoo.com" created="Mon, 14 Apr 2003 05:43:49 +0000"/>
                            <attachment id="12332226" name="ASF.LICENSE.NOT.GRANTED--Patch.txt" size="2263" author="mohankishore@yahoo.com" created="Mon, 14 Apr 2003 06:23:09 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>18905</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114400</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            22 years, 14 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uwrz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178451</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-116] [dbcp] transactionIsolation,  testOnBorrow and autoCommmit=false crashes for Oracle</title>
                <link>https://issues.apache.org/jira/browse/DBCP-116</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;I&apos;m using dbcp nightly build 20050626 (i.e. &lt;a href=&quot;https://issues.apache.org/jira/browse/DBCP-20&quot; title=&quot;[DBCP] per-user pooling with Oracle driver and default isolation settings&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DBCP-20&quot;&gt;&lt;del&gt;COM-1666&lt;/del&gt;&lt;/a&gt; is fixed) to work with a&lt;br/&gt;
SharedPoolDataSource with an underlying oracle9i database and the 9.2.0.4 oracle&lt;br/&gt;
jdbc driver.&lt;br/&gt;
defaultTransactionIsolation is set to 8 (serializable), testOnBorrow is set to&lt;br/&gt;
true and defaultAutoCommit is set to false. (as an aside, with the oracle 10g&lt;br/&gt;
driver 10.1.0.4 the error also appears for defaultAutoCommit=true, but this is&lt;br/&gt;
an oracle problem) &lt;br/&gt;
I retrieve a connection, commit it, and close it. The first time works fine. The&lt;br/&gt;
second time while retrieving the connection, I get the ORA-01453: SET&lt;br/&gt;
TRANSACTION must be first statement of transaction error in the method&lt;br/&gt;
SharedPoolDataSource.setupDefaults upon execution of the line 215 :&lt;br/&gt;
con.setTransactionIsolation(defaultTransactionIsolation);&lt;br/&gt;
I have debugged the pool behaviour, extracted the jdbc commands and am able to&lt;br/&gt;
reproduce the behaviour with the following code:&lt;/p&gt;

&lt;p&gt;Connection connection = DriverManager.getConnection(sid, user, password);&lt;br/&gt;
connection.createStatement().execute(&quot;Select 1 from dual&quot;);&lt;br/&gt;
connection.setAutoCommit(false);&lt;br/&gt;
connection.setTransactionIsolation(&lt;br/&gt;
    Connection.TRANSACTION_SERIALIZABLE);&lt;br/&gt;
//connection.setReadOnly(false);  // not needed to get error&lt;br/&gt;
connection.commit();&lt;/p&gt;

&lt;p&gt;connection.createStatement().execute(&quot;Select 1 from dual&quot;);&lt;br/&gt;
// connection.rollback(); // this would solve the problem&lt;br/&gt;
                          // might be inserted into the validateObject()&lt;br/&gt;
                          // method of KeyedCPDSConnectionFactory&lt;br/&gt;
// connection.setAutoCommit(false); // not needed to get error&lt;br/&gt;
connection.setTransactionIsolation(&lt;br/&gt;
    Connection.TRANSACTION_SERIALIZABLE); // this causes the error&lt;/p&gt;

&lt;p&gt;I am not sure whether the rollback after the validation query fits into the&lt;br/&gt;
general philosophy of dbcp. Before I have come to use dbcp, I had programmed my&lt;br/&gt;
own pool and had done a rollback on every connection returned to the pool, in&lt;br/&gt;
order not to hand out a connection with a started transaction. In my opinion,&lt;br/&gt;
this is a good thing, but one might also argue against it because it eats&lt;br/&gt;
performance.&lt;/p&gt;

&lt;p&gt;Another solution would be to reverse the validation query /&lt;br/&gt;
setTransactionIsolation order, but it seems to me that this is very deep in the&lt;br/&gt;
pool architecture.&lt;/p&gt;

&lt;p&gt;Still another solution would be to reset autocommit to true when a connection is&lt;br/&gt;
returned into the pool, but personally I do not like this solution (it has no&lt;br/&gt;
additional merit like the rollback solution).&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: other&lt;br/&gt;
Platform: Other&lt;/p&gt;</environment>
        <key id="12342348">DBCP-116</key>
            <summary>[dbcp] transactionIsolation,  testOnBorrow and autoCommmit=false crashes for Oracle</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="fischer@seitenbau.de">Thomas Fischer</reporter>
                        <labels>
                    </labels>
                <created>Sun, 3 Jul 2005 08:13:26 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:32 +0000</updated>
                            <resolved>Mon, 18 Sep 2006 02:53:11 +0000</resolved>
                                    <version>Nightly Builds</version>
                                    <fixVersion>1.2.2</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12409719" author="fischer@seitenbau.de" created="Wed, 27 Jul 2005 18:05:34 +0000"  >&lt;p&gt;I would volunteer to patch and write a testcase for the bug. My idea would be to&lt;br/&gt;
add another configuration parameter, rollbackAfterValidation, which is set false&lt;br/&gt;
by default. If it is set true, it performs a rollback after every validation&lt;br/&gt;
query, which allows to set the connection to serializable afterwards.&lt;br/&gt;
I just would like to make sure that this general direction is ok for dbcp. Some&lt;br/&gt;
feedback would be nice.&lt;/p&gt;

&lt;p&gt;   Thanks,&lt;/p&gt;

&lt;p&gt;         Thomas&lt;/p&gt;</comment>
                            <comment id="12409720" author="fischer@seitenbau.de" created="Wed, 7 Sep 2005 23:30:32 +0000"  >&lt;p&gt;Created an attachment (id=16330)&lt;br/&gt;
testcase to show described behaviour&lt;/p&gt;

&lt;p&gt;The bug is produced in the test testRepeated. The other tests prove everything&lt;br/&gt;
else works as expected.&lt;br/&gt;
The classpatch must contain dbcp, its dependent libraries, and an oracle driver&lt;br/&gt;
jar(I used jdbc14.jar from oracle 9.2.0.6).&lt;br/&gt;
Somebody wanting to run the test must be able to connect to an oracle instance&lt;br/&gt;
(I used oracle 9.2.0.6). The system properties commons.dbcp.user,&lt;br/&gt;
commons.dbcp.password, and commons.dbcp.url must contain the connection info&lt;br/&gt;
for the oracle connection.&lt;/p&gt;</comment>
                            <comment id="12409721" author="fischer@seitenbau.de" created="Thu, 8 Sep 2005 00:29:33 +0000"  >&lt;p&gt;Created an attachment (id=16331)&lt;br/&gt;
proposed patch&lt;/p&gt;

&lt;p&gt;This patch resolves the problem using an additional configuration parameter,&lt;br/&gt;
rollbackAfterValidation. If set to true, dbcp issues a rollback after a&lt;br/&gt;
validation query is executed. The default is not to rollback, so backward&lt;br/&gt;
compatibility is assured. &lt;br/&gt;
The public API was only extended, no existing method signature was  modified.&lt;/p&gt;</comment>
                            <comment id="12409722" author="fischer@seitenbau.de" created="Thu, 8 Sep 2005 00:33:01 +0000"  >&lt;p&gt;Created an attachment (id=16332)&lt;br/&gt;
test case to ensure that the patch works&lt;/p&gt;

&lt;p&gt;This is a modification of the first test case. If run against the patched dbcp&lt;br/&gt;
version, no error should occur. The error can be reproduced by setting the&lt;br/&gt;
class variable ROLLBACK_AFTER_VALIDATION in the testcase to false.&lt;/p&gt;</comment>
                            <comment id="12435376" author="psteitz" created="Mon, 18 Sep 2006 02:53:11 +0000"  >&lt;p&gt;Patch applied.  Thanks!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12333608" name="ASF.LICENSE.NOT.GRANTED--TestSerializableOracleConnection.java" size="7889" author="fischer@seitenbau.de" created="Thu, 8 Sep 2005 00:33:01 +0000"/>
                            <attachment id="12333606" name="ASF.LICENSE.NOT.GRANTED--TestSerializableOracleConnection.java" size="6179" author="fischer@seitenbau.de" created="Wed, 7 Sep 2005 23:30:32 +0000"/>
                            <attachment id="12333607" name="ASF.LICENSE.NOT.GRANTED--patch_35591.txt" size="9138" author="fischer@seitenbau.de" created="Thu, 8 Sep 2005 00:29:33 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>35591</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114399</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            19 years, 8 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uxhr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178567</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-115] Poor performance under load</title>
                <link>https://issues.apache.org/jira/browse/DBCP-115</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;I&apos;m working with the JA-SIG uPortal under tomcat using &lt;br/&gt;
Oracles thin driver. &lt;/p&gt;

&lt;p&gt;I&apos;ve discovered that doing a Connection.close() was taking&lt;br/&gt;
longer and longer under heavy load.&lt;br/&gt;
I finally tracked it down to the synchronized statement &lt;br/&gt;
in GenericObjectPool::returnObject() (after having removed the&lt;br/&gt;
synchronized attribute of the AbandonedPool methods).&lt;/p&gt;

&lt;p&gt;I added some debugging statements like this:&lt;/p&gt;

&lt;p&gt;    public void returnObject(Object obj) throws Exception {&lt;br/&gt;
      long startTime = System.currentTimeMillis();&lt;br/&gt;
        boolean success = true;&lt;br/&gt;
        if(_testOnReturn &amp;amp;&amp;amp; !(_factory.validateObject(obj))) &lt;/p&gt;
{
            success = false;
        }
&lt;p&gt; else {&lt;br/&gt;
            try &lt;/p&gt;
{
                _factory.passivateObject(obj);
            }
&lt;p&gt; catch(Exception e) &lt;/p&gt;
{
                success = false;
            }
&lt;p&gt;        }&lt;/p&gt;

&lt;p&gt;        boolean shouldDestroy = !success;&lt;/p&gt;

&lt;p&gt;        long startTime3 = System.currentTimeMillis();&lt;br/&gt;
        synchronized(this) {&lt;br/&gt;
            long startTime2 = System.currentTimeMillis();&lt;br/&gt;
            _numActive--;&lt;br/&gt;
            if((_maxIdle &amp;gt; 0) &amp;amp;&amp;amp; (_pool.size() &amp;gt;= _maxIdle)) &lt;/p&gt;
{
                shouldDestroy = true;
            }
&lt;p&gt; else if(success) &lt;/p&gt;
{
                _pool.addFirst(new ObjectTimestampPair(obj));
            }
&lt;p&gt;            System.err.println(&quot;Thread.currentThread().getName() +&lt;br/&gt;
GenericObjectPool::returnObject:addFirst &quot; + (System.currentTimeMillis() -&lt;br/&gt;
startTime2));&lt;br/&gt;
            startTime2 = System.currentTimeMillis();&lt;br/&gt;
            notifyAll(); // _numActive has changed&lt;br/&gt;
            System.err.println(Thread.currentThread().getName() +&lt;br/&gt;
&quot;GenericObjectPool::returnObject:notify &quot; + (System.currentTimeMillis() -&lt;br/&gt;
startTime2));&lt;br/&gt;
        }&lt;br/&gt;
        System.err.println(Thread.currentThread().getName() +&lt;br/&gt;
&quot;GenericObjectPool::returnObject:synchronized &quot; + (System.currentTimeMillis() -&lt;br/&gt;
startTime3));&lt;br/&gt;
        if(shouldDestroy) {&lt;br/&gt;
            try &lt;/p&gt;
{
                _factory.destroyObject(obj);
                System.err.println(&quot;destroyed &quot; + obj);
            }
&lt;p&gt; catch(Exception e) &lt;/p&gt;
{
                // ignored
            }
&lt;p&gt;        }&lt;br/&gt;
        System.err.println(Thread.currentThread().getName() +&lt;br/&gt;
&quot;GenericObjectPool::returnObject: &quot; + (System.currentTimeMillis() - startTime) +&lt;br/&gt;
&quot;:: Active: &quot; + _numActive + &quot;, poolSize: &quot; + _pool.size());&lt;/p&gt;


&lt;p&gt;Here is a short example of the times I&apos;m seeing under load:&lt;/p&gt;

&lt;p&gt;HttpProcessor&lt;span class=&quot;error&quot;&gt;&amp;#91;8090&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;26&amp;#93;&lt;/span&gt;GenericObjectPool::returnObject:addFirst 0&lt;br/&gt;
HttpProcessor&lt;span class=&quot;error&quot;&gt;&amp;#91;8090&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;26&amp;#93;&lt;/span&gt;GenericObjectPool::returnObject:notify 0&lt;br/&gt;
HttpProcessor&lt;span class=&quot;error&quot;&gt;&amp;#91;8090&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;26&amp;#93;&lt;/span&gt;GenericObjectPool::returnObject:synchronized 8158&lt;br/&gt;
HttpProcessor&lt;span class=&quot;error&quot;&gt;&amp;#91;8090&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;26&amp;#93;&lt;/span&gt;GenericObjectPool::returnObject: 8158:: Active: 25,&lt;br/&gt;
poolSize: 3&lt;br/&gt;
HttpProcessor&lt;span class=&quot;error&quot;&gt;&amp;#91;8090&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;26&amp;#93;&lt;/span&gt;AbandonedPool::returnObject: 8158:: Active: 25, poolSize: 3&lt;br/&gt;
HttpProcessor&lt;span class=&quot;error&quot;&gt;&amp;#91;8090&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;26&amp;#93;&lt;/span&gt;PoolableConnection::returnObject: 8158&lt;br/&gt;
HttpProcessor&lt;span class=&quot;error&quot;&gt;&amp;#91;8090&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;25&amp;#93;&lt;/span&gt;GenericObjectPool::returnObject:addFirst 0&lt;br/&gt;
HttpProcessor&lt;span class=&quot;error&quot;&gt;&amp;#91;8090&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;25&amp;#93;&lt;/span&gt;GenericObjectPool::returnObject:notify 0&lt;br/&gt;
HttpProcessor&lt;span class=&quot;error&quot;&gt;&amp;#91;8090&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;25&amp;#93;&lt;/span&gt;GenericObjectPool::returnObject:synchronized 8497&lt;br/&gt;
HttpProcessor&lt;span class=&quot;error&quot;&gt;&amp;#91;8090&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;25&amp;#93;&lt;/span&gt;GenericObjectPool::returnObject: 8497:: Active: 28,&lt;br/&gt;
poolSize: 1&lt;br/&gt;
HttpProcessor&lt;span class=&quot;error&quot;&gt;&amp;#91;8090&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;25&amp;#93;&lt;/span&gt;AbandonedPool::returnObject: 8497:: Active: 28, poolSize: 1&lt;br/&gt;
HttpProcessor&lt;span class=&quot;error&quot;&gt;&amp;#91;8090&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;25&amp;#93;&lt;/span&gt;PoolableConnection::returnObject: 8497&lt;br/&gt;
HttpProcessor&lt;span class=&quot;error&quot;&gt;&amp;#91;8090&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;23&amp;#93;&lt;/span&gt;GenericObjectPool::returnObject:addFirst 0&lt;br/&gt;
HttpProcessor&lt;span class=&quot;error&quot;&gt;&amp;#91;8090&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;23&amp;#93;&lt;/span&gt;GenericObjectPool::returnObject:notify 0&lt;br/&gt;
HttpProcessor&lt;span class=&quot;error&quot;&gt;&amp;#91;8090&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;23&amp;#93;&lt;/span&gt;GenericObjectPool::returnObject:synchronized 8340&lt;br/&gt;
HttpProcessor&lt;span class=&quot;error&quot;&gt;&amp;#91;8090&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;23&amp;#93;&lt;/span&gt;GenericObjectPool::returnObject: 8342:: Active: 28,&lt;br/&gt;
poolSize: 1&lt;br/&gt;
HttpProcessor&lt;span class=&quot;error&quot;&gt;&amp;#91;8090&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;23&amp;#93;&lt;/span&gt;AbandonedPool::returnObject: 8342:: Active: 28, poolSize: 1&lt;br/&gt;
HttpProcessor&lt;span class=&quot;error&quot;&gt;&amp;#91;8090&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;23&amp;#93;&lt;/span&gt;PoolableConnection::returnObject: 8342&lt;br/&gt;
HttpProcessor&lt;span class=&quot;error&quot;&gt;&amp;#91;8090&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;2&amp;#93;&lt;/span&gt;GenericObjectPool::returnObject:addFirst 0&lt;br/&gt;
HttpProcessor&lt;span class=&quot;error&quot;&gt;&amp;#91;8090&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;2&amp;#93;&lt;/span&gt;GenericObjectPool::returnObject:notify 0&lt;br/&gt;
HttpProcessor&lt;span class=&quot;error&quot;&gt;&amp;#91;8090&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;2&amp;#93;&lt;/span&gt;GenericObjectPool::returnObject:synchronized 8333&lt;br/&gt;
HttpProcessor&lt;span class=&quot;error&quot;&gt;&amp;#91;8090&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;2&amp;#93;&lt;/span&gt;GenericObjectPool::returnObject: 8334:: Active: 27,&lt;br/&gt;
poolSize: 2&lt;br/&gt;
HttpProcessor&lt;span class=&quot;error&quot;&gt;&amp;#91;8090&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;2&amp;#93;&lt;/span&gt;AbandonedPool::returnObject: 8334:: Active: 27, poolSize: 2&lt;br/&gt;
HttpProcessor&lt;span class=&quot;error&quot;&gt;&amp;#91;8090&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;2&amp;#93;&lt;/span&gt;PoolableConnection::returnObject: 8334&lt;/p&gt;



&lt;p&gt;java version &quot;1.4.1_02&quot;&lt;br/&gt;
Java(TM) 2 Runtime Environment, Standard Edition (build 1.4.1_02-b06)&lt;br/&gt;
Java HotSpot(TM) Client VM (build 1.4.1_02-b06, mixed mode)&lt;/p&gt;


&lt;p&gt;And is it really necessary to notifyAll()? Why not use notify() instead&lt;br/&gt;
since the effect would be the same in this use?&lt;br/&gt;
Thanks&lt;/p&gt;


&lt;p&gt;   George&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: Linux&lt;br/&gt;
Platform: PC&lt;/p&gt;</environment>
        <key id="12340694">DBCP-115</key>
            <summary>Poor performance under load</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="george.lindholm@ubc.ca">George Lindholm</reporter>
                        <labels>
                    </labels>
                <created>Sat, 3 May 2003 04:07:17 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:32 +0000</updated>
                            <resolved>Tue, 25 Mar 2008 08:11:32 +0000</resolved>
                                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12404186" author="dirkv" created="Wed, 13 Aug 2003 19:59:06 +0000"  >&lt;p&gt;In my tests notifyAll() doesn&apos;t have a mayor impact.&lt;br/&gt;
Using notify() would require other changes as well.&lt;br/&gt;
(The thread that woke up should notify the next thread after getting its object)&lt;/p&gt;

&lt;p&gt;I only removed the &quot;synchronized&quot; from the borrowObject method.&lt;br/&gt;
Performance now much better.&lt;br/&gt;
See also the results from the new&lt;br/&gt;
org.apache.commons.pool.performance.PerformanceTest&lt;/p&gt;

&lt;p&gt;This test uses the SleepingObjectFactory (includes penalty for heavy operations)&lt;br/&gt;
makeObject      500ms&lt;br/&gt;
destroyObject   250ms&lt;br/&gt;
validateObject   30ms&lt;br/&gt;
activateObject   10ms&lt;br/&gt;
passivateObject  10ms&lt;/p&gt;
</comment>
                            <comment id="12404187" author="dirkv" created="Wed, 13 Aug 2003 20:00:46 +0000"  >&lt;p&gt;Created an attachment (id=7797)&lt;br/&gt;
Test results using original (synchronized)  GenericObjectPool&lt;/p&gt;</comment>
                            <comment id="12404188" author="dirkv" created="Wed, 13 Aug 2003 20:01:38 +0000"  >&lt;p&gt;Created an attachment (id=7798)&lt;br/&gt;
Test results using new  GenericObjectPool&lt;/p&gt;</comment>
                            <comment id="12404189" author="dirkv" created="Wed, 13 Aug 2003 20:05:24 +0000"  >&lt;p&gt;Created an attachment (id=7799)&lt;br/&gt;
Test results using new GenericObjectPool (no delay)&lt;/p&gt;</comment>
                            <comment id="12404190" author="dirkv" created="Wed, 13 Aug 2003 20:06:23 +0000"  >&lt;p&gt;Created an attachment (id=7800)&lt;br/&gt;
Test results using new  GenericObjectPool (impact of maxIdle)&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12332251" name="ASF.LICENSE.NOT.GRANTED--maxIdle.txt" size="491" author="dirkv" created="Wed, 13 Aug 2003 20:06:23 +0000"/>
                            <attachment id="12332249" name="ASF.LICENSE.NOT.GRANTED--new.txt" size="1803" author="dirkv" created="Wed, 13 Aug 2003 20:01:38 +0000"/>
                            <attachment id="12332250" name="ASF.LICENSE.NOT.GRANTED--nodelay.txt" size="1721" author="dirkv" created="Wed, 13 Aug 2003 20:05:24 +0000"/>
                            <attachment id="12332248" name="ASF.LICENSE.NOT.GRANTED--original.txt" size="1376" author="dirkv" created="Wed, 13 Aug 2003 20:00:46 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>19614</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114398</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            22 years, 14 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uy5r:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178675</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-114] Cleanup dead connections</title>
                <link>https://issues.apache.org/jira/browse/DBCP-114</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;The Generic Object Pool can drop idle resources.  An idle resource is a &lt;br/&gt;
resource that has been returned to the pool.  A database connection pool needs &lt;br/&gt;
a method of recliaming a connection that was never returned to the pool.  For &lt;br/&gt;
instance a JSP page that gets a connection but never calls close because there &lt;br/&gt;
is an occasional uncaught exception or a database query that never returns.&lt;/p&gt;

&lt;p&gt;Think 24/7!&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: other&lt;br/&gt;
Platform: Other&lt;/p&gt;</environment>
        <key id="12340284">DBCP-114</key>
            <summary>Cleanup dead connections</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="4">Incomplete</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="rogernell@yahoo.com">Roger Nell</reporter>
                        <labels>
                    </labels>
                <created>Wed, 7 Aug 2002 01:35:12 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:32 +0000</updated>
                            <resolved>Tue, 25 Mar 2008 08:11:32 +0000</resolved>
                                    <version>1.0</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12402809" author="jmcnally" created="Wed, 7 Aug 2002 01:45:31 +0000"  >&lt;p&gt;dbcp contains an AbandonedObjectPool which is used in BasicDataSource to allow&lt;br/&gt;
reclaiming connections after a given amount of time.&lt;/p&gt;

&lt;p&gt;Are you saying this feature does not work?&lt;/p&gt;</comment>
                            <comment id="12402810" author="rogernell@yahoo.com" created="Wed, 7 Aug 2002 02:07:18 +0000"  >&lt;p&gt;I&apos;m not seeing an unclosed connection being reclaimed in the following test &lt;br/&gt;
case:&lt;/p&gt;

&lt;p&gt;  // TIME_BEWTWEEN_EVICTION_RUNS_MILLIS = 1000&lt;br/&gt;
  // MIN_EVICTABLE_IDLE_TIME_MILLIS = 5000&lt;br/&gt;
  conn = datasource.getConnection();&lt;/p&gt;

&lt;p&gt;  // execute &quot;select * from dual&quot;&lt;br/&gt;
  exeriseConn( conn );&lt;br/&gt;
  assertEquals( &quot;numActive&quot;, 1, p.numActive() );&lt;/p&gt;

&lt;p&gt;  // sleep for 16secs, connection should be reclaimed&lt;br/&gt;
  synchronized( this ) &lt;/p&gt;
{ wait( 16000 ); }

&lt;p&gt;  // Fails with numActive=1&lt;br/&gt;
  assertEquals( &quot;numActive&quot;, 0, p.numActive() );&lt;/p&gt;


</comment>
                            <comment id="12402811" author="rogernell@yahoo.com" created="Wed, 7 Aug 2002 02:10:59 +0000"  >&lt;p&gt;I&apos;m using commons-dbcp.jar dated 21-MAR-2002 that came with a struts &lt;br/&gt;
distribution.&lt;/p&gt;</comment>
                            <comment id="12402812" author="rogernell@yahoo.com" created="Wed, 7 Aug 2002 05:18:50 +0000"  >&lt;p&gt;Newer version of BasicDataSource offers this feature.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>11507</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114397</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            23 years, 15 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0v0k7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>179064</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-113] Broken behaviour for BasicDataSource.setMaxActive(0)/setMaxIde(0)</title>
                <link>https://issues.apache.org/jira/browse/DBCP-113</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;I wanted to make a datasource that fails on each attempt (for testing purposes).&lt;/p&gt;

&lt;p&gt;The way the pools are configured appears to be wrong because if I do this -&lt;/p&gt;

&lt;p&gt;        final BasicDataSource ds = new BasicDataSource();&lt;br/&gt;
        ds.setDriverClassName(driverName);&lt;br/&gt;
        ds.setUrl(url);&lt;br/&gt;
        ds.setUsername(userName);&lt;br/&gt;
        ds.setPassword(passwd);&lt;br/&gt;
        ds.setMaxActive(0);&lt;br/&gt;
        ds.setMaxIdle(0);&lt;/p&gt;


&lt;p&gt;        final Connection conn = ds.getConnection();&lt;/p&gt;

&lt;p&gt;I expect to get an SQL Exception about exhausted pool.  Instead it just gives &lt;br/&gt;
me a connection !!.&lt;/p&gt;

&lt;p&gt;There is a workaround - use a null driver name - but that is silly - it should &lt;br/&gt;
be doing the right thing with the pool&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: other&lt;br/&gt;
Platform: Other&lt;/p&gt;</environment>
        <key id="12341545">DBCP-113</key>
            <summary>Broken behaviour for BasicDataSource.setMaxActive(0)/setMaxIde(0)</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="rlenard">Rohan Lenard</reporter>
                        <labels>
                    </labels>
                <created>Mon, 28 Jun 2004 08:08:52 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:32 +0000</updated>
                            <resolved>Tue, 25 Mar 2008 08:11:32 +0000</resolved>
                                    <version>1.2</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12406943" author="dirkv" created="Wed, 30 Jun 2004 03:16:56 +0000"  >&lt;p&gt;Issue fixed in commons-pool&lt;/p&gt;

&lt;p&gt;See:&lt;br/&gt;
&lt;a href=&quot;http://issues.apache.org/bugzilla/show_bug.cgi?id=29863&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://issues.apache.org/bugzilla/show_bug.cgi?id=29863&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>29832</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114396</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            21 years, 20 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uz3r:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178828</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-112] Strange Result Set on output</title>
                <link>https://issues.apache.org/jira/browse/DBCP-112</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;I created the stored procedure in MSSQL2000 taking 4 parameters, inserting 1&lt;br/&gt;
record and returning nothing. So stmt.execute(..) returns -1. But is still&lt;br/&gt;
returns some funny org.apache.commons.dbcp.DelegatingResultSet which gives&lt;br/&gt;
NullPointerException on any attempt to examine it (for example, using&lt;br/&gt;
getMetaData()). It cannot even be closed, because I get &lt;/p&gt;

&lt;p&gt;java.lang.NullPointerException&lt;br/&gt;
        at&lt;br/&gt;
org.apache.commons.dbcp.DelegatingResultSet.close(DelegatingResultSet.java).&lt;/p&gt;

&lt;p&gt;If I work &lt;em&gt;directly&lt;/em&gt; with MS SQL JDBC driver (using DriverManager, not Tomcat&apos;s&lt;br/&gt;
JNDI), I have no problems - I get NO result set.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: other&lt;br/&gt;
Platform: Other&lt;/p&gt;</environment>
        <key id="12340467">DBCP-112</key>
            <summary>Strange Result Set on output</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="sergey.oudaltsov@clients.ie">Sergey V. Oudaltsov</reporter>
                        <labels>
                    </labels>
                <created>Fri, 20 Dec 2002 01:16:02 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:32 +0000</updated>
                            <resolved>Fri, 24 Nov 2006 20:51:26 +0000</resolved>
                                    <version>1.0</version>
                                                        <due></due>
                            <votes>2</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12403387" author="ralf@michl.name" created="Thu, 6 Feb 2003 20:47:04 +0000"  >&lt;p&gt;According to what I gather the problem is that DelegateStatement always creates &lt;br/&gt;
a DelegateResultSet, even if no result set exists.&lt;br/&gt;
Instead DelegateStatement should return null if no ResultSet exists.&lt;/p&gt;</comment>
                            <comment id="12403388" author="funkman@joedog.org" created="Thu, 6 Feb 2003 21:01:21 +0000"  >&lt;p&gt;From the CVS tags - there is was a patch submitted a while back which probably&lt;br/&gt;
addressed this AFTER the 1.0 release.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://cvs.apache.org/viewcvs.cgi/jakarta-commons/dbcp/src/java/org/apache/commons/dbcp/DelegatingStatement.java&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://cvs.apache.org/viewcvs.cgi/jakarta-commons/dbcp/src/java/org/apache/commons/dbcp/DelegatingStatement.java&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;From the report above - you are using v1.0. Can you reproduce this issue with a&lt;br/&gt;
nightly build? &lt;/p&gt;</comment>
                            <comment id="12403389" author="ralf@michl.name" created="Thu, 6 Feb 2003 22:39:49 +0000"  >&lt;p&gt;Same as &lt;a href=&quot;https://issues.apache.org/jira/browse/DBCP-73&quot; title=&quot;[DBCP][PATCH]Statement.getResultSet() doesn&amp;#39;t return null if like javadocs&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DBCP-73&quot;&gt;&lt;del&gt;COM-165&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
Fixed in nightly build - thx Tim.&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;
	&lt;ul&gt;
		&lt;li&gt;
		&lt;ul&gt;
			&lt;li&gt;This bug has been marked as a duplicate of 12733 ***&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>15539</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114395</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            22 years, 40 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0ux2n:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178499</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-111] Infinite loop (stack overflow) in BasicDataSource</title>
                <link>https://issues.apache.org/jira/browse/DBCP-111</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;The if method createDataSource() encounters a problem loading or instantiating &lt;br/&gt;
the JDBC driver, it calls the method getLogWriter().  &lt;/p&gt;

&lt;p&gt;The method getLogWriter() in turn calls createDataSource(), thus creating an &lt;br/&gt;
infinite loop, and a stack-overflow exception.  Perhaps createDataSource() &lt;br/&gt;
needs to simply log it&apos;s errors to stderr - or simply throw an exception, and &lt;br/&gt;
not log at all.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: All&lt;br/&gt;
Platform: Other&lt;/p&gt;</environment>
        <key id="12340198">DBCP-111</key>
            <summary>Infinite loop (stack overflow) in BasicDataSource</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="james@interobjective.com">James House</reporter>
                        <labels>
                    </labels>
                <created>Thu, 4 Apr 2002 01:20:04 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:32 +0000</updated>
                            <resolved>Tue, 25 Mar 2008 08:11:32 +0000</resolved>
                                    <version>Nightly Builds</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12402589" author="craig.mcclanahan@sun.com" created="Sun, 21 Apr 2002 01:31:26 +0000"  >&lt;p&gt;Fixed in nightly build 20020421.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>7727</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114394</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            23 years, 30 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uwfj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178395</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-109] [dbcp] removing a webapp does not force connections closed</title>
                <link>https://issues.apache.org/jira/browse/DBCP-109</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;as reported by Michael Holly &amp;lt;mholly@talisentech.com&amp;gt; and Tony Locke &amp;lt;tlocke@tlocke.org.uk&amp;gt; &lt;br/&gt;
on commons-user@jakarta.apache.org &quot;removing&quot; a Tomcat webapp does not force connections &lt;br/&gt;
present in DBCP pool be closed.&lt;/p&gt;

&lt;p&gt;In fact even if the webapp is unloaded and dbcp is unloaded &lt;br/&gt;
there is nobody to call BasicDataSource.close().&lt;/p&gt;

&lt;p&gt;Probably some context listener would &lt;br/&gt;
solve this problem but I fear not to have enough competence to say how to hook it in.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: other&lt;br/&gt;
Platform: Other&lt;/p&gt;</environment>
        <key id="12340827">DBCP-109</key>
            <summary>[dbcp] removing a webapp does not force connections closed</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="4">Incomplete</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="tagunov@motor.ru">tagunov</reporter>
                        <labels>
                    </labels>
                <created>Mon, 30 Jun 2003 18:01:53 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:32 +0000</updated>
                            <resolved>Tue, 25 Mar 2008 08:11:32 +0000</resolved>
                                    <version>1.0</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12404642" author="tagunov@motor.ru" created="Mon, 30 Jun 2003 19:20:10 +0000"  >&lt;p&gt;Tony Locke &amp;lt;tlocke@tlocke.org.uk&amp;gt; does it like this, but I still do not see a general &lt;br/&gt;
solution&lt;/p&gt;

&lt;p&gt;if (ds instanceof org.apache.commons.dbcp.BasicDataSource) {&lt;/p&gt;

&lt;p&gt;((org.apache.commons.dbcp.BasicDataSource) ds).close();&lt;br/&gt;
}&lt;/p&gt;

&lt;p&gt;in the contextDestroyed &lt;br/&gt;
method of the context listener class of my web&lt;br/&gt;
app.&lt;/p&gt;</comment>
                            <comment id="12404643" author="dirkv" created="Wed, 20 Aug 2003 05:22:14 +0000"  >&lt;p&gt;More info from Michael Holly (commons-user 11/08/2003)&lt;br/&gt;
------------------------------------------------------------&lt;br/&gt;
I had much the same problem.  Starting/Stopping webapps did not deal with&lt;br/&gt;
cleaning up the pool correctly.&lt;/p&gt;

&lt;p&gt;Since I was trying to implement junit and other testing mechanisims I wanted&lt;br/&gt;
my build script to stop, build, and&lt;br/&gt;
start the the app, then test it.  My problem was that the pools were being&lt;br/&gt;
treated as a quasi server/webapp resource.&lt;br/&gt;
For the current configurations I couldn&apos;t find one that would take ownership&lt;br/&gt;
of the pool. Then somebody told me&lt;br/&gt;
to create a Context listener and use it to clean up the pool when the webapp&lt;br/&gt;
shutdown occurs.  After several&lt;br/&gt;
iterations I go this to work.  I have checked it against my db through&lt;br/&gt;
several shutdown startup cycles and&lt;br/&gt;
it has yet to lose track of a connection.&lt;/p&gt;

&lt;p&gt;Here is my Context Listener&lt;/p&gt;

&lt;p&gt;/**&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;The listener runs when the app is started and shutdown&lt;br/&gt;
 *&lt;/li&gt;
	&lt;li&gt;@author  Michael Holly&lt;/li&gt;
	&lt;li&gt;created  Apr 18, 2003&lt;br/&gt;
 */&lt;br/&gt;
package net.talisen.tsr;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;import javax.sql.DataSource;&lt;br/&gt;
import javax.naming.InitialContext;&lt;br/&gt;
import javax.naming.Context;&lt;br/&gt;
import javax.naming.NamingException;&lt;br/&gt;
import javax.naming.NamingEnumeration;&lt;/p&gt;

&lt;p&gt;import org.apache.commons.dbcp.BasicDataSource;&lt;br/&gt;
import javax.servlet.*;&lt;br/&gt;
import org.apache.log4j.Logger;&lt;br/&gt;
import java.util.ResourceBundle;&lt;br/&gt;
import java.net.URL;&lt;br/&gt;
import java.net.MalformedURLException;&lt;br/&gt;
import java.io.*;&lt;br/&gt;
import java.util.*;&lt;br/&gt;
import org.apache.log4j.Logger;&lt;br/&gt;
import org.apache.log4j.Level;&lt;br/&gt;
import org.apache.log4j.PropertyConfigurator;&lt;/p&gt;

&lt;p&gt;public final class ContextListener&lt;br/&gt;
implements ServletContextListener&lt;br/&gt;
{&lt;/p&gt;

&lt;p&gt;   //get a logger&lt;br/&gt;
   Logger log = Logger.getLogger(ContextListener.class);&lt;/p&gt;

&lt;p&gt;   private InitialContext initialContext = null;&lt;br/&gt;
   private Context namingContext = null;&lt;br/&gt;
   private ServletContext context = null;&lt;/p&gt;

&lt;p&gt;   public void contextInitialized (ServletContextEvent servletContextEvent)&lt;br/&gt;
   {&lt;/p&gt;

&lt;p&gt;      context = servletContextEvent.getServletContext ();&lt;br/&gt;
      try&lt;/p&gt;
      {

         System.out.println(&quot; \n\n Intializing Context&quot;);
         log.info(&quot;Initializing logging&quot;);
         // configure the Log4j system
         String file = new String( &quot;/WEB-INF/classes/log4j.properties&quot; );
         URL url = context.getResource(file);
         PropertyConfigurator.configure( url );
         System.out.println(&quot;Log4j Properties @ &quot; + url.toString() );


         log.info(&quot;Cataloging Context Resources&quot;);
         initialContext = new InitialContext();

         namingContext = (Context) initialContext.lookup(&quot;java:comp/env&quot;);

         DataSource ds1 =
(DataSource)namingContext.lookup(&quot;jdbc/oracle_myapp&quot;);
         DataSource ds2 =
(DataSource)namingContext.lookup(&quot;jdbc/oracle_company_db&quot;);

         context.setAttribute(&quot;dataSource1&quot;, ds1);
         context.setAttribute(&quot;dataSource2&quot;, ds2);

         log.info(&quot;oracle_myapp connection pool cataloged&quot;);
         log.info(&quot;oracle_company_db connection pool cataloged&quot;);

      }
&lt;p&gt;      catch (NamingException ne)&lt;/p&gt;
      {
         log.error(&quot;Couldn&apos;t create context attribute: &quot; + ne.getMessage
());
         ne.printStackTrace();
      }
&lt;p&gt;      catch (Exception e)&lt;/p&gt;
      {
         log.error(&quot;Couldn&apos;t create context attribute: &quot; + e.getMessage ());
         e.printStackTrace();
      }
&lt;p&gt;   }&lt;/p&gt;

&lt;p&gt;   public void contextDestroyed (ServletContextEvent servletContextEvent)&lt;br/&gt;
   {&lt;/p&gt;

&lt;p&gt;      DataSource ds1 = ((DataSource) context.getAttribute(&quot;dataSource1&quot;));&lt;br/&gt;
      DataSource ds2 = ((DataSource) context.getAttribute(&quot;dataSource2&quot;));&lt;/p&gt;

&lt;p&gt;      try&lt;br/&gt;
      {&lt;/p&gt;

&lt;p&gt;         log.info(&quot;Cleaning up Context Resources&quot;);&lt;/p&gt;

&lt;p&gt;         if (ds1 instanceof org.apache.commons.dbcp.BasicDataSource) &lt;/p&gt;
{
            log.info(&quot;Found oracle_tsr connection pool &quot; + ds1.toString());
            ((org.apache.commons.dbcp.BasicDataSource) ds1).close();
            ds1 = null;
         }
&lt;p&gt;         log.info(&quot;Removed oracle_myapp connection &quot;);&lt;/p&gt;

&lt;p&gt;         if (ds2 instanceof org.apache.commons.dbcp.BasicDataSource) &lt;/p&gt;
{
            log.info(&quot;Found oracle_talisen connection pool &quot; +
ds2.toString() );
            ((org.apache.commons.dbcp.BasicDataSource) ds2).close();
            ds2 = null;
         }
&lt;p&gt;         log.info(&quot;Removed oracle_company_db connection&quot;);&lt;/p&gt;


&lt;p&gt;         context.removeAttribute (&quot;dataSource1&quot;);&lt;br/&gt;
         context.removeAttribute (&quot;dataSource2&quot;);&lt;br/&gt;
      }&lt;br/&gt;
      catch (Exception e)&lt;/p&gt;
      {
         log.error(&quot;Error destroying Context: &quot; + e.getMessage ());
         e.printStackTrace();
      }
&lt;p&gt;      finally&lt;/p&gt;
      {

System.out.println(&quot;########################################################
###########################################&quot;);

System.out.println(&quot;########################################################
###########################################&quot;);
         System.out.println(&quot;&quot;);
         System.out.println(&quot;&quot;);
         System.out.println(&quot;&quot;);
         System.out.println(&quot;&quot;);
         System.out.println(&quot;&quot;);
         System.out.println(&quot;&quot;);
         System.out.println(&quot;&quot;);
         System.out.println(&quot;&quot;);
      }
&lt;p&gt;   }&lt;br/&gt;
}&lt;/p&gt;

&lt;p&gt;then I add the Contect Listener to the web.xml file&lt;/p&gt;

&lt;p&gt;&amp;lt;!-- CONTEXT LISTENER --&amp;gt;&lt;br/&gt;
    &amp;lt;listener&amp;gt;&lt;br/&gt;
        &amp;lt;listener-class&amp;gt;net.talisen.tsr.ContextListener&amp;lt;/listener-class&amp;gt;&lt;br/&gt;
    &amp;lt;/listener&amp;gt;&lt;/p&gt;



&lt;p&gt;My server.xml does not contain any of the config info for the pools.  This&lt;br/&gt;
is&lt;br/&gt;
contained in a context xml file.  This file get stuffed into the META-INF&lt;br/&gt;
dir.&lt;br/&gt;
Then the whole thing gets jared up.  I deploy using Tomcat Manager.&lt;/p&gt;

&lt;p&gt;&amp;lt;!--Context path=&quot;/tsr&quot; docBase=&quot;/tsr&quot; debug=&quot;9&quot; reloadable=&quot;true&quot;&lt;br/&gt;
crossContext=&quot;true&quot;--&amp;gt;&lt;br/&gt;
&amp;lt;!--Context path=&quot;/tsr&quot; docBase=&quot;tsr.war&quot; debug=&quot;9&quot; reloadable=&quot;true&quot;&lt;br/&gt;
crossContext=&quot;true&quot;--&amp;gt;&lt;/p&gt;

&lt;p&gt;&amp;lt;Context path=&quot;/tsr&quot; debug=&quot;9&quot; privileged=&quot;true&quot; docBase=&quot;C:\Tomcat&lt;br/&gt;
4.1\webapps\tsr&quot; useNaming=&quot;true&quot;&amp;gt;&lt;/p&gt;

&lt;p&gt;   &amp;lt;Loader checkInterval=&quot;6&quot;/&amp;gt;&lt;/p&gt;

&lt;p&gt;   &amp;lt;Logger className=&quot;org.apache.catalina.logger.FileLogger&quot;&lt;br/&gt;
       prefix=&quot;localhost_tsrdb_log.&quot;&lt;br/&gt;
       suffix=&quot;.txt&quot;&lt;br/&gt;
    timestamp=&quot;true&quot;/&amp;gt;&lt;/p&gt;


&lt;p&gt;   &amp;lt;Resource name=&quot;jdbc/oracle_tsr&quot; auth=&quot;Container&quot; scope=&quot;Shareable&quot;&lt;br/&gt;
   type=&quot;javax.sql.DataSource&quot;/&amp;gt;&lt;/p&gt;

&lt;p&gt;   &amp;lt;ResourceParams name=&quot;jdbc/oracle_myapp&quot;&amp;gt;&lt;br/&gt;
      &amp;lt;parameter&amp;gt;&lt;br/&gt;
         &amp;lt;name&amp;gt;factory&amp;lt;/name&amp;gt;&lt;br/&gt;
         &amp;lt;value&amp;gt;org.apache.commons.dbcp.BasicDataSourceFactory&amp;lt;/value&amp;gt;&lt;br/&gt;
      &amp;lt;/parameter&amp;gt;&lt;br/&gt;
      &amp;lt;parameter&amp;gt;&lt;br/&gt;
         &amp;lt;name&amp;gt;driverClassName&amp;lt;/name&amp;gt;&lt;br/&gt;
         &amp;lt;!-&lt;del&gt;value&amp;gt;oracle.jdbc.OracleDriver&amp;lt;/value&lt;/del&gt;-&amp;gt;&lt;br/&gt;
         &amp;lt;!-&lt;del&gt;value&amp;gt;oracle.jdbc.pool.OracleConnectionPoolDataSource&amp;lt;/value&lt;/del&gt;-&amp;gt;&lt;br/&gt;
         &amp;lt;value&amp;gt;oracle.jdbc.pool.OracleDataSource&amp;lt;/value&amp;gt;&lt;br/&gt;
      &amp;lt;/parameter&amp;gt;&lt;br/&gt;
      &amp;lt;parameter&amp;gt;&lt;br/&gt;
         &amp;lt;name&amp;gt;url&amp;lt;/name&amp;gt;&lt;br/&gt;
         &amp;lt;!-&lt;del&gt;value&amp;gt;jdbc:oracle:thin:@myserver:1521:myco&amp;lt;/value&lt;/del&gt;-&amp;gt;&lt;br/&gt;
      &amp;lt;/parameter&amp;gt;&lt;br/&gt;
      &amp;lt;parameter&amp;gt;&lt;br/&gt;
         &amp;lt;name&amp;gt;username&amp;lt;/name&amp;gt;&lt;br/&gt;
         &amp;lt;value&amp;gt;myapp&amp;lt;/value&amp;gt;&lt;br/&gt;
      &amp;lt;/parameter&amp;gt;&lt;br/&gt;
      &amp;lt;parameter&amp;gt;&lt;br/&gt;
         &amp;lt;name&amp;gt;password&amp;lt;/name&amp;gt;&lt;br/&gt;
         &amp;lt;value&amp;gt;????????&amp;lt;/value&amp;gt;&lt;br/&gt;
      &amp;lt;/parameter&amp;gt;&lt;br/&gt;
      &amp;lt;parameter&amp;gt;&lt;br/&gt;
         &amp;lt;name&amp;gt;maxActive&amp;lt;/name&amp;gt;&lt;br/&gt;
         &amp;lt;value&amp;gt;20&amp;lt;/value&amp;gt;&lt;br/&gt;
      &amp;lt;/parameter&amp;gt;&lt;br/&gt;
      &amp;lt;parameter&amp;gt;&lt;br/&gt;
         &amp;lt;name&amp;gt;maxIdle&amp;lt;/name&amp;gt;&lt;br/&gt;
         &amp;lt;value&amp;gt;10&amp;lt;/value&amp;gt;&lt;br/&gt;
      &amp;lt;/parameter&amp;gt;&lt;br/&gt;
      &amp;lt;parameter&amp;gt;&lt;br/&gt;
         &amp;lt;name&amp;gt;maxWait&amp;lt;/name&amp;gt;&lt;br/&gt;
         &amp;lt;value&amp;gt;-1&amp;lt;/value&amp;gt;&lt;br/&gt;
      &amp;lt;/parameter&amp;gt;&lt;br/&gt;
      &amp;lt;parameter&amp;gt;&lt;br/&gt;
         &amp;lt;name&amp;gt;removeAbandoned&amp;lt;/name&amp;gt;&lt;br/&gt;
         &amp;lt;value&amp;gt;true&amp;lt;/value&amp;gt;&lt;br/&gt;
      &amp;lt;/parameter&amp;gt;&lt;br/&gt;
      &amp;lt;parameter&amp;gt;&lt;br/&gt;
         &amp;lt;name&amp;gt;removeAbandonedTimeout&amp;lt;/name&amp;gt;&lt;br/&gt;
         &amp;lt;value&amp;gt;300&amp;lt;/value&amp;gt;&lt;br/&gt;
      &amp;lt;/parameter&amp;gt;&lt;br/&gt;
      &amp;lt;parameter&amp;gt;&lt;br/&gt;
         &amp;lt;name&amp;gt;logAbandoned&amp;lt;/name&amp;gt;&lt;br/&gt;
         &amp;lt;value&amp;gt;true&amp;lt;/value&amp;gt;&lt;br/&gt;
      &amp;lt;/parameter&amp;gt;&lt;br/&gt;
      &amp;lt;parameter&amp;gt;&lt;br/&gt;
         &amp;lt;name&amp;gt;validationQuery&amp;lt;/name&amp;gt;&lt;br/&gt;
         &amp;lt;value&amp;gt;select &apos;validationQuery&apos; from dual&amp;lt;/value&amp;gt;&lt;br/&gt;
      &amp;lt;/parameter&amp;gt;&lt;br/&gt;
      &amp;lt;parameter&amp;gt;&lt;br/&gt;
         &amp;lt;name&amp;gt;testOnBorrow&amp;lt;/name&amp;gt;&lt;br/&gt;
         &amp;lt;value&amp;gt;true&amp;lt;/value&amp;gt;&lt;br/&gt;
      &amp;lt;/parameter&amp;gt;&lt;br/&gt;
   &amp;lt;/ResourceParams&amp;gt;&lt;/p&gt;

&lt;p&gt;   &amp;lt;Resource name=&quot;jdbc/oracle_talisen&quot; auth=&quot;Container&quot;&lt;br/&gt;
type=&quot;javax.sql.DataSource&quot;/&amp;gt;&lt;/p&gt;

&lt;p&gt;   &amp;lt;ResourceParams name=&quot;jdbc/oracle_talisen&quot;&amp;gt;&lt;br/&gt;
      &amp;lt;parameter&amp;gt;&lt;br/&gt;
         &amp;lt;name&amp;gt;factory&amp;lt;/name&amp;gt;&lt;br/&gt;
         &amp;lt;value&amp;gt;org.apache.commons.dbcp.BasicDataSourceFactory&amp;lt;/value&amp;gt;&lt;br/&gt;
      &amp;lt;/parameter&amp;gt;&lt;br/&gt;
      &amp;lt;parameter&amp;gt;&lt;br/&gt;
         &amp;lt;name&amp;gt;driverClassName&amp;lt;/name&amp;gt;&lt;br/&gt;
         &amp;lt;value&amp;gt;oracle.jdbc.OracleDriver&amp;lt;/value&amp;gt;&lt;br/&gt;
         &amp;lt;!-&lt;del&gt;value&amp;gt;oracle.jdbc.pool.OracleConnectionPoolDataSource&amp;lt;/value&lt;/del&gt;-&amp;gt;&lt;br/&gt;
         &amp;lt;!-&lt;del&gt;value&amp;gt;oracle.jdbc.pool.OracleDataSource&amp;lt;/value&lt;/del&gt;-&amp;gt;&lt;br/&gt;
      &amp;lt;/parameter&amp;gt;&lt;br/&gt;
      &amp;lt;parameter&amp;gt;&lt;br/&gt;
         &amp;lt;name&amp;gt;url&amp;lt;/name&amp;gt;&lt;br/&gt;
         &amp;lt;!-&lt;del&gt;value&amp;gt;jdbc:oracle:thin:@myserver:1521:myco&amp;lt;/value&lt;/del&gt;-&amp;gt;&lt;br/&gt;
      &amp;lt;/parameter&amp;gt;&lt;br/&gt;
      &amp;lt;parameter&amp;gt;&lt;br/&gt;
         &amp;lt;name&amp;gt;username&amp;lt;/name&amp;gt;&lt;br/&gt;
         &amp;lt;value&amp;gt;company_db&amp;lt;/value&amp;gt;&lt;br/&gt;
      &amp;lt;/parameter&amp;gt;&lt;br/&gt;
      &amp;lt;parameter&amp;gt;&lt;br/&gt;
         &amp;lt;name&amp;gt;password&amp;lt;/name&amp;gt;&lt;br/&gt;
         &amp;lt;value&amp;gt;?????????&amp;lt;/value&amp;gt;&lt;br/&gt;
      &amp;lt;/parameter&amp;gt;&lt;br/&gt;
      &amp;lt;parameter&amp;gt;&lt;br/&gt;
         &amp;lt;name&amp;gt;maxActive&amp;lt;/name&amp;gt;&lt;br/&gt;
         &amp;lt;value&amp;gt;20&amp;lt;/value&amp;gt;&lt;br/&gt;
      &amp;lt;/parameter&amp;gt;&lt;br/&gt;
      &amp;lt;parameter&amp;gt;&lt;br/&gt;
         &amp;lt;name&amp;gt;maxIdle&amp;lt;/name&amp;gt;&lt;br/&gt;
         &amp;lt;value&amp;gt;10&amp;lt;/value&amp;gt;&lt;br/&gt;
      &amp;lt;/parameter&amp;gt;&lt;br/&gt;
      &amp;lt;parameter&amp;gt;&lt;br/&gt;
         &amp;lt;name&amp;gt;maxWait&amp;lt;/name&amp;gt;&lt;br/&gt;
         &amp;lt;value&amp;gt;-1&amp;lt;/value&amp;gt;&lt;br/&gt;
      &amp;lt;/parameter&amp;gt;&lt;br/&gt;
      &amp;lt;parameter&amp;gt;&lt;br/&gt;
         &amp;lt;name&amp;gt;removeAbandoned&amp;lt;/name&amp;gt;&lt;br/&gt;
         &amp;lt;value&amp;gt;true&amp;lt;/value&amp;gt;&lt;br/&gt;
      &amp;lt;/parameter&amp;gt;&lt;br/&gt;
      &amp;lt;parameter&amp;gt;&lt;br/&gt;
         &amp;lt;name&amp;gt;removeAbandonedTimeout&amp;lt;/name&amp;gt;&lt;br/&gt;
         &amp;lt;value&amp;gt;300&amp;lt;/value&amp;gt;&lt;br/&gt;
      &amp;lt;/parameter&amp;gt;&lt;br/&gt;
      &amp;lt;parameter&amp;gt;&lt;br/&gt;
         &amp;lt;name&amp;gt;logAbandoned&amp;lt;/name&amp;gt;&lt;br/&gt;
         &amp;lt;value&amp;gt;true&amp;lt;/value&amp;gt;&lt;br/&gt;
      &amp;lt;/parameter&amp;gt;&lt;br/&gt;
      &amp;lt;parameter&amp;gt;&lt;br/&gt;
         &amp;lt;name&amp;gt;validationQuery&amp;lt;/name&amp;gt;&lt;br/&gt;
         &amp;lt;value&amp;gt;select &apos;validationQuery&apos; from dual&amp;lt;/value&amp;gt;&lt;br/&gt;
      &amp;lt;/parameter&amp;gt;&lt;br/&gt;
      &amp;lt;parameter&amp;gt;&lt;br/&gt;
        &amp;lt;name&amp;gt;testOnBorrow&amp;lt;/name&amp;gt;&lt;br/&gt;
        &amp;lt;value&amp;gt;true&amp;lt;/value&amp;gt;&lt;br/&gt;
      &amp;lt;/parameter&amp;gt;&lt;br/&gt;
   &amp;lt;/ResourceParams&amp;gt;&lt;br/&gt;
&amp;lt;/Context&amp;gt;&lt;/p&gt;

&lt;p&gt;Hope this helps.&lt;/p&gt;

&lt;p&gt;Michael&lt;/p&gt;</comment>
                            <comment id="12404644" author="dirkv" created="Thu, 21 Aug 2003 21:35:08 +0000"  >&lt;p&gt;This is a container issue, moving to tomcat project.&lt;/p&gt;

&lt;p&gt;Tomcat 4&lt;br/&gt;
&lt;a href=&quot;http://issues.apache.org/bugzilla/show_bug.cgi?id=22625&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://issues.apache.org/bugzilla/show_bug.cgi?id=22625&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Tomcat 5&lt;br/&gt;
&lt;a href=&quot;http://issues.apache.org/bugzilla/show_bug.cgi?id=22626&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://issues.apache.org/bugzilla/show_bug.cgi?id=22626&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>21182</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114392</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            22 years, 12 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0v0jb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>179060</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-108] DriverManagerConnectionFactory: blank username/password handling</title>
                <link>https://issues.apache.org/jira/browse/DBCP-108</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;Mail from Maxwell Grender-Jones (on commons-dev 24 june 2004)&lt;br/&gt;
-------------------------------------------------------------&lt;br/&gt;
If you supply a username but not a password, or a password but not a&lt;br/&gt;
username, dbcp ignores these values, and simply uses the URL to connect&lt;br/&gt;
to your database (even when defaults exist for the null values). This&lt;br/&gt;
means if I create a DriverManagerConnectionFactory with url, user and&lt;br/&gt;
pass of mydburl, myusername, null, it will try connect to mydburl using&lt;br/&gt;
default username and default password rather than myusername and default&lt;br/&gt;
password.&lt;/p&gt;

&lt;p&gt;The solution:&lt;br/&gt;
Allow the default username and password values to be used when one is&lt;br/&gt;
present but the other is not, as provided by the patch. Now I realise&lt;br/&gt;
default usernames/passwords are not ideal, but at the same time there&apos;s&lt;br/&gt;
no need to prevent this functionality from working (imho).&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: other&lt;br/&gt;
Platform: Other&lt;/p&gt;</environment>
        <key id="12341538">DBCP-108</key>
            <summary>DriverManagerConnectionFactory: blank username/password handling</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="dirkv">Dirk Verbeeck</reporter>
                        <labels>
                    </labels>
                <created>Fri, 25 Jun 2004 01:29:02 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:32 +0000</updated>
                            <resolved>Tue, 25 Mar 2008 08:11:32 +0000</resolved>
                                    <version>1.2</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12406921" author="dirkv" created="Fri, 25 Jun 2004 01:30:27 +0000"  >&lt;p&gt;Created an attachment (id=11943)&lt;br/&gt;
patch from Maxwell Grender-Jones&lt;/p&gt;</comment>
                            <comment id="12406922" author="dirkv" created="Fri, 25 Jun 2004 01:36:16 +0000"  >&lt;p&gt;Patch applied&lt;/p&gt;

&lt;p&gt;DriverManagerConnectionFactory.java   Revision : 1.9   Date : 2004/6/24 18:32:53&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12332960" name="ASF.LICENSE.NOT.GRANTED--patch.txt" size="1112" author="dirkv" created="Fri, 25 Jun 2004 01:30:27 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>29791</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114391</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            21 years, 20 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uzc7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178866</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-107] Statements and connections don&apos;t implement equals()/hashCode</title>
                <link>https://issues.apache.org/jira/browse/DBCP-107</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;This makes impossible to put-then-find again such statements/connection in a&lt;br/&gt;
Collection or Map based on their equality (this works with standard&lt;br/&gt;
java.sql.PreparedStatements for example).&lt;/p&gt;

&lt;p&gt;equals() and hashCode() should be added and delegate to the encapsulted&lt;br/&gt;
statements (at least).&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: All&lt;br/&gt;
Platform: All&lt;/p&gt;</environment>
        <key id="12340848">DBCP-107</key>
            <summary>Statements and connections don&apos;t implement equals()/hashCode</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="jbeau@noos.fr">J&#233;r&#244;me Beau</reporter>
                        <labels>
                    </labels>
                <created>Thu, 10 Jul 2003 17:18:25 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:32 +0000</updated>
                            <resolved>Tue, 25 Mar 2008 08:11:32 +0000</resolved>
                                    <version>1.0</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12404691" author="dirkv" created="Tue, 12 Aug 2003 06:58:38 +0000"  >&lt;p&gt;Added equals &amp;amp; hashCode methods to the Delegatin* classes,&lt;br/&gt;
getInnermostDelegate where needed and some unit tests.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>21458</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114390</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            22 years, 14 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0ux1r:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178495</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-106] [dbcp] ClassCastException while using OracleCallableStatement with DBCP -Urgent</title>
                <link>https://issues.apache.org/jira/browse/DBCP-106</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;I am getting a ClassCastException  : &lt;br/&gt;
org.apache.commoms.dbcp.DelegationgCallableStatement&lt;/p&gt;

&lt;p&gt;while using DBCP1.2.1. I am using commons-dbcp1.2.1 with TomCat 4.1.29. to get &lt;br/&gt;
the DBCPConnectionPool Object.&lt;/p&gt;

&lt;p&gt;I use the OracleCallableStatement Object to call the geCursor() to retrieve the &lt;br/&gt;
Cursor&lt;/p&gt;

&lt;p&gt;Please see the Code snippet which generates error&lt;/p&gt;

&lt;p&gt;Connection conn=null;&lt;br/&gt;
CallableStatement stmt=null;&lt;br/&gt;
ResultSet rs=null;&lt;/p&gt;

&lt;p&gt;try{&lt;br/&gt;
   //datasource will contain the javax.sql.DataSource after lookup&lt;br/&gt;
   //Here we get the org.apache.commons.dbcp.PoolableConnection Object&lt;br/&gt;
   conn=dataSource.getConnection();&lt;br/&gt;
   stmt=conn.prepareCall(sql);&lt;br/&gt;
   stmt.registerOutParameter(1,OracleTypes.CURSOR);&lt;br/&gt;
   ....//set the statement object values here&lt;br/&gt;
   stmt.execute();&lt;/p&gt;

&lt;p&gt;    //get the Cursor here, here we get the ClassCastException&lt;br/&gt;
   rs=((OracleCallableStatement)stmt).getCursor(1);&lt;/p&gt;


&lt;p&gt;As an alternative, I tried to use the DelegatingConnection.getInnremostDelegate&lt;br/&gt;
() to get the underlying connection and create the statement object from that. &lt;br/&gt;
Still I get the same exception. &lt;/p&gt;

&lt;p&gt;As this is an existing code, i have to use the OracleCallableStatement to get &lt;br/&gt;
the Cursor. &lt;/p&gt;

&lt;p&gt;Can you please suggest a work around for this ASAP&lt;/p&gt;

&lt;p&gt;Thanks&lt;br/&gt;
Eldo Itteera&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: Windows 2000&lt;br/&gt;
Platform: PC&lt;/p&gt;</environment>
        <key id="12341894">DBCP-106</key>
            <summary>[dbcp] ClassCastException while using OracleCallableStatement with DBCP -Urgent</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="4">Incomplete</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="eldoitteera@yahoo.com">Eldo Itteera</reporter>
                        <labels>
                    </labels>
                <created>Wed, 24 Nov 2004 16:29:37 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:32 +0000</updated>
                            <resolved>Tue, 25 Mar 2008 08:11:32 +0000</resolved>
                                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12408182" author="yoavs@computer.org" created="Wed, 8 Dec 2004 05:21:52 +0000"  >&lt;p&gt;You should use the DelegatingCallableStatement&apos;s getDelegate method to get at &lt;br/&gt;
the underlying statement.&lt;/p&gt;

&lt;p&gt;Bugzilla is not the way to ask for workarounds: use the mailing lists.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>32375</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114389</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            20 years, 49 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0v0mn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>179075</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-105] [dbcp] JNDI problems with SharedPoolDataSource</title>
                <link>https://issues.apache.org/jira/browse/DBCP-105</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;It is currently not possible to bind a SharedPoolDataSource into jndi and&lt;br/&gt;
retrieve it again via a lookup. The problem was seen in tomcat&apos;s naming&lt;br/&gt;
implementation, but is likely to be not limited to that implementation.&lt;br/&gt;
The problem is: SharedPoolDataSource implements javax.naming.Referenceable via&lt;br/&gt;
its parent InstanceKeyDataSource. Referenceable specifies that a getReference()&lt;br/&gt;
method is implemented, which returns a javax.naming.Reference object. The&lt;br/&gt;
reference object contains a reference to a factory for the object. In the&lt;br/&gt;
implementation of InstanceKeyDataSource, dbcp&apos;s InstanceKeyObjectFactory is&lt;br/&gt;
specified as facory. However, this is invalid as InstanceKeyObjectFactory is&lt;br/&gt;
abstract and cannot be instantiated, so upon a lookup, the object cannot be&lt;br/&gt;
retrieved from jndi.&lt;/p&gt;

&lt;p&gt;There are two obvious solutions. First, getReference() could return the correct&lt;br/&gt;
factory (SharedPoolDataSourceFactory). Second, InstanceKeyDataSource could not&lt;br/&gt;
implement Referenceable any more.&lt;/p&gt;

&lt;p&gt;The problem also occurs for dbcp&apos;s PerUserPoolDatasource. A successfull bind can&lt;br/&gt;
be done using dbcp&apos;s BasicDataSource.&lt;/p&gt;

&lt;p&gt;I will attach a test case which shows the wrong behaviour. It depends on the&lt;br/&gt;
jars naming-common-5.0.28.jar and naming-java.5.0.28.jar which can be downloaded&lt;br/&gt;
from www.ibiblio.org/maven/tomcat/jars.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: other&lt;br/&gt;
Platform: Other&lt;/p&gt;</environment>
        <key id="12342822">DBCP-105</key>
            <summary>[dbcp] JNDI problems with SharedPoolDataSource</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="fischer@seitenbau.de">Thomas Fischer</reporter>
                        <labels>
                    </labels>
                <created>Fri, 30 Dec 2005 03:39:06 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:32 +0000</updated>
                            <resolved>Tue, 25 Mar 2008 08:11:32 +0000</resolved>
                                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12411156" author="fischer@seitenbau.de" created="Fri, 30 Dec 2005 03:42:02 +0000"  >&lt;p&gt;Created an attachment (id=17293)&lt;br/&gt;
Junit testcase displaying the specified behaviour&lt;/p&gt;</comment>
                            <comment id="12411157" author="phil@steitz.com" created="Fri, 30 Dec 2005 07:13:18 +0000"  >&lt;p&gt;I agree this is a bug and it should be fixed by getting a concrete factory returned.&lt;/p&gt;

&lt;p&gt;Assuming we stick with &amp;lt;class&amp;gt;Factory naming convention, the current setup can&lt;br/&gt;
be made to work by having InstanceKeyDataSource&apos;s getReference method pass&lt;br/&gt;
getClass().getName() + &quot;Factory&quot; &lt;br/&gt;
instead of &lt;br/&gt;
InstanceKeyObjectFactory.class.getName()&lt;br/&gt;
as the factory argument to the Reference constructor.&lt;/p&gt;</comment>
                            <comment id="12411158" author="fischer@seitenbau.de" created="Fri, 30 Dec 2005 17:58:51 +0000"  >&lt;p&gt;In my opinion, it would be cleaner to make the method getReference() abstract in&lt;br/&gt;
InstanceKeyDataSource, and implement it in the subclasses. Then one need not&lt;br/&gt;
rely on naming conventions, but can return XXXFactory.class.getName() in the&lt;br/&gt;
implementations.&lt;/p&gt;</comment>
                            <comment id="12411159" author="phil@steitz.com" created="Fri, 30 Dec 2005 23:47:21 +0000"  >&lt;p&gt;Yes. That would be cleaner.  &lt;/p&gt;</comment>
                            <comment id="12411160" author="phil@steitz.com" created="Sat, 31 Dec 2005 00:15:10 +0000"  >&lt;p&gt;But unfortunately InstanceKeyDataSource has been released and making&lt;br/&gt;
getReference() abstract in InstanceKeyDataSource would technically be an&lt;br/&gt;
incompatible change - &quot;technically&quot; because binary compatibility problem would&lt;br/&gt;
only surface for those using the broken functionality. Source compatibility is&lt;br/&gt;
another isssue - would bite anyone who has created their own&lt;br/&gt;
InstanceKeyDataSources.  &lt;/p&gt;</comment>
                            <comment id="12411161" author="fischer@seitenbau.de" created="Sat, 31 Dec 2005 01:16:07 +0000"  >&lt;p&gt;What about change the implementation of InstanceKeyDataSource.getReference() to&lt;br/&gt;
always throw an Exception instead of making it abstract? This would preserve&lt;br/&gt;
binary and source compatibility, but ease finding the cause why binding to jndi&lt;br/&gt;
fails.&lt;/p&gt;</comment>
                            <comment id="12411162" author="sandymac@apache.org" created="Sat, 11 Mar 2006 00:40:39 +0000"  >&lt;p&gt;Seems to me that changing the second param of Reference in&lt;br/&gt;
InstanceKeyDataSource.getReference() to the following would be a suboptimal but&lt;br/&gt;
working solution.&lt;/p&gt;

&lt;p&gt;    public Reference getReference() throws NamingException &lt;/p&gt;
{
        Reference ref = new Reference(getClass().getName(), 
            getClass().getName() + &quot;Factory&quot;, null);
        ref.add(new StringRefAddr(&quot;instanceKey&quot;, instanceKey));
        return ref;
    }</comment>
                            <comment id="12411163" author="sandymac@apache.org" created="Sat, 11 Mar 2006 05:35:56 +0000"  >&lt;p&gt;Created an attachment (id=17868)&lt;br/&gt;
Dbcp-getReference-fixes.patch&lt;/p&gt;

&lt;p&gt;My suggested fixes to InstanceKeyDataSource.getReference() and subclasses. The&lt;br/&gt;
patch:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;encourages subclasses of InstanceKeyDataSource to override getReference()&lt;/li&gt;
	&lt;li&gt;changes InstanceKeyDataSource.getReference() so it takes a guess at what the&lt;br/&gt;
Factory class would be named. I think this version will work at least as often&lt;br/&gt;
as the current version though I don&apos;t think it should be used. Removing that&lt;br/&gt;
method should wait until a major release.&lt;/li&gt;
	&lt;li&gt;adds implementations of getReference() to PerUserPoolDataSource and&lt;br/&gt;
SharedPoolDataSource.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="12411164" author="phil@steitz.com" created="Sun, 12 Mar 2006 07:10:59 +0000"  >&lt;p&gt;Last patch, with test case, applied.  Thanks!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12333962" name="ASF.LICENSE.NOT.GRANTED--Dbcp-getReference-fixes.patch" size="3699" author="sandymac@apache.org" created="Sat, 11 Mar 2006 05:35:56 +0000"/>
                            <attachment id="12333961" name="ASF.LICENSE.NOT.GRANTED--SharedPoolDataSourceJndiTest.java" size="2733" author="fischer@seitenbau.de" created="Fri, 30 Dec 2005 03:42:02 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>38073</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114388</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            19 years, 35 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uxhb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178565</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-104] PooledConnectionImpl ignores resultsetType and Concurrency if statement pooling is not enabled</title>
                <link>https://issues.apache.org/jira/browse/DBCP-104</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;Around line 261 in PooledConnectionImpl, the method preparedStatement fowrards&lt;br/&gt;
the request to to the real connection.  However the resultSetType and&lt;br/&gt;
Resultsetconcurrency are NOT passed down.&lt;br/&gt;
   /**&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Create or obtain a {*link PreparedStatement} from my pool.&lt;/li&gt;
	&lt;li&gt;@return a {*link PoolablePreparedStatement}&lt;br/&gt;
     */&lt;br/&gt;
    PreparedStatement prepareStatement(String sql, int resultSetType, &lt;br/&gt;
                                       int resultSetConcurrency) &lt;br/&gt;
            throws SQLException {&lt;br/&gt;
        if (pstmtPool == null) {&lt;br/&gt;
            return connection.prepareStatement(sql);&lt;/li&gt;
&lt;/ul&gt;
</description>
                <environment>&lt;p&gt;Operating System: other&lt;br/&gt;
Platform: All&lt;/p&gt;</environment>
        <key id="12341068">DBCP-104</key>
            <summary>PooledConnectionImpl ignores resultsetType and Concurrency if statement pooling is not enabled</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="toddc@concur.com">Todd Carmichael</reporter>
                        <labels>
                    </labels>
                <created>Sun, 2 Nov 2003 08:38:21 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:32 +0000</updated>
                            <resolved>Tue, 25 Mar 2008 08:11:32 +0000</resolved>
                                    <version>1.1</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12405372" author="dirkv" created="Mon, 10 Nov 2003 22:46:23 +0000"  >&lt;p&gt;fixed in PooledConnectionImpl.java revision 1.11&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>24328</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114387</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            22 years, 1 week, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0ux93:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178528</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-103] Connection re-use conflates logical and physical connections</title>
                <link>https://issues.apache.org/jira/browse/DBCP-103</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;[Let me say up front that you may already know about this, but I couldn&apos;t find&lt;br/&gt;
anything like this in the dev list or the bug DB.  I may just be using&lt;br/&gt;
different terms than you.  If so, sorry.]&lt;/p&gt;

&lt;p&gt;I just debugged a problem with a finalizer closing a connection that had been&lt;br/&gt;
re-allocated from the pool to a different use, and what this made clear to me&lt;br/&gt;
is the following: DBCP is pooling physical connections and using them as&lt;br/&gt;
logical connections.  This will cause all sorts of problems like this.&lt;/p&gt;

&lt;p&gt;First, my terms: A physical connection is a lower-level JDBC Connection object&lt;br/&gt;
that talks to a database.  A logical connection is a user level concept that&lt;br/&gt;
flows from using getConnection() and continues until the user code invokes&lt;br/&gt;
close().  (&quot;User&quot; here means &quot;programmer using DBCP&quot;.)&lt;/p&gt;

&lt;p&gt;Physical connections are expensive to establish and so need pooling.  But&lt;br/&gt;
logical connections can be cheap.  What I would recommend is that you put an&lt;br/&gt;
object representing the logical connection between the user and the physical&lt;br/&gt;
connection.  The physical connections would be pooled, but the logical ones&lt;br/&gt;
would be created during getConnection() to represent the user&apos;s notion of a&lt;br/&gt;
single connection.  The logical connection would maintain state for the logical&lt;br/&gt;
connection, such as isClosed().&lt;/p&gt;

&lt;p&gt;Here is an example of code that, while stupid, should work &amp;#8211; it does work in&lt;br/&gt;
the absence of a pooled connection:&lt;/p&gt;

&lt;p&gt;    Connection conn = getConnection();&lt;br/&gt;
    conn.executeQuery(query);&lt;br/&gt;
    conn.close();&lt;br/&gt;
    Thread.sleep(30 * 1000);&lt;br/&gt;
    conn.close();&lt;/p&gt;

&lt;p&gt;While dumb, this is exactly what happened to me, except that the delay between&lt;br/&gt;
close() calls was the delay between the explicit close and when the garbage&lt;br/&gt;
collector invoked a finalize() method.&lt;/p&gt;

&lt;p&gt;The problem here is that someone else may have picked up the physical&lt;br/&gt;
connection after the first clase, and be using it when the second close&lt;br/&gt;
occurrs.&lt;/p&gt;

&lt;p&gt;The reason this problem exists is that you are handing me phyiscal connections.&lt;br/&gt;
If instead you put a logical connection object in the middle, the logical&lt;br/&gt;
connection object would know that it was closed and the second close would act&lt;br/&gt;
appropriately (throwing an exception, I think, is correct).  This is because&lt;br/&gt;
the second use of the physical connection would be using a different object&lt;br/&gt;
implementing Connection with its own state, and so my old Connection object&lt;br/&gt;
would not be accessing the physical connection any more.&lt;/p&gt;

&lt;p&gt;In other words, as a user, I should never get my hands on physical connection&lt;br/&gt;
objects.  This reduces the number of ways I can screw up myself or, in this&lt;br/&gt;
case, others.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: All&lt;br/&gt;
Platform: All&lt;/p&gt;</environment>
        <key id="12341444">DBCP-103</key>
            <summary>Connection re-use conflates logical and physical connections</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="arnold@moonhill.org">Ken Arnold</reporter>
                        <labels>
                    </labels>
                <created>Wed, 12 May 2004 02:21:58 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:32 +0000</updated>
                            <resolved>Tue, 25 Mar 2008 08:11:32 +0000</resolved>
                                    <version>1.1</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12406590" author="dirkv" created="Thu, 13 May 2004 01:44:40 +0000"  >&lt;p&gt;PoolingDataSource has a PoolGuardConnectionWrapper doing what you describe.&lt;br/&gt;
(preventing access after closing the wrapped pooled connection)&lt;/p&gt;

&lt;p&gt;How did you create your pool?&lt;/p&gt;
</comment>
                            <comment id="12406591" author="arnold@moonhill.org" created="Thu, 13 May 2004 02:12:53 +0000"  >&lt;p&gt;Pretty much copying out one of the examples, but I&apos;m using driver, not data source:&lt;/p&gt;

&lt;p&gt;            ObjectPool connectionPool = new GenericObjectPool(null);&lt;br/&gt;
            ConnectionFactory connectionFactory = new DriverManagerConnectionFactory(dbc.getURL(), props);&lt;br/&gt;
            new PoolableConnectionFactory(connectionFactory, connectionPool, null, null, false, true);&lt;br/&gt;
            Class.forName(&quot;org.apache.commons.dbcp.PoolingDriver&quot;);&lt;br/&gt;
            String poolURLBase = &quot;jdbc:apache:commons:dbcp:&quot;;&lt;br/&gt;
            PoolingDriver driver = (PoolingDriver) DriverManager.getDriver(poolURLBase);&lt;br/&gt;
            driver.registerPool(poolName, connectionPool);&lt;br/&gt;
            dbc.setPoolURL(poolURLBase + poolName);&lt;/p&gt;</comment>
                            <comment id="12406592" author="dirkv" created="Tue, 18 May 2004 01:49:38 +0000"  >&lt;p&gt;Implemented a PoolGuardConnectionWrapper for PoolingDriver &lt;br/&gt;
(same as PoolingDataSource) and added a testcase to TestManual.&lt;/p&gt;

&lt;p&gt;PoolingDriver.java   Revision : 1.12 Date : 2004/5/17 18:39:44&lt;/p&gt;</comment>
                            <comment id="12406593" author="arnold@moonhill.org" created="Tue, 25 May 2004 19:11:25 +0000"  >&lt;p&gt;I&apos;m not certain I get the idea &amp;#8211; why would anyone want the non-guarded behavior?  It&apos;s like a dangling pointer &lt;br/&gt;
bug, where one part of the code holds on to a pointer to memory some other part has freed.  Somone holding a &lt;br/&gt;
reference under the old logical connection ends up refering to a new logical connection by accident, not design.  &lt;br/&gt;
At least this guarded behavior should be the default, but I&apos;m not sure why it&apos;s ever right for user code to be &lt;br/&gt;
unguarded.  What am I missing?&lt;/p&gt;</comment>
                            <comment id="12406594" author="dirkv" created="Tue, 25 May 2004 20:00:48 +0000"  >&lt;p&gt;Some database vendors (Oracle for example) add extra methods to their Connection&lt;br/&gt;
implementation (not part of jdbc spec). So sometimes you need to access the&lt;br/&gt;
underlying physical connection and cast it to the specific implementation.&lt;/p&gt;

&lt;p&gt;But allowing direct access is indeed a dangerous operation and is disabled by&lt;br/&gt;
default.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://cvs.apache.org/viewcvs.cgi/jakarta-commons/dbcp/src/java/org/apache/commons/dbcp/PoolingDriver.java?r1=1.11&amp;amp;r2=1.12&amp;amp;diff_format=h&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://cvs.apache.org/viewcvs.cgi/jakarta-commons/dbcp/src/java/org/apache/commons/dbcp/PoolingDriver.java?r1=1.11&amp;amp;r2=1.12&amp;amp;diff_format=h&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;private static boolean accessToUnderlyingConnectionAllowed = false;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>28912</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114386</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            21 years, 25 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0ux7j:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178521</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-102] [dbcp] setReadOnly &amp; setAutoCommit called too many times</title>
                <link>https://issues.apache.org/jira/browse/DBCP-102</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;In order to gain some processor time for my application that uses Hibernate, I &lt;br/&gt;
looked with optimizeIt where it spends time. It seems that for a request on the &lt;br/&gt;
database (Oracle 9) around 25% (!!?) is spent on getting the connection from &lt;br/&gt;
the DBCP pool, and this not only the first time!. The methods that provoke this &lt;br/&gt;
loss of time are connection.setReadOnly and connection.setAutoCommit called &lt;br/&gt;
inside the method PoolableConnectionFactory.activateObject. Looking to the &lt;br/&gt;
stack, these calls translate to communication with the Oracle server. &lt;br/&gt;
The obvious thing to do is to check if read only and autocommit flags are &lt;br/&gt;
already set to the expected values. (Of course, Oracle could &apos;ve done this too, &lt;br/&gt;
but I hope you&apos;ll have a faster response &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; )&lt;/p&gt;

&lt;p&gt;Thank you very much for you help.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: other&lt;br/&gt;
Platform: Sun&lt;/p&gt;</environment>
        <key id="12341740">DBCP-102</key>
            <summary>[dbcp] setReadOnly &amp; setAutoCommit called too many times</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="acraciun@flashmail.com">AC</reporter>
                        <labels>
                    </labels>
                <created>Tue, 21 Sep 2004 22:18:16 +0000</created>
                <updated>Mon, 16 Feb 2009 15:51:09 +0000</updated>
                            <resolved>Mon, 23 Jul 2007 19:02:58 +0000</resolved>
                                    <version>1.2</version>
                                    <fixVersion>1.2.2</fixVersion>
                                        <due></due>
                            <votes>1</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="12407625" author="andy@agilbert.net" created="Fri, 18 Feb 2005 01:07:43 +0000"  >&lt;p&gt;We are experiencing a similar issue over a VPN connection where latency is&lt;br/&gt;
causing  problems when retrieving Connections from the pool. Testing a fix that&lt;br/&gt;
tests status of autocommit and readonly against default before setting&lt;br/&gt;
eliminates unecessary net traffic. The fix as applied to 1.2 of &quot;not set&quot; is not&lt;br/&gt;
suitable, as we definitely want the defaults set back if they have been changed,&lt;br/&gt;
ie Connections should come out of pool in known (default) state, but need to&lt;br/&gt;
avoid wasted network trip to set what is already set.&lt;/p&gt;
</comment>
                            <comment id="12407626" author="phil@steitz.com" created="Sun, 2 Apr 2006 09:01:02 +0000"  >&lt;p&gt;Fixed in r390763, nightlies starting 2 Apr 2006.&lt;/p&gt;</comment>
                            <comment id="12407627" author="pretbrao@yahoo.co.in" created="Thu, 20 Apr 2006 15:38:15 +0000"  >&lt;p&gt;(In reply to comment #2)&lt;br/&gt;
&amp;gt; Fixed in r390763, nightlies starting 2 Apr 2006.&lt;/p&gt;

&lt;p&gt;I just looked at the source code and activateObject() method in&lt;br/&gt;
PoolableConnectionfactory.java has been enhanced to first call&lt;br/&gt;
getAutoCommit() and then if needed call setAutoCommit().&lt;/p&gt;

&lt;p&gt;But as I have seen with OptimizeIt, passivateObject() too calls &lt;br/&gt;
setAutoCommit() without checking any condition, and that again &lt;br/&gt;
causes network overhead.&lt;/p&gt;

&lt;p&gt;Our application experiences about 20% difference in performance due &lt;br/&gt;
to this network overhead.&lt;/p&gt;

&lt;p&gt;a) should it too be fixed ?&lt;/p&gt;

&lt;p&gt;b) Is there no way to completely get rid of this network overhead due to&lt;br/&gt;
autoCommit? For example, if my application is sure that it will always use&lt;br/&gt;
autoCommit(true), then without any overhead I should be able to achieve it.&lt;br/&gt;
So, there should be a way to tell the DBCP that. &quot;let the application manage &lt;br/&gt;
all operations related to setting/getting auto commit&quot;. Same logic applies to &lt;br/&gt;
operation, that can be optionally turbed off. For example, here by optionally&lt;br/&gt;
not executing any code related to _defaultAutoCommit, we might achieve it.&lt;/p&gt;

&lt;p&gt;Thanks&lt;br/&gt;
Preetam&lt;/p&gt;</comment>
                            <comment id="12424433" author="psteitz" created="Sun, 30 Jul 2006 20:16:46 +0000"  >&lt;p&gt;Per last comment, passivateObject should also be fixed.&lt;/p&gt;</comment>
                            <comment id="12424439" author="psteitz" created="Sun, 30 Jul 2006 21:09:10 +0000"  >&lt;p&gt;passivateObject fix committed.&lt;/p&gt;</comment>
                            <comment id="12505838" author="pavel.sher" created="Mon, 18 Jun 2007 14:56:25 +0000"  >&lt;p&gt;It looks like the fix in passivateObject() is not quite correct. At the moment it sets auto commit to true if it was set to false:&lt;br/&gt;
if(!conn.getAutoCommit()) {&lt;br/&gt;
   conn.setAutoCommit(true);&lt;br/&gt;
}&lt;/p&gt;

&lt;p&gt;In our system we set default auto commit to false and now every time when connection is passivated we see unnecessary cal to setAutoCommit(true). For me passivateObject should reset auto commit to default value.&lt;/p&gt;</comment>
                            <comment id="12505930" author="psteitz" created="Mon, 18 Jun 2007 19:22:35 +0000"  >&lt;p&gt;Setting fix level to 1.3, as fix represents a behavior change for passivateObject  vs. 1.2 base.  The fix in 1.2.2 retained (broken?) 1.2.1 behavior.&lt;/p&gt;</comment>
                            <comment id="12505943" author="psteitz" created="Mon, 18 Jun 2007 20:27:46 +0000"  >&lt;p&gt;The hard-coded &lt;b&gt;true&lt;/b&gt; value for autoCommit in passivateObject was introduced to resolve &lt;a href=&quot;https://issues.apache.org/jira/browse/DBCP-97&quot; title=&quot;setAutoCommit(true) when returning connection to the pool&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DBCP-97&quot;&gt;&lt;del&gt;DBCP-97&lt;/del&gt;&lt;/a&gt; in r132043 (DBCP 1.1 release)&lt;/p&gt;</comment>
                            <comment id="12514733" author="dain" created="Mon, 23 Jul 2007 19:02:58 +0000"  >&lt;p&gt;Fixed some time ago.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10032">
                    <name>Blocker</name>
                                                                <inwardlinks description="is blocked by">
                                        <issuelink>
            <issuekey id="12340987">DBCP-97</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>31343</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114385</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            18 years, 16 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uvjb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178250</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-101] AutoCommit and ReadOnly</title>
                <link>https://issues.apache.org/jira/browse/DBCP-101</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;In PoolableConnectionFactory.passivateObject(Object), a Connection is attempted&lt;br/&gt;
rolled back, if autoCommit is false. This can cause exceptions with some drivers&lt;br/&gt;
if readOnly is true. A fix would be to test both autoCommit AND readOnly properties.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: All&lt;br/&gt;
Platform: All&lt;/p&gt;</environment>
        <key id="12341457">DBCP-101</key>
            <summary>AutoCommit and ReadOnly</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="nils_kilden-pedersen@countrywide.com">Nils Kilden-Pedersen</reporter>
                        <labels>
                    </labels>
                <created>Tue, 18 May 2004 13:30:59 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:32 +0000</updated>
                            <resolved>Tue, 25 Mar 2008 08:11:32 +0000</resolved>
                                    <version>1.1</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12406633" author="dirkv" created="Wed, 19 May 2004 01:21:20 +0000"  >&lt;p&gt;This is a DBCP issue.&lt;/p&gt;

&lt;p&gt;Can you give more information about the driver causing exceptions in this case?&lt;br/&gt;
Also, why would you turn off autocommit on a read-only database?&lt;/p&gt;</comment>
                            <comment id="12406634" author="nils_kilden-pedersen@countrywide.com" created="Wed, 19 May 2004 01:50:24 +0000"  >&lt;p&gt;Yes, you&apos;re right, it&apos;s DBCP. I got confused because it implements &lt;br/&gt;
PoolableObjectFactory from pool.&lt;br/&gt;
It is the DaffodilDB driver that will, and rightly so, throw an SQLException if &lt;br/&gt;
trying to commit or rollback a readOnly connection.&lt;br/&gt;
It&apos;s not really a matter of whether I want to turn on or off autocommit on &lt;br/&gt;
readonly. No attempt should be made to commit or rollback a Connection if it is &lt;br/&gt;
readonly.&lt;/p&gt;</comment>
                            <comment id="12406635" author="dirkv" created="Thu, 20 May 2004 20:16:22 +0000"  >&lt;p&gt;Issue fixed with extra test on readonly property. (as suggested by Nils)&lt;br/&gt;
Testcase added to TestBasicDataSource&lt;/p&gt;

&lt;p&gt;Changes to PoolableConnectionFactory.java&lt;br/&gt;
Revision : 1.22 Date : 2004/5/20 13:11:56&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>29055</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114384</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            21 years, 25 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uwmv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178428</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-100] [dbcp] NullPointerException retrieving connection from the pool</title>
                <link>https://issues.apache.org/jira/browse/DBCP-100</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;under some load we start getting this exception when retrieving connection from&lt;br/&gt;
pool:&lt;/p&gt;

&lt;p&gt;org.apache.commons.dbcp.SQLNestedException: Could not retrieve connection info&lt;br/&gt;
from pool&lt;br/&gt;
        at&lt;br/&gt;
org.apache.commons.dbcp.datasources.SharedPoolDataSource.getPooledConnectionAndInfo(SharedPoolDataSource.java:169)&lt;br/&gt;
        at&lt;br/&gt;
org.apache.commons.dbcp.datasources.InstanceKeyDataSource.getConnection(InstanceKeyDataSource.java:631)&lt;br/&gt;
        at&lt;br/&gt;
org.apache.commons.dbcp.datasources.InstanceKeyDataSource.getConnection(InstanceKeyDataSource.java:615)&lt;br/&gt;
        at org.apache.torque.TorqueInstance.getConnection(TorqueInstance.java:705)&lt;br/&gt;
        ... 34 more&lt;br/&gt;
Caused by: java.lang.NullPointerException&lt;br/&gt;
        at&lt;br/&gt;
org.apache.commons.collections.SequencedHashMap.insertEntry(SequencedHashMap.java:226)&lt;br/&gt;
        at&lt;br/&gt;
org.apache.commons.collections.SequencedHashMap.put(SequencedHashMap.java:451)&lt;br/&gt;
        at org.apache.commons.collections.LRUMap.put(LRUMap.java:125)&lt;br/&gt;
        at&lt;br/&gt;
org.apache.commons.dbcp.datasources.SharedPoolDataSource.getUserPassKey(SharedPoolDataSource.java:179)&lt;br/&gt;
        at&lt;br/&gt;
org.apache.commons.dbcp.datasources.SharedPoolDataSource.getPooledConnectionAndInfo(SharedPoolDataSource.java:165)&lt;br/&gt;
        ... 37 more&lt;/p&gt;

&lt;p&gt;this is apparently caused by improper syncronization:&lt;/p&gt;

&lt;p&gt;SharedPoolDataSource.getPooledConnectionAndInfo() is synchronized &lt;em&gt;instance&lt;/em&gt;&lt;br/&gt;
method, but it accesses SharedPoolDataSource.userKeys which is a &lt;em&gt;static&lt;/em&gt;&lt;br/&gt;
variable, so if you have more than one instance of SharedPoolDataSource (as we&lt;br/&gt;
do) access to the map would not be properly synchronized. So either map should&lt;br/&gt;
be made instance variable, or the method should be synchronized on the class,&lt;br/&gt;
not instance.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: Windows XP&lt;br/&gt;
Platform: Other&lt;/p&gt;</environment>
        <key id="12342390">DBCP-100</key>
            <summary>[dbcp] NullPointerException retrieving connection from the pool</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="fedor.karpelevitch@mscibarra.com">Fedor Karpelevitch</reporter>
                        <labels>
                    </labels>
                <created>Fri, 22 Jul 2005 07:13:15 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:32 +0000</updated>
                            <resolved>Mon, 21 Aug 2006 00:34:23 +0000</resolved>
                                                    <fixVersion>1.2.2</fixVersion>
                                        <due></due>
                            <votes>3</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="12429310" author="psteitz" created="Mon, 21 Aug 2006 00:34:23 +0000"  >&lt;p&gt;Made userKeys an instance variable.  Fixed in r433104, nightlies starting 21-aug-06.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>35825</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114383</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            19 years, 12 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uxin:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178571</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-99] BasicDataSource defaults are unusable</title>
                <link>https://issues.apache.org/jira/browse/DBCP-99</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;BasicDataSource includes a number of properties that it sets to default values &lt;br/&gt;
when an instance is created.  BasicDataSourceFactory then set these properties &lt;br/&gt;
to whatever values it received from the container.  However, if the container &lt;br/&gt;
does not provide values for some properties, those properties retain their &lt;br/&gt;
default values, producing a connection pool that is completely unusable.  &lt;br/&gt;
Specificially, if maxActive and maxWait are not set from the container, then &lt;br/&gt;
their default values of 0 for maxActive and -1 (forever) for maxWait produce a &lt;br/&gt;
connection pool that blocks forever whenever the application attempts to &lt;br/&gt;
retrieve a connection.  I suggest that BasicDataSource should use the defaults &lt;br/&gt;
defined in GenericObjectPool.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: Linux&lt;br/&gt;
Platform: PC&lt;/p&gt;</environment>
        <key id="12340270">DBCP-99</key>
            <summary>BasicDataSource defaults are unusable</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="wboyce@panix.com">Willis Blackburn</reporter>
                        <labels>
                    </labels>
                <created>Fri, 19 Jul 2002 04:46:06 +0000</created>
                <updated>Tue, 16 May 2006 12:48:51 +0000</updated>
                            <resolved>Tue, 16 May 2006 12:48:51 +0000</resolved>
                                    <version>Nightly Builds</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12402785" author="craig.mcclanahan@sun.com" created="Sun, 21 Jul 2002 00:38:20 +0000"  >&lt;p&gt;Fixed in nightly build 20020721.&lt;/p&gt;</comment>
                            <comment id="12402786" author="glenn@apache.org" created="Sun, 21 Jul 2002 03:43:03 +0000"  >&lt;ul&gt;
	&lt;li&gt;
	&lt;ul&gt;
		&lt;li&gt;
		&lt;ul&gt;
			&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/DBCP-16&quot; title=&quot;dataSource.getConnection never returns in Tomcat using DBCP&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DBCP-16&quot;&gt;&lt;del&gt;COM-105&lt;/del&gt;&lt;/a&gt; has been marked as a duplicate of this bug. ***&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>10969</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114382</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            23 years, 17 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uwon:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178436</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-98] DBCP log message in tomcat has incorrect day</title>
                <link>https://issues.apache.org/jira/browse/DBCP-98</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;It looks like the timestamp generated by DBCP incorrectly updates the &quot;day&quot; &lt;br/&gt;
with the &quot;minute&quot;.  Here&apos;s an grep of the DBCP log in my catalina.out file:&lt;/p&gt;

&lt;p&gt;DBCP object created 2004-23-06 14:23:39 by the following code was never closed:&lt;br/&gt;
DBCP object created 2004-39-06 14:39:51 by the following code was never closed:&lt;br/&gt;
DBCP object created 2004-56-06 14:56:06 by the following code was never closed:&lt;br/&gt;
DBCP object created 2004-11-06 15:11:20 by the following code was never closed:&lt;br/&gt;
DBCP object created 2004-12-06 15:12:57 by the following code was never closed:&lt;br/&gt;
DBCP object created 2004-23-06 15:23:30 by the following code was never closed:&lt;br/&gt;
DBCP object created 2004-02-06 16:02:06 by the following code was never closed:&lt;br/&gt;
DBCP object created 2004-43-06 20:43:47 by the following code was never closed:&lt;br/&gt;
DBCP object created 2004-47-06 20:47:46 by the following code was never closed:&lt;br/&gt;
DBCP object created 2004-56-06 20:56:21 by the following code was never closed:&lt;br/&gt;
DBCP object created 2004-47-06 21:47:07 by the following code was never closed:&lt;br/&gt;
DBCP object created 2004-52-06 21:52:19 by the following code was never closed:&lt;/p&gt;

&lt;p&gt;As you can tell, the date always match the minute.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: Linux&lt;br/&gt;
Platform: PC&lt;/p&gt;</environment>
        <key id="12341214">DBCP-98</key>
            <summary>DBCP log message in tomcat has incorrect day</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="jmwhite@interval.com">Jean-Marie White</reporter>
                        <labels>
                    </labels>
                <created>Tue, 20 Jan 2004 07:03:42 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:31 +0000</updated>
                            <resolved>Tue, 25 Mar 2008 08:11:31 +0000</resolved>
                                    <version>1.0</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12405840" author="jmwhite@interval.com" created="Tue, 20 Jan 2004 07:28:08 +0000"  >&lt;p&gt;Hum... let me rephrase that.  It looks like the &quot;month&quot; is incorrectly updated &lt;br/&gt;
with the value of the &quot;minute&quot; field.&lt;/p&gt;</comment>
                            <comment id="12405841" author="dirkv" created="Wed, 21 Jan 2004 05:30:36 +0000"  >&lt;p&gt;This bug was fixed on Mon Sep 30 13:31:12 2002&lt;br/&gt;
and is included in the 1.1 release&lt;/p&gt;

&lt;p&gt;Please upgrade to version 1.1 of DBCP &amp;amp; pool.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>26262</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114381</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            21 years, 43 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uz3b:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178826</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-97] setAutoCommit(true) when returning connection to the pool</title>
                <link>https://issues.apache.org/jira/browse/DBCP-97</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;From the Struts user list: &lt;span class=&quot;error&quot;&gt;&amp;#91;OT&amp;#93;&lt;/span&gt; RE: Stackoverflow after DB inactivity &lt;br/&gt;
(MySQL reconnect problem)&lt;br/&gt;
&lt;a href=&quot;http://www.mail-archive.com/mysql@lists.mysql.com/msg70196.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.mail-archive.com/mysql@lists.mysql.com/msg70196.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Giving a hint to the database driver that you don&apos;t need long running&lt;br/&gt;
transactions makes sense. &lt;/p&gt;

&lt;p&gt;setAutoCommit(true) should be added to PoolableConnectionFactory.passivateObject&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: All&lt;br/&gt;
Platform: All&lt;/p&gt;</environment>
        <key id="12340987">DBCP-97</key>
            <summary>setAutoCommit(true) when returning connection to the pool</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="dirkv">Dirk Verbeeck</reporter>
                        <labels>
                    </labels>
                <created>Sat, 20 Sep 2003 23:42:46 +0000</created>
                <updated>Mon, 23 Jul 2007 19:03:18 +0000</updated>
                            <resolved>Mon, 23 Jul 2007 19:03:18 +0000</resolved>
                                    <version>Nightly Builds</version>
                                    <fixVersion>1.3</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12405138" author="dirkv" created="Sun, 21 Sep 2003 00:03:16 +0000"  >&lt;p&gt;implemented in PoolableConnectionFactory revision: 1.14&lt;/p&gt;</comment>
                            <comment id="12505944" author="psteitz" created="Mon, 18 Jun 2007 20:29:40 +0000"  >&lt;p&gt;Need to verify this fix is correct and necessary.&lt;/p&gt;</comment>
                            <comment id="12514044" author="dain" created="Thu, 19 Jul 2007 23:26:05 +0000"  >&lt;p&gt;Yes, this is correct.  When auto commit is off, you have an open transaction with the database, so leaving auto commit off while a connection is idle in the pool is a bad idea.&lt;/p&gt;

&lt;p&gt;One note.  The current passivate code has the following block:&lt;/p&gt;

&lt;p&gt;            conn.clearWarnings();&lt;br/&gt;
            if(!conn.getAutoCommit()) &lt;/p&gt;
{
                conn.setAutoCommit(true);
            }

&lt;p&gt;Do we want the clearWarnings() after the potential autocommit change?&lt;/p&gt;</comment>
                            <comment id="12514734" author="dain" created="Mon, 23 Jul 2007 19:03:18 +0000"  >&lt;p&gt;Fixed some time ago.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10032">
                    <name>Blocker</name>
                                            <outwardlinks description="blocks">
                                        <issuelink>
            <issuekey id="12341740">DBCP-102</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>23293</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114380</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            18 years, 16 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uwyn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178481</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-96] Delegating ResultSet causing NPE</title>
                <link>https://issues.apache.org/jira/browse/DBCP-96</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;If you execute a query that would result in a NULL ResultSet, DBCP still &lt;br/&gt;
produces a delegating resultset instance, with a null _res member field.&lt;/p&gt;

&lt;p&gt;Therefore this breaks the contract of Statement.getResultSet which is permitted &lt;br/&gt;
to return null in this condition.&lt;/p&gt;

&lt;p&gt;Also, because you cannot tell the ResultSet was null because you get a delegated &lt;br/&gt;
one, so you have no choice but to have your code clean up nicely - but any &lt;br/&gt;
methods called cause an NPE - i.e. rs.next(), rs.close() - because of this &lt;br/&gt;
problem.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: Windows XP&lt;br/&gt;
Platform: PC&lt;/p&gt;</environment>
        <key id="12340892">DBCP-96</key>
            <summary>Delegating ResultSet causing NPE</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="marc@anyware.co.uk">Marc Palmer</reporter>
                        <labels>
                    </labels>
                <created>Thu, 7 Aug 2003 20:10:28 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:31 +0000</updated>
                            <resolved>Tue, 25 Mar 2008 08:11:31 +0000</resolved>
                                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12404814" author="marty_f_rose@hotmail.com" created="Thu, 7 Aug 2003 20:49:17 +0000"  >&lt;p&gt;At a glance it appears to me that the latest code in CVS should not be doing this...&lt;/p&gt;

&lt;p&gt;If you look at&lt;/p&gt;
{DelegatingCallableStatement/DelegatingPreparedStatement/DelegatingStatement}
&lt;p&gt;,&lt;br/&gt;
and look at their getResultSet() methods, they do the following:&lt;/p&gt;

&lt;p&gt;    public ResultSet getResultSet() throws SQLException &lt;/p&gt;
{
        checkOpen();
        return DelegatingResultSet.wrapResultSet(this,_stmt.getResultSet());
    }

&lt;p&gt;And if we go look at DelegatingResultSet.wrapResultSet(ResultSet rs) :&lt;/p&gt;

&lt;p&gt;    public static ResultSet wrapResultSet(Statement stmt, ResultSet rset) {&lt;br/&gt;
        if(null == rset) &lt;/p&gt;
{
            return null;
        }
&lt;p&gt; else &lt;/p&gt;
{
            return new DelegatingResultSet(stmt,rset);
        }
&lt;p&gt;    }&lt;/p&gt;

&lt;p&gt;And the sample code snippet I wrote doesn&apos;t seem to do this either...  &lt;br/&gt;
        Connection conn = null;&lt;br/&gt;
        try &lt;/p&gt;
{
            conn = ConnectionFactory.getConnection(&quot;ORBIDSS&quot;); // Get A Pooled
Connection
            Statement stmt = conn.createStatement();
            stmt.execute(&quot;update table set table_id=1 where table_id=1000000&quot;);
            log.warn(&quot;&quot; + (stmt.getResultSet() == null));
        }
&lt;p&gt; catch( Throwable t ) {&lt;/p&gt;

&lt;p&gt;        } finally &lt;/p&gt;
{
            util.Utilities.closeConnection(conn);
        }

&lt;p&gt;Could you make sure you&apos;re using the released dbcp, and if possible post some&lt;br/&gt;
generic code that I could see how you&apos;re using this to get it to break???&lt;/p&gt;</comment>
                            <comment id="12404815" author="marc@anyware.co.uk" created="Thu, 7 Aug 2003 21:53:56 +0000"  >&lt;p&gt;I am using the only binary build I can find on Jakarta... the 12 August 2002 &lt;br/&gt;
build.&lt;/p&gt;

&lt;p&gt;If this is not compatible with the latest CVS I suggest a new binary build, as &lt;br/&gt;
many people who wish to use DBCP with Tomcat will be downloading the binary &lt;br/&gt;
version, and this could break code that would work without DBCP.&lt;/p&gt;

</comment>
                            <comment id="12404816" author="dirkv" created="Sun, 10 Aug 2003 03:35:13 +0000"  >&lt;p&gt;Fix was committed on 2002/10/31 21:14:32&lt;br/&gt;
and is therefor not in the 1.0.1 release&lt;br/&gt;
you will need to use a nightly build or build from source&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>22214</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114379</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            22 years, 14 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uwzj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178485</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-95] GenericObjectPool.invalidateObject() doesn&apos;t work with AbandonedObjectPool</title>
                <link>https://issues.apache.org/jira/browse/DBCP-95</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;AbandonedObjectPool inherits invalidateObject() from GenericObjectPool, but this&lt;br/&gt;
method doesn&apos;t update the list of connections in use. Yuck!&lt;/p&gt;

&lt;p&gt;AbandonedObjectPool should overwrite the method - possibly like this:&lt;/p&gt;


&lt;p&gt;    public synchronized void invalidateObject(Object obj) throws Exception {&lt;br/&gt;
        if (config != null &amp;amp;&amp;amp; config.getRemoveAbandoned()) &lt;/p&gt;
{
            trace.remove(obj);
        }
&lt;p&gt;	super.invalidateObject(obj);        &lt;br/&gt;
    }&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: Linux&lt;br/&gt;
Platform: PC&lt;/p&gt;</environment>
        <key id="12340550">DBCP-95</key>
            <summary>GenericObjectPool.invalidateObject() doesn&apos;t work with AbandonedObjectPool</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="mic@schlund.de">Michael Salzmann</reporter>
                        <labels>
                    </labels>
                <created>Thu, 13 Feb 2003 02:10:53 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:31 +0000</updated>
                            <resolved>Tue, 25 Mar 2008 08:11:31 +0000</resolved>
                                    <version>Nightly Builds</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12403630" author="rwaldhoff@apache.org" created="Fri, 7 Mar 2003 03:01:20 +0000"  >&lt;p&gt;Change applied.  Thanks.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>17015</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114378</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            22 years, 36 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uwun:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178463</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-94] SQLTransformer.java - infinite loop in getConnection</title>
                <link>https://issues.apache.org/jira/browse/DBCP-94</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;method getConnection&lt;br/&gt;
When a datasource exists, but does not return a connection, goes into an &lt;br/&gt;
infinite loop.  Datasource bug lies deeper, and probably related to JDK1.4 &lt;br/&gt;
classloader problem, but this loop should exit gracefully on error.  Reproduces &lt;br/&gt;
identically on Win2000 and Linux.&lt;/p&gt;

&lt;p&gt;Reproducible with /cocoon/sql/sql-page example.&lt;br/&gt;
Log:&lt;br/&gt;
DEBUG   (2002-03-06) 15:40.18:841   &lt;span class=&quot;error&quot;&gt;&amp;#91;sitemap.transformer.sql&amp;#93;&lt;/span&gt; (/cocoon/sql/sql-&lt;br/&gt;
page) HttpProcessor&lt;span class=&quot;error&quot;&gt;&amp;#91;8080&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;3&amp;#93;&lt;/span&gt;/SQLTransformer$Query: SQLTransformer$Query: could &lt;br/&gt;
not acquire a Connection &amp;#8211; waiting 0 ms to try again.&lt;/p&gt;

&lt;p&gt;Although I did not check the source of 2.0.1, but it appears that the &lt;br/&gt;
throttling final variable waittime is not working either.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: All&lt;br/&gt;
Platform: All&lt;/p&gt;</environment>
        <key id="12340180">DBCP-94</key>
            <summary>SQLTransformer.java - infinite loop in getConnection</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="3">Duplicate</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="akber@dyanet.com">Akber Choudhry</reporter>
                        <labels>
                    </labels>
                <created>Thu, 7 Mar 2002 04:37:27 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:31 +0000</updated>
                            <resolved>Tue, 25 Mar 2008 08:11:31 +0000</resolved>
                                    <version>1.0</version>
                                    <fixVersion>1.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12402536" author="vgritsenko" created="Wed, 19 Jun 2002 10:22:45 +0000"  >&lt;p&gt;Fixed. Added configuration parameters.&lt;/p&gt;</comment>
                            <comment id="12402537" author="daniel.santos@pobox.com" created="Sat, 20 Sep 2003 15:22:06 +0000"  >&lt;p&gt;This bug does not appear to be fixed or is of deeper scope than originally&lt;br/&gt;
believed. I had a typo in my validationQuery and I was going into an infinte&lt;br/&gt;
loop as well. This means that the validation query would have failed but the&lt;br/&gt;
failure was not picked up and it was repeatedly attempted. I ran tomcat in dbg&lt;br/&gt;
and was able to ascertain this much. I am using 4.1.27 and JDK 1.4.1_02 on Win2k&lt;br/&gt;
sp2 using the new oracle jdbc drivers (v9.2.0.1) in ojdbc14.jar. Here is the&lt;br/&gt;
stack trace where it appeared to spend most of it&apos;s time (I didn&apos;t run an hprof)&lt;/p&gt;

&lt;p&gt;  &lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; java.net.SocketInputStream.socketRead0 (native method)&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;2&amp;#93;&lt;/span&gt; java.net.SocketInputStream.read (SocketInputStream.java:129)&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;3&amp;#93;&lt;/span&gt; oracle.net.ns.Packet.receive (null)&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;4&amp;#93;&lt;/span&gt; oracle.net.ns.DataPacket.receive (null)&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;5&amp;#93;&lt;/span&gt; oracle.net.ns.NetInputStream.getNextPacket (null)&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;6&amp;#93;&lt;/span&gt; oracle.net.ns.NetInputStream.read (null)&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;7&amp;#93;&lt;/span&gt; oracle.net.ns.NetInputStream.read (null)&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;8&amp;#93;&lt;/span&gt; oracle.net.ns.NetInputStream.read (null)&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;9&amp;#93;&lt;/span&gt; oracle.jdbc.ttc7.MAREngine.unmarshalUB1 (MAREngine.java:931)&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;10&amp;#93;&lt;/span&gt; oracle.jdbc.ttc7.MAREngine.unmarshalSB1 (MAREngine.java:893)&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;11&amp;#93;&lt;/span&gt; oracle.jdbc.ttc7.O3log.receive1st (O3log.java:353)&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;12&amp;#93;&lt;/span&gt; oracle.jdbc.ttc7.TTC7Protocol.logon (TTC7Protocol.java:260)&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;13&amp;#93;&lt;/span&gt; oracle.jdbc.driver.OracleConnection.&amp;lt;init&amp;gt; (OracleConnection.java:360)&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;14&amp;#93;&lt;/span&gt; oracle.jdbc.driver.OracleDriver.getConnectionInstance (OracleDriver.java:521)&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;15&amp;#93;&lt;/span&gt; oracle.jdbc.driver.OracleDriver.connect (OracleDriver.java:325)&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;16&amp;#93;&lt;/span&gt; org.apache.commons.dbcp.DriverConnectionFactory.createConnection&lt;br/&gt;
(DriverConnectionFactory.java:83)&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;17&amp;#93;&lt;/span&gt; org.apache.commons.dbcp.PoolableConnectionFactory.makeObject&lt;br/&gt;
(PoolableConnectionFactory.java:184)&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;18&amp;#93;&lt;/span&gt; org.apache.commons.pool.impl.GenericObjectPool.borrowObject (null)&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;19&amp;#93;&lt;/span&gt; org.apache.commons.dbcp.AbandonedObjectPool.borrowObject&lt;br/&gt;
(AbandonedObjectPool.java:117)&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;20&amp;#93;&lt;/span&gt; org.apache.commons.dbcp.PoolingDataSource.getConnection&lt;br/&gt;
(PoolingDataSource.java:110)&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;21&amp;#93;&lt;/span&gt; org.apache.commons.dbcp.BasicDataSource.getConnection&lt;br/&gt;
(BasicDataSource.java:312)&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;22&amp;#93;&lt;/span&gt; org.apache.jsp.TestTomcatConnectionPool_jsp._jspService&lt;br/&gt;
(TestTomcatConnectionPool_jsp.java:117)&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;23&amp;#93;&lt;/span&gt; org.apache.jasper.runtime.HttpJspBase.service (HttpJspBase.java:137)&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;24&amp;#93;&lt;/span&gt; javax.servlet.http.HttpServlet.service (HttpServlet.java:853)&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;25&amp;#93;&lt;/span&gt; org.apache.jasper.servlet.JspServletWrapper.service&lt;br/&gt;
(JspServletWrapper.java:210)&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;26&amp;#93;&lt;/span&gt; org.apache.jasper.servlet.JspServlet.serviceJspFile (JspServlet.java:295)&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;27&amp;#93;&lt;/span&gt; org.apache.jasper.servlet.JspServlet.service (JspServlet.java:241)&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;28&amp;#93;&lt;/span&gt; javax.servlet.http.HttpServlet.service (HttpServlet.java:853)&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;29&amp;#93;&lt;/span&gt; org.apache.catalina.core.ApplicationFilterChain.internalDoFilter&lt;br/&gt;
(ApplicationFilterChain.java:247)&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;30&amp;#93;&lt;/span&gt; org.apache.catalina.core.ApplicationFilterChain.doFilter&lt;br/&gt;
(ApplicationFilterChain.java:193)&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;31&amp;#93;&lt;/span&gt; org.apache.catalina.core.StandardWrapperValve.invoke&lt;br/&gt;
(StandardWrapperValve.java:256)&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;32&amp;#93;&lt;/span&gt;&lt;br/&gt;
org.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNext&lt;br/&gt;
(StandardPipeline.java:643)&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;33&amp;#93;&lt;/span&gt; org.apache.catalina.core.StandardPipeline.invoke (StandardPipeline.java:480)&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;34&amp;#93;&lt;/span&gt; org.apache.catalina.core.ContainerBase.invoke (ContainerBase.java:995)&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;35&amp;#93;&lt;/span&gt; org.apache.catalina.core.StandardContextValve.invoke&lt;br/&gt;
(StandardContextValve.java:191)&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;36&amp;#93;&lt;/span&gt;&lt;br/&gt;
org.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNext&lt;br/&gt;
(StandardPipeline.java:643)&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;37&amp;#93;&lt;/span&gt; org.apache.catalina.core.StandardPipeline.invoke (StandardPipeline.java:480)&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;38&amp;#93;&lt;/span&gt; org.apache.catalina.core.ContainerBase.invoke (ContainerBase.java:995)&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;39&amp;#93;&lt;/span&gt; org.apache.catalina.core.StandardContext.invoke (StandardContext.java:2,416)&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;40&amp;#93;&lt;/span&gt; org.apache.catalina.core.StandardHostValve.invoke&lt;br/&gt;
(StandardHostValve.java:180)&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;41&amp;#93;&lt;/span&gt;&lt;br/&gt;
org.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNext&lt;br/&gt;
(StandardPipeline.java:643)&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;42&amp;#93;&lt;/span&gt; org.apache.catalina.valves.ErrorDispatcherValve.invoke&lt;br/&gt;
(ErrorDispatcherValve.java:171)&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;43&amp;#93;&lt;/span&gt;&lt;br/&gt;
org.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNext&lt;br/&gt;
(StandardPipeline.java:641)&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;44&amp;#93;&lt;/span&gt; org.apache.catalina.valves.ErrorReportValve.invoke&lt;br/&gt;
(ErrorReportValve.java:172)&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;45&amp;#93;&lt;/span&gt;&lt;br/&gt;
org.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNext&lt;br/&gt;
(StandardPipeline.java:641)&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;46&amp;#93;&lt;/span&gt; org.apache.catalina.core.StandardPipeline.invoke (StandardPipeline.java:480)&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;47&amp;#93;&lt;/span&gt; org.apache.catalina.core.ContainerBase.invoke (ContainerBase.java:995)&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;48&amp;#93;&lt;/span&gt; org.apache.catalina.core.StandardEngineValve.invoke&lt;br/&gt;
(StandardEngineValve.java:174)&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;49&amp;#93;&lt;/span&gt;&lt;br/&gt;
org.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNext&lt;br/&gt;
(StandardPipeline.java:643)&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;50&amp;#93;&lt;/span&gt; org.apache.catalina.core.StandardPipeline.invoke (StandardPipeline.java:480)&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;51&amp;#93;&lt;/span&gt; org.apache.catalina.core.ContainerBase.invoke (ContainerBase.java:995)&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;52&amp;#93;&lt;/span&gt; org.apache.coyote.tomcat4.CoyoteAdapter.service (CoyoteAdapter.java:223)&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;53&amp;#93;&lt;/span&gt; org.apache.coyote.http11.Http11Processor.process (Http11Processor.java:601)&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;54&amp;#93;&lt;/span&gt;&lt;br/&gt;
org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.processConnection&lt;br/&gt;
(Http11Protocol.java:392)&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;55&amp;#93;&lt;/span&gt; org.apache.tomcat.util.net.TcpWorkerThread.runIt (PoolTcpEndpoint.java:565)&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;56&amp;#93;&lt;/span&gt; org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run&lt;br/&gt;
(ThreadPool.java:619)&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;57&amp;#93;&lt;/span&gt; java.lang.Thread.run (Thread.java:534)&lt;/p&gt;

&lt;p&gt;To reproduce this bug, you can just create an error in your validation query&lt;br/&gt;
string and then attempt to getConnection and you will enter the loop. Can we try&lt;br/&gt;
to get to the root of this exception handling please? This would be a nice place&lt;br/&gt;
to get an exception or at least a null from getConnection() and the exception&lt;br/&gt;
logged or sent to standard out. Please? &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; I will try to take a look at it&lt;br/&gt;
also... Probably the exception is being thrown past&lt;br/&gt;
org.apache.commons.dbcp.DriverConnectionFactory.createConnection and getting&lt;br/&gt;
caught and improperly handled somewhere in the org.apache.commons.dbcp package&lt;br/&gt;
is my guess. I moved this bug to the commons product.&lt;/p&gt;

&lt;p&gt;Daniel&lt;/p&gt;</comment>
                            <comment id="12402538" author="daniel.santos@pobox.com" created="Sat, 20 Sep 2003 15:29:57 +0000"  >&lt;p&gt;oops, need to reassign this...&lt;/p&gt;</comment>
                            <comment id="12402539" author="dirkv" created="Sat, 20 Sep 2003 19:08:42 +0000"  >

&lt;ul&gt;
	&lt;li&gt;
	&lt;ul&gt;
		&lt;li&gt;
		&lt;ul&gt;
			&lt;li&gt;This bug has been marked as a duplicate of 23081 ***&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="12402540" author="dirkv" created="Sat, 20 Sep 2003 19:09:41 +0000"  >&lt;p&gt;Fixed in nightly build&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>6934</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114377</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            22 years, 8 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uzvb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178952</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-93] [dbcp] BasicDataSource.createDataSource() memory leak on SQLExceptions</title>
                <link>https://issues.apache.org/jira/browse/DBCP-93</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;Using:&lt;br/&gt;
commons-dbcp-1.2.1&lt;br/&gt;
commons-pool-1.2&lt;/p&gt;

&lt;p&gt;When using BasicDataSource, if the datasource is initialized while the database &lt;br/&gt;
is down, or a wrong user/pass is given, each call to getConnection() results in &lt;br/&gt;
a memory leak.&lt;/p&gt;

&lt;p&gt;Here&apos;s what I&apos;ve tracked down:&lt;/p&gt;

&lt;p&gt;In the BasicDataSource.createDataSource method, if the datasource was &lt;br/&gt;
previously un-initialized, a new GenericObjectPool (or AbandonedObjectPool &lt;br/&gt;
depending on configuration) is always instantiated.&lt;/p&gt;

&lt;p&gt;The GenericObjectPool constructor (and also the call to &lt;br/&gt;
setTimeBetweenEvictionRunsMillis()) starts a new thread for the Evictor.  This &lt;br/&gt;
thread runs until it&apos;s cancel() is called.&lt;/p&gt;

&lt;p&gt;The problem is that if a SQLException is thrown when the &lt;br/&gt;
PoolableConnectionFactory is instantiated (like with a bad user/pass), the &lt;br/&gt;
exception is rethrown, but no attempt is made to clean up the Evictor thread &lt;br/&gt;
that was started in the GenericObjectPool, so that thread just keeps running &lt;br/&gt;
forever.  Since this happens before the datasource was created, the next call &lt;br/&gt;
to getConnection() will again attempt to re-initialize the datasource in &lt;br/&gt;
createDataSource(), and if the same error happens again, another Evictor thread &lt;br/&gt;
will be left running, -&amp;gt; repeat a few thousand times and it starts to bring &lt;br/&gt;
down systems.&lt;/p&gt;

&lt;p&gt;Changing BasicDataSource to only initialize the connectionPool when it is null &lt;br/&gt;
seemed resolve the issue.  Alternatively, catching the exception, and calling &lt;br/&gt;
close() on the pool (which then cancel()&apos;s the Evictor) also seemed to work.&lt;/p&gt;

&lt;p&gt;Environment:&lt;br/&gt;
WinXP&lt;br/&gt;
SQL2000&lt;br/&gt;
JSQLConnect driver&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: Windows XP&lt;br/&gt;
Platform: PC&lt;/p&gt;</environment>
        <key id="12342799">DBCP-93</key>
            <summary>[dbcp] BasicDataSource.createDataSource() memory leak on SQLExceptions</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="ekaufman@infinitecampus.com">ekaufman</reporter>
                        <labels>
                    </labels>
                <created>Fri, 16 Dec 2005 08:47:53 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:31 +0000</updated>
                            <resolved>Thu, 14 Sep 2006 06:02:25 +0000</resolved>
                                                    <fixVersion>1.2.2</fixVersion>
                                        <due></due>
                            <votes>1</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="12411081" author="ekaufman@infinitecampus.com" created="Tue, 20 Dec 2005 03:42:51 +0000"  >&lt;p&gt;Created an attachment (id=17241)&lt;br/&gt;
Proposed Patch&lt;/p&gt;


&lt;p&gt;The changes I made here took care of the issue in my testing.&lt;/p&gt;</comment>
                            <comment id="12434596" author="psteitz" created="Thu, 14 Sep 2006 06:02:25 +0000"  >&lt;p&gt;This bug is fixed by the upgrade to commons pool 1.3, which no longer spawns threads for the evictor functionality.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12333954" name="ASF.LICENSE.NOT.GRANTED--BasicDataSource.java" size="31594" author="ekaufman@infinitecampus.com" created="Tue, 20 Dec 2005 03:42:51 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>37926</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114376</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            19 years, 9 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uvkn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178256</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-92] Unecessary global synchronized in AbandonedObjectPool methods</title>
                <link>https://issues.apache.org/jira/browse/DBCP-92</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;Rather than having &quot;public synchronized void returnObject()/borrowObject()&quot;&lt;br/&gt;
wouldn&apos;t this be better if RemoveAbandoned is false:&lt;/p&gt;

&lt;p&gt;    public void returnObject(Object obj) throws Exception {&lt;br/&gt;
      long startTime = System.currentTimeMillis();&lt;br/&gt;
        if (config != null &amp;amp;&amp;amp; config.getRemoveAbandoned()) {&lt;br/&gt;
            synchronized(this) &lt;/p&gt;
{
              trace.remove(obj);
            }
&lt;p&gt;        }&lt;br/&gt;
        super.returnObject(obj);&lt;br/&gt;
    }&lt;/p&gt;

&lt;p&gt;   George&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: Linux&lt;br/&gt;
Platform: PC&lt;/p&gt;</environment>
        <key id="12340695">DBCP-92</key>
            <summary>Unecessary global synchronized in AbandonedObjectPool methods</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="4">Incomplete</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="george.lindholm@ubc.ca">George Lindholm</reporter>
                        <labels>
                    </labels>
                <created>Sat, 3 May 2003 04:12:24 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:31 +0000</updated>
                            <resolved>Tue, 25 Mar 2008 08:11:31 +0000</resolved>
                                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12404191" author="dgraham@apache.org" created="Sat, 3 May 2003 04:13:48 +0000"  >&lt;p&gt;The abandoned functionality has been deprecated.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>19615</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114375</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            22 years, 28 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0v0kv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>179067</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-91] dbcp 1.2 doesn&apos;t work on JDK1.3</title>
                <link>https://issues.apache.org/jira/browse/DBCP-91</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;It used some APIs which are only available on JDK 1.4&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: other&lt;br/&gt;
Platform: All&lt;/p&gt;</environment>
        <key id="12341510">DBCP-91</key>
            <summary>dbcp 1.2 doesn&apos;t work on JDK1.3</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="shuangli@yahoo.com">slc</reporter>
                        <labels>
                    </labels>
                <created>Tue, 15 Jun 2004 01:29:04 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:31 +0000</updated>
                            <resolved>Tue, 25 Mar 2008 08:11:31 +0000</resolved>
                                    <version>1.2</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12406836" author="dirkv" created="Tue, 15 Jun 2004 03:22:00 +0000"  >&lt;p&gt;DBCP 1.2.1 was just released to fix this problem&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>29560</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114374</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            21 years, 22 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uw93:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178366</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-90] Please give possibility to acecss ObjectPools from PoolingDriver or at least un-deprecate PoolingDriver.getPool()</title>
                <link>https://issues.apache.org/jira/browse/DBCP-90</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;PoolingDriver.getPool() provides a great method to get statistics about an &lt;br/&gt;
active pool, even from a static context (eg a web page for an servlet program &lt;br/&gt;
that provides statistics)&lt;br/&gt;
ObjectPool instances are usually used only once by an API end user, that is &lt;br/&gt;
when setting up the PoolableConnectionFactory.&lt;br/&gt;
After that, the ObjectPool disappears in the internals of the PoolingDriver.&lt;/p&gt;

&lt;p&gt;Therefore, the PoolingDriver is also the right place to get back an instance of &lt;br/&gt;
the ObjectPool, ay? &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;I think that the best way would be to have a static method:&lt;br/&gt;
public static ObjectPool getPool(String name);&lt;br/&gt;
and I should also be able to get a list of all pool names registered to the &lt;br/&gt;
PoolingDriver, e.g.&lt;br/&gt;
public static Enumeration getPoolNames();&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: other&lt;br/&gt;
Platform: Other&lt;/p&gt;</environment>
        <key id="12341130">DBCP-90</key>
            <summary>Please give possibility to acecss ObjectPools from PoolingDriver or at least un-deprecate PoolingDriver.getPool()</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="g.hueller@gmx.at">Gernot H&#195;&#188;ller</reporter>
                        <labels>
                    </labels>
                <created>Fri, 28 Nov 2003 20:13:18 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:31 +0000</updated>
                            <resolved>Tue, 25 Mar 2008 08:11:31 +0000</resolved>
                                    <version>1.1</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12405571" author="dirkv" created="Fri, 26 Dec 2003 21:36:45 +0000"  >&lt;p&gt;Added the requested getPoolNames method.&lt;br/&gt;
The following methods are now available:&lt;br/&gt;
   public synchronized void registerPool(String name, ObjectPool pool)&lt;br/&gt;
   public synchronized void closePool(String name)&lt;br/&gt;
   public synchronized String[] getPoolNames()&lt;br/&gt;
   public synchronized ObjectPool getConnectionPool(String name)&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>25067</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114373</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            21 years, 46 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uxtb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178619</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-89] [dbcp] The API needs clarifications</title>
                <link>https://issues.apache.org/jira/browse/DBCP-89</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;Hi,&lt;br/&gt;
Thanks for your effort in putting together the db pool.&lt;br/&gt;
I would like to point out some clarifications:&lt;/p&gt;

&lt;p&gt;1. in the XML example there is an xml problem in the comment &amp;lt;;!-- validation &lt;br/&gt;
query --&amp;gt;&lt;/p&gt;

&lt;p&gt;2. You should probably state that the commons-pool package is required (quite &lt;br/&gt;
obvious) and that the commons-collections package is required for the pool &lt;br/&gt;
(not obvious at all), this is used in the GenericObjectPool Ctor.&lt;/p&gt;

&lt;p&gt;Keep up the good work!&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: All&lt;br/&gt;
Platform: All&lt;/p&gt;</environment>
        <key id="12341948">DBCP-89</key>
            <summary>[dbcp] The API needs clarifications</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="oded@cyota.com">oded</reporter>
                        <labels>
                    </labels>
                <created>Fri, 17 Dec 2004 00:46:43 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:31 +0000</updated>
                            <resolved>Tue, 25 Mar 2008 08:11:31 +0000</resolved>
                                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12408356" author="dirkv" created="Mon, 10 Jan 2005 06:50:37 +0000"  >&lt;p&gt;Fixed the XML example and added the depedencies to the download page&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>32733</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114372</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            20 years, 44 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uyxb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178799</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-88] setTestOnReturn(boolean)</title>
                <link>https://issues.apache.org/jira/browse/DBCP-88</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;The BasicDataSource.setTestOnReturn(boolean) is not carried through to the&lt;br/&gt;
GenericObjectPool variable _testOnReturn.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: other&lt;br/&gt;
Platform: All&lt;/p&gt;</environment>
        <key id="12341456">DBCP-88</key>
            <summary>setTestOnReturn(boolean)</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="nils_kilden-pedersen@countrywide.com">Nils Kilden-Pedersen</reporter>
                        <labels>
                    </labels>
                <created>Tue, 18 May 2004 13:26:55 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:31 +0000</updated>
                            <resolved>Tue, 25 Mar 2008 08:11:31 +0000</resolved>
                                    <version>1.1</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12406627" author="dirkv" created="Wed, 19 May 2004 01:45:56 +0000"  >&lt;p&gt;Testcase shows this report is invalid:&lt;br/&gt;
&lt;a href=&quot;http://cvs.apache.org/viewcvs.cgi/jakarta-commons/dbcp/src/test/org/apache/commons/dbcp/TestBasicDataSource.java?r1=1.18&amp;amp;r2=1.19&amp;amp;diff_format=h&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://cvs.apache.org/viewcvs.cgi/jakarta-commons/dbcp/src/test/org/apache/commons/dbcp/TestBasicDataSource.java?r1=1.18&amp;amp;r2=1.19&amp;amp;diff_format=h&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="12406628" author="nils_kilden-pedersen@countrywide.com" created="Wed, 19 May 2004 02:02:14 +0000"  >&lt;p&gt;BasicDataSource does not have a getConnectionPool() method, so the test case &lt;br/&gt;
must be invalid.&lt;/p&gt;</comment>
                            <comment id="12406630" author="dirkv" created="Wed, 19 May 2004 05:07:56 +0000"  >&lt;p&gt;OK, the getConnectionPool() method doesn&apos;t exist in 1.1.&lt;br/&gt;
I have also removed it from cvs (public access to the internal pool is not good)&lt;/p&gt;

&lt;p&gt;The testcase uses the protected member variable directly:&lt;br/&gt;
&lt;a href=&quot;http://cvs.apache.org/viewcvs.cgi/jakarta-commons/dbcp/src/test/org/apache/commons/dbcp/TestBasicDataSource.java?tr1=1.18&amp;amp;tr2=1.20&amp;amp;r1=text&amp;amp;r2=text&amp;amp;diff_format=h&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://cvs.apache.org/viewcvs.cgi/jakarta-commons/dbcp/src/test/org/apache/commons/dbcp/TestBasicDataSource.java?tr1=1.18&amp;amp;tr2=1.20&amp;amp;r1=text&amp;amp;r2=text&amp;amp;diff_format=h&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Testcase still works (now I have tried with 1.1) but maybe I&apos;m missing something?&lt;/p&gt;</comment>
                            <comment id="12406631" author="nils_kilden-pedersen@countrywide.com" created="Wed, 19 May 2004 05:14:50 +0000"  >&lt;p&gt;Ok. The code below isn&apos;t in 1.1 either, but with that added in CVS, I assume &lt;br/&gt;
it&apos;ll work. Any release date coming up?&lt;/p&gt;

&lt;p&gt;if (connectionPool != null) {&lt;br/&gt;
    connectionPool.setTestOnReturn(testOnReturn);&lt;br/&gt;
}&lt;/p&gt;</comment>
                            <comment id="12406632" author="dirkv" created="Thu, 20 May 2004 19:50:27 +0000"  >&lt;p&gt;Ah, now I see you problem. You want to change the pool properties while the pool&lt;br/&gt;
is active.&lt;br/&gt;
This is not yet a fully supported feature. As you can see I started with it in&lt;br/&gt;
this development cycle but is not yet complete (and not tested).&lt;/p&gt;

&lt;p&gt;If you are going to use it then I would recommend you write some testcases for it.&lt;br/&gt;
(and share them with us &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;The release of DBCP 1.2 is planned to be complete in 1-2 weeks.&lt;/p&gt;
</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>29054</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114371</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            21 years, 25 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uwbb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178376</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-87] Cant Deserialize the Class PerUserPoolDataSource</title>
                <link>https://issues.apache.org/jira/browse/DBCP-87</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;Hello,&lt;/p&gt;

&lt;p&gt;I want to send a DataSource from a servlet to a client per serialization.&lt;br/&gt;
I want to report a bug with deserializing the class&lt;br/&gt;
org.apache.commons.dbcp.datasources.PerUserPoolDataSource&lt;br/&gt;
with the code:&lt;/p&gt;

&lt;p&gt;URL url = null;&lt;br/&gt;
try {&lt;br/&gt;
    url = new URL(&quot;http://ws1157:8080/resources/servlet/ds?datasource=&quot; +&lt;br/&gt;
      &quot;jdbc/photo/test&quot;);&lt;br/&gt;
}&lt;br/&gt;
catch (MalformedURLException ex) {&lt;br/&gt;
    ex.printStackTrace();&lt;br/&gt;
    return false;&lt;br/&gt;
}&lt;br/&gt;
InputStream in = null;&lt;br/&gt;
try {&lt;br/&gt;
    in = url.openStream();&lt;br/&gt;
}&lt;br/&gt;
catch (IOException ex) {&lt;br/&gt;
    ex.printStackTrace();&lt;br/&gt;
    return false;&lt;br/&gt;
}&lt;br/&gt;
BufferedInputStream bi = new BufferedInputStream(in);&lt;br/&gt;
ObjectInputStream ois = new ObjectInputStream(bi);&lt;br/&gt;
DataSource ds = (DataSource)ois.readObject();&lt;/p&gt;

&lt;p&gt;The error is in the last line of code. The stacktrace is:&lt;/p&gt;

&lt;p&gt;java.lang.NullPointerException&lt;br/&gt;
	at org.apache.commons.dbcp.datasources.PerUserPoolDataSource.readObject&lt;br/&gt;
(PerUserPoolDataSource.java:540)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke&lt;br/&gt;
(NativeMethodAccessorImpl.java:39)&lt;br/&gt;
	at sun.reflect.DelegatingMethodAccessorImpl.invoke&lt;br/&gt;
(DelegatingMethodAccessorImpl.java:25)&lt;br/&gt;
	at java.lang.reflect.Method.invoke(Method.java:324)&lt;br/&gt;
	at java.io.ObjectStreamClass.invokeReadObject&lt;br/&gt;
(ObjectStreamClass.java:838)&lt;br/&gt;
	at java.io.ObjectInputStream.readSerialData(ObjectInputStream.java:1746)&lt;br/&gt;
	at java.io.ObjectInputStream.readOrdinaryObject&lt;br/&gt;
(ObjectInputStream.java:1646)&lt;br/&gt;
	at java.io.ObjectInputStream.readObject0(ObjectInputStream.java:1274)&lt;br/&gt;
	at java.io.ObjectInputStream.readObject(ObjectInputStream.java:324)&lt;br/&gt;
	at de.bayern.blva.apps.infogeopoints.DBTest.init(DBTest.java:105)&lt;br/&gt;
	at de.bayern.blva.apps.infogeopoints.DBTest.&amp;lt;init&amp;gt;(DBTest.java:22)&lt;br/&gt;
	at de.bayern.blva.apps.geotools.MainClass._$614(MainClass.java:41)&lt;br/&gt;
	at de.bayern.blva.apps.geotools.MainClass.&amp;lt;init&amp;gt;(MainClass.java:23)&lt;br/&gt;
	at de.bayern.blva.apps.geotools.MainClass.main(MainClass.java:81)&lt;/p&gt;

&lt;p&gt;this Bug is probably in the class&lt;br/&gt;
org.apache.commons.dbcp.datasources.InstanceKeyObjectFactory&lt;br/&gt;
in the method getObjectInstance.&lt;/p&gt;

&lt;p&gt;In Line 141, the return-value is null. This is causing the error. The HashMap &lt;br/&gt;
instanceMap contains no values. I dont know, where the values should come from. &lt;br/&gt;
The HashMap is static, so it isnt serializised.&lt;/p&gt;

&lt;p&gt;Please send an answer, because this feature would be critical for us to use &lt;br/&gt;
this package.&lt;/p&gt;

&lt;p&gt;Whith greatings&lt;br/&gt;
Matthias Schulze&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: All&lt;br/&gt;
Platform: PC&lt;/p&gt;</environment>
        <key id="12341428">DBCP-87</key>
            <summary>Cant Deserialize the Class PerUserPoolDataSource</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="4">Incomplete</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="matthias.schulze@gmx.de">Matthias Schulze</reporter>
                        <labels>
                    </labels>
                <created>Thu, 29 Apr 2004 20:55:15 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:31 +0000</updated>
                            <resolved>Tue, 25 Mar 2008 08:11:31 +0000</resolved>
                                    <version>1.1</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12406539" author="dirkv" created="Sat, 1 May 2004 21:07:44 +0000"  >&lt;p&gt;Serialization of a PerUserPoolDataSource&lt;br/&gt;
 was not intended to work accoss multiple JVMs.&lt;/p&gt;

&lt;p&gt;An application server can serialize a PerUserPoolDataSource when it is included&lt;br/&gt;
in a HttpSession for example but transferring a PerUserPoolDataSource to another&lt;br/&gt;
JVM is not supported.&lt;/p&gt;

&lt;p&gt;Please use the commons-dev mailing list to describe your requirments and discuss&lt;br/&gt;
a solution.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>28688</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114370</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            21 years, 28 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0v0hz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>179054</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-86] validationQuery + MSSQL</title>
                <link>https://issues.apache.org/jira/browse/DBCP-86</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;Hello,&lt;/p&gt;

&lt;p&gt;I am using Commons DBCP with Tomcat 4.0.x and accessing MSSQL 2000 database &lt;br/&gt;
server with JDBC driver from Microsoft through my own constructed JNDI SPI that &lt;br/&gt;
works as a DataSource factory using BasicDataSource from DBCP. &lt;/p&gt;

&lt;p&gt;I get SQLException (s) frequently with &quot;Object has been closed&quot; message when I &lt;br/&gt;
set connection timeout larger than 0. (In Enterprise Manager select server &amp;gt;&amp;gt;  &lt;br/&gt;
Properties &amp;gt;&amp;gt; SQL Server Properties &amp;gt;&amp;gt; Connections &amp;gt;&amp;gt; Remote Server Connections &lt;br/&gt;
&amp;gt;&amp;gt; Query time-out )&lt;br/&gt;
). Besides these, I also set the validationQuery configuration to &quot;select 1&quot; &lt;br/&gt;
that showing up properly in the Profiler (Monitoring tool of SQL Server). This &lt;br/&gt;
setting is responsible for validating the connection before it returning from &lt;br/&gt;
the pool. However when I set value of query time-out to 0 this problem not &lt;br/&gt;
occours.&lt;/p&gt;

&lt;p&gt;I feel that this is a bug because after setting the validationQuery option it &lt;br/&gt;
should return valid connection.&lt;/p&gt;

&lt;p&gt;What do you think?&lt;/p&gt;

&lt;p&gt;Bye&lt;/p&gt;

&lt;p&gt;ps.: I&apos;m taking care to open and close connections with try catch finally block &lt;br/&gt;
so look for the bug elsewhere.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: other&lt;br/&gt;
Platform: Other&lt;/p&gt;</environment>
        <key id="12340301">DBCP-86</key>
            <summary>validationQuery + MSSQL</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="4">Incomplete</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="teletype@freemail.hu">teletype</reporter>
                        <labels>
                    </labels>
                <created>Tue, 27 Aug 2002 00:11:19 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:31 +0000</updated>
                            <resolved>Tue, 25 Mar 2008 08:11:31 +0000</resolved>
                                    <version>1.0</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12402856" author="teletype@freemail.hu" created="Tue, 27 Aug 2002 16:17:39 +0000"  >&lt;p&gt;Today I got exception even query time-out was set to 0.&lt;/p&gt;

&lt;p&gt;Using Tyrex instead of DBCP also produces this exception.&lt;/p&gt;

&lt;p&gt;Is there anyone who has been able to use connection pooling on MSSQL &lt;br/&gt;
successfully?&lt;/p&gt;

&lt;p&gt;Caused by: java.sql.SQLException: &lt;span class=&quot;error&quot;&gt;&amp;#91;Microsoft&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;SQLServer 2000 Driver for JDBC&amp;#93;&lt;/span&gt;&lt;br/&gt;
Object has been closed.&lt;br/&gt;
	at com.microsoft.jdbc.base.BaseExceptions.createException(Unknown &lt;br/&gt;
Source)&lt;br/&gt;
	at com.microsoft.jdbc.base.BaseExceptions.getException(Unknown Source)&lt;br/&gt;
	at com.microsoft.jdbc.base.BaseResultSet.validateClosedState(Unknown &lt;br/&gt;
Source)&lt;br/&gt;
	at com.microsoft.jdbc.base.BaseResultSet.wasNull(Unknown Source)&lt;br/&gt;
	at org.apache.commons.dbcp.DelegatingResultSet.wasNull&lt;br/&gt;
(DelegatingResultSet.java:136)&lt;/p&gt;</comment>
                            <comment id="12402857" author="rwaldhof@us.britannica.com" created="Sat, 2 Nov 2002 01:26:56 +0000"  >&lt;p&gt;I vaguely recall discussion about this on the commons-dev list implying that &lt;br/&gt;
this was determined to be a MSSQL issue (and the Tyrex comment above supports &lt;br/&gt;
that), but I can&apos;t seem to find it on eyebrowse.&lt;/p&gt;

&lt;p&gt;I&apos;m going to close this as invalid for now. If there&apos;s still an issue (or if &lt;br/&gt;
the resolution required/implied some change to DBCP) please re-open.&lt;/p&gt;

&lt;p&gt;Thanks.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>12047</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114369</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            23 years, 2 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0v0m7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>179073</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-85] Connection can be closed twice</title>
                <link>https://issues.apache.org/jira/browse/DBCP-85</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;public static void main(String[] args)&lt;br/&gt;
                     throws Exception&lt;br/&gt;
    {&lt;br/&gt;
        int i;&lt;br/&gt;
        setupDriver();&lt;br/&gt;
        Connection con1, con2, con3;&lt;br/&gt;
        con1 = DriverManager.getConnection(&quot;jdbc:apache:commons:dbcp:example&quot;);&lt;br/&gt;
        System.out.println(con1);&lt;br/&gt;
        con1.close();&lt;br/&gt;
        try&lt;/p&gt;
{con1.close();}
&lt;p&gt;catch (Exception e)&lt;/p&gt;
{System.out.println(e);}
&lt;p&gt;        con1 = DriverManager.getConnection(&quot;jdbc:apache:commons:dbcp:example&quot;);&lt;br/&gt;
        System.out.println(con1);&lt;br/&gt;
        con2 = DriverManager.getConnection(&quot;jdbc:apache:commons:dbcp:example&quot;);&lt;br/&gt;
        System.out.println(con2);&lt;br/&gt;
        con3 = DriverManager.getConnection(&quot;jdbc:apache:commons:dbcp:example&quot;);&lt;br/&gt;
        System.out.println(con3);&lt;/p&gt;

&lt;p&gt;    }&lt;/p&gt;

&lt;p&gt;    public static void setupDriver()&lt;br/&gt;
                            throws Exception&lt;/p&gt;
    {
        ObjectPool connectionPool = new GenericObjectPool(null, 10, 
                        GenericObjectPool.WHEN_EXHAUSTED_BLOCK, 2000, 10);

        ConnectionFactory connectionFactory = new DriverManagerConnectionFactory
(url, null);

        PoolableConnectionFactory poolableConnectionFactory = new 
PoolableConnectionFactory(connectionFactory, connectionPool, null, null, false, 
true);
        PoolingDriver driver = new PoolingDriver();
        driver.registerPool(&quot;example&quot;, connectionPool);
    }</description>
                <environment>&lt;p&gt;Operating System: All&lt;br/&gt;
Platform: All&lt;/p&gt;</environment>
        <key id="12340309">DBCP-85</key>
            <summary>Connection can be closed twice</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="jihh@neusoft.com">Haihan Ji</reporter>
                        <labels>
                    </labels>
                <created>Mon, 9 Sep 2002 10:20:14 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:31 +0000</updated>
                            <resolved>Tue, 25 Mar 2008 08:11:31 +0000</resolved>
                                    <version>1.0</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12402871" author="rwaldhof@us.britannica.com" created="Fri, 1 Nov 2002 23:29:00 +0000"  >&lt;p&gt;fixed in rev. 1.5 of PoolableConnection&lt;br/&gt;
see tests in rev. 1.9 of TestManual&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>12409</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114368</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            23 years, 2 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uv8n:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178202</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-84] [dbcp] Transaction conflicts in Oracle will corrupt prepared statements in the dbcp pool.</title>
                <link>https://issues.apache.org/jira/browse/DBCP-84</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;If a prepared statement fails due to a transaction conflict &lt;br/&gt;
(i.e., ORA-08177 sqlState 72000: can&apos;t serialize access for this transaction, &lt;br/&gt;
or ORA-00060 sqlState 61000: deadlock detected while waiting for resource), &lt;br/&gt;
the copy of this prepared statement in the pool will become corrupted and cause &lt;br/&gt;
an NPE the next time it is called.&lt;/p&gt;

&lt;p&gt;java.lang.NullPointerException&lt;br/&gt;
	at oracle.jdbc.driver.OraclePreparedStatement.setupBindBuffers&lt;br/&gt;
(OraclePreparedStatement.java:2609)&lt;br/&gt;
	at oracle.jdbc.driver.OraclePreparedStatement.executeBatch&lt;br/&gt;
(OraclePreparedStatement.java:10240)&lt;br/&gt;
	at org.apache.commons.dbcp.DelegatingStatement.executeBatch&lt;br/&gt;
(DelegatingStatement.java:294)&lt;br/&gt;
	at org.apache.commons.dbcp.DelegatingStatement.executeBatch&lt;br/&gt;
(DelegatingStatement.java:294)&lt;br/&gt;
	at net.sf.hibernate.impl.BatchingBatcher.doExecuteBatch&lt;br/&gt;
(BatchingBatcher.java:54)&lt;br/&gt;
	at net.sf.hibernate.impl.BatcherImpl.executeBatch(BatcherImpl.java:126)&lt;br/&gt;
	at net.sf.hibernate.impl.SessionImpl.executeAll(SessionImpl.java:2440)&lt;br/&gt;
	at net.sf.hibernate.impl.SessionImpl.execute(SessionImpl.java:2391)&lt;br/&gt;
	at net.sf.hibernate.impl.SessionImpl.flush(SessionImpl.java:2259)&lt;br/&gt;
	at com.talisar.hibernate.ThreadLocalSession.flush&lt;br/&gt;
(ThreadLocalSession.java:293)&lt;br/&gt;
	at com.talisar.hibernate.ThreadLocalSession.txCommit&lt;br/&gt;
(ThreadLocalSession.java:281)&lt;br/&gt;
	at test.TestConflict$T1.run(TestConflict.java:65)&lt;br/&gt;
	at java.lang.Thread.run(Thread.java:534)&lt;/p&gt;


&lt;p&gt;This problem exists ONLY when dbcp is configured with &lt;br/&gt;
poolPreparedStatements=true.&lt;/p&gt;

&lt;p&gt;Environment:&lt;br/&gt;
    Transaction Isolation: 8 (serializable)&lt;br/&gt;
    j2sdk: 1.4.2&lt;br/&gt;
    tomcat: 5.0.28&lt;br/&gt;
    oracle: 9.2.0.1&lt;br/&gt;
    jdbc driver: ojdbc14_g.jar with orai18n.jar&lt;br/&gt;
    dbcp: commons-dbcp-1.2.1.jar with commons-pool-1.2.jar&lt;br/&gt;
    hibernate: 2.1&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: All&lt;br/&gt;
Platform: PC&lt;/p&gt;</environment>
        <key id="12341758">DBCP-84</key>
            <summary>[dbcp] Transaction conflicts in Oracle will corrupt prepared statements in the dbcp pool.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="ttps@pacbell.net">Clay Winkler</reporter>
                        <labels>
                    </labels>
                <created>Wed, 29 Sep 2004 03:18:50 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:31 +0000</updated>
                            <resolved>Tue, 25 Mar 2008 08:11:31 +0000</resolved>
                                    <version>1.2</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12407665" author="ttps@pacbell.net" created="Wed, 26 Jan 2005 04:53:14 +0000"  >&lt;p&gt;Created an attachment (id=14102)&lt;br/&gt;
Java source code that demonstrates the bug.&lt;/p&gt;

&lt;p&gt;This problem does not exist in CP30, and it occurs ONLY when DBCP is configured&lt;br/&gt;
with poolPreparedStatements=true.&lt;/p&gt;</comment>
                            <comment id="12407666" author="ttps@pacbell.net" created="Thu, 27 Jan 2005 04:02:53 +0000"  >&lt;p&gt;The JDBC driver that was being used in the test (i.e., ojdbc14_g.jar version &lt;br/&gt;
10.1.0.2.0) is inappropriate for use wtih Oracle 9.2.0.1. The problem goes away &lt;br/&gt;
when this driver is replaced by version 9.0.2.0.0.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12333134" name="ASF.LICENSE.NOT.GRANTED--TestConflictDBCP.java" size="3400" author="ttps@pacbell.net" created="Wed, 26 Jan 2005 04:53:14 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>31457</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114367</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            20 years, 42 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uv5r:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178189</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-83] Problem with getConnection() and Informix</title>
                <link>https://issues.apache.org/jira/browse/DBCP-83</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;When I set the driver Informix I receive this exception but the boolean value &lt;br/&gt;
passed in setReadOnly(value) is false and when I test with Oracle Is OK.&lt;br/&gt;
I&apos;m not sure but I think the IfxSqliConnect.setReadOnly method return always &lt;br/&gt;
this execption&lt;/p&gt;

&lt;p&gt;Message: Read only mode not supported&lt;br/&gt;
Class: java.sql.SQLException&lt;br/&gt;
Stack trace: &lt;br/&gt;
java.sql.SQLException: Read only mode not supported&lt;br/&gt;
	at com.informix.util.IfxErrMsg.getSQLException(IfxErrMsg.java:348)&lt;br/&gt;
	at com.informix.jdbc.IfxSqliConnect.setReadOnly&lt;br/&gt;
(IfxSqliConnect.java:1876)&lt;br/&gt;
	at org.apache.commons.dbcp.cpdsadapter.ConnectionImpl.setReadOnly&lt;br/&gt;
(ConnectionImpl.java:442)&lt;br/&gt;
	at org.apache.commons.dbcp.jdbc2pool.Jdbc2PoolDataSource.getConnection&lt;br/&gt;
(Jdbc2PoolDataSource.java:1152)&lt;br/&gt;
	at imtf.ch.atlas.core.db.DBCPoolHelper.getConnection&lt;br/&gt;
(DBCPoolHelper.java:125)&lt;br/&gt;
	at DBCPoolHelperExample.main(DBCPoolHelperExample.java:80)&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: All&lt;br/&gt;
Platform: PC&lt;/p&gt;</environment>
        <key id="12340602">DBCP-83</key>
            <summary>Problem with getConnection() and Informix</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="2">Won&apos;t Fix</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="jpe@imtf.ch">Juan Rafael P&#233;rez</reporter>
                        <labels>
                    </labels>
                <created>Wed, 12 Mar 2003 21:06:47 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:31 +0000</updated>
                            <resolved>Tue, 25 Mar 2008 08:11:31 +0000</resolved>
                                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12403860" author="rwaldhoff@apache.org" created="Sat, 15 Mar 2003 02:46:53 +0000"  >&lt;p&gt;Grrr. This behavior of Informix is pretty crappy (setReadOnly(false) should be &lt;br/&gt;
OK, even if read only mode is unsupported).  &lt;/p&gt;

&lt;p&gt;I suppose one fix would be to have three values for defaultReadOnly, &lt;br/&gt;
defaultAutoCommit, etc.: Boolean.TRUE, Boolean.FALSE and null, and when null &lt;br/&gt;
not try to reset the property at all.&lt;/p&gt;</comment>
                            <comment id="12403861" author="dgraham@apache.org" created="Mon, 24 Mar 2003 23:34:57 +0000"  >&lt;p&gt;Is it DBCP&apos;s responsibility to correct the behavior of all broken drivers?  &lt;br/&gt;
Going down this path seems dangerous to me.  If someone is using a driver that &lt;br/&gt;
is apparently broken, they can simply not call the broken method.&lt;/p&gt;</comment>
                            <comment id="12403862" author="rwaldhoff@apache.org" created="Wed, 2 Apr 2003 08:57:57 +0000"  >&lt;p&gt;David wrote:&lt;br/&gt;
&amp;gt; If someone is using a driver that &lt;br/&gt;
&amp;gt; is apparently broken, they can simply &lt;br/&gt;
&amp;gt; not call the broken method.&lt;/p&gt;

&lt;p&gt;Not in this case.  When a Connection is returned to the pool, dbcp attempts to&lt;br/&gt;
reset its read only state to some default value.  When the object is passivated,&lt;br/&gt;
one of setReadOnly(true) or setReadOnly(false) is invoked.  If the driver is&lt;br/&gt;
going to throw an exception in either case, then that driver will be pretty much&lt;br/&gt;
unusable for most if not all of the default dbcp configurations.&lt;/p&gt;

&lt;p&gt;My previous comment gives the only fix I can see (short of changing the Informix&lt;br/&gt;
connection implementation).&lt;/p&gt;</comment>
                            <comment id="12403863" author="dgraham@apache.org" created="Wed, 2 Apr 2003 10:57:02 +0000"  >&lt;p&gt;The Connection.setReadOnly() javadoc says, &quot;Throws: SQLException - if a database &lt;br/&gt;
access error occurs or this method is called during a transaction&quot;.  Is it &lt;br/&gt;
possible Informix thinks the transaction has not finished?  If we&apos;re certain &lt;br/&gt;
that DBCP is correctly completing the transaction before calling this method, I &lt;br/&gt;
think we should close this bug as WONTFIX.  If someone wants to use Informix (or &lt;br/&gt;
any other broken driver) they can subclass or otherwise alter the source to work &lt;br/&gt;
with it.  However, if Informix is correct and DBCP is at fault we should work to &lt;br/&gt;
fix this.&lt;/p&gt;</comment>
                            <comment id="12403864" author="mohankishore@yahoo.com" created="Mon, 7 Apr 2003 09:31:45 +0000"  >&lt;p&gt;Checked out the Informix Driver code:&lt;br/&gt;
    public void setReadOnly(boolean flag)&lt;br/&gt;
        throws SQLException&lt;/p&gt;
    {
        throw IfxErrMsg.getSQLException(0xfffec87f, this);
    }

&lt;p&gt;Download from: &lt;br/&gt;
&lt;a href=&quot;http://www-3.ibm.com/software/data/informix/tools/jdbc/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www-3.ibm.com/software/data/informix/tools/jdbc/&lt;/a&gt;&lt;br/&gt;
States that setReadOnly is not supported: &lt;br/&gt;
&lt;a href=&quot;http://www-&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www-&lt;/a&gt;&lt;br/&gt;
3.ibm.com/software/data/informix/pubs/library/notes/relnotes/jav0110r38.txt&lt;/p&gt;

&lt;p&gt;But, jdbc site says: &quot;When a DBMS does not support a feature, the methods that &lt;br/&gt;
support the feature may throw an SQLException.&quot; (see: &lt;br/&gt;
&lt;a href=&quot;http://java.sun.com/products/jdbc/driverdevs.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://java.sun.com/products/jdbc/driverdevs.html&lt;/a&gt;)&lt;/p&gt;

&lt;p&gt;Seems like Oracle also has problems: &lt;br/&gt;
&lt;a href=&quot;http://forum.java.sun.com/thread.jsp?forum=48&amp;amp;thread=89314&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://forum.java.sun.com/thread.jsp?forum=48&amp;amp;thread=89314&lt;/a&gt;&lt;/p&gt;
</comment>
                            <comment id="12403865" author="dgraham@apache.org" created="Tue, 8 Apr 2003 07:48:40 +0000"  >&lt;p&gt;Thanks for doing some research on this Mohan.  The informix driver you found was &lt;br/&gt;
released in 1998.  I found release notes for newer driver versions and didn&apos;t &lt;br/&gt;
find any reference to a setReadOnly problem.  I suggest the reporter update &lt;br/&gt;
their driver; if that doesn&apos;t fix it, you can always modify the source for your &lt;br/&gt;
needs.  &lt;/p&gt;


&lt;p&gt;FYI, Oracle doesn&apos;t support read only connections but only throws an &lt;br/&gt;
SQLException when you try to set it to true.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>17911</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114366</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            22 years, 32 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uznz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178919</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-82] Inproper use of Exception</title>
                <link>https://issues.apache.org/jira/browse/DBCP-82</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;java.lang.Exception is thrown from public methods.  This is bad.  I&apos;m not sure&lt;br/&gt;
of all of them that do this, but here is one example:&lt;br/&gt;
    public PoolableConnectionFactory(ConnectionFactory connFactory, ObjectPool&lt;br/&gt;
pool, KeyedObjectPoolFactory stmtPoolFactory, String validationQuery, boolean&lt;br/&gt;
defaultReadOnly, boolean defaultAutoCommit) throws Exception {&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: All&lt;br/&gt;
Platform: All&lt;/p&gt;</environment>
        <key id="12340504">DBCP-82</key>
            <summary>Inproper use of Exception</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="2">Won&apos;t Fix</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="treaves@silverfields.com">Timothy Reaves</reporter>
                        <labels>
                    </labels>
                <created>Tue, 21 Jan 2003 08:46:20 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:31 +0000</updated>
                            <resolved>Tue, 25 Mar 2008 08:11:31 +0000</resolved>
                                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12403476" author="craig.mcclanahan@sun.com" created="Sat, 1 Feb 2003 12:36:09 +0000"  >&lt;p&gt;I cannot see doing anything concrete with this bug report, for at least two&lt;br/&gt;
important reasons:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Changing the method signatures now would destroy backwards&lt;br/&gt;
  compatibility, and cannot be contemplated without thinking&lt;br/&gt;
  about a major version number change.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;The bug report doesn&apos;t suggest any concrete changes &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;.&lt;br/&gt;
  It only expresses an opinion which is not universally shared.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="12403477" author="treaves@silverfields.com" created="Sun, 2 Feb 2003 04:29:23 +0000"  >&lt;p&gt;Thanks for responding.&lt;/p&gt;

&lt;p&gt;You make two arguments for not fixing this bug.  I&apos;ll respond to both.&lt;/p&gt;

&lt;p&gt;a) as to breaking backwards compatibility, that is what the entire idea of&lt;br/&gt;
deprecation is about.  It was added to the Java semantic model to allow for this&lt;br/&gt;
very issue.  As to the major / minor version, perhaps it would have to wait, but&lt;br/&gt;
that in no way invalidates the issue.&lt;/p&gt;

&lt;p&gt;b) as to offering a concrete  change, it was directly implied that every case&lt;br/&gt;
where a java.lang.Exception is thrown should be replaced with throwing an&lt;br/&gt;
exception that is appropriate for the error that occurred.  This is concrete,&lt;br/&gt;
although perhaps a bit open ended.&lt;/p&gt;

&lt;p&gt;You also state that this was a matter of my opinion. This is not correct.  It is&lt;br/&gt;
a matter of fact.  Being a matter of fact does not of course imply that it is&lt;br/&gt;
correct.  But it is not a matter of opinion.  &lt;/p&gt;

&lt;p&gt;I won&apos;t take the time to give you a lesson in OO language; I assume you&apos;re at&lt;br/&gt;
least somewhat familiar.  I will point out, however, that one of the tenets of&lt;br/&gt;
an OO language is the concept of sub-classing.  This allows reuse of code (the&lt;br/&gt;
Exception class in this case) while at the same time allowing for a more&lt;br/&gt;
specific instance of a class to be used to denote more concrete aspects of the&lt;br/&gt;
system (i.e. java.lang.ClassNotFoundException).  It is not a matter of opinion,&lt;br/&gt;
but a very basic concept of any OO system.&lt;/p&gt;

&lt;p&gt;Perhaps this would be best handled as a feature request.  &lt;/p&gt;</comment>
                            <comment id="12403478" author="dimiter@blue-edge.bg" created="Sun, 2 Feb 2003 04:43:41 +0000"  >&lt;p&gt;I think that you&apos;re mistaking OO with strictly typed programming.&lt;br/&gt;
While C++ and Eiffel are two &lt;br/&gt;
of the textbook OO languages, and they both are strictly typed, there are a lot of dynamically &lt;br/&gt;
typed OO langues. Smalltalk and Python to for example. As you said, I&apos;m not going to give a lesson on &lt;br/&gt;
the advantages of the dynamic typing. &lt;/p&gt;

&lt;p&gt;We all realize that Java is mostly static language, but &lt;br/&gt;
it doesn&apos;t hurt to break the rules when it makes our life easier. E.g. typical case is Runnable. If &lt;br/&gt;
it did allow to throw throwable then I shouldn&apos;t have to write:&lt;/p&gt;

&lt;p&gt;new Runnable{&lt;br/&gt;
  public void &lt;br/&gt;
run{&lt;br/&gt;
    try&lt;/p&gt;
{
       somethingThatMightGoWrongAndTheresNothingICanDo();
    }
&lt;p&gt; &lt;br/&gt;
catch(FatalException fx) &lt;/p&gt;
{ 
       throw new WrappingError(fx);
    }
&lt;p&gt;  }&lt;br/&gt;
}&lt;/p&gt;</comment>
                            <comment id="12403479" author="craig.mcclanahan@sun.com" created="Sun, 2 Feb 2003 12:07:36 +0000"  >&lt;p&gt;Regarding your deprecation proposal, it&apos;s not technically feasible to change the&lt;br/&gt;
following:&lt;/p&gt;

&lt;p&gt;  /**&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Documentation for PoolableConnectionFactory ...&lt;br/&gt;
   */&lt;br/&gt;
  public PoolableConnectionFactory(ConnectionFactory connFactory,&lt;br/&gt;
                                   ObjectPool pool,&lt;br/&gt;
                                   KeyedObjectPoolFactory stmtPoolFactory,&lt;br/&gt;
                                   String validationQuery,&lt;br/&gt;
                                   boolean defaultReadOnly,&lt;br/&gt;
                                   boolean defaultAutoCommit)&lt;br/&gt;
      throws Exception;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;into the following:&lt;/p&gt;

&lt;p&gt;  /**&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Documentation for PoolableConnectionFactory ...&lt;br/&gt;
   *&lt;/li&gt;
	&lt;li&gt;@deprecated Use the following version instead&lt;br/&gt;
   */&lt;br/&gt;
  public PoolableConnectionFactory(ConnectionFactory connFactory,&lt;br/&gt;
                                   ObjectPool pool,&lt;br/&gt;
                                   KeyedObjectPoolFactory stmtPoolFactory,&lt;br/&gt;
                                   String validationQuery,&lt;br/&gt;
                                   boolean defaultReadOnly,&lt;br/&gt;
                                   boolean defaultAutoCommit)&lt;br/&gt;
      throws Exception;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;  /**&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Documentation for PoolableConnectionFactory ...&lt;br/&gt;
   */&lt;br/&gt;
  public PoolableConnectionFactory(ConnectionFactory connFactory,&lt;br/&gt;
                                   ObjectPool pool,&lt;br/&gt;
                                   KeyedObjectPoolFactory stmtPoolFactory,&lt;br/&gt;
                                   String validationQuery,&lt;br/&gt;
                                   boolean defaultReadOnly,&lt;br/&gt;
                                   boolean defaultAutoCommit)&lt;br/&gt;
      throws SomeSpecificException;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;because the compiler will complain about duplicate method signatures.  The only&lt;br/&gt;
way to actually make the change is to eliminate the old signature, which breaks&lt;br/&gt;
every application signature that used the old approach (unless&lt;br/&gt;
SomeSpecificException was a subclass of Exception, which doesn&apos;t really&lt;br/&gt;
accomplish your objective anyway; it sounds like you would prefer something&lt;br/&gt;
based on a RuntimeException so that would not require a try/catch block in the&lt;br/&gt;
calling code).&lt;/p&gt;

&lt;p&gt;Maintaining backwards compatibility, especially within a major version number,&lt;br/&gt;
is a core value of most Jakarta projects &amp;#8211; and especially so in&lt;br/&gt;
jakarta-commons.  Making a change like the one you suggest would be very&lt;br/&gt;
disruptive.  And you **&lt;b&gt;still&lt;/b&gt;** have not described what you think &quot;an exception&lt;br/&gt;
appropriate for the error that occurred&quot; in this particular constructor, or for&lt;br/&gt;
any other specific case.  Inded, it is hard to conceive of what such an&lt;br/&gt;
exception would be, given that the commons-pool APIs define a generic framework&lt;br/&gt;
for building pools, and there is no way to come up with a specific exception&lt;br/&gt;
class that will cover all possibilities.  At best, you could create a general&lt;br/&gt;
PoolException that would need to be subclassed by pool implementations &amp;#8211; and&lt;br/&gt;
that doesn&apos;t really add any value over java.lang.Exception.&lt;/p&gt;

&lt;p&gt;As to your assertion about &quot;bad&quot;, I&apos;ve only been a professional software&lt;br/&gt;
developer for a short while (about to start my 29th year of getting paid for it,&lt;br/&gt;
and almost half of that in O-O languages &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;, but one thing I have definitely&lt;br/&gt;
learned is that statements from people who make absolute judgements, and state&lt;br/&gt;
them as facts rather than opinions, and offer no specific evidence or&lt;br/&gt;
collaboration, should definitely be taken with a large grain of salt.&lt;/p&gt;

&lt;p&gt;Get off your high horse, please, and make a &lt;b&gt;specific&lt;/b&gt; proposal for the API&lt;br/&gt;
signatures you don&apos;t like.  And, the best place to do that is on the COMMONS-DEV&lt;br/&gt;
mailing list, where you can endeavor to convince the other developers on the&lt;br/&gt;
pool project to share your views.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>16283</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114365</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            22 years, 41 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uzqn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178931</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-81] [dbcp] NPE in PoolableConnectionFactory validating the connection with an invalid SQL statement</title>
                <link>https://issues.apache.org/jira/browse/DBCP-81</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;The PooleableConnectionFactory.validateConnection(Connection) throws a NPE, if&lt;br/&gt;
the provided SQL statement for validation is invalid itself (e.g. uses a&lt;br/&gt;
non-existing table). See the code snippet below. If stmt.executeQuery(query)&lt;br/&gt;
throws an SQLException, rset is still null, but will be closed in the finally&lt;br/&gt;
block ==&amp;gt; NPE!&lt;/p&gt;


&lt;p&gt;        if(null != query) {&lt;br/&gt;
            Statement stmt = null;&lt;br/&gt;
            ResultSet rset = null;&lt;br/&gt;
            try {&lt;br/&gt;
                stmt = conn.createStatement();&lt;br/&gt;
                rset = stmt.executeQuery(query);&lt;br/&gt;
                if(!rset.next()) &lt;/p&gt;
{
                    throw new SQLException(&quot;validationQuery didn&apos;t return a row&quot;);
                }
&lt;p&gt;            } finally {&lt;br/&gt;
                try &lt;/p&gt;
{
                    rset.close();
                }
&lt;p&gt; catch(Exception t) &lt;/p&gt;
{
                    // ignored
                }&lt;br/&gt;
                try {
                    stmt.close();
                } catch(Exception t) {                    // ignored                }

&lt;p&gt;            }&lt;br/&gt;
        }&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: All&lt;br/&gt;
Platform: All&lt;/p&gt;</environment>
        <key id="12342558">DBCP-81</key>
            <summary>[dbcp] NPE in PoolableConnectionFactory validating the connection with an invalid SQL statement</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="joehni">Joerg Schaible</reporter>
                        <labels>
                    </labels>
                <created>Fri, 16 Sep 2005 23:03:34 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:31 +0000</updated>
                            <resolved>Tue, 25 Mar 2008 08:11:31 +0000</resolved>
                                    <version>1.2</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12410412" author="joerg.schaible@gmx.de" created="Thu, 9 Mar 2006 05:15:25 +0000"  >&lt;p&gt;I&apos;ve committed the change. Additionally new Eclipse 3.2M5 identified a lot of &lt;br/&gt;
other occurrences of this construct - I fixed them all. &lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>36685</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114364</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            19 years, 36 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uvcn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178220</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-80] NumberFormatException: For input string: &quot;myDB&quot; in InstanceKeyDataSourceFactory</title>
                <link>https://issues.apache.org/jira/browse/DBCP-80</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;I took DBCP 1.1 for a spin today (I was going to try CVS today, but for the&lt;br/&gt;
release - if only it had been earlier! &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;There&apos;s a fatal bug in InstanceKeyDataSourceFactory that means you can&apos;t&lt;br/&gt;
instantiate more than one factory. I&apos;m using this via Tomcat 4.&lt;/p&gt;

&lt;p&gt;There is this function that is called first:&lt;br/&gt;
InstanceKeyDataSourceFactory.getObjectInstance()&lt;br/&gt;
...&lt;br/&gt;
                    String key = null;&lt;br/&gt;
                    if (name != null) &lt;/p&gt;
                    {
                        key = name.toString();
                        obj = instanceMap.get(key); 
                    }                    
&lt;p&gt;                    if (obj == null)&lt;br/&gt;
                    {&lt;br/&gt;
                        InstanceKeyDataSource ds = getNewInstance(ref);&lt;br/&gt;
                        setCommonProperties(ref, ds);&lt;br/&gt;
                        obj = ds;&lt;br/&gt;
                        if (key != null) &lt;/p&gt;
                        {
                            instanceMap.put(key, ds);
                        }                        
&lt;p&gt;                    }&lt;/p&gt;

&lt;p&gt;So, key = something like &quot;myDb&quot;, which is put into instanceMap.&lt;/p&gt;

&lt;p&gt;But then there is:&lt;/p&gt;

&lt;p&gt;    synchronized static String registerNewInstance(InstanceKeyDataSource ds) {&lt;br/&gt;
        int max = 0;&lt;br/&gt;
        Iterator i = instanceMap.keySet().iterator();&lt;br/&gt;
        while (i.hasNext()) {&lt;br/&gt;
            Object obj = i.next();&lt;br/&gt;
            if (obj instanceof String) &lt;/p&gt;
            {
                max = Math.max(max, Integer.parseInt((String)obj));
            }
&lt;p&gt;        }&lt;br/&gt;
        String instanceKey = String.valueOf(max + 1);&lt;br/&gt;
        // put a placeholder here for now, so other instances will not&lt;br/&gt;
        // take our key.  we will replace with a pool when ready.&lt;br/&gt;
        instanceMap.put(instanceKey, ds);&lt;br/&gt;
        return instanceKey;&lt;br/&gt;
    }&lt;/p&gt;

&lt;p&gt;The Math.max line throws a NumberFormatException, because the key is assumed to&lt;br/&gt;
be an int, but it is &quot;myDb&quot;.&lt;/p&gt;

&lt;p&gt;What is the way to resolve this? My feeling is that it just doesn&apos;t set max if&lt;br/&gt;
the key is not a number, so the first one gets &quot;0&quot;, etc. Is that ok? I&apos;ve done&lt;br/&gt;
this and it seems to work, so I&apos;ll attach that quick fix as a patch.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: All&lt;br/&gt;
Platform: All&lt;/p&gt;</environment>
        <key id="12341054">DBCP-80</key>
            <summary>NumberFormatException: For input string: &quot;myDB&quot; in InstanceKeyDataSourceFactory</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="brett">Brett Porter</reporter>
                        <labels>
                    </labels>
                <created>Fri, 24 Oct 2003 05:05:46 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:31 +0000</updated>
                            <resolved>Tue, 25 Mar 2008 08:11:31 +0000</resolved>
                                    <version>1.1</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12405332" author="brett@apache.org" created="Fri, 24 Oct 2003 05:09:11 +0000"  >&lt;p&gt;Created an attachment (id=8712)&lt;br/&gt;
short patch for bug described - seems to work for me&lt;/p&gt;</comment>
                            <comment id="12405333" author="dirkv" created="Mon, 27 Oct 2003 01:41:36 +0000"  >&lt;p&gt;testcase:&lt;br/&gt;
   TestFactory.testJNDI2Pools&lt;/p&gt;</comment>
                            <comment id="12405334" author="dirkv" created="Tue, 30 Dec 2003 04:01:50 +0000"  >&lt;ul&gt;
	&lt;li&gt;
	&lt;ul&gt;
		&lt;li&gt;
		&lt;ul&gt;
			&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/DBCP-1&quot; title=&quot;NumberFormatException: For input string: &amp;quot;myDB&amp;quot;&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DBCP-1&quot;&gt;&lt;del&gt;COM-1026&lt;/del&gt;&lt;/a&gt; has been marked as a duplicate of this bug. ***&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="12405335" author="dirkv" created="Sun, 29 Feb 2004 05:53:51 +0000"  >&lt;p&gt;Patch applied&lt;br/&gt;
InstanceKeyObjectFactory.java Revision : 1.9 Date : 2004/2/28 21:51:59&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12332586" name="ASF.LICENSE.NOT.GRANTED--bug-24082-patch.diff" size="1069" author="brett@apache.org" created="Fri, 24 Oct 2003 05:09:11 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>24082</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114363</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            21 years, 37 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uv4v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178185</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-79] deadlock when acquiring connections from a pool</title>
                <link>https://issues.apache.org/jira/browse/DBCP-79</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;After some time of inactivity I get deadlock. Here is dump:&lt;/p&gt;

&lt;p&gt;Full thread dump Java HotSpot(TM) Client VM (1.4.0-b92 mixed mode):&lt;/p&gt;

&lt;p&gt;&quot;Thread-262&quot; daemon prio=1 tid=0x0x8698ba0 nid=0x2fe1 waiting on monitor&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;bb3fe000..bb3ff87c&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at java.lang.Object.wait(Native Method)&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;waiting on &amp;lt;0x45372418&amp;gt; (a org.apache.commons.dbcp.AbandonedObjectPool)&lt;br/&gt;
	at java.lang.Object.wait(Object.java:426)&lt;br/&gt;
	at org.apache.commons.pool.impl.GenericObjectPool.borrowObject(Unknown Source)&lt;/li&gt;
	&lt;li&gt;locked &amp;lt;0x45372418&amp;gt; (a org.apache.commons.dbcp.AbandonedObjectPool)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.commons.dbcp.AbandonedObjectPool.borrowObject(AbandonedObjectPool.java:117)&lt;/li&gt;
	&lt;li&gt;locked &amp;lt;0x45372418&amp;gt; (a org.apache.commons.dbcp.AbandonedObjectPool)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.commons.dbcp.PoolingDataSource.getConnection(PoolingDataSource.java:110)&lt;br/&gt;
	at org.apache.commons.dbcp.BasicDataSource.getConnection(BasicDataSource.java:312)&lt;br/&gt;
	at&lt;br/&gt;
com.opensymphony.module.user.provider.jdbc.JDBCCredentialsProvider.handles(JDBCCredentialsProvider.java:21)&lt;br/&gt;
	at com.opensymphony.module.user.UserManager.getProvider(UserManager.java:351)&lt;br/&gt;
	at com.opensymphony.module.user.UserManager.getEntity(UserManager.java:313)&lt;br/&gt;
	at com.opensymphony.module.user.UserManager.getUser(UserManager.java:129)&lt;br/&gt;
	at&lt;br/&gt;
net.metasite.formonline.commons.CustomRequestProcessor.processRoles(CustomRequestProcessor.java:52)&lt;br/&gt;
	at org.apache.struts.action.RequestProcessor.process(RequestProcessor.java:248)&lt;br/&gt;
	at org.apache.struts.action.ActionServlet.process(ActionServlet.java:1420)&lt;br/&gt;
	at org.apache.struts.action.ActionServlet.doGet(ActionServlet.java:502)&lt;br/&gt;
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:740)&lt;br/&gt;
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:853)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:247)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:193)&lt;br/&gt;
	at net.metasite.servlet.filters.EncodingFilter.doFilter(Unknown Source)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:213)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:193)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:256)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNext(StandardPipeline.java:643)&lt;br/&gt;
	at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:480)&lt;br/&gt;
	at org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:995)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNext(StandardPipeline.java:643)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:494)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNext(StandardPipeline.java:641)&lt;br/&gt;
	at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:480)&lt;br/&gt;
	at org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:995)&lt;br/&gt;
	at org.apache.catalina.core.StandardContext.invoke(StandardContext.java:2415)&lt;br/&gt;
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:180)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNext(StandardPipeline.java:643)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.valves.ErrorDispatcherValve.invoke(ErrorDispatcherValve.java:171)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNext(StandardPipeline.java:641)&lt;br/&gt;
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:172)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNext(StandardPipeline.java:641)&lt;br/&gt;
	at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:480)&lt;br/&gt;
	at org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:995)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:174)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNext(StandardPipeline.java:643)&lt;br/&gt;
	at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:480)&lt;br/&gt;
	at org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:995)&lt;br/&gt;
	at org.apache.coyote.tomcat4.CoyoteAdapter.service(CoyoteAdapter.java:223)&lt;br/&gt;
	at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:594)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.processConnection(Http11Protocol.java:392)&lt;br/&gt;
	at org.apache.tomcat.util.net.TcpWorkerThread.runIt(PoolTcpEndpoint.java:565)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run(ThreadPool.java:619)&lt;br/&gt;
	at java.lang.Thread.run(Thread.java:536)&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;&quot;Thread-261&quot; daemon prio=1 tid=0x0x8698488 nid=0x2fe0 waiting on monitor&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;bb5fe000..bb5ff87c&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at java.lang.Object.wait(Native Method)&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;waiting on &amp;lt;0x45372418&amp;gt; (a org.apache.commons.dbcp.AbandonedObjectPool)&lt;br/&gt;
	at java.lang.Object.wait(Object.java:426)&lt;br/&gt;
	at org.apache.commons.pool.impl.GenericObjectPool.borrowObject(Unknown Source)&lt;/li&gt;
	&lt;li&gt;locked &amp;lt;0x45372418&amp;gt; (a org.apache.commons.dbcp.AbandonedObjectPool)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.commons.dbcp.AbandonedObjectPool.borrowObject(AbandonedObjectPool.java:117)&lt;/li&gt;
	&lt;li&gt;locked &amp;lt;0x45372418&amp;gt; (a org.apache.commons.dbcp.AbandonedObjectPool)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.commons.dbcp.PoolingDataSource.getConnection(PoolingDataSource.java:110)&lt;br/&gt;
	at org.apache.commons.dbcp.BasicDataSource.getConnection(BasicDataSource.java:312)&lt;br/&gt;
	at&lt;br/&gt;
com.opensymphony.module.user.provider.jdbc.JDBCCredentialsProvider.handles(JDBCCredentialsProvider.java:21)&lt;br/&gt;
	at com.opensymphony.module.user.UserManager.getProvider(UserManager.java:351)&lt;br/&gt;
	at com.opensymphony.module.user.UserManager.getEntity(UserManager.java:313)&lt;br/&gt;
	at com.opensymphony.module.user.UserManager.getUser(UserManager.java:129)&lt;br/&gt;
	at&lt;br/&gt;
net.metasite.formonline.commons.CustomRequestProcessor.processRoles(CustomRequestProcessor.java:52)&lt;br/&gt;
	at org.apache.struts.action.RequestProcessor.process(RequestProcessor.java:248)&lt;br/&gt;
	at org.apache.struts.action.ActionServlet.process(ActionServlet.java:1420)&lt;br/&gt;
	at org.apache.struts.action.ActionServlet.doGet(ActionServlet.java:502)&lt;br/&gt;
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:740)&lt;br/&gt;
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:853)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:247)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:193)&lt;br/&gt;
	at net.metasite.servlet.filters.EncodingFilter.doFilter(Unknown Source)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:213)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:193)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:256)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNext(StandardPipeline.java:643)&lt;br/&gt;
	at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:480)&lt;br/&gt;
	at org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:995)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNext(StandardPipeline.java:643)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:494)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNext(StandardPipeline.java:641)&lt;br/&gt;
	at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:480)&lt;br/&gt;
	at org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:995)&lt;br/&gt;
	at org.apache.catalina.core.StandardContext.invoke(StandardContext.java:2415)&lt;br/&gt;
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:180)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNext(StandardPipeline.java:643)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.valves.ErrorDispatcherValve.invoke(ErrorDispatcherValve.java:171)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNext(StandardPipeline.java:641)&lt;br/&gt;
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:172)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNext(StandardPipeline.java:641)&lt;br/&gt;
	at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:480)&lt;br/&gt;
	at org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:995)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:174)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNext(StandardPipeline.java:643)&lt;br/&gt;
	at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:480)&lt;br/&gt;
	at org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:995)&lt;br/&gt;
	at org.apache.coyote.tomcat4.CoyoteAdapter.service(CoyoteAdapter.java:223)&lt;br/&gt;
	at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:594)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.processConnection(Http11Protocol.java:392)&lt;br/&gt;
	at org.apache.tomcat.util.net.TcpWorkerThread.runIt(PoolTcpEndpoint.java:565)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run(ThreadPool.java:619)&lt;br/&gt;
	at java.lang.Thread.run(Thread.java:536)&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;&quot;Thread-260&quot; daemon prio=1 tid=0x0x8698190 nid=0x2fdf waiting on monitor&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;bb7fe000..bb7ff87c&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at java.lang.Object.wait(Native Method)&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;waiting on &amp;lt;0x45372418&amp;gt; (a org.apache.commons.dbcp.AbandonedObjectPool)&lt;br/&gt;
	at java.lang.Object.wait(Object.java:426)&lt;br/&gt;
	at org.apache.commons.pool.impl.GenericObjectPool.borrowObject(Unknown Source)&lt;/li&gt;
	&lt;li&gt;locked &amp;lt;0x45372418&amp;gt; (a org.apache.commons.dbcp.AbandonedObjectPool)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.commons.dbcp.AbandonedObjectPool.borrowObject(AbandonedObjectPool.java:117)&lt;/li&gt;
	&lt;li&gt;locked &amp;lt;0x45372418&amp;gt; (a org.apache.commons.dbcp.AbandonedObjectPool)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.commons.dbcp.PoolingDataSource.getConnection(PoolingDataSource.java:110)&lt;br/&gt;
	at org.apache.commons.dbcp.BasicDataSource.getConnection(BasicDataSource.java:312)&lt;br/&gt;
	at&lt;br/&gt;
com.opensymphony.module.user.provider.jdbc.JDBCCredentialsProvider.handles(JDBCCredentialsProvider.java:21)&lt;br/&gt;
	at com.opensymphony.module.user.UserManager.getProvider(UserManager.java:351)&lt;br/&gt;
	at com.opensymphony.module.user.UserManager.getEntity(UserManager.java:313)&lt;br/&gt;
	at com.opensymphony.module.user.UserManager.getUser(UserManager.java:129)&lt;br/&gt;
	at&lt;br/&gt;
net.metasite.formonline.commons.CustomRequestProcessor.processRoles(CustomRequestProcessor.java:52)&lt;br/&gt;
	at org.apache.struts.action.RequestProcessor.process(RequestProcessor.java:248)&lt;br/&gt;
	at org.apache.struts.action.ActionServlet.process(ActionServlet.java:1420)&lt;br/&gt;
	at org.apache.struts.action.ActionServlet.doPost(ActionServlet.java:520)&lt;br/&gt;
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:760)&lt;br/&gt;
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:853)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:247)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:193)&lt;br/&gt;
	at net.metasite.servlet.filters.EncodingFilter.doFilter(Unknown Source)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:213)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:193)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:256)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNext(StandardPipeline.java:643)&lt;br/&gt;
	at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:480)&lt;br/&gt;
	at org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:995)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNext(StandardPipeline.java:643)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:494)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNext(StandardPipeline.java:641)&lt;br/&gt;
	at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:480)&lt;br/&gt;
	at org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:995)&lt;br/&gt;
	at org.apache.catalina.core.StandardContext.invoke(StandardContext.java:2415)&lt;br/&gt;
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:180)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNext(StandardPipeline.java:643)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.valves.ErrorDispatcherValve.invoke(ErrorDispatcherValve.java:171)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNext(StandardPipeline.java:641)&lt;br/&gt;
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:172)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNext(StandardPipeline.java:641)&lt;br/&gt;
	at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:480)&lt;br/&gt;
	at org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:995)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:174)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNext(StandardPipeline.java:643)&lt;br/&gt;
	at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:480)&lt;br/&gt;
	at org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:995)&lt;br/&gt;
	at org.apache.coyote.tomcat4.CoyoteAdapter.service(CoyoteAdapter.java:223)&lt;br/&gt;
	at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:594)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.processConnection(Http11Protocol.java:392)&lt;br/&gt;
	at org.apache.tomcat.util.net.TcpWorkerThread.runIt(PoolTcpEndpoint.java:565)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run(ThreadPool.java:619)&lt;br/&gt;
	at java.lang.Thread.run(Thread.java:536)&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;&quot;Thread-259&quot; daemon prio=1 tid=0x0x869b990 nid=0x2fde runnable &lt;span class=&quot;error&quot;&gt;&amp;#91;bb9ff000..bb9ff87c&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at java.net.PlainSocketImpl.socketAccept(Native Method)&lt;br/&gt;
	at java.net.PlainSocketImpl.accept(PlainSocketImpl.java:343)&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;locked &amp;lt;0x4482a978&amp;gt; (a java.net.PlainSocketImpl)&lt;br/&gt;
	at java.net.ServerSocket.implAccept(ServerSocket.java:438)&lt;br/&gt;
	at java.net.ServerSocket.accept(ServerSocket.java:409)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.tomcat.util.net.DefaultServerSocketFactory.acceptSocket(DefaultServerSocketFactory.java:107)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.tomcat.util.net.PoolTcpEndpoint.acceptSocket(PoolTcpEndpoint.java:356)&lt;br/&gt;
	at org.apache.tomcat.util.net.TcpWorkerThread.runIt(PoolTcpEndpoint.java:529)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run(ThreadPool.java:619)&lt;br/&gt;
	at java.lang.Thread.run(Thread.java:536)&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;&quot;StandardManager&lt;span class=&quot;error&quot;&gt;&amp;#91;/formonline&amp;#93;&lt;/span&gt;&quot; daemon prio=1 tid=0x0x86ac248 nid=0x2f0b waiting&lt;br/&gt;
on monitor &lt;span class=&quot;error&quot;&gt;&amp;#91;be3ff000..be3ff87c&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at java.lang.Thread.sleep(Native Method)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.session.StandardManager.threadSleep(StandardManager.java:810)&lt;br/&gt;
	at org.apache.catalina.session.StandardManager.run(StandardManager.java:869)&lt;br/&gt;
	at java.lang.Thread.run(Thread.java:536)&lt;/p&gt;

&lt;p&gt;&quot;WebappLoader&lt;span class=&quot;error&quot;&gt;&amp;#91;/formonline&amp;#93;&lt;/span&gt;&quot; daemon prio=1 tid=0x0x8743ae0 nid=0x2f09 waiting on&lt;br/&gt;
monitor &lt;span class=&quot;error&quot;&gt;&amp;#91;be5ff000..be5ff87c&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at java.lang.Thread.sleep(Native Method)&lt;br/&gt;
	at org.apache.catalina.loader.WebappLoader.threadSleep(WebappLoader.java:1208)&lt;br/&gt;
	at org.apache.catalina.loader.WebappLoader.run(WebappLoader.java:1328)&lt;br/&gt;
	at java.lang.Thread.run(Thread.java:536)&lt;/p&gt;

&lt;p&gt;&quot;process forker&quot; daemon prio=1 tid=0x0x888de30 nid=0x238f waiting on monitor&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;bbbff000..bbbff87c&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at java.lang.Object.wait(Native Method)&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;waiting on &amp;lt;0x44c930d0&amp;gt; (a java.lang.Object)&lt;br/&gt;
	at java.lang.UNIXProcessForker.run(Native Method)&lt;br/&gt;
	at java.lang.Thread.run(Thread.java:536)&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;&quot;process reaper&quot; daemon prio=1 tid=0x0x88931c0 nid=0x238e runnable&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;bbdff000..bbdff87c&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at java.lang.UNIXProcessReaper.run(Native Method)&lt;br/&gt;
	at java.lang.Thread.run(Thread.java:536)&lt;/p&gt;

&lt;p&gt;&quot;MonitorRunnable&quot; daemon prio=1 tid=0x0x8378b80 nid=0x2385 waiting on monitor&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;bbfff000..bbfff87c&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at java.lang.Object.wait(Native Method)&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;waiting on &amp;lt;0x44b1e430&amp;gt; (a&lt;br/&gt;
org.apache.tomcat.util.threads.ThreadPool$MonitorRunnable)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.tomcat.util.threads.ThreadPool$MonitorRunnable.run(ThreadPool.java:503)&lt;/li&gt;
	&lt;li&gt;locked &amp;lt;0x44b1e430&amp;gt; (a org.apache.tomcat.util.threads.ThreadPool$MonitorRunnable)&lt;br/&gt;
	at java.lang.Thread.run(Thread.java:536)&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;&quot;Thread-10&quot; daemon prio=1 tid=0x0x836e670 nid=0x2384 runnable &lt;span class=&quot;error&quot;&gt;&amp;#91;bc1ff000..bc1ff87c&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at java.net.PlainSocketImpl.socketAccept(Native Method)&lt;br/&gt;
	at java.net.PlainSocketImpl.accept(PlainSocketImpl.java:343)&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;locked &amp;lt;0x44b1e4b0&amp;gt; (a java.net.PlainSocketImpl)&lt;br/&gt;
	at java.net.ServerSocket.implAccept(ServerSocket.java:438)&lt;br/&gt;
	at java.net.ServerSocket.accept(ServerSocket.java:409)&lt;br/&gt;
	at org.apache.jk.common.ChannelSocket.accept(ChannelSocket.java:268)&lt;br/&gt;
	at org.apache.jk.common.ChannelSocket.acceptConnections(ChannelSocket.java:531)&lt;br/&gt;
	at org.apache.jk.common.SocketAcceptor.runIt(ChannelSocket.java:660)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run(ThreadPool.java:619)&lt;br/&gt;
	at java.lang.Thread.run(Thread.java:536)&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;&quot;Thread-9&quot; daemon prio=1 tid=0x0x836f688 nid=0x2383 waiting on monitor&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;bc3ff000..bc3ff87c&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at java.lang.Object.wait(Native Method)&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;waiting on &amp;lt;0x44b1e670&amp;gt; (a&lt;br/&gt;
org.apache.tomcat.util.threads.ThreadPool$ControlRunnable)&lt;br/&gt;
	at java.lang.Object.wait(Object.java:426)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run(ThreadPool.java:595)&lt;/li&gt;
	&lt;li&gt;locked &amp;lt;0x44b1e670&amp;gt; (a org.apache.tomcat.util.threads.ThreadPool$ControlRunnable)&lt;br/&gt;
	at java.lang.Thread.run(Thread.java:536)&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;&quot;Thread-8&quot; daemon prio=1 tid=0x0x8372520 nid=0x2382 waiting on monitor&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;bc5ff000..bc5ff87c&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at java.lang.Object.wait(Native Method)&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;waiting on &amp;lt;0x44b1e6e8&amp;gt; (a&lt;br/&gt;
org.apache.tomcat.util.threads.ThreadPool$ControlRunnable)&lt;br/&gt;
	at java.lang.Object.wait(Object.java:426)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run(ThreadPool.java:595)&lt;/li&gt;
	&lt;li&gt;locked &amp;lt;0x44b1e6e8&amp;gt; (a org.apache.tomcat.util.threads.ThreadPool$ControlRunnable)&lt;br/&gt;
	at java.lang.Thread.run(Thread.java:536)&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;&quot;Thread-7&quot; daemon prio=1 tid=0x0x836cf18 nid=0x2381 waiting on monitor&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;bc7ff000..bc7ff87c&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at java.lang.Object.wait(Native Method)&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;waiting on &amp;lt;0x44b1e760&amp;gt; (a&lt;br/&gt;
org.apache.tomcat.util.threads.ThreadPool$ControlRunnable)&lt;br/&gt;
	at java.lang.Object.wait(Object.java:426)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run(ThreadPool.java:595)&lt;/li&gt;
	&lt;li&gt;locked &amp;lt;0x44b1e760&amp;gt; (a org.apache.tomcat.util.threads.ThreadPool$ControlRunnable)&lt;br/&gt;
	at java.lang.Thread.run(Thread.java:536)&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;&quot;MonitorRunnable&quot; daemon prio=1 tid=0x0x836b398 nid=0x2380 waiting on monitor&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;bc9ff000..bc9ff87c&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at java.lang.Object.wait(Native Method)&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;waiting on &amp;lt;0x44b0e700&amp;gt; (a&lt;br/&gt;
org.apache.tomcat.util.threads.ThreadPool$MonitorRunnable)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.tomcat.util.threads.ThreadPool$MonitorRunnable.run(ThreadPool.java:503)&lt;/li&gt;
	&lt;li&gt;locked &amp;lt;0x44b0e700&amp;gt; (a org.apache.tomcat.util.threads.ThreadPool$MonitorRunnable)&lt;br/&gt;
	at java.lang.Thread.run(Thread.java:536)&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;&quot;Thread-5&quot; daemon prio=1 tid=0x0x836a478 nid=0x237f waiting on monitor&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;bcbfe000..bcbff87c&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at java.lang.Object.wait(Native Method)&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;waiting on &amp;lt;0x45372418&amp;gt; (a org.apache.commons.dbcp.AbandonedObjectPool)&lt;br/&gt;
	at java.lang.Object.wait(Object.java:426)&lt;br/&gt;
	at org.apache.commons.pool.impl.GenericObjectPool.borrowObject(Unknown Source)&lt;/li&gt;
	&lt;li&gt;locked &amp;lt;0x45372418&amp;gt; (a org.apache.commons.dbcp.AbandonedObjectPool)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.commons.dbcp.AbandonedObjectPool.borrowObject(AbandonedObjectPool.java:117)&lt;/li&gt;
	&lt;li&gt;locked &amp;lt;0x45372418&amp;gt; (a org.apache.commons.dbcp.AbandonedObjectPool)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.commons.dbcp.PoolingDataSource.getConnection(PoolingDataSource.java:110)&lt;br/&gt;
	at org.apache.commons.dbcp.BasicDataSource.getConnection(BasicDataSource.java:312)&lt;br/&gt;
	at&lt;br/&gt;
com.opensymphony.module.user.provider.jdbc.JDBCCredentialsProvider.handles(JDBCCredentialsProvider.java:21)&lt;br/&gt;
	at com.opensymphony.module.user.UserManager.getProvider(UserManager.java:351)&lt;br/&gt;
	at com.opensymphony.module.user.UserManager.getEntity(UserManager.java:313)&lt;br/&gt;
	at com.opensymphony.module.user.UserManager.getUser(UserManager.java:129)&lt;br/&gt;
	at&lt;br/&gt;
net.metasite.formonline.commons.CustomRequestProcessor.processRoles(CustomRequestProcessor.java:52)&lt;br/&gt;
	at org.apache.struts.action.RequestProcessor.process(RequestProcessor.java:248)&lt;br/&gt;
	at org.apache.struts.action.ActionServlet.process(ActionServlet.java:1420)&lt;br/&gt;
	at org.apache.struts.action.ActionServlet.doGet(ActionServlet.java:502)&lt;br/&gt;
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:740)&lt;br/&gt;
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:853)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:247)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:193)&lt;br/&gt;
	at net.metasite.servlet.filters.EncodingFilter.doFilter(Unknown Source)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:213)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:193)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:256)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNext(StandardPipeline.java:643)&lt;br/&gt;
	at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:480)&lt;br/&gt;
	at org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:995)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNext(StandardPipeline.java:643)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:494)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNext(StandardPipeline.java:641)&lt;br/&gt;
	at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:480)&lt;br/&gt;
	at org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:995)&lt;br/&gt;
	at org.apache.catalina.core.StandardContext.invoke(StandardContext.java:2415)&lt;br/&gt;
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:180)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNext(StandardPipeline.java:643)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.valves.ErrorDispatcherValve.invoke(ErrorDispatcherValve.java:171)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNext(StandardPipeline.java:641)&lt;br/&gt;
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:172)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNext(StandardPipeline.java:641)&lt;br/&gt;
	at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:480)&lt;br/&gt;
	at org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:995)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:174)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNext(StandardPipeline.java:643)&lt;br/&gt;
	at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:480)&lt;br/&gt;
	at org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:995)&lt;br/&gt;
	at org.apache.coyote.tomcat4.CoyoteAdapter.service(CoyoteAdapter.java:223)&lt;br/&gt;
	at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:594)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.processConnection(Http11Protocol.java:392)&lt;br/&gt;
	at org.apache.tomcat.util.net.TcpWorkerThread.runIt(PoolTcpEndpoint.java:565)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run(ThreadPool.java:619)&lt;br/&gt;
	at java.lang.Thread.run(Thread.java:536)&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;&quot;Thread-4&quot; daemon prio=1 tid=0x0x8369560 nid=0x237e waiting on monitor&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;bcdfe000..bcdff87c&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at java.lang.Object.wait(Native Method)&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;waiting on &amp;lt;0x45372418&amp;gt; (a org.apache.commons.dbcp.AbandonedObjectPool)&lt;br/&gt;
	at java.lang.Object.wait(Object.java:426)&lt;br/&gt;
	at org.apache.commons.pool.impl.GenericObjectPool.borrowObject(Unknown Source)&lt;/li&gt;
	&lt;li&gt;locked &amp;lt;0x45372418&amp;gt; (a org.apache.commons.dbcp.AbandonedObjectPool)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.commons.dbcp.AbandonedObjectPool.borrowObject(AbandonedObjectPool.java:117)&lt;/li&gt;
	&lt;li&gt;locked &amp;lt;0x45372418&amp;gt; (a org.apache.commons.dbcp.AbandonedObjectPool)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.commons.dbcp.PoolingDataSource.getConnection(PoolingDataSource.java:110)&lt;br/&gt;
	at org.apache.commons.dbcp.BasicDataSource.getConnection(BasicDataSource.java:312)&lt;br/&gt;
	at&lt;br/&gt;
com.opensymphony.module.user.provider.jdbc.JDBCCredentialsProvider.handles(JDBCCredentialsProvider.java:21)&lt;br/&gt;
	at com.opensymphony.module.user.UserManager.getProvider(UserManager.java:351)&lt;br/&gt;
	at com.opensymphony.module.user.UserManager.getEntity(UserManager.java:313)&lt;br/&gt;
	at com.opensymphony.module.user.UserManager.getUser(UserManager.java:129)&lt;br/&gt;
	at&lt;br/&gt;
net.metasite.formonline.commons.CustomRequestProcessor.processRoles(CustomRequestProcessor.java:52)&lt;br/&gt;
	at org.apache.struts.action.RequestProcessor.process(RequestProcessor.java:248)&lt;br/&gt;
	at org.apache.struts.action.ActionServlet.process(ActionServlet.java:1420)&lt;br/&gt;
	at org.apache.struts.action.ActionServlet.doGet(ActionServlet.java:502)&lt;br/&gt;
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:740)&lt;br/&gt;
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:853)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:247)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:193)&lt;br/&gt;
	at net.metasite.servlet.filters.EncodingFilter.doFilter(Unknown Source)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:213)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:193)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:256)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNext(StandardPipeline.java:643)&lt;br/&gt;
	at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:480)&lt;br/&gt;
	at org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:995)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNext(StandardPipeline.java:643)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:494)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNext(StandardPipeline.java:641)&lt;br/&gt;
	at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:480)&lt;br/&gt;
	at org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:995)&lt;br/&gt;
	at org.apache.catalina.core.StandardContext.invoke(StandardContext.java:2415)&lt;br/&gt;
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:180)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNext(StandardPipeline.java:643)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.valves.ErrorDispatcherValve.invoke(ErrorDispatcherValve.java:171)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNext(StandardPipeline.java:641)&lt;br/&gt;
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:172)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNext(StandardPipeline.java:641)&lt;br/&gt;
	at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:480)&lt;br/&gt;
	at org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:995)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:174)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNext(StandardPipeline.java:643)&lt;br/&gt;
	at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:480)&lt;br/&gt;
	at org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:995)&lt;br/&gt;
	at org.apache.coyote.tomcat4.CoyoteAdapter.service(CoyoteAdapter.java:223)&lt;br/&gt;
	at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:594)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.processConnection(Http11Protocol.java:392)&lt;br/&gt;
	at org.apache.tomcat.util.net.TcpWorkerThread.runIt(PoolTcpEndpoint.java:565)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run(ThreadPool.java:619)&lt;br/&gt;
	at java.lang.Thread.run(Thread.java:536)&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;&quot;Thread-3&quot; daemon prio=1 tid=0x0x8368958 nid=0x237d waiting on monitor&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;bcffe000..bcfff87c&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at java.lang.Object.wait(Native Method)&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;waiting on &amp;lt;0x45372418&amp;gt; (a org.apache.commons.dbcp.AbandonedObjectPool)&lt;br/&gt;
	at java.lang.Object.wait(Object.java:426)&lt;br/&gt;
	at org.apache.commons.pool.impl.GenericObjectPool.borrowObject(Unknown Source)&lt;/li&gt;
	&lt;li&gt;locked &amp;lt;0x45372418&amp;gt; (a org.apache.commons.dbcp.AbandonedObjectPool)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.commons.dbcp.AbandonedObjectPool.borrowObject(AbandonedObjectPool.java:117)&lt;/li&gt;
	&lt;li&gt;locked &amp;lt;0x45372418&amp;gt; (a org.apache.commons.dbcp.AbandonedObjectPool)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.commons.dbcp.PoolingDataSource.getConnection(PoolingDataSource.java:110)&lt;br/&gt;
	at org.apache.commons.dbcp.BasicDataSource.getConnection(BasicDataSource.java:312)&lt;br/&gt;
	at&lt;br/&gt;
com.opensymphony.module.user.provider.jdbc.JDBCCredentialsProvider.handles(JDBCCredentialsProvider.java:21)&lt;br/&gt;
	at com.opensymphony.module.user.UserManager.getProvider(UserManager.java:351)&lt;br/&gt;
	at com.opensymphony.module.user.UserManager.getEntity(UserManager.java:313)&lt;br/&gt;
	at com.opensymphony.module.user.UserManager.getUser(UserManager.java:129)&lt;br/&gt;
	at&lt;br/&gt;
net.metasite.formonline.commons.CustomRequestProcessor.processRoles(CustomRequestProcessor.java:52)&lt;br/&gt;
	at org.apache.struts.action.RequestProcessor.process(RequestProcessor.java:248)&lt;br/&gt;
	at org.apache.struts.action.ActionServlet.process(ActionServlet.java:1420)&lt;br/&gt;
	at org.apache.struts.action.ActionServlet.doGet(ActionServlet.java:502)&lt;br/&gt;
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:740)&lt;br/&gt;
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:853)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:247)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:193)&lt;br/&gt;
	at net.metasite.servlet.filters.EncodingFilter.doFilter(Unknown Source)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:213)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:193)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:256)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNext(StandardPipeline.java:643)&lt;br/&gt;
	at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:480)&lt;br/&gt;
	at org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:995)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNext(StandardPipeline.java:643)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:494)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNext(StandardPipeline.java:641)&lt;br/&gt;
	at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:480)&lt;br/&gt;
	at org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:995)&lt;br/&gt;
	at org.apache.catalina.core.StandardContext.invoke(StandardContext.java:2415)&lt;br/&gt;
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:180)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNext(StandardPipeline.java:643)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.valves.ErrorDispatcherValve.invoke(ErrorDispatcherValve.java:171)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNext(StandardPipeline.java:641)&lt;br/&gt;
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:172)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNext(StandardPipeline.java:641)&lt;br/&gt;
	at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:480)&lt;br/&gt;
	at org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:995)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:174)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNext(StandardPipeline.java:643)&lt;br/&gt;
	at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:480)&lt;br/&gt;
	at org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:995)&lt;br/&gt;
	at org.apache.coyote.tomcat4.CoyoteAdapter.service(CoyoteAdapter.java:223)&lt;br/&gt;
	at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:594)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.processConnection(Http11Protocol.java:392)&lt;br/&gt;
	at org.apache.tomcat.util.net.TcpWorkerThread.runIt(PoolTcpEndpoint.java:565)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run(ThreadPool.java:619)&lt;br/&gt;
	at java.lang.Thread.run(Thread.java:536)&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;&quot;Thread-2&quot; daemon prio=1 tid=0x0x836a0a0 nid=0x237c waiting on monitor&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;bd1fe000..bd1ff87c&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at java.lang.Object.wait(Native Method)&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;waiting on &amp;lt;0x45372418&amp;gt; (a org.apache.commons.dbcp.AbandonedObjectPool)&lt;br/&gt;
	at java.lang.Object.wait(Object.java:426)&lt;br/&gt;
	at org.apache.commons.pool.impl.GenericObjectPool.borrowObject(Unknown Source)&lt;/li&gt;
	&lt;li&gt;locked &amp;lt;0x45372418&amp;gt; (a org.apache.commons.dbcp.AbandonedObjectPool)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.commons.dbcp.AbandonedObjectPool.borrowObject(AbandonedObjectPool.java:117)&lt;/li&gt;
	&lt;li&gt;locked &amp;lt;0x45372418&amp;gt; (a org.apache.commons.dbcp.AbandonedObjectPool)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.commons.dbcp.PoolingDataSource.getConnection(PoolingDataSource.java:110)&lt;br/&gt;
	at org.apache.commons.dbcp.BasicDataSource.getConnection(BasicDataSource.java:312)&lt;br/&gt;
	at&lt;br/&gt;
com.opensymphony.module.user.provider.jdbc.JDBCCredentialsProvider.handles(JDBCCredentialsProvider.java:21)&lt;br/&gt;
	at com.opensymphony.module.user.UserManager.getProvider(UserManager.java:351)&lt;br/&gt;
	at com.opensymphony.module.user.UserManager.getEntity(UserManager.java:313)&lt;br/&gt;
	at com.opensymphony.module.user.UserManager.getUser(UserManager.java:129)&lt;br/&gt;
	at&lt;br/&gt;
net.metasite.formonline.commons.CustomRequestProcessor.processRoles(CustomRequestProcessor.java:52)&lt;br/&gt;
	at org.apache.struts.action.RequestProcessor.process(RequestProcessor.java:248)&lt;br/&gt;
	at org.apache.struts.action.ActionServlet.process(ActionServlet.java:1420)&lt;br/&gt;
	at org.apache.struts.action.ActionServlet.doGet(ActionServlet.java:502)&lt;br/&gt;
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:740)&lt;br/&gt;
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:853)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:247)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:193)&lt;br/&gt;
	at net.metasite.servlet.filters.EncodingFilter.doFilter(Unknown Source)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:213)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:193)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:256)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNext(StandardPipeline.java:643)&lt;br/&gt;
	at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:480)&lt;br/&gt;
	at org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:995)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNext(StandardPipeline.java:643)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:494)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNext(StandardPipeline.java:641)&lt;br/&gt;
	at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:480)&lt;br/&gt;
	at org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:995)&lt;br/&gt;
	at org.apache.catalina.core.StandardContext.invoke(StandardContext.java:2415)&lt;br/&gt;
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:180)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNext(StandardPipeline.java:643)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.valves.ErrorDispatcherValve.invoke(ErrorDispatcherValve.java:171)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNext(StandardPipeline.java:641)&lt;br/&gt;
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:172)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNext(StandardPipeline.java:641)&lt;br/&gt;
	at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:480)&lt;br/&gt;
	at org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:995)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:174)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNext(StandardPipeline.java:643)&lt;br/&gt;
	at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:480)&lt;br/&gt;
	at org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:995)&lt;br/&gt;
	at org.apache.coyote.tomcat4.CoyoteAdapter.service(CoyoteAdapter.java:223)&lt;br/&gt;
	at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:594)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.processConnection(Http11Protocol.java:392)&lt;br/&gt;
	at org.apache.tomcat.util.net.TcpWorkerThread.runIt(PoolTcpEndpoint.java:565)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run(ThreadPool.java:619)&lt;br/&gt;
	at java.lang.Thread.run(Thread.java:536)&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;&quot;HostConfig&lt;span class=&quot;error&quot;&gt;&amp;#91;localhost&amp;#93;&lt;/span&gt;&quot; daemon prio=1 tid=0x0x8365730 nid=0x237b waiting on&lt;br/&gt;
monitor &lt;span class=&quot;error&quot;&gt;&amp;#91;bd3ff000..bd3ff87c&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at java.lang.Thread.sleep(Native Method)&lt;br/&gt;
	at org.apache.catalina.startup.HostConfig.threadSleep(HostConfig.java:824)&lt;br/&gt;
	at org.apache.catalina.startup.HostConfig.run(HostConfig.java:848)&lt;br/&gt;
	at java.lang.Thread.run(Thread.java:536)&lt;/p&gt;

&lt;p&gt;&quot;StandardManager[]&quot; daemon prio=1 tid=0x0x83651f8 nid=0x237a waiting on monitor&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;bd5ff000..bd5ff87c&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at java.lang.Thread.sleep(Native Method)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.session.StandardManager.threadSleep(StandardManager.java:810)&lt;br/&gt;
	at org.apache.catalina.session.StandardManager.run(StandardManager.java:869)&lt;br/&gt;
	at java.lang.Thread.run(Thread.java:536)&lt;/p&gt;

&lt;p&gt;&quot;StandardManager&lt;span class=&quot;error&quot;&gt;&amp;#91;/tomcat-docs&amp;#93;&lt;/span&gt;&quot; daemon prio=1 tid=0x0x8366980 nid=0x2379 waiting&lt;br/&gt;
on monitor &lt;span class=&quot;error&quot;&gt;&amp;#91;bd7ff000..bd7ff87c&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at java.lang.Thread.sleep(Native Method)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.session.StandardManager.threadSleep(StandardManager.java:810)&lt;br/&gt;
	at org.apache.catalina.session.StandardManager.run(StandardManager.java:869)&lt;br/&gt;
	at java.lang.Thread.run(Thread.java:536)&lt;/p&gt;

&lt;p&gt;&quot;StandardManager&lt;span class=&quot;error&quot;&gt;&amp;#91;/cewolf&amp;#93;&lt;/span&gt;&quot; daemon prio=1 tid=0x0x8362cc8 nid=0x2378 waiting on&lt;br/&gt;
monitor &lt;span class=&quot;error&quot;&gt;&amp;#91;bd9ff000..bd9ff87c&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at java.lang.Thread.sleep(Native Method)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.session.StandardManager.threadSleep(StandardManager.java:810)&lt;br/&gt;
	at org.apache.catalina.session.StandardManager.run(StandardManager.java:869)&lt;br/&gt;
	at java.lang.Thread.run(Thread.java:536)&lt;/p&gt;

&lt;p&gt;&quot;StandardManager&lt;span class=&quot;error&quot;&gt;&amp;#91;/jfreechart-sample&amp;#93;&lt;/span&gt;&quot; daemon prio=1 tid=0x0x852cea8 nid=0x2377&lt;br/&gt;
waiting on monitor &lt;span class=&quot;error&quot;&gt;&amp;#91;bdbff000..bdbff87c&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at java.lang.Thread.sleep(Native Method)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.session.StandardManager.threadSleep(StandardManager.java:810)&lt;br/&gt;
	at org.apache.catalina.session.StandardManager.run(StandardManager.java:869)&lt;br/&gt;
	at java.lang.Thread.run(Thread.java:536)&lt;/p&gt;

&lt;p&gt;&quot;StandardManager&lt;span class=&quot;error&quot;&gt;&amp;#91;/struts-documentation&amp;#93;&lt;/span&gt;&quot; daemon prio=1 tid=0x0x8294dd0&lt;br/&gt;
nid=0x2376 waiting on monitor &lt;span class=&quot;error&quot;&gt;&amp;#91;bddff000..bddff87c&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at java.lang.Thread.sleep(Native Method)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.session.StandardManager.threadSleep(StandardManager.java:810)&lt;br/&gt;
	at org.apache.catalina.session.StandardManager.run(StandardManager.java:869)&lt;br/&gt;
	at java.lang.Thread.run(Thread.java:536)&lt;/p&gt;

&lt;p&gt;&quot;StandardManager&lt;span class=&quot;error&quot;&gt;&amp;#91;/manager&amp;#93;&lt;/span&gt;&quot; daemon prio=1 tid=0x0x82b99f8 nid=0x2375 waiting on&lt;br/&gt;
monitor &lt;span class=&quot;error&quot;&gt;&amp;#91;bdfff000..bdfff87c&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at java.lang.Thread.sleep(Native Method)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.session.StandardManager.threadSleep(StandardManager.java:810)&lt;br/&gt;
	at org.apache.catalina.session.StandardManager.run(StandardManager.java:869)&lt;br/&gt;
	at java.lang.Thread.run(Thread.java:536)&lt;/p&gt;

&lt;p&gt;&quot;StandardManager&lt;span class=&quot;error&quot;&gt;&amp;#91;/admin&amp;#93;&lt;/span&gt;&quot; daemon prio=1 tid=0x0x85422f8 nid=0x2374 waiting on&lt;br/&gt;
monitor &lt;span class=&quot;error&quot;&gt;&amp;#91;be1ff000..be1ff87c&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at java.lang.Thread.sleep(Native Method)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.session.StandardManager.threadSleep(StandardManager.java:810)&lt;br/&gt;
	at org.apache.catalina.session.StandardManager.run(StandardManager.java:869)&lt;br/&gt;
	at java.lang.Thread.run(Thread.java:536)&lt;/p&gt;

&lt;p&gt;&quot;StandardManager&lt;span class=&quot;error&quot;&gt;&amp;#91;/examples&amp;#93;&lt;/span&gt;&quot; daemon prio=1 tid=0x0x862ffc8 nid=0x2370 waiting on&lt;br/&gt;
monitor &lt;span class=&quot;error&quot;&gt;&amp;#91;be7ff000..be7ff87c&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at java.lang.Thread.sleep(Native Method)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.catalina.session.StandardManager.threadSleep(StandardManager.java:810)&lt;br/&gt;
	at org.apache.catalina.session.StandardManager.run(StandardManager.java:869)&lt;br/&gt;
	at java.lang.Thread.run(Thread.java:536)&lt;/p&gt;

&lt;p&gt;&quot;WebappLoader&lt;span class=&quot;error&quot;&gt;&amp;#91;/examples&amp;#93;&lt;/span&gt;&quot; daemon prio=1 tid=0x0x85a9f88 nid=0x236f waiting on&lt;br/&gt;
monitor &lt;span class=&quot;error&quot;&gt;&amp;#91;be9ff000..be9ff87c&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at java.lang.Thread.sleep(Native Method)&lt;br/&gt;
	at org.apache.catalina.loader.WebappLoader.threadSleep(WebappLoader.java:1208)&lt;br/&gt;
	at org.apache.catalina.loader.WebappLoader.run(WebappLoader.java:1328)&lt;br/&gt;
	at java.lang.Thread.run(Thread.java:536)&lt;/p&gt;

&lt;p&gt;&quot;Signal Dispatcher&quot; daemon prio=1 tid=0x0x8084468 nid=0x236c waiting on monitor&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;0..0&amp;#93;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&quot;Finalizer&quot; daemon prio=1 tid=0x0x807cb88 nid=0x2369 waiting on monitor&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;bf3ff000..bf3ff87c&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at java.lang.Object.wait(Native Method)&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;waiting on &amp;lt;0x446f27b0&amp;gt; (a java.lang.ref.ReferenceQueue$Lock)&lt;br/&gt;
	at java.lang.ref.ReferenceQueue.remove(ReferenceQueue.java:111)&lt;/li&gt;
	&lt;li&gt;locked &amp;lt;0x446f27b0&amp;gt; (a java.lang.ref.ReferenceQueue$Lock)&lt;br/&gt;
	at java.lang.ref.ReferenceQueue.remove(ReferenceQueue.java:127)&lt;br/&gt;
	at java.lang.ref.Finalizer$FinalizerThread.run(Finalizer.java:159)&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;&quot;Reference Handler&quot; daemon prio=1 tid=0x0x807bfc8 nid=0x2368 waiting on monitor&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;bf5ff000..bf5ff87c&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at java.lang.Object.wait(Native Method)&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;waiting on &amp;lt;0x446f2818&amp;gt; (a java.lang.ref.Reference$Lock)&lt;br/&gt;
	at java.lang.Object.wait(Object.java:426)&lt;br/&gt;
	at java.lang.ref.Reference$ReferenceHandler.run(Reference.java:113)&lt;/li&gt;
	&lt;li&gt;locked &amp;lt;0x446f2818&amp;gt; (a java.lang.ref.Reference$Lock)&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;&quot;main&quot; prio=1 tid=0x0x8051970 nid=0x2360 runnable &lt;span class=&quot;error&quot;&gt;&amp;#91;bfffc000..bfffd4e8&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at java.net.PlainSocketImpl.socketAccept(Native Method)&lt;br/&gt;
	at java.net.PlainSocketImpl.accept(PlainSocketImpl.java:343)&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;locked &amp;lt;0x44b1e7a8&amp;gt; (a java.net.PlainSocketImpl)&lt;br/&gt;
	at java.net.ServerSocket.implAccept(ServerSocket.java:438)&lt;br/&gt;
	at java.net.ServerSocket.accept(ServerSocket.java:409)&lt;br/&gt;
	at org.apache.catalina.core.StandardServer.await(StandardServer.java:527)&lt;br/&gt;
	at org.apache.catalina.startup.Catalina.start(Catalina.java:521)&lt;br/&gt;
	at org.apache.catalina.startup.Catalina.execute(Catalina.java:400)&lt;br/&gt;
	at org.apache.catalina.startup.Catalina.process(Catalina.java:180)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)&lt;br/&gt;
	at&lt;br/&gt;
sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)&lt;br/&gt;
	at java.lang.reflect.Method.invoke(Method.java:324)&lt;br/&gt;
	at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:203)&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;&quot;VM Thread&quot; prio=1 tid=0x0x8078e18 nid=0x2367 runnable &lt;/p&gt;

&lt;p&gt;&quot;VM Periodic Task Thread&quot; prio=1 tid=0x0x8083048 nid=0x236a waiting on monitor &lt;br/&gt;
&quot;Suspend Checker Thread&quot; prio=1 tid=0x0x80839f0 nid=0x236b runnable&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: other&lt;br/&gt;
Platform: PC&lt;/p&gt;</environment>
        <key id="12340776">DBCP-79</key>
            <summary>deadlock when acquiring connections from a pool</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="4">Incomplete</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="saulius@metasite.net">Saulius Sinkunas</reporter>
                        <labels>
                    </labels>
                <created>Tue, 10 Jun 2003 22:14:38 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:31 +0000</updated>
                            <resolved>Tue, 25 Mar 2008 08:11:31 +0000</resolved>
                                    <version>1.0</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12404440" author="dirkv" created="Tue, 12 Aug 2003 07:06:19 +0000"  >&lt;p&gt;AbandonedObjectPool and its heave synchronized methods isn&apos;t used anymore.&lt;br/&gt;
Please use latest version.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>20649</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114362</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            22 years, 14 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0v0hj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>179052</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-78] same connections</title>
                <link>https://issues.apache.org/jira/browse/DBCP-78</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;I use blow code in a jsp file, and I get some same connection.&lt;/p&gt;

&lt;p&gt;System.setProperty(&quot;jdbc.drivers&quot;, &quot;oracle.jdbc.dirver.OracleDriver&quot;);&lt;br/&gt;
ObjectPool connectionPool =&lt;br/&gt;
	new GenericObjectPool(null, 70, GenericObjectPool.WHEN_EXHAUSTED_BLOCK, &lt;br/&gt;
		      60000, 10);&lt;br/&gt;
ConnectionFactory connectionFactory =&lt;br/&gt;
	new DriverManagerConnectionFactory&lt;br/&gt;
(&quot;jdbc:oracle:thin:@192.168.3.226:1521:pacs&quot;, &lt;br/&gt;
				   username, password);&lt;br/&gt;
PoolableConnectionFactory poolableConnectionFactory =&lt;br/&gt;
	new PoolableConnectionFactory(connectionFactory, connectionPool, null, &lt;br/&gt;
null, false, true);&lt;/p&gt;

&lt;p&gt;PoolingDriver driver = new PoolingDriver();&lt;br/&gt;
driver.registerPool(&quot;neusoftim&quot;, connectionPool);&lt;/p&gt;

&lt;p&gt;Connection[] conn = new Connection&lt;span class=&quot;error&quot;&gt;&amp;#91;25&amp;#93;&lt;/span&gt;;&lt;br/&gt;
for (int i = 0; i &amp;lt; 25; i++)&lt;br/&gt;
{&lt;br/&gt;
        try&lt;/p&gt;
        {
                conn[i] = DriverManager.getConnection
(com.neusoft.im.IMConstants.DATABASE_URL);
                out.println(&quot;hashcode of &quot; + conn[i] + &quot; is &quot; + conn[i].hashCode
());
        }
&lt;p&gt;        catch (Exception e)&lt;/p&gt;
        {
                Log.error(&quot;ERROR for connection&quot; + i, e);
                out.println(e);
                out.flush();
        }
&lt;p&gt;}&lt;/p&gt;

&lt;p&gt;for (int i = 0; i &amp;lt; 25; i++)&lt;br/&gt;
{&lt;br/&gt;
      out.println(&quot;Close &quot; + i + &quot;:&quot;);&lt;br/&gt;
      try &lt;/p&gt;
{conn[i].close();}
&lt;p&gt; catch (Exception e) &lt;/p&gt;
{out.println(e);}
&lt;p&gt;}&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: Linux&lt;br/&gt;
Platform: PC&lt;/p&gt;</environment>
        <key id="12340308">DBCP-78</key>
            <summary>same connections</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="5">Cannot Reproduce</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="jihh@neusoft.com">Haihan Ji</reporter>
                        <labels>
                    </labels>
                <created>Sun, 8 Sep 2002 22:23:16 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:31 +0000</updated>
                            <resolved>Tue, 25 Mar 2008 08:11:31 +0000</resolved>
                                    <version>1.0</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12402869" author="jihh@neusoft.com" created="Mon, 9 Sep 2002 10:25:39 +0000"  >&lt;p&gt;reason may be &lt;a href=&quot;https://issues.apache.org/jira/browse/DBCP-85&quot; title=&quot;Connection can be closed twice&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DBCP-85&quot;&gt;&lt;del&gt;COM-158&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="12402870" author="rwaldhof@us.britannica.com" created="Fri, 8 Nov 2002 05:08:23 +0000"  >&lt;p&gt;There was already a similar test at &lt;br/&gt;
org.apache.commons.dbcp.TestManual.testPooling, but I added a more directy copy &lt;br/&gt;
at TestManual.testReportedBug12400 (see rev. 1.11), and I still don&apos;t see any &lt;br/&gt;
problem.  &lt;/p&gt;

&lt;p&gt;Although &lt;a href=&quot;https://issues.apache.org/jira/browse/DBCP-85&quot; title=&quot;Connection can be closed twice&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DBCP-85&quot;&gt;&lt;del&gt;COM-158&lt;/del&gt;&lt;/a&gt; (&lt;a href=&quot;http://issues.apache.org/bugzilla/show_bug.cgi?id=12409&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://issues.apache.org/bugzilla/show_bug.cgi?id=12409&lt;/a&gt;) &lt;br/&gt;
was already fixed, I don&apos;t think that&apos;s related--in the sample code you posted, &lt;br/&gt;
each connection is only closed once anyway.&lt;/p&gt;

&lt;p&gt;If you still see issues here, please reopen with more detail.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>12400</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114361</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            23 years, 1 week, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0v0sf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>179101</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-77] Potential for DelegateStatement, DelegateResultSet to be left open</title>
                <link>https://issues.apache.org/jira/browse/DBCP-77</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;There is a potential for DBCP to leave DelegateStatement and DelegateResultSet&lt;br/&gt;
open when PoolableConnection is closed.&lt;/p&gt;

&lt;p&gt;PoolableConnection overrides DelegateConnection.close() method and returns the&lt;br/&gt;
object to the pool.  The pool will normally call&lt;br/&gt;
PoolableConnectionFactory.passivate() which in turn calls&lt;br/&gt;
DelegateConnection.passivate() that closes any open DelegateStatement and&lt;br/&gt;
DelegateResultSet.&lt;/p&gt;

&lt;p&gt;When a pool is set up to testOnReturn and the validation fails, then passivate()&lt;br/&gt;
is not called, only factory.destroyObject() is called.  Also if a connection is&lt;br/&gt;
returned with pool.invalidateObject() then factory.destroyObject() is only called.&lt;/p&gt;

&lt;p&gt;factory.destroyObject() just calls PoolableConnection.reallyClose() which closes&lt;br/&gt;
the underlying connection and does not close any DelegateStatements and&lt;br/&gt;
DelegateResultSets created.&lt;/p&gt;

&lt;p&gt;Obviously PoolableConnection.close() should override DelegateConnection.close()&lt;br/&gt;
because the latter closes the underlying connection which we don&apos;t want to have&lt;br/&gt;
happen.  It is relying on the pool to call passivate() when the object is&lt;br/&gt;
returned to the pool, so it doesn&apos;t need to call passivate() itself.&lt;/p&gt;

&lt;p&gt;Solutions?&lt;/p&gt;

&lt;p&gt;Perhaps PoolableConnectionFactory.destroyObject() should call&lt;br/&gt;
DelegateConnection.passivate()?&lt;/p&gt;

&lt;p&gt;Perhaps PoolableConnection.close() should use the&lt;br/&gt;
PoolableConnectionFactory.passivateObject() code, and PoolableConnectionFactory.&lt;br/&gt;
be modified to do nothing?  This would return a clean connection back to the pool.&lt;/p&gt;

&lt;p&gt;I thought GenericObjectPool might have been at fault but I think it seems&lt;br/&gt;
reasonable for the pool to not passivate() and object and only call&lt;br/&gt;
factory.destroyObject() and have it clean everything up.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: other&lt;br/&gt;
Platform: Other&lt;/p&gt;</environment>
        <key id="12340686">DBCP-77</key>
            <summary>Potential for DelegateStatement, DelegateResultSet to be left open</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="jason@kumachan.net.nz">Jason Lea</reporter>
                        <labels>
                    </labels>
                <created>Mon, 28 Apr 2003 06:10:55 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:30 +0000</updated>
                            <resolved>Tue, 25 Mar 2008 08:11:30 +0000</resolved>
                                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12404170" author="dirkv" created="Sun, 11 May 2003 20:20:30 +0000"  >&lt;p&gt;How about changing PoolableConnection to simply do:&lt;/p&gt;

&lt;p&gt;    /**&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Actually close my underlying 
{@link Connection}
&lt;p&gt;.&lt;br/&gt;
     */&lt;br/&gt;
    public void reallyClose() throws SQLException &lt;/p&gt;
{
        super.close();
    }&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="12404171" author="dirkv" created="Mon, 11 Aug 2003 19:25:37 +0000"  >&lt;p&gt;Applied the super.close fix&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>19374</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114360</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            22 years, 14 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uy4v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178671</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-76] Version in the Manifest</title>
                <link>https://issues.apache.org/jira/browse/DBCP-76</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;Can you add, for a future use, the release number in the Manifest File, like it &lt;br/&gt;
is done in other commons projects.&lt;/p&gt;

&lt;p&gt;Thanks.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: other&lt;br/&gt;
Platform: Other&lt;/p&gt;</environment>
        <key id="12340260">DBCP-76</key>
            <summary>Version in the Manifest</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="aheritier@sopragroup.com">Arnaud HERITIER</reporter>
                        <labels>
                    </labels>
                <created>Thu, 11 Jul 2002 21:13:00 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:30 +0000</updated>
                            <resolved>Tue, 25 Mar 2008 08:11:30 +0000</resolved>
                                    <version>Nightly Builds</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12402740" author="craig.mcclanahan@sun.com" created="Sun, 21 Jul 2002 01:03:01 +0000"  >&lt;p&gt;Fixed in nightly build 20020721.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>10688</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114359</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            23 years, 17 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uysn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178778</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-75] PoolableConnectionFactory-Construction declared to throw Exception</title>
                <link>https://issues.apache.org/jira/browse/DBCP-75</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;The constructor &quot;public PoolableConnectionFactory(ConnectionFactory connFactory, &lt;br/&gt;
ObjectPool pool, KeyedObjectPoolFactory stmtPoolFactory, String validationQuery, &lt;br/&gt;
boolean defaultReadOnly, boolean defaultAutoCommit)&quot; is declared that it may &lt;br/&gt;
throw an exception.&lt;/p&gt;




&lt;p&gt;However the constructor code &lt;b&gt;never&lt;/b&gt; throws any checked exceptions so this &lt;br/&gt;
throws-declartion should be removed (like the second constructor with an &lt;br/&gt;
additional parameter).&lt;/p&gt;




&lt;p&gt;This change is completely backwards compatible (ie existing source code &lt;br/&gt;
continues to compile)&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: other&lt;br/&gt;
Platform: Other&lt;/p&gt;</environment>
        <key id="12340581">DBCP-75</key>
            <summary>PoolableConnectionFactory-Construction declared to throw Exception</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="tkl@telenet.ch">Thomas Kl&#228;ger</reporter>
                        <labels>
                    </labels>
                <created>Tue, 4 Mar 2003 22:32:47 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:30 +0000</updated>
                            <resolved>Tue, 25 Mar 2008 08:11:30 +0000</resolved>
                                    <version>1.0</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12403772" author="tkl@telenet.ch" created="Tue, 4 Mar 2003 22:39:27 +0000"  >&lt;p&gt;Created an attachment (id=5149)&lt;br/&gt;
Patch for PoolableConnectionFactory&lt;/p&gt;</comment>
                            <comment id="12403773" author="rwaldhoff@apache.org" created="Thu, 6 Mar 2003 23:27:51 +0000"  >&lt;p&gt;Fixed. Thanks Thomas.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12332166" name="ASF.LICENSE.NOT.GRANTED--PoolableConnectionFactory.txt" size="1286" author="tkl@telenet.ch" created="Tue, 4 Mar 2003 22:39:27 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>17635</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114358</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            22 years, 36 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uyzz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178811</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-74] Tomcat5 server hangs when trying to get the database connection</title>
                <link>https://issues.apache.org/jira/browse/DBCP-74</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;Tomcat5 server hangs when trying to get the database connection with Pointbase &lt;br/&gt;
4.2. &lt;/p&gt;

&lt;p&gt;From pointbase server, it seems the connection has been made. But the container &lt;br/&gt;
hangs and gives no response during getConnection() while the system is kept &lt;br/&gt;
busy.&lt;/p&gt;

&lt;p&gt;The datasource was looked up successfully by:&lt;/p&gt;

&lt;p&gt;datasource = (DataSource) ic.lookup(JNDINames.WORKFLOW_DATASOURCE);&lt;/p&gt;

&lt;p&gt;But container hangs when web applicaiton calls:&lt;/p&gt;

&lt;p&gt;dbConnection = datasource.getConnection();&lt;/p&gt;

&lt;p&gt;The same code and config worked on Tomcat 4.0 with no problem.&lt;/p&gt;


&lt;p&gt;------- Additional Comments From Bob Herrmann 2002-09-13 16:37 -------&lt;/p&gt;

&lt;p&gt;Ok, that sounds weird... I would imagine a class loader issue.&lt;/p&gt;

&lt;p&gt;How do I set this up?  Download from pointbase.com?  install DB?  Create users? &lt;/p&gt;



&lt;p&gt;------- Additional Comments From Chris Marks 2002-11-05 21:42 -------&lt;/p&gt;

&lt;p&gt;I don&apos;t know how you are coming along with the fix of this one, but I can &lt;br/&gt;
supply a little more information...&lt;br/&gt;
This is also apparent in Tomcat 4 and only affects Windows installs.  I have &lt;br/&gt;
tried tomcat 4.1.12 with a Win2k machine trying to connect to a Cloudscape db &lt;br/&gt;
as well as an Oracle db.  I have also tried tomcat 4.1.12 on WinXP connecting &lt;br/&gt;
to MySQL and MS SQL Server.  Both installs hung when trying to get a &lt;br/&gt;
connection.  The code I used is nearly identical to that referenced in &apos;JDBC &lt;br/&gt;
DataSource HOW-TO&apos;. Finally, I installed tomcat 4.1.12 on Mandrake and the &lt;br/&gt;
exact code I ran on the WinXP machine succeeded, giving me a connection to the &lt;br/&gt;
MySQL and MS SQL Server db&apos;s.  I could not try the Oracle db because it is at &lt;br/&gt;
another company.&lt;br/&gt;
Hope this helps a little.&lt;br/&gt;
Thanks,&lt;br/&gt;
Chris Marks&lt;/p&gt;


&lt;p&gt;------- Additional Comments From Remy Maucherat 2002-11-15 13:53 -------&lt;/p&gt;

&lt;p&gt;This cannot be a bug in Tomcat. Doing a thread dump should confirm this. You&lt;br/&gt;
might want to file a bug against commons-dbcp (with at least some stack&lt;br/&gt;
information added).&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: other&lt;br/&gt;
Platform: Other&lt;/p&gt;</environment>
        <key id="12340425">DBCP-74</key>
            <summary>Tomcat5 server hangs when trying to get the database connection</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="jian.cai@sun.com">James Cai</reporter>
                        <labels>
                    </labels>
                <created>Tue, 19 Nov 2002 09:20:01 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:30 +0000</updated>
                            <resolved>Fri, 24 Nov 2006 20:52:08 +0000</resolved>
                                    <version>1.0</version>
                                                        <due></due>
                            <votes>1</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12403253" author="rwaldhoff@apache.org" created="Fri, 7 Mar 2003 03:16:45 +0000"  >&lt;p&gt;Can someone provide additional detail on this problem?  Otherwise I&apos;ll flag it &lt;br/&gt;
as WORKSFORME at some point in the future.&lt;/p&gt;</comment>
                            <comment id="12403254" author="charlotte.millard@baesystems.com" created="Wed, 14 May 2003 14:35:52 +0000"  >&lt;p&gt;I am also experiencing this problem.&lt;br/&gt;
I am using Tomcat 4.1.24 on Windows 2000 server, connecting to a MS SQL Server &lt;br/&gt;
2000 database. (I&apos;ve also used Tomcat 4.1.18 with the same problem.)&lt;br/&gt;
I do not have this problem when using the Tomcat in Sun&apos;s JWSDP.&lt;/p&gt;

&lt;p&gt;Most of the time it works - I get the connection immediately. The problem &lt;br/&gt;
occurs when I try to get a second connection while the first one is open.&lt;br/&gt;
In SQL Server, while tomcat is hanging, I can see that the second (new) &lt;br/&gt;
connection/process is being blocked by the first. If I kill the first process, &lt;br/&gt;
Tomcat returns with a &quot;connection reset by peer: socket write error&quot; (as you&apos;d &lt;br/&gt;
expect).&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>14663</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114357</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            22 years, 27 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uwqf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178444</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-73] [DBCP][PATCH]Statement.getResultSet() doesn&apos;t return null if like javadocs</title>
                <link>https://issues.apache.org/jira/browse/DBCP-73</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;getResultSet() for java.sql.Statement():&lt;br/&gt;
the current result as a ResultSet object; null if the result is an update count&lt;br/&gt;
or there are no more results&lt;/p&gt;

&lt;p&gt;Currently DelegatingPreparedStatement,DelegatingCallableStatement, and&lt;br/&gt;
DelegatingStatement return a DelegatingResultSet where the delegate resultset is&lt;br/&gt;
null which will cause a NPE on future operations.&lt;/p&gt;

&lt;p&gt;Attached is a patch for the 3 files to check for null from getResultSet() via&lt;br/&gt;
cvs diff from the HEAD tag&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: All&lt;br/&gt;
Platform: All&lt;/p&gt;</environment>
        <key id="12340316">DBCP-73</key>
            <summary>[DBCP][PATCH]Statement.getResultSet() doesn&apos;t return null if like javadocs</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="funkman@joedog.org">Tim Funk</reporter>
                        <labels>
                    </labels>
                <created>Tue, 17 Sep 2002 18:56:12 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:30 +0000</updated>
                            <resolved>Tue, 25 Mar 2008 08:11:30 +0000</resolved>
                                    <version>Nightly Builds</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12402905" author="funkman@joedog.org" created="Tue, 17 Sep 2002 18:58:08 +0000"  >&lt;p&gt;Created an attachment (id=3102)&lt;br/&gt;
diff of the 3 files affected&lt;/p&gt;</comment>
                            <comment id="12402906" author="rwaldhof@us.britannica.com" created="Fri, 1 Nov 2002 05:16:16 +0000"  >&lt;p&gt;There were a couple of other places this needed to be addressed, but patch &lt;br/&gt;
applied.&lt;/p&gt;

&lt;p&gt;Thanks Tim.&lt;/p&gt;</comment>
                            <comment id="12402907" author="ralf@michl.name" created="Thu, 6 Feb 2003 22:39:50 +0000"  >&lt;ul&gt;
	&lt;li&gt;
	&lt;ul&gt;
		&lt;li&gt;
		&lt;ul&gt;
			&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/DBCP-112&quot; title=&quot;Strange Result Set on output&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DBCP-112&quot;&gt;&lt;del&gt;COM-316&lt;/del&gt;&lt;/a&gt; has been marked as a duplicate of this bug. ***&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12332015" name="ASF.LICENSE.NOT.GRANTED--diff.txt" size="3175" author="funkman@joedog.org" created="Tue, 17 Sep 2002 18:58:08 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>12733</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114356</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            22 years, 40 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uwlb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178421</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-72] CPDSConnectionFactory prints invalid error messages</title>
                <link>https://issues.apache.org/jira/browse/DBCP-72</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;KeyedCPDSConnectionFactory and CPDSConnectionFactory should not print error &lt;br/&gt;
message &quot;CLOSING DOWN CONNECTION DUE TO INTERNAL ERROR&quot;&lt;br/&gt;
in connectionErrorOccurred(ConnectionEvent event)&lt;br/&gt;
if event.getSQLException == null&lt;br/&gt;
because this event gets fired when physical connection gets closed normal way&lt;/p&gt;

&lt;p&gt;from ConnectionEventListener API DOCS:&lt;/p&gt;

&lt;p&gt;The ConnectionEventListener interface is implemented by a connection pooling &lt;br/&gt;
component. A connection pooling component will usually be provided by a JDBC &lt;br/&gt;
driver vendor or another system software vendor. A JDBC driver notifies a &lt;br/&gt;
ConnectionEventListener object when an application is finished using a pooled &lt;br/&gt;
connection with which the listener has registered. The notification occurs &lt;br/&gt;
after the application calls the method close on its representation of a &lt;br/&gt;
PooledConnection object. A ConnectionEventListener is also notified when a &lt;br/&gt;
connection error occurs due to the fact that the PooledConnection is unfit for &lt;br/&gt;
future use---the server has crashed, for example. The listener is notified by &lt;br/&gt;
the JDBC driver just before the driver throws an SQLException to the &lt;br/&gt;
application using the PooledConnection object.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: other&lt;br/&gt;
Platform: Other&lt;/p&gt;</environment>
        <key id="12340342">DBCP-72</key>
            <summary>CPDSConnectionFactory prints invalid error messages</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="roytmana@peacetech.com">Alex Roytman</reporter>
                        <labels>
                    </labels>
                <created>Mon, 30 Sep 2002 13:46:29 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:30 +0000</updated>
                            <resolved>Tue, 25 Mar 2008 08:11:30 +0000</resolved>
                                    <version>Nightly Builds</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12403000" author="rwaldhof@us.britannica.com" created="Sat, 2 Nov 2002 00:04:44 +0000"  >&lt;p&gt;fixed in rev. 1.2 of &lt;span class=&quot;error&quot;&gt;&amp;#91;Keyed&amp;#93;&lt;/span&gt;CPDSConnectionFactory&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>13129</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114355</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            23 years, 2 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uwjr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178414</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-71] [dbcp] Docs inaccurately describe default value of testOnBorrow</title>
                <link>https://issues.apache.org/jira/browse/DBCP-71</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;On the page &lt;a href=&quot;http://jakarta.apache.org/commons/dbcp/configuration.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://jakarta.apache.org/commons/dbcp/configuration.html&lt;/a&gt;, the &lt;br/&gt;
Default column for the testOnBorrow parameter says that testOnBorrow is set by &lt;br/&gt;
default to &quot;true&quot;. I observe from the behaviour of my application that this &lt;br/&gt;
seems to be true only if validationQuery is not set to null. Further, I find &lt;br/&gt;
this code in the BasicDataSource.java file, createDataSource method:&lt;br/&gt;
        // Can&apos;t test without a validationQuery&lt;br/&gt;
        if (validationQuery == null) &lt;/p&gt;
{
            setTestOnBorrow(false);
            setTestOnReturn(false);
            setTestWhileIdle(false);
        }

&lt;p&gt;Users may think that DBCP uses a default validationQuery such as &quot;SELECT 1&quot; if &lt;br/&gt;
you don&apos;t set one up explicitly, and that therefore setting testOnBorrow &lt;br/&gt;
without setting validationQuery is legitimate. This is what I naively thought -&lt;br/&gt;
 although on reflection I can see why you don&apos;t, for reasons of portability.&lt;/p&gt;

&lt;p&gt;It would be very helpful if the documentation explained this, with text like &lt;br/&gt;
this:&lt;br/&gt;
&quot;The testOnBorrow, testOnReturn, and testWhileIdle parameters are defaulted to &lt;br/&gt;
true if and only if you supply a non-null value for the validationQuery &lt;br/&gt;
parameter.&quot;&lt;/p&gt;

&lt;p&gt;It would be even more helpful if BasicDataSource noticed that testOnBorrow was &lt;br/&gt;
set to true without a valid validationQuery setting, and logged something like&lt;br/&gt;
&quot;Disabling testOnBorrow, testOnReturn, and testWhileIdle because no &lt;br/&gt;
valiationQuery was supplied. To enable these settings you must also supply a &lt;br/&gt;
validationQuery, typically a very simple query like &apos;SELECT 1&apos;&quot;.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: other&lt;br/&gt;
Platform: Other&lt;/p&gt;</environment>
        <key id="12342573">DBCP-71</key>
            <summary>[dbcp] Docs inaccurately describe default value of testOnBorrow</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="douglas.squirrel@youdevise.com">Douglas Squirrel</reporter>
                        <labels>
                    </labels>
                <created>Sat, 24 Sep 2005 22:42:10 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:30 +0000</updated>
                            <resolved>Tue, 25 Mar 2008 08:11:30 +0000</resolved>
                                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12410450" author="douglas.squirrel@youdevise.com" created="Sat, 24 Sep 2005 22:46:38 +0000"  >&lt;p&gt;I just realised that my suggested text was wrong on two fronts:&lt;br/&gt;
1. testOnReturn and testWhileIdle are not set by default.&lt;br/&gt;
2. Even if you explicitly set any of these three parameters, they will be &lt;br/&gt;
ignored if you don&apos;t also set a validationQuery.&lt;/p&gt;

&lt;p&gt;So I would suggest adding this text to each of the three parameters instead, &lt;br/&gt;
preferably with bold type or a bright colour:&lt;br/&gt;
&quot;NOTE: This parameter will be ignored if validationQuery is not set to a non-&lt;br/&gt;
null string.&quot;&lt;/p&gt;</comment>
                            <comment id="12410451" author="phil@steitz.com" created="Mon, 13 Mar 2006 13:14:45 +0000"  >&lt;p&gt;Site docs and method javadocs have been updated to clarify this issue.  Thanks!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>36799</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114354</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            19 years, 35 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uxi7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178569</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-70] PATCH: Oracle 9i and default isolation settings</title>
                <link>https://issues.apache.org/jira/browse/DBCP-70</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;When using default isolation levels in ctor of PoolableConnectionFactory method&lt;br/&gt;
activateObject first sets readonly, then isolation. The problem is Oracle&lt;br/&gt;
expects the setting of the isolation level to be the first in a transaction. The&lt;br/&gt;
obvious fix, that worked for me would be to revese order, i.e. &lt;br/&gt;
first set isolation then readonly. I will attach a patch for this.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: other&lt;br/&gt;
Platform: All&lt;/p&gt;</environment>
        <key id="12341124">DBCP-70</key>
            <summary>PATCH: Oracle 9i and default isolation settings</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="ozeigermann@c1-fse.de">Oliver Zeigermann</reporter>
                        <labels>
                    </labels>
                <created>Wed, 26 Nov 2003 16:08:04 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:30 +0000</updated>
                            <resolved>Tue, 25 Mar 2008 08:11:30 +0000</resolved>
                                    <version>1.1</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12405553" author="ozeigermann@c1-fse.de" created="Wed, 26 Nov 2003 16:10:20 +0000"  >&lt;p&gt;Created an attachment (id=9289)&lt;br/&gt;
Obvious patch reversing order of statements on connection&lt;/p&gt;</comment>
                            <comment id="12405554" author="dirkv" created="Mon, 1 Dec 2003 03:01:57 +0000"  >&lt;p&gt;patch applied&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12332636" name="ASF.LICENSE.NOT.GRANTED--patch" size="982" author="ozeigermann@c1-fse.de" created="Wed, 26 Nov 2003 16:10:20 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>25001</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114353</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            21 years, 50 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uwsv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178455</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-69] DBCP connection pooling broken in Tomcat-4.1.7 (regression)</title>
                <link>https://issues.apache.org/jira/browse/DBCP-69</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;I used DBCP connection pooling in Tomcat-4.1.3 and everything worked as &lt;br/&gt;
expected.  I tried upgrading to Tomcat-4.1.7 and pooling no longer works.  &lt;/p&gt;

&lt;p&gt;I have found a workaround for this.  Copying the commons-dbcp.jar from &lt;br/&gt;
Tomcat-4.1.3 to Tomcat-4.1.7 replacing the existing jar file makes everything &lt;br/&gt;
work just fine.&lt;/p&gt;

&lt;p&gt;Below is the stacktrace that I get when using the commons-dbcp.jar that comes &lt;br/&gt;
with Tomcat-4.1.7:&lt;/p&gt;


&lt;p&gt;java.sql.SQLException: Closed Statement&lt;br/&gt;
	at oracle.jdbc.dbaccess.DBError.throwSqlException(DBError.java:168)&lt;br/&gt;
	at oracle.jdbc.dbaccess.DBError.throwSqlException(DBError.java:210)&lt;br/&gt;
	at oracle.jdbc.dbaccess.DBError.throwSqlException(DBError.java:273)&lt;br/&gt;
	at oracle.jdbc.driver.OracleStatement.get_column_index&lt;br/&gt;
(OracleStatement.java:4372)&lt;br/&gt;
	at oracle.jdbc.driver.OracleResultSetImpl.findColumn&lt;br/&gt;
(OracleResultSetImpl.java:667)&lt;br/&gt;
	at oracle.jdbc.driver.OracleResultSet.getTimestamp&lt;br/&gt;
(OracleResultSet.java:1517)&lt;br/&gt;
	at org.apache.commons.dbcp.DelegatingResultSet.getTimestamp&lt;br/&gt;
(DelegatingResultSet.java:165)&lt;br/&gt;
	at com.syntegra.unilever.tasklist.data.Site.fromResults(Site.java:24)&lt;br/&gt;
	at com.syntegra.unilever.tasklist.data.SiteManager.getSites&lt;br/&gt;
(SiteManager.java:108)&lt;br/&gt;
	at com.syntegra.unilever.tasklist.data.SiteManager.getSites&lt;br/&gt;
(SiteManager.java:73)&lt;br/&gt;
	at &lt;br/&gt;
com.syntegra.unilever.tasklist.pres.SearchSiteData$SearchSiteDataModel.preIterat&lt;br/&gt;
e(SearchSiteData.java:146)&lt;br/&gt;
	at org.enhydra.barracuda.core.comp.renderer.TemplateHelper.getNode&lt;br/&gt;
(TemplateHelper.java:516)&lt;br/&gt;
	at &lt;br/&gt;
org.enhydra.barracuda.core.comp.renderer.TemplateHelper.copyChildNodes&lt;br/&gt;
(TemplateHelper.java:121)&lt;br/&gt;
	at org.enhydra.barracuda.core.comp.renderer.TemplateHelper.getNode&lt;br/&gt;
(TemplateHelper.java:579)&lt;br/&gt;
	at &lt;br/&gt;
org.enhydra.barracuda.core.comp.renderer.TemplateHelper.copyChildNodes&lt;br/&gt;
(TemplateHelper.java:121)&lt;br/&gt;
	at org.enhydra.barracuda.core.comp.renderer.TemplateHelper.getNode&lt;br/&gt;
(TemplateHelper.java:579)&lt;br/&gt;
	at &lt;br/&gt;
org.enhydra.barracuda.core.comp.renderer.TemplateHelper.copyChildNodes&lt;br/&gt;
(TemplateHelper.java:121)&lt;br/&gt;
	at org.enhydra.barracuda.core.comp.renderer.TemplateHelper.getNode&lt;br/&gt;
(TemplateHelper.java:579)&lt;br/&gt;
	at &lt;br/&gt;
org.enhydra.barracuda.core.comp.renderer.TemplateHelper.copyChildNodes&lt;br/&gt;
(TemplateHelper.java:121)&lt;br/&gt;
	at org.enhydra.barracuda.core.comp.renderer.TemplateHelper.getNode&lt;br/&gt;
(TemplateHelper.java:579)&lt;br/&gt;
	at &lt;br/&gt;
org.enhydra.barracuda.core.comp.renderer.TemplateHelper.copyChildNodes&lt;br/&gt;
(TemplateHelper.java:121)&lt;br/&gt;
	at org.enhydra.barracuda.core.comp.renderer.TemplateHelper.getNode&lt;br/&gt;
(TemplateHelper.java:579)&lt;br/&gt;
	at &lt;br/&gt;
org.enhydra.barracuda.core.comp.renderer.TemplateHelper.copyChildNodes&lt;br/&gt;
(TemplateHelper.java:121)&lt;br/&gt;
	at org.enhydra.barracuda.core.comp.renderer.TemplateHelper.render&lt;br/&gt;
(TemplateHelper.java:102)&lt;br/&gt;
	at &lt;br/&gt;
org.enhydra.barracuda.core.comp.renderer.html.HTMLTemplateRenderer.renderCompone&lt;br/&gt;
nt(HTMLTemplateRenderer.java:113)&lt;br/&gt;
	at org.enhydra.barracuda.core.comp.BComponent.renderView&lt;br/&gt;
(BComponent.java:547)&lt;br/&gt;
	at org.enhydra.barracuda.core.comp.BComponent.render&lt;br/&gt;
(BComponent.java:442)&lt;br/&gt;
	at org.enhydra.barracuda.core.comp.BComponent.render&lt;br/&gt;
(BComponent.java:460)&lt;br/&gt;
	at org.enhydra.barracuda.core.comp.BComponent.render&lt;br/&gt;
(BComponent.java:388)&lt;br/&gt;
	at &lt;br/&gt;
com.syntegra.unilever.tasklist.UTaskListEventGateway$RenderUTaskListHandler.hand&lt;br/&gt;
leViewEvent(UTaskListEventGateway.java:168)&lt;br/&gt;
	at org.enhydra.barracuda.core.event.DefaultBaseEventListener.handleEvent&lt;br/&gt;
(DefaultBaseEventListener.java:66)&lt;br/&gt;
	at &lt;br/&gt;
org.enhydra.barracuda.core.event.DefaultEventDispatcher.notifyListeners&lt;br/&gt;
(DefaultEventDispatcher.java:381)&lt;br/&gt;
	at org.enhydra.barracuda.core.event.DefaultEventDispatcher.dispatch&lt;br/&gt;
(DefaultEventDispatcher.java:183)&lt;br/&gt;
	at org.enhydra.barracuda.core.event.DefaultEventDispatcher.dispatchEvent&lt;br/&gt;
(DefaultEventDispatcher.java:120)&lt;br/&gt;
	at org.enhydra.barracuda.core.event.DefaultEventBroker.dispatchEvent&lt;br/&gt;
(DefaultEventBroker.java:488)&lt;br/&gt;
	at org.enhydra.barracuda.core.event.ApplicationGateway.handleDefaultExt&lt;br/&gt;
(ApplicationGateway.java:413)&lt;br/&gt;
	at org.enhydra.barracuda.core.event.ApplicationGateway.handleDefault&lt;br/&gt;
(ApplicationGateway.java:239)&lt;br/&gt;
	at org.enhydra.barracuda.core.event.ApplicationGateway.doGet&lt;br/&gt;
(ApplicationGateway.java:632)&lt;br/&gt;
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:740)&lt;br/&gt;
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:853)&lt;br/&gt;
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter&lt;br/&gt;
(ApplicationFilterChain.java:247)&lt;br/&gt;
	at org.apache.catalina.core.ApplicationFilterChain.doFilter&lt;br/&gt;
(ApplicationFilterChain.java:193)&lt;br/&gt;
	at org.apache.catalina.core.StandardWrapperValve.invoke&lt;br/&gt;
(StandardWrapperValve.java:260)&lt;br/&gt;
	at &lt;br/&gt;
org.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNex&lt;br/&gt;
t(StandardPipeline.java:643)&lt;br/&gt;
	at org.apache.catalina.core.StandardPipeline.invoke&lt;br/&gt;
(StandardPipeline.java:480)&lt;br/&gt;
	at org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:995)&lt;br/&gt;
	at org.apache.catalina.core.StandardContextValve.invoke&lt;br/&gt;
(StandardContextValve.java:191)&lt;br/&gt;
	at &lt;br/&gt;
org.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNex&lt;br/&gt;
t(StandardPipeline.java:643)&lt;br/&gt;
	at org.apache.catalina.core.StandardPipeline.invoke&lt;br/&gt;
(StandardPipeline.java:480)&lt;br/&gt;
	at org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:995)&lt;br/&gt;
	at org.apache.catalina.core.StandardContext.invoke&lt;br/&gt;
(StandardContext.java:2350)&lt;br/&gt;
	at org.apache.catalina.core.StandardHostValve.invoke&lt;br/&gt;
(StandardHostValve.java:180)&lt;br/&gt;
	at &lt;br/&gt;
org.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNex&lt;br/&gt;
t(StandardPipeline.java:643)&lt;br/&gt;
	at org.apache.catalina.valves.ErrorDispatcherValve.invoke&lt;br/&gt;
(ErrorDispatcherValve.java:170)&lt;br/&gt;
	at &lt;br/&gt;
org.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNex&lt;br/&gt;
t(StandardPipeline.java:641)&lt;br/&gt;
	at org.apache.catalina.valves.ErrorReportValve.invoke&lt;br/&gt;
(ErrorReportValve.java:171)&lt;br/&gt;
	at &lt;br/&gt;
org.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNex&lt;br/&gt;
t(StandardPipeline.java:641)&lt;br/&gt;
	at org.apache.catalina.core.StandardPipeline.invoke&lt;br/&gt;
(StandardPipeline.java:480)&lt;br/&gt;
	at org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:995)&lt;br/&gt;
	at org.apache.catalina.core.StandardEngineValve.invoke&lt;br/&gt;
(StandardEngineValve.java:174)&lt;br/&gt;
	at &lt;br/&gt;
org.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNex&lt;br/&gt;
t(StandardPipeline.java:643)&lt;br/&gt;
	at org.apache.catalina.core.StandardPipeline.invoke&lt;br/&gt;
(StandardPipeline.java:480)&lt;br/&gt;
	at org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:995)&lt;br/&gt;
	at org.apache.ajp.tomcat4.Ajp13Processor.process&lt;br/&gt;
(Ajp13Processor.java:458)&lt;br/&gt;
	at org.apache.ajp.tomcat4.Ajp13Processor.run(Ajp13Processor.java:551)&lt;br/&gt;
	at java.lang.Thread.run(Thread.java:536)&lt;/p&gt;


&lt;p&gt;Since everything works with the commons-dbcp.jar from Tomcat-4.1.3, there must &lt;br/&gt;
have been something added to more recent versions on DBCP which caused a &lt;br/&gt;
regression.  I guess I will continue using the old version of DBCP until this &lt;br/&gt;
bug is fixed.&lt;/p&gt;

&lt;p&gt;Jake&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: other&lt;br/&gt;
Platform: Other&lt;/p&gt;</environment>
        <key id="12340257">DBCP-69</key>
            <summary>DBCP connection pooling broken in Tomcat-4.1.7 (regression)</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="hoju">Jacob Kjome</reporter>
                        <labels>
                    </labels>
                <created>Wed, 10 Jul 2002 04:29:39 +0000</created>
                <updated>Tue, 16 May 2006 11:28:00 +0000</updated>
                            <resolved>Tue, 16 May 2006 11:28:00 +0000</resolved>
                                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12402733" author="glenn@apache.org" created="Sun, 21 Jul 2002 03:40:28 +0000"  >&lt;p&gt;There was a bug found after 4.1.7 was released with Statement pooling that&lt;br/&gt;
is fixed.  You can use either a nightly build of dbcp or wait for Tomcat 4.1.8.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>10614</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114352</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            23 years, 17 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uwin:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178409</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-68] [dbcp] Commons Collection dependency version clash when using Commons DBCP via Maven2</title>
                <link>https://issues.apache.org/jira/browse/DBCP-68</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;When using Maven2 to incorporate Commons DBCP 1.2.1 into your project a&lt;br/&gt;
transient dependency on Commons Collections 2.1 is added. This will clash with&lt;br/&gt;
other Commons Components like Commons Configuration 1.2 for example that depend&lt;br/&gt;
on Commons Collections 3.1. Upon adding Commons DBCP 1.2.1 to your project the&lt;br/&gt;
existing transient dependency on Commons Collections 3.1 gets changed into&lt;br/&gt;
Commons Collections 2.1. This will result in runtime errors like the following:&lt;/p&gt;

&lt;p&gt;java.lang.NoClassDefFoundError: org/apache/commons/collections/map/LinkedMap&lt;br/&gt;
	at&lt;br/&gt;
org.apache.commons.configuration.BaseConfiguration.&amp;lt;init&amp;gt;(BaseConfiguration.java:53)&lt;/p&gt;

&lt;p&gt;Since Commons Collections is incorporated into most Commons Components please&lt;br/&gt;
update the dependency within Commons DBCP to Commons Collections 3.1 if possible.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: All&lt;br/&gt;
Platform: All&lt;/p&gt;</environment>
        <key id="12343065">DBCP-68</key>
            <summary>[dbcp] Commons Collection dependency version clash when using Commons DBCP via Maven2</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="cenowa@makdata.de">Christoph Cenowa</reporter>
                        <labels>
                    </labels>
                <created>Sun, 7 May 2006 01:54:35 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:30 +0000</updated>
                            <resolved>Wed, 4 Apr 2007 03:35:33 +0000</resolved>
                                    <version>1.2</version>
                                    <fixVersion>1.2.2</fixVersion>
                                        <due></due>
                            <votes>1</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12411843" author="bayard" created="Mon, 8 May 2006 02:31:13 +0000"  >&lt;p&gt;There&apos;s a DBCP release in the planning, so I imagine this will be very easy to integrate into that.&lt;/p&gt;

&lt;p&gt;I believe you can override such things in Maven2 in the meantime &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/help_16.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;.&lt;/p&gt;</comment>
                            <comment id="12411844" author="bayard" created="Mon, 8 May 2006 03:15:18 +0000"  >&lt;p&gt;svn ci -m &quot;Updating to Collections 3.1 as suggested in #39502&quot; project.xml &lt;br/&gt;
Sending        project.xml&lt;br/&gt;
Transmitting file data .&lt;br/&gt;
Committed revision 404836.  &lt;/p&gt;

&lt;p&gt;Not marking as fixed though as this bug is not fixed until a release is done (into maven repository).&lt;/p&gt;</comment>
                            <comment id="12435269" author="psteitz" created="Sat, 16 Sep 2006 20:12:55 +0000"  >&lt;p&gt;Updating to collections 3.1 may cause dependency problems for some users.  Per discussion on commons-dev, I would prefer to bundle the required classes in their 2.1 versions.  There are two classes required - o.a.c.collections.LRUMap and o.a.c.collections.SequencedHashMap and only one dbcp class that depends on them - o.a.c.dbcp.datasources.SharedPoolDataSource.   The collections classes have been deprecated, but still exist, in Collections 3.x.  I propose that we take the versions from the collections 2.1 source and include them with package scope in o.a.c.dbcp.datasources, then remove collections dependency altogether.&lt;/p&gt;</comment>
                            <comment id="12435302" author="scolebourne" created="Sun, 17 Sep 2006 10:28:38 +0000"  >&lt;p&gt;Upgrading to a later version of collections shouldn&apos;t prove to be a problem. But, I agree with the proposed solution of removng the dependency in this case. Just ensure that neither class being copied is in the public API at the moment, or in the future.&lt;/p&gt;</comment>
                            <comment id="12437159" author="psteitz" created="Sat, 23 Sep 2006 22:25:19 +0000"  >&lt;p&gt;Sources have been added and dependency removed in r449319.  Waiting to resolve until 1.2.2 release is cut.&lt;/p&gt;</comment>
                            <comment id="12486558" author="psteitz" created="Wed, 4 Apr 2007 03:35:33 +0000"  >&lt;p&gt;1.2.2 has (at last) been released.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>39502</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114351</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            18 years, 32 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uvlr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178261</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-67] No compile under J2SDK 1.3</title>
                <link>https://issues.apache.org/jira/browse/DBCP-67</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;Hi:&lt;/p&gt;

&lt;p&gt;I tried to compile the sources using J2SDK 1.3.1 and it does not work. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/sad.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;In the sources the commons DBCP is using a class (java.sql.SavePoint) released&lt;br/&gt;
in 1.4:&lt;/p&gt;

&lt;p&gt;java:compile:&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;echo&amp;#93;&lt;/span&gt; Compiling to /commons-dbcp-1.2/target/classes&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;javac&amp;#93;&lt;/span&gt; Compiling 39 source files to /commons-dbcp-1.2/target/classes&lt;br/&gt;
/commons-dbcp-1.2/src/java/org/apache/commons/dbcp/cpdsadapter/ConnectionImpl.java:387:&lt;br/&gt;
cannot resolve symbol&lt;br/&gt;
symbol  : class Savepoint&lt;br/&gt;
location: package sql&lt;br/&gt;
    public java.sql.Savepoint setSavepoint() throws SQLException {&lt;br/&gt;
                   ^&lt;/p&gt;

&lt;p&gt;Looking in the javadocs of java 1.3 I cannot found this class and in Java API&lt;br/&gt;
docs 1.4.2 show that it was introduced since 1.4:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://java.sun.com/j2se/1.4.2/docs/api/java/sql/Savepoint.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://java.sun.com/j2se/1.4.2/docs/api/java/sql/Savepoint.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;No where in the documentation of DBCP defines the minimum java version to be&lt;br/&gt;
used. But since there is JDBC 2.0 I thought java 1.3 can compile the sources.&lt;/p&gt;

&lt;p&gt;I see a problem when some packages as Apache OJB using java 1.3 as the minimum&lt;br/&gt;
version will use it.&lt;/p&gt;

&lt;p&gt;BTW, commons-pool can be compiled with java 1.3&lt;/p&gt;

&lt;p&gt;Please at least update the commons-dbcp site with the minimum java version to be&lt;br/&gt;
used.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: other&lt;br/&gt;
Platform: All&lt;/p&gt;</environment>
        <key id="12341499">DBCP-67</key>
            <summary>No compile under J2SDK 1.3</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="agallardo@agsoftware.dnsalias.com">Antonio Gallardo</reporter>
                        <labels>
                    </labels>
                <created>Wed, 9 Jun 2004 11:22:30 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:30 +0000</updated>
                            <resolved>Tue, 25 Mar 2008 08:11:30 +0000</resolved>
                                    <version>1.2</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12406789" author="dirkv" created="Thu, 10 Jun 2004 01:38:56 +0000"  >&lt;p&gt;Normally you should be able to build using ant.&lt;br/&gt;
The ant build script comments out the non-JDBC3 methods.&lt;/p&gt;

&lt;p&gt;Attached you will find a patch to replace the Boolean.valueOf(boolean) method.&lt;br/&gt;
This JDK1.4 method was used by mistake but can be easily removed.&lt;/p&gt;</comment>
                            <comment id="12406790" author="dirkv" created="Thu, 10 Jun 2004 01:39:36 +0000"  >&lt;p&gt;Created an attachment (id=11805)&lt;br/&gt;
issue29454.patch&lt;/p&gt;</comment>
                            <comment id="12406791" author="agallardo@agsoftware.dnsalias.com" created="Thu, 10 Jun 2004 13:27:10 +0000"  >&lt;p&gt;Perhaps I don&apos;t explain myself good enough. I mean:&lt;/p&gt;

&lt;p&gt;How to build the library that will run on java 1.3 and 1.4. and use JDBC 2.0 or&lt;br/&gt;
3.0 for general use?&lt;/p&gt;

&lt;p&gt;For example if we will distribute the lib in a package as OJB or Cocoon?&lt;/p&gt;

&lt;p&gt;AFAIK, there is a common limitation in some javac versions of 1.4 that cannot&lt;br/&gt;
run on java 1.3&lt;/p&gt;

&lt;p&gt;The key is to avoid using API introduced since version 1.4 And seems this is not&lt;br/&gt;
the case since you are providing a patch for that.&lt;/p&gt;

&lt;p&gt;Limiting a build just to JDBC 2.0 is just a workaround and not a solution from&lt;br/&gt;
my POV.&lt;/p&gt;

&lt;p&gt;Anyway, if you think the bug is resolved and fixed, it is ok. I was just trying&lt;br/&gt;
to point to a problem. I use J2SDK 1.4, the cencerns was just for back&lt;br/&gt;
compatibility.&lt;/p&gt;</comment>
                            <comment id="12406792" author="analogue" created="Fri, 11 Jun 2004 02:31:03 +0000"  >&lt;p&gt;Well I downloaded the latest dbcp 1.2 hoping the PoolingDriver.closePool()&lt;br/&gt;
method would fix some resource problems we&apos;re having. Heres are short recap..&lt;/p&gt;

&lt;p&gt;1. Download commons-dbcp-1.2&lt;br/&gt;
2. Download commons-pool-1.2&lt;br/&gt;
3. Run my unit test that makes used of dbcp...whoops. Boolean.valueOf() not&lt;br/&gt;
   defined in JDK 1.3&lt;br/&gt;
4. Gotta find out if dbcp-1.2 requirements changed. &lt;br/&gt;
   Check the website..nope&lt;br/&gt;
   Check the release notes...nope&lt;br/&gt;
   Check the javadocs...nope&lt;br/&gt;
   Check the wiki...look what we have here, a reference to this bug.&lt;br/&gt;
5. Fair enough download dbcp-1.2 source&lt;br/&gt;
6. Apply patch&lt;br/&gt;
7. Build using &apos;maven dist&apos;. Blows up:&lt;/p&gt;

&lt;p&gt;Attempting to download jdbc-2.0.jar.&lt;br/&gt;
Getting URL: &lt;a href=&quot;http://www.ibiblio.org/maven/jdbc/jars/jdbc-2.0.jar&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.ibiblio.org/maven/jdbc/jars/jdbc-2.0.jar&lt;/a&gt;&lt;br/&gt;
File not found on one of the repos&lt;br/&gt;
java.io.FileNotFoundException:&lt;br/&gt;
&lt;a href=&quot;http://www.ibiblio.org/maven/jdbc/jars/jdbc-2.0.jar&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.ibiblio.org/maven/jdbc/jars/jdbc-2.0.jar&lt;/a&gt; (HTTP Error: 404 Not Found)&lt;br/&gt;
        at org.apache.maven.util.HttpUtils.getFile(HttpUtils.java:259)&lt;br/&gt;
        at org.apache.maven.util.HttpUtils.getFile(HttpUtils.java:180)&lt;br/&gt;
        at org.apache.maven.util.HttpUtils.getFile(HttpUtils.java:111)&lt;br/&gt;
        at&lt;br/&gt;
org.apache.maven.verifier.DependencyVerifier.getRemoteArtifact(DependencyVerifier.java:314)&lt;br/&gt;
        at&lt;br/&gt;
org.apache.maven.verifier.DependencyVerifier.getDependencies(DependencyVerifier.java:253)&lt;br/&gt;
        at&lt;br/&gt;
org.apache.maven.verifier.DependencyVerifier.satisfyDependencies(DependencyVerifier.java:170)&lt;br/&gt;
        at&lt;br/&gt;
org.apache.maven.verifier.DependencyVerifier.verify(DependencyVerifier.java:96)&lt;br/&gt;
        at org.apache.maven.project.Project.verifyDependencies(Project.java:1356)&lt;br/&gt;
        at org.apache.maven.plugin.PluginManager.attainGoals(PluginManager.java:486)&lt;br/&gt;
        at org.apache.maven.MavenSession.attainGoals(MavenSession.java:266)&lt;br/&gt;
        at org.apache.maven.cli.App.doMain(App.java:485)&lt;br/&gt;
        at org.apache.maven.cli.App.main(App.java:1214)&lt;br/&gt;
        at java.lang.reflect.Method.invoke(Native Method)&lt;br/&gt;
        at com.werken.forehead.Forehead.run(Forehead.java:551)&lt;br/&gt;
        at com.werken.forehead.Forehead.main(Forehead.java:581)&lt;/p&gt;

&lt;p&gt;8. Sure enough, I http it on over to &lt;a href=&quot;http://www.ibiblio.org/maven/jdbc/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.ibiblio.org/maven/jdbc/&lt;/a&gt; and&lt;br/&gt;
   theres not a jar in sight.&lt;br/&gt;
9. Ok, lets try this ant thing. Kalbam..no luck. Dependent jars don&apos;t ship with&lt;br/&gt;
   the product. &lt;/p&gt;

&lt;p&gt;What sounds easier? Backing out 8 lines of code to maintain 1.3 compatibility or&lt;br/&gt;
making every single one of your unsuspecting JDK 1.3 users go through this &lt;br/&gt;
dead end process when they think they&apos;re in for an innocent 0.1 upgrade of&lt;br/&gt;
an otherwise very useful library.&lt;/p&gt;

&lt;p&gt;Otherwise, job well done! &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;Now..time to use a little maven.jar.override...&lt;/p&gt;</comment>
                            <comment id="12406793" author="dirkv" created="Fri, 11 Jun 2004 13:21:31 +0000"  >&lt;p&gt;jdbc-2.0.jar cannot be made available because of the redistribution restrictions&lt;br/&gt;
of sun. You have to download the library directly from the sun website.&lt;/p&gt;

&lt;p&gt;This issue is fixed, this means the fix has been accepted into CVS.&lt;br/&gt;
You can use a nightly build to test the fix. (see download page for url)&lt;br/&gt;
DBCP 1.2.1 will be release shortly to restore JVM 1.3 compatibility.&lt;/p&gt;

&lt;p&gt;By the way, if you want to help prevent these kind of issues, beta testers are&lt;br/&gt;
always welcome. There is always a test period (the first call to test DBCP 1.2&lt;br/&gt;
was made on 17 may). &lt;br/&gt;
Also documentation/website updates (and other contributions) are also&lt;br/&gt;
appreciated &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12332943" name="ASF.LICENSE.NOT.GRANTED--issue29454.patch" size="1704" author="dirkv" created="Thu, 10 Jun 2004 01:39:36 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>29454</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114350</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            21 years, 22 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uxkn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178580</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-66] [dbcp] setReadOnly always being called</title>
                <link>https://issues.apache.org/jira/browse/DBCP-66</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;Using Hibernate, DBCP and Sybase I am getting the following warning from Hibernate:&lt;/p&gt;

&lt;p&gt;   010SK: Database cannot set connection option SET_READONLY_FALSE&lt;/p&gt;

&lt;p&gt; This is because DBCP&apos;s PoolableConnectionFactory.activateObject(..) method is&lt;br/&gt;
calling &apos;setReadOnly&apos; on the Connection and the database does not support it.&lt;br/&gt;
Hibernate spots the warning and logs it.&lt;/p&gt;

&lt;p&gt; There is a guard in the &apos;activateObject&apos; method to only call setReadOnly if&lt;br/&gt;
&apos;_defaultReadOnly&apos; is not null. All the constructors of&lt;br/&gt;
PoolableConnectionFactory set &apos;_defaultReadOnly&apos; to a &apos;boolean&apos; so it will never&lt;br/&gt;
be null.&lt;/p&gt;

&lt;p&gt; This goes against what the docs&lt;br/&gt;
(&lt;a href=&quot;http://jakarta.apache.org/commons/dbcp/configuration.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://jakarta.apache.org/commons/dbcp/configuration.html&lt;/a&gt;) say about the&lt;br/&gt;
defaultReadOnly config parameter:  &quot;If not set then the setReadOnly method will&lt;br/&gt;
not be called&quot;.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: All&lt;br/&gt;
Platform: All&lt;/p&gt;</environment>
        <key id="12341989">DBCP-66</key>
            <summary>[dbcp] setReadOnly always being called</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="4">Incomplete</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="graham@darkcoding.net">Graham King</reporter>
                        <labels>
                    </labels>
                <created>Sun, 9 Jan 2005 02:42:19 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:30 +0000</updated>
                            <resolved>Tue, 25 Mar 2008 08:11:30 +0000</resolved>
                                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12408531" author="dirkv" created="Mon, 10 Jan 2005 06:58:03 +0000"  >&lt;p&gt;In the 1.2 dbcp release a constructor was made available with&lt;br/&gt;
&quot;Boolean defaultReadOnly&quot; so it is possible to set it to &quot;null&quot;.&lt;br/&gt;
&lt;a href=&quot;http://jakarta.apache.org/commons/dbcp/xref/org/apache/commons/dbcp/PoolableConnectionFactory.html#192&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://jakarta.apache.org/commons/dbcp/xref/org/apache/commons/dbcp/PoolableConnectionFactory.html#192&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;See also commons-dev mailing list archives for more about Hibernate integration&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>33014</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114349</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            20 years, 44 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0v0j3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>179059</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-65] [dbcp] Deadlock when evicting dbcp objects (testWhileIdle=true)</title>
                <link>https://issues.apache.org/jira/browse/DBCP-65</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;The GenericKeyedObjectPool$Evictor thread has probability of deadlock with dbcp&lt;br/&gt;
objects.&lt;/p&gt;

&lt;p&gt;For example, at a certain time, a normal user thread calls a PoolingConnection&lt;br/&gt;
object&apos;s synchronized method, which in turn calls GenericKeyedObjectPool&lt;br/&gt;
object&apos;s synchronzied method.&lt;/p&gt;

&lt;p&gt;At the same time, the evictor thread calls the GenericKeyedObjectPool object&apos;s&lt;br/&gt;
synchronized method &apos;evict&apos;, which in turn calls the PoolingConnection object&apos;s&lt;br/&gt;
synchronized method.  When testWhileIdle=true, the probability of evictor&lt;br/&gt;
calling GenericKeyedObjectPool&apos;s synchronized method is much greater.&lt;/p&gt;

&lt;p&gt;The following is the deadlock information in the thread dump of our program&lt;br/&gt;
(testWhileIdle=true):&lt;/p&gt;

&lt;p&gt;&quot;Thread-106&quot;:&lt;br/&gt;
	at org.apache.commons.dbcp.AbandonedTrace.removeTrace(AbandonedTrace.java:221)&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;waiting to lock &amp;lt;0x6a6b1b80&amp;gt; (a org.apache.commons.dbcp.PoolingConnection)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.commons.dbcp.PoolablePreparedStatement.passivate(PoolablePreparedStatement.java:100)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.commons.dbcp.PoolingConnection.passivateObject(PoolingConnection.java:239)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.commons.pool.impl.GenericKeyedObjectPool.evict(GenericKeyedObjectPool.java:1001)&lt;/li&gt;
	&lt;li&gt;locked &amp;lt;0x6a6b1858&amp;gt; (a org.apache.commons.pool.impl.GenericKeyedObjectPool)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.commons.pool.impl.GenericKeyedObjectPool$Evictor.run(GenericKeyedObjectPool.java:1156)&lt;br/&gt;
	at java.lang.Thread.run(Thread.java:534)&lt;br/&gt;
&quot;Thread-41&quot;:&lt;br/&gt;
	at&lt;br/&gt;
org.apache.commons.pool.impl.GenericKeyedObjectPool.borrowObject(GenericKeyedObjectPool.java:715)&lt;/li&gt;
	&lt;li&gt;waiting to lock &amp;lt;0x6a6b1858&amp;gt; (a&lt;br/&gt;
org.apache.commons.pool.impl.GenericKeyedObjectPool)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.commons.dbcp.PoolingConnection.prepareStatement(PoolingConnection.java:87)&lt;/li&gt;
	&lt;li&gt;locked &amp;lt;0x6a6b1b80&amp;gt; (a org.apache.commons.dbcp.PoolingConnection)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.commons.dbcp.DelegatingConnection.prepareStatement(DelegatingConnection.java:185)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.commons.dbcp.PoolingDataSource$PoolGuardConnectionWrapper.prepareStatement(PoolingDataSource.java:278)&lt;br/&gt;
...&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;This problem can be worked around by setting testWhileIdle to false, although&lt;br/&gt;
there is still very small possibility of deadlock.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: All&lt;br/&gt;
Platform: All&lt;/p&gt;</environment>
        <key id="12342202">DBCP-65</key>
            <summary>[dbcp] Deadlock when evicting dbcp objects (testWhileIdle=true)</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="phnixwxz1@yahoo.com">Wang Xianzhu</reporter>
                        <labels>
                    </labels>
                <created>Wed, 20 Apr 2005 19:01:49 +0000</created>
                <updated>Fri, 29 Jan 2010 21:43:03 +0000</updated>
                            <resolved>Mon, 22 Jan 2007 04:47:31 +0000</resolved>
                                                    <fixVersion>1.2.2</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="12409180" author="sandymac@apache.org" created="Sat, 11 Feb 2006 07:23:26 +0000"  >&lt;p&gt;Looking at GenericKeyedObjectPool.Evictor and PoolingConnection I think this is&lt;br/&gt;
a problem with PoolingConnection because it is both a client for&lt;br/&gt;
GenericKeyedObjectPool and passes an instance of itself as the&lt;br/&gt;
KeyedPoolableObjectFactory for GenericKeyedObjectPool.&lt;/p&gt;

&lt;p&gt;I&apos;m not sure GenericKeyedObjectPool can be changed and remain thread safe to fix&lt;br/&gt;
this situation. I think PoolingConnection needs to be changed so it aquires&lt;br/&gt;
synchronization lock in the order of the GenericKeyedObjectPool instance first&lt;br/&gt;
and then itself.&lt;/p&gt;

&lt;p&gt;Does an apache dev agree with me and want to punt this off to Dbcp?&lt;/p&gt;</comment>
                            <comment id="12409181" author="sandymac@apache.org" created="Mon, 13 Feb 2006 05:10:34 +0000"  >&lt;p&gt;After sleeping on it I&apos;m convinced this is a DBCP problem.&lt;/p&gt;

&lt;p&gt;DBCP needs to be careful about syncronization on it KeyedPoolableObjectFactory&lt;br/&gt;
implementations. Specificly it needs to pay attention to the fact that the&lt;br/&gt;
ObjectPool&apos;s evictor aquires the sync lock for the ObjectPool first and then may&lt;br/&gt;
call the following methods in KeyedPoolableObjectFactory: activateObject,&lt;br/&gt;
validateObject, and passivateObject. I&apos;m not familiar with DBCP else I&apos;d try to&lt;br/&gt;
be  more specific.&lt;/p&gt;</comment>
                            <comment id="12451188" author="psteitz" created="Sun, 19 Nov 2006 22:06:39 +0000"  >&lt;p&gt;I cannot find a backward compatible way to fix this. &lt;/p&gt;</comment>
                            <comment id="12451390" author="sandymac" created="Mon, 20 Nov 2006 18:47:28 +0000"  >&lt;p&gt;I think the only backward compatible way to fix this is to drop Pool as a dependency and pull GOP into DBCP and make it a DBCP specific implementations. This would be kinda funny since, as I understand it, Pool was birthed from DBCP long ago.&lt;/p&gt;

&lt;p&gt;The other choices would be to:&lt;/p&gt;

&lt;p&gt;1. Extend PoolableObjectFactory with a subinterface that provides hooks for the pool&apos;s eviction thread to acquire the needed locks before acquiring the internal pool locks. I think this would be very hard to do in the existing pool implementations in a backwards compatible way, but there is the new composite pool implementation that hasn&apos;t seen an official release and we could make this work with that in Pool 2.&lt;/p&gt;

&lt;p&gt;2. Simply make the DBCP config options that cause an eviction thread to be created be no-ops and provide a way to enable the erodingPool decorator that will be in Pool 2.&lt;/p&gt;

&lt;p&gt;3. Perform deep surgery on DBCP so it works with existing pool implementations but, as you said, this probably won&apos;t be backward compatible and I think it&apos;s a bit of the tail wagging the dog.&lt;/p&gt;

&lt;p&gt;I personally think #2 is the best choice but I&apos;ll work with you to make #1 happen. A lot of users think they need an evictor even though I maintain that is a risky way to use Pool and should be discouraged.&lt;/p&gt;</comment>
                            <comment id="12452488" author="psteitz" created="Fri, 24 Nov 2006 16:02:38 +0000"  >&lt;p&gt;I am +1 on option 2, or just migrate to Pool 2 when it is released.  Having spent many hours trying to find workarounds for this and &lt;a href=&quot;https://issues.apache.org/jira/browse/DBCP-44&quot; title=&quot;[dbcp] Evictor thread in GenericObjectPool has potential for deadlock&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DBCP-44&quot;&gt;&lt;del&gt;DBCP-44&lt;/del&gt;&lt;/a&gt; (trying to do things like 1 outside of &lt;span class=&quot;error&quot;&gt;&amp;#91;pool&amp;#93;&lt;/span&gt;, which is hopeless), I agree that the current evictor setup is a recipe for deadlocks and can&apos;t be fixed without changes to &lt;span class=&quot;error&quot;&gt;&amp;#91;pool&amp;#93;&lt;/span&gt; or &lt;span class=&quot;error&quot;&gt;&amp;#91;dbcp&amp;#93;&lt;/span&gt; config semantics.&lt;/p&gt;</comment>
                            <comment id="12460140" author="psteitz" created="Thu, 21 Dec 2006 04:49:51 +0000"  >&lt;p&gt;Unless someone can give a good reason that PoolingConnection&apos;s prepareStatement methods &lt;b&gt;must&lt;/b&gt; be synchronized, I am inclined to remove the synchronization from these methods.  That sounds radical, but observe that all we have in these methods is:q&lt;br/&gt;
try &lt;/p&gt;
{
            return(PreparedStatement)(_pstmtPool.borrowObject(createKey(sql)));
        }
&lt;p&gt; catch(NoSuchElementException e) &lt;/p&gt;
{
            throw new SQLNestedException(&quot;MaxOpenPreparedStatements limit reached&quot;, e); 
        }
&lt;p&gt; catch(RuntimeException e) &lt;/p&gt;
{
            throw e;
        }
&lt;p&gt; catch(Exception e) &lt;/p&gt;
{
            throw new SQLNestedException(&quot;Borrow prepareStatement from pool failed&quot;, e);
        }
&lt;p&gt;The borrowObject pool method is synchronized and the cause of the deadlocks here and in &lt;a href=&quot;https://issues.apache.org/jira/browse/DBCP-202&quot; title=&quot;Deadlock creating/closing PreparedStatement&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DBCP-202&quot;&gt;&lt;del&gt;DBCP-202&lt;/del&gt;&lt;/a&gt; is that these methods lock the PoolingConnection first and then the pool.   I thought first about changing the order explicitly by replacing the outer synchronization with &lt;br/&gt;
synchronized (_pstmtPool) {&lt;br/&gt;
  synchronized (this) {&lt;br/&gt;
   ...&lt;br/&gt;
to force consistent lock order, but then could not see any reason for the inner synch, and the other one is already there in the pool method.  &lt;br/&gt;
Can anyone see why these methods need to be synchronized on the PoolingConnection?   If this seems too high-risk, how about the explicit lock ordering above?&lt;br/&gt;
Removing or altering synchronization lock order should resolve &lt;a href=&quot;https://issues.apache.org/jira/browse/DBCP-202&quot; title=&quot;Deadlock creating/closing PreparedStatement&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DBCP-202&quot;&gt;&lt;del&gt;DBCP-202&lt;/del&gt;&lt;/a&gt; as well.&lt;/p&gt;</comment>
                            <comment id="12466387" author="psteitz" created="Mon, 22 Jan 2007 04:47:31 +0000"  >&lt;p&gt;Synchronization was removed from the perpareStatement methods per last comment in r498524.  &lt;/p&gt;</comment>
                            <comment id="12573586" author="drees" created="Fri, 29 Feb 2008 04:24:01 +0000"  >&lt;p&gt;This bug still exists in 1.2.2. I don&apos;t think that removing the prepareStatement synchronization helps, there is still a lock-race between the Evictor and returning objects to the pool for example.&lt;/p&gt;

&lt;p&gt;Here is a stack trace, I&apos;ve had this happen twice in the last week on two completely different applications (after using dbcp successfully without issue for years!):&lt;/p&gt;

&lt;p&gt;&quot;Timer-0&quot;:&lt;br/&gt;
at org.apache.commons.dbcp.AbandonedTrace.addTrace(AbandonedTrace.java:175)&lt;br/&gt;
waiting to lock &amp;lt;0x0000002aa04d4be8&amp;gt; (a org.apache.commons.dbcp.PoolableConnection)&lt;br/&gt;
at org.apache.commons.dbcp.AbandonedTrace.init(AbandonedTrace.java:92)&lt;br/&gt;
at org.apache.commons.dbcp.AbandonedTrace.&amp;lt;init&amp;gt;(AbandonedTrace.java:82)&lt;br/&gt;
at org.apache.commons.dbcp.DelegatingStatement.&amp;lt;init&amp;gt;(DelegatingStatement.java:61)&lt;br/&gt;
at org.apache.commons.dbcp.DelegatingConnection.createStatement(DelegatingConnection.java:224)&lt;br/&gt;
at org.apache.commons.dbcp.PoolableConnectionFactory.validateConnection(PoolableConnectionFactory.java:331)&lt;br/&gt;
at org.apache.commons.dbcp.PoolableConnectionFactory.validateObject(PoolableConnectionFactory.java:312)&lt;br/&gt;
at org.apache.commons.pool.impl.GenericObjectPool.evict(GenericObjectPool.java:1217)&lt;br/&gt;
locked &amp;lt;0x0000002a9ee91bf8&amp;gt; (a org.apache.commons.pool.impl.GenericObjectPool)&lt;br/&gt;
at org.apache.commons.pool.impl.GenericObjectPool$Evictor.run(GenericObjectPool.java:1341)&lt;br/&gt;
at java.util.TimerThread.mainLoop(Timer.java:512)&lt;br/&gt;
at java.util.TimerThread.run(Timer.java:462)&lt;br/&gt;
&quot;SocketRequest-8&quot;:&lt;br/&gt;
at org.apache.commons.pool.impl.GenericObjectPool.addObjectToPool(GenericObjectPool.java:1137)&lt;br/&gt;
waiting to lock &amp;lt;0x0000002a9ee91bf8&amp;gt; (a org.apache.commons.pool.impl.GenericObjectPool)&lt;br/&gt;
at org.apache.commons.pool.impl.GenericObjectPool.returnObject(GenericObjectPool.java:1076)&lt;br/&gt;
at org.apache.commons.dbcp.PoolableConnection.close(PoolableConnection.java:87)&lt;br/&gt;
locked &amp;lt;0x0000002aa04d4be8&amp;gt; (a org.apache.commons.dbcp.PoolableConnection)&lt;br/&gt;
at org.apache.commons.dbcp.PoolingDataSource$PoolGuardConnectionWrapper.close(PoolingDataSource.java:181)&lt;br/&gt;
at my.package.DbUtil.close(DbUtil.java:545)&lt;/p&gt;

&lt;p&gt;In this configuration, minIdle=0, maxIdle=4, maxActive=8, testWhileIdle=true timeBetweenEvictionRunsMillis=15000&lt;/p&gt;

&lt;p&gt;It appears that the only workaround for now to prevent this deadlock is to disable the Evictor thread by disabling testWhileIdle.&lt;/p&gt;

&lt;p&gt;I have two comments on &lt;a href=&quot;https://issues.apache.org/jira/browse/DBCP-44&quot; title=&quot;[dbcp] Evictor thread in GenericObjectPool has potential for deadlock&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DBCP-44&quot;&gt;&lt;del&gt;DBCP-44&lt;/del&gt;&lt;/a&gt; with other information (before I realized that this was the bug I was hitting, though they are related).&lt;/p&gt;</comment>
                            <comment id="12806519" author="novoj" created="Fri, 29 Jan 2010 21:43:02 +0000"  >&lt;p&gt;I confirmt, that deadlock persists even in 1.2.2 version. Testing web application under a high load it will with 100% probability stuck at return object method:&lt;/p&gt;

&lt;p&gt;at org.apache.commons.pool.impl.GenericKeyedObjectPool.returnObject (GenericKeyedObjectPool.java:872)&lt;br/&gt;
at org.apache.commons.dbcp.datasources.KeyedCPDSConnectionFactory.connectionClosed (KeyedCPDSConnectionFactory.java:268)&lt;br/&gt;
at com.mysql.jdbc.jdbc2.optional.MysqlPooledConnection.callListener (MysqlPooledConnection.java:209)&lt;br/&gt;
at com.mysql.jdbc.jdbc2.optional.ConnectionWrapper.close (ConnectionWrapper.java:857)&lt;br/&gt;
at com.mysql.jdbc.jdbc2.optional.ConnectionWrapper.close (ConnectionWrapper.java:480)&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10032">
                    <name>Blocker</name>
                                                                <inwardlinks description="is blocked by">
                                        <issuelink>
            <issuekey id="12356581">DBCP-202</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10020">
                    <name>Cloners</name>
                                                                <inwardlinks description="is cloned by">
                                        <issuelink>
            <issuekey id="12413259">DBCP-281</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>34539</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114348</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            15 years, 40 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uvzj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178323</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-64] Returning dead database connections to BasicDataSource</title>
                <link>https://issues.apache.org/jira/browse/DBCP-64</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;I have been using the BasicDataSource class to do connection pooling.  I am &lt;br/&gt;
using sybase version 12.0.0.8 with jconnect 5.5.  &lt;/p&gt;

&lt;p&gt;The problem is if you get a connection from the pool and before it is handed &lt;br/&gt;
back the physical connection dies then there is no way to hand that connection &lt;br/&gt;
back to the pool so it remains as an active connection when it is actually dead.&lt;/p&gt;

&lt;p&gt;I would expect the following behaviour when handing back a connection:-&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;if the connection is ok, place in the pool&lt;/li&gt;
	&lt;li&gt;if the connection is not valid for any reason then it should be closed&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;I think the problem lies in the following code in PoolableConnection class. If &lt;br/&gt;
the isClosed() method returns true then an SQLExceptoin is thrown and then you &lt;br/&gt;
can never return the connection to the pool, hence leaving an active connection &lt;br/&gt;
that doesn;t actually exist anymore.&lt;/p&gt;


&lt;p&gt;public synchronized void close() throws SQLException {&lt;br/&gt;
        if(isClosed()) &lt;/p&gt;
{
            throw new SQLException(&quot;Already closed.&quot;);
        }
&lt;p&gt; else {&lt;br/&gt;
            try &lt;/p&gt;
{
                _pool.returnObject(this);
            }
&lt;p&gt; catch(SQLException e) &lt;/p&gt;
{
                throw e;
            } catch(RuntimeException e) {                throw e;            }
&lt;p&gt; catch(Exception e) &lt;/p&gt;
{
                throw new SQLNestedException(&quot;Cannot close connection (return 
to pool failed)&quot;, e);
            }
&lt;p&gt;        }&lt;br/&gt;
    }&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: All&lt;br/&gt;
Platform: PC&lt;/p&gt;</environment>
        <key id="12341392">DBCP-64</key>
            <summary>Returning dead database connections to BasicDataSource</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="ajul.shah@jpmorgan.com">Ajul Shah</reporter>
                        <labels>
                    </labels>
                <created>Wed, 7 Apr 2004 16:22:21 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:30 +0000</updated>
                            <resolved>Tue, 25 Mar 2008 08:11:30 +0000</resolved>
                                    <version>1.1</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12406415" author="dirkv" created="Sat, 1 May 2004 19:51:22 +0000"  >&lt;p&gt;Fixed by catching the SQLException and invalidating the connection before&lt;br/&gt;
rethrowing the exception.&lt;/p&gt;

&lt;p&gt;     public synchronized void close() throws SQLException {&lt;br/&gt;
        boolean isClosed = false;&lt;br/&gt;
        try &lt;/p&gt;
{
            isClosed = isClosed();
        }
&lt;p&gt; catch (SQLException e) {&lt;br/&gt;
            try &lt;/p&gt;
{
                _pool.invalidateObject(this);
            }
&lt;p&gt; catch (Exception ie) &lt;/p&gt;
{
                // DO NOTHING the original exception will be rethrown
            }
&lt;p&gt;            throw new SQLNestedException(&quot;Cannot close connection (isClosed&lt;br/&gt;
check failed)&quot;, e);&lt;br/&gt;
        }&lt;br/&gt;
        if (isClosed) &lt;/p&gt;
{
            throw new SQLException(&quot;Already closed.&quot;);
        }
&lt;p&gt; else {&lt;br/&gt;
            try &lt;/p&gt;
{
                _pool.returnObject(this);
            }
&lt;p&gt; catch(SQLException e) &lt;/p&gt;
{
                throw e;
            } catch(RuntimeException e) {                throw e;            }
&lt;p&gt; catch(Exception e) &lt;/p&gt;
{
                throw new SQLNestedException(&quot;Cannot close connection (return to
pool failed)&quot;, e);
            }
&lt;p&gt;        }&lt;br/&gt;
    }&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>28251</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114347</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            21 years, 28 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uxlb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178583</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-63] Example code</title>
                <link>https://issues.apache.org/jira/browse/DBCP-63</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;I am using DB2 v8.1.0.36, and have tried running the example &lt;br/&gt;
ManualPoolingDriverExample with the DB2 JDBC driver in db2jcc.jar, but was &lt;br/&gt;
unsucessful, getting the following error:&lt;br/&gt;
org.apache.commons.dbcp.DbcpException: java.sql.SQLException: No suitable driver&lt;/p&gt;

&lt;p&gt;After some experimentation, I realized that simply adding&lt;br/&gt;
Class.forName(&amp;lt;dbdriver class&amp;gt;)&lt;br/&gt;
fixed the issue.  If you could include this snippit in your sample code, it may &lt;br/&gt;
save some potential aggrevation in the future.&lt;/p&gt;

&lt;p&gt;Otherwise, the DBCP is great!&lt;br/&gt;
Thanks&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: All&lt;br/&gt;
Platform: PC&lt;/p&gt;</environment>
        <key id="12340843">DBCP-63</key>
            <summary>Example code</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="david.badia@wachovia.com">David Badia</reporter>
                        <labels>
                    </labels>
                <created>Wed, 9 Jul 2003 03:39:35 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:30 +0000</updated>
                            <resolved>Tue, 25 Mar 2008 08:11:30 +0000</resolved>
                                    <version>1.0</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12404683" author="dirkv" created="Mon, 11 Aug 2003 21:41:08 +0000"  >&lt;p&gt;Added Class.forName to the ManualPooling* examples&lt;br/&gt;
and a warning to README.txt&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>21418</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114346</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            22 years, 14 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uyn3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178753</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-62] NumActive can become incorrect when removeAbandoned=true</title>
                <link>https://issues.apache.org/jira/browse/DBCP-62</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;Issue &amp;amp; patch posted by Wayne Woodfield on commons-dev (19 April 2004)&lt;br/&gt;
----------------------------------------------------------------------&lt;br/&gt;
BUG DESCRIPTION:&lt;br/&gt;
I discovered this bug while using Tomcat DBCP.  I was using&lt;br/&gt;
removeAbandoned=true, so AbandonedObjectPool was used.  We had&lt;br/&gt;
maxActive=10 and maxIdle=2.  Under a really heavy load, numActive gets&lt;br/&gt;
off.  Over time, well over a hundred connections to the database get&lt;br/&gt;
spawned at the same time.  Because numActive gets so far off, it seems&lt;br/&gt;
like the maxActive limit is ignored.  The database runs out of&lt;br/&gt;
connections to give.  After the heavy load has passed and things go back&lt;br/&gt;
to normal, a call to DataSource.getNumActive() shows that numActive is&lt;br/&gt;
negative.&lt;/p&gt;

&lt;p&gt;CAUSE:&lt;br/&gt;
I was able to trace this problem back to a bug in AbandonedObjectPool.&lt;br/&gt;
AbandonedObjectPool initiates an abandoned connection check every time&lt;br/&gt;
someone tries to borrow a connection from an exhausted or&lt;br/&gt;
nearly-exhausted connection pool.  That means that several threads could&lt;br/&gt;
initiate an abandoned connection sweep at once.  If two abandoned&lt;br/&gt;
connection checks running at the same time try to invalidate the same&lt;br/&gt;
connection, they will both be allowed to do so.  GenericObjectPool&lt;br/&gt;
(where numActive is stored) doesn&apos;t have any way of knowing whether a&lt;br/&gt;
connection has been invalidated before.  It just decrements numActive&lt;br/&gt;
again.  A connection can also be invalidated and returned to the idle&lt;br/&gt;
pool at the same time, again decrementing numActive twice.&lt;/p&gt;

&lt;p&gt;AbandonedObjectPool keeps track of active connections.  When a&lt;br/&gt;
connection is returned or invalidated, the connection is removed from&lt;br/&gt;
the active list.  AbandonedObjectPool should check to see whether the&lt;br/&gt;
connection is still in the active list before removing it, and it&lt;br/&gt;
doesn&apos;t.&lt;/p&gt;

&lt;p&gt;SOLUTION:&lt;br/&gt;
In AbandonedObjectPool&apos;s returnObject(Object obj) and&lt;br/&gt;
invalidateObject(Object obj) methods, I&apos;ve added a few lines to ensure&lt;br/&gt;
that connections cannot be invalidated or returned twice.  Before&lt;br/&gt;
invalidating a connection or returning a connection to the idle pool,&lt;br/&gt;
I&apos;m simply checking to see whether the connection to return or&lt;br/&gt;
invalidate is still in the active connection list.  If it isn&apos;t, then&lt;br/&gt;
this connection has already been invalidated, and the return or&lt;br/&gt;
invalidation is aborted.&lt;/p&gt;

&lt;p&gt;I took advantage of the fact that calling remove(Object) on an ArrayList&lt;br/&gt;
returns true if the object to remove was actually found, and false&lt;br/&gt;
otherwise, so I didn&apos;t even have to do an additional traversal of the&lt;br/&gt;
active connection list to find out whether the connection had already&lt;br/&gt;
been removed, so there is practically no performance impact at all &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;br/&gt;
See the attached patch.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: All&lt;br/&gt;
Platform: All&lt;/p&gt;</environment>
        <key id="12341418">DBCP-62</key>
            <summary>NumActive can become incorrect when removeAbandoned=true</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="dirkv">Dirk Verbeeck</reporter>
                        <labels>
                    </labels>
                <created>Sun, 25 Apr 2004 16:42:27 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:30 +0000</updated>
                            <resolved>Tue, 25 Mar 2008 08:11:30 +0000</resolved>
                                    <version>1.1</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12406509" author="dirkv" created="Sun, 25 Apr 2004 16:44:27 +0000"  >&lt;p&gt;Created an attachment (id=11325)&lt;br/&gt;
patch written by Wayne Woodfield&lt;/p&gt;</comment>
                            <comment id="12406510" author="dirkv" created="Sun, 25 Apr 2004 16:55:50 +0000"  >&lt;p&gt;Patch committed&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12332883" name="ASF.LICENSE.NOT.GRANTED--patchfile.txt" size="1451" author="dirkv" created="Sun, 25 Apr 2004 16:44:27 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>28579</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114345</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            21 years, 29 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uxlz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178586</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-61] [dbcp] Individual connection close method</title>
                <link>https://issues.apache.org/jira/browse/DBCP-61</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;The PerUserPoolDataSource object has a close method which closes all the &lt;br/&gt;
connection that is being maintained by the pool. I have a need where the users &lt;br/&gt;
can change their passwords, which requires closing the existing connection and &lt;br/&gt;
opening a new one. I have a close method which takes a user as a parameter &lt;br/&gt;
which will close all the connections for the specified user name.&lt;br/&gt;
I have pasted the code here.&lt;/p&gt;

&lt;p&gt;    /**&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Close pool for particular user&lt;/li&gt;
	&lt;li&gt;&lt;p&gt;     */&lt;br/&gt;
    public void close(String user) &lt;/p&gt;
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {    	try {
            PoolKey key = getPoolKey(user);
            ObjectPool pool = (ObjectPool) pools.get(key);
            pool.close();
    	} catch (Exception closePoolException) {
    		closePoolException.printStackTrace();
    	}     }&lt;/span&gt; &lt;/div&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;My questions are are is this is a right way to approach or should there a &lt;br/&gt;
change password method which should do that ? If the above code can be added &lt;br/&gt;
to the main stream ( if it is good, it will be great). &lt;br/&gt;
Thanks.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: Windows XP&lt;br/&gt;
Platform: PC&lt;/p&gt;</environment>
        <key id="12342007">DBCP-61</key>
            <summary>[dbcp] Individual connection close method</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="3">Duplicate</resolution>
                                        <assignee username="markt">Mark Thomas</assignee>
                                    <reporter username="srinath5177@hotmail.com">Srinath Narasimhan</reporter>
                        <labels>
                    </labels>
                <created>Thu, 20 Jan 2005 04:50:11 +0000</created>
                <updated>Mon, 15 Feb 2010 04:18:19 +0000</updated>
                            <resolved>Sun, 25 Oct 2009 21:12:16 +0000</resolved>
                                                    <fixVersion>1.3</fixVersion>
                                        <due></due>
                            <votes>1</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="12408571" author="dirkv" created="Thu, 3 Feb 2005 06:02:01 +0000"  >&lt;p&gt;I&apos;m wondering if the pool should be removed from the pools map =&amp;gt;&lt;br/&gt;
pools.remove(key) and thus needs to be synchronized.&lt;br/&gt;
Looking at pool.close() I think the pool will be unusable once it has been closed.&lt;/p&gt;

&lt;p&gt;Do you have JUnit tests showing the correct working of this new method? (use&lt;br/&gt;
pool, close, use pool again ?)&lt;/p&gt;</comment>
                            <comment id="12408572" author="srinath5177@hotmail.com" created="Thu, 3 Feb 2005 06:19:27 +0000"  >&lt;p&gt;JUnit Test case for my initial the code I posted&lt;/p&gt;

&lt;p&gt;    public void testClosing1() throws Exception &lt;/p&gt;
{
        Connection c = null;
        c = ds.getConnection(&quot;u1&quot;,&quot;p1&quot;);
        ds.close(&quot;u1&quot;);
        assertTrue(c.isClosed());
        c = ds.getConnection(&quot;u1&quot;,&quot;p1&quot;);
        assertTrue(!c.isClosed());
    }

&lt;p&gt;As far as removing the pool, if we don&apos;t leave it will it be reused, inwhich &lt;br/&gt;
case it can be left there. I am not sure about what should be done there.&lt;/p&gt;</comment>
                            <comment id="12408573" author="dirkv" created="Wed, 16 Feb 2005 03:17:24 +0000"  >&lt;p&gt;I have added your method locally and ran the testcase but if fails.&lt;br/&gt;
The assertTrue(c.isClosed()); fails because the connection is still open. This&lt;br/&gt;
is normal, the pool is closed but the connection remains open.&lt;/p&gt;

&lt;p&gt;After I removed the assert I got the following stacktrace:&lt;br/&gt;
org.apache.commons.dbcp.SQLNestedException: Could not retrieve connection info&lt;br/&gt;
from pool&lt;br/&gt;
    at&lt;br/&gt;
org.apache.commons.dbcp.datasources.PerUserPoolDataSource.getPooledConnectionAndInfo(PerUserPoolDataSource.java:396)&lt;br/&gt;
    at&lt;br/&gt;
org.apache.commons.dbcp.datasources.InstanceKeyDataSource.getConnection(InstanceKeyDataSource.java:631)&lt;br/&gt;
    at&lt;br/&gt;
org.apache.commons.dbcp.datasources.TestPerUserPoolDataSource.testClosing1(TestPerUserPoolDataSource.java:567)&lt;br/&gt;
...&lt;br/&gt;
Caused by: java.lang.IllegalStateException: Pool not open&lt;br/&gt;
    at org.apache.commons.pool.BaseObjectPool.assertOpen(BaseObjectPool.java:78)&lt;br/&gt;
    at&lt;br/&gt;
org.apache.commons.pool.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:776)&lt;br/&gt;
    at&lt;br/&gt;
org.apache.commons.dbcp.datasources.PerUserPoolDataSource.getPooledConnectionAndInfo(PerUserPoolDataSource.java:393)&lt;br/&gt;
    ... 17 more&lt;/p&gt;

&lt;p&gt;This is what I expected, the closed pool cannot be reused. It must be&lt;br/&gt;
unregistered in a way that getPooledConnectionAndInfo() will create a new pool&lt;br/&gt;
for the user. (simply removing it from the HashMap?) &lt;/p&gt;</comment>
                            <comment id="12408574" author="srinath5177@hotmail.com" created="Fri, 18 Feb 2005 09:12:50 +0000"  >&lt;p&gt;That sounds like the right way to do it.&lt;/p&gt;</comment>
                            <comment id="12408575" author="dirkv" created="Tue, 1 Mar 2005 02:41:10 +0000"  >&lt;p&gt;Removing the pool from the hashmap seems to work&lt;br/&gt;
(unit test doesn&apos;t fail anymore) but more testing is needed before commit.&lt;/p&gt;

&lt;p&gt;    public synchronized void close(String user) {&lt;br/&gt;
    	try &lt;/p&gt;
{
            PoolKey key = getPoolKey(user);
            ObjectPool pool = (ObjectPool) pools.get(key);
            pool.close();
            pools.remove(key);
    	}
&lt;p&gt; catch (Exception closePoolException) &lt;/p&gt;
{
    		closePoolException.printStackTrace();
    	}
&lt;p&gt; &lt;br/&gt;
    }&lt;/p&gt;</comment>
                            <comment id="12408576" author="matt@thebishops.org" created="Thu, 21 Jul 2005 05:55:18 +0000"  >&lt;p&gt;Some additional comments:&lt;/p&gt;

&lt;p&gt;The pools member isn&apos;t a synchronized collection, so it is possible for pools.remove() to cause a failure &lt;br/&gt;
in other operations that use it, like get().  I recommend wrapping pool in a SynchronizedMap:&lt;/p&gt;

&lt;p&gt;    private transient Map pools = Collections.synchronizedMap(new HashMap());&lt;/p&gt;


&lt;p&gt;Additionally, it would be better to remove the ObjectPool from pools before closing it so a follow-on &lt;br/&gt;
thread can create a new pool for this user while the old pool is being closed down.  This is a real &lt;br/&gt;
possibility for the password-change scenario, as it may take some time for the pool to close down &lt;br/&gt;
before the user account is re-opened with the new credentials.&lt;/p&gt;

&lt;p&gt;Here&apos;s the method we are using in production to solve this problem:&lt;/p&gt;

&lt;p&gt;    /**&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Close pool associated with this user.&lt;br/&gt;
     */&lt;br/&gt;
    public void close(String user) {&lt;br/&gt;
        PoolKey key = getPoolKey(user);&lt;br/&gt;
        ObjectPool pool = (ObjectPool) pools.remove(key);&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;        //is there a pool to be closed?&lt;br/&gt;
        if (pool == null) &lt;/p&gt;
{
            return;
        }

&lt;p&gt;        try &lt;/p&gt;
{
            pool.close();
        }
&lt;p&gt; catch (Exception closePoolException) &lt;/p&gt;
{
            //ignore
        }
&lt;p&gt;    }&lt;/p&gt;</comment>
                            <comment id="12408577" author="srinath5177@hotmail.com" created="Fri, 22 Jul 2005 03:29:03 +0000"  >&lt;p&gt;Thats a good suggestion.&lt;br/&gt;
I am using the changes I had committed before in production. I would like to &lt;br/&gt;
see if this would get added to into the next release version.&lt;/p&gt;</comment>
                            <comment id="12408578" author="srinath5177@hotmail.com" created="Thu, 22 Sep 2005 02:29:13 +0000"  >&lt;p&gt;Will this feature be added into the release ? If so when ?&lt;/p&gt;
</comment>
                            <comment id="12675021" author="markt" created="Thu, 19 Feb 2009 16:09:38 +0000"  >&lt;p&gt;Having looked at &lt;a href=&quot;https://issues.apache.org/jira/browse/DBCP-8&quot; title=&quot;[dbcp][PATCH] Handle changed passwords in SharedPoolDataSource&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DBCP-8&quot;&gt;&lt;del&gt;DBCP-8&lt;/del&gt;&lt;/a&gt; and this issue, they are trying to solve the same problem. Given we only need one solution I am going to go with the approach in &lt;a href=&quot;https://issues.apache.org/jira/browse/DBCP-8&quot; title=&quot;[dbcp][PATCH] Handle changed passwords in SharedPoolDataSource&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DBCP-8&quot;&gt;&lt;del&gt;DBCP-8&lt;/del&gt;&lt;/a&gt;. My main reason for doing this is simplicity. There appears to be far fewer edge cases and things that could go wrong in the approach outlined in &lt;a href=&quot;https://issues.apache.org/jira/browse/DBCP-8&quot; title=&quot;[dbcp][PATCH] Handle changed passwords in SharedPoolDataSource&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DBCP-8&quot;&gt;&lt;del&gt;DBCP-8&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;If the &lt;a href=&quot;https://issues.apache.org/jira/browse/DBCP-8&quot; title=&quot;[dbcp][PATCH] Handle changed passwords in SharedPoolDataSource&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DBCP-8&quot;&gt;&lt;del&gt;DBCP-8&lt;/del&gt;&lt;/a&gt; approach fails for some unforeseen reason then I&apos;ll re-open this issue and look again at the approach described here.&lt;/p&gt;</comment>
                            <comment id="12768440" author="haixiliu" created="Wed, 21 Oct 2009 20:48:36 +0000"  >&lt;p&gt;Mark,&lt;/p&gt;

&lt;p&gt;I am a colleague of Srinath&apos;s and I tested the patch for &lt;a href=&quot;https://issues.apache.org/jira/browse/DBCP-8&quot; title=&quot;[dbcp][PATCH] Handle changed passwords in SharedPoolDataSource&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DBCP-8&quot;&gt;&lt;del&gt;DBCP-8&lt;/del&gt;&lt;/a&gt; and it didn&apos;t resolve our problem.&lt;/p&gt;

&lt;p&gt;I then looked in the source code and found that the solution would only work for SharedPoolDataSource and not PerUserPoolDataSource because the related changes are only made to SharedPoolDataSource and we are using PerUserPoolDataSource.&lt;/p&gt;

&lt;p&gt;Can the same fix for &lt;a href=&quot;https://issues.apache.org/jira/browse/DBCP-8&quot; title=&quot;[dbcp][PATCH] Handle changed passwords in SharedPoolDataSource&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DBCP-8&quot;&gt;&lt;del&gt;DBCP-8&lt;/del&gt;&lt;/a&gt; be extended to cover PerUserPoolDataSource? If not, then we probably will still need a solution around the close method as proposed in this bug report.&lt;/p&gt;

&lt;p&gt;Thanks,&lt;br/&gt;
Haixi&lt;/p&gt;</comment>
                            <comment id="12768490" author="markt" created="Wed, 21 Oct 2009 22:11:22 +0000"  >&lt;p&gt;Re-open to look at PerUserPoolDataSource&lt;/p&gt;</comment>
                            <comment id="12769866" author="markt" created="Sun, 25 Oct 2009 21:12:16 +0000"  >&lt;p&gt;I resolving this as a duplicate of &lt;a href=&quot;https://issues.apache.org/jira/browse/DBCP-8&quot; title=&quot;[dbcp][PATCH] Handle changed passwords in SharedPoolDataSource&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DBCP-8&quot;&gt;&lt;del&gt;DBCP-8&lt;/del&gt;&lt;/a&gt; again and I&apos;ll re-open &lt;a href=&quot;https://issues.apache.org/jira/browse/DBCP-8&quot; title=&quot;[dbcp][PATCH] Handle changed passwords in SharedPoolDataSource&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DBCP-8&quot;&gt;&lt;del&gt;DBCP-8&lt;/del&gt;&lt;/a&gt; in a second to extend the fix to the PerUserPoolDataSource&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>33167</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114344</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            16 years, 2 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uzxr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178963</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-60] [dbcp] hands out connections though broken at back end</title>
                <link>https://issues.apache.org/jira/browse/DBCP-60</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;The setup:&lt;br/&gt;
Hibernate Session is fetched from a Hibernate SessionFactory, created from a&lt;br/&gt;
Hibernate Configuration which uses JNDI/DBCP setup by Tomcat. The entry is found&lt;br/&gt;
below.&lt;/p&gt;

&lt;p&gt;The problem:&lt;br/&gt;
After tomcat has completed starting up, all is well. No problems, but if I&lt;br/&gt;
restart the PostgreSQL database (as in /etc/init.d/postgres restart), the&lt;br/&gt;
Connections handed out by DBCP fails to execute queries.&lt;/p&gt;

&lt;p&gt;Actual results:&lt;br/&gt;
The pool becomes unusable.&lt;/p&gt;

&lt;p&gt;Expected results:  &lt;br/&gt;
The pool detects the problem and reinitiates all connections to the database.&lt;/p&gt;

&lt;p&gt;Stacktrace: (heavily reduced)&lt;br/&gt;
javax.servlet.ServletException: Couldn&apos;t load todo items from database.&lt;br/&gt;
        at&lt;br/&gt;
se.csbnet.nvg.worksupport.actions.ViewTodoList.service(ViewTodoList.java:49)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;...&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at net.w_sys.mwa.filters.HibernateFilter.doFilter(HibernateFilter.java:142)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;...&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.ajp.tomcat4.Ajp13Processor.process(Ajp13Processor.java:457)&lt;br/&gt;
        at org.apache.ajp.tomcat4.Ajp13Processor.run(Ajp13Processor.java:576)&lt;br/&gt;
        at java.lang.Thread.run(Thread.java:534)&lt;br/&gt;
Could not execute query&lt;br/&gt;
net.sf.hibernate.JDBCException: Could not execute query&lt;br/&gt;
        at net.sf.hibernate.impl.SessionImpl.find(SessionImpl.java:1539)&lt;br/&gt;
        at net.sf.hibernate.impl.SessionImpl.find(SessionImpl.java:1513)&lt;br/&gt;
        at net.sf.hibernate.impl.SessionImpl.find(SessionImpl.java:1505)&lt;br/&gt;
        at&lt;br/&gt;
se.csbnet.nvg.worksupport.actions.ViewTodoList.service(ViewTodoList.java:37)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;...&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at net.w_sys.mwa.filters.HibernateFilter.doFilter(HibernateFilter.java:142)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;...&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.ajp.tomcat4.Ajp13Processor.process(Ajp13Processor.java:457)&lt;br/&gt;
        at org.apache.ajp.tomcat4.Ajp13Processor.run(Ajp13Processor.java:576)&lt;br/&gt;
        at java.lang.Thread.run(Thread.java:534)&lt;br/&gt;
Caused by: org.postgresql.util.PSQLException: An IO erro occured while sending&lt;br/&gt;
to the backend - Exception: java.net.SocketException: Broken pipe&lt;br/&gt;
Stack Trace:&lt;/p&gt;

&lt;p&gt;java.net.SocketException: Broken pipe&lt;br/&gt;
        at java.net.SocketOutputStream.socketWrite0(Native Method)&lt;br/&gt;
        at java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:92)&lt;br/&gt;
        at java.net.SocketOutputStream.write(SocketOutputStream.java:136)&lt;br/&gt;
        at java.io.BufferedOutputStream.flushBuffer(BufferedOutputStream.java:66)&lt;br/&gt;
        at java.io.BufferedOutputStream.write(BufferedOutputStream.java:79)&lt;br/&gt;
        at org.postgresql.core.PGStream.SendChar(PGStream.java:66)&lt;br/&gt;
        at org.postgresql.core.QueryExecutor.sendQueryV3(QueryExecutor.java:320)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;...&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at&lt;br/&gt;
org.postgresql.jdbc1.AbstractJdbc1Statement.executeQuery(AbstractJdbc1Statement.java:233)&lt;br/&gt;
        at&lt;br/&gt;
org.apache.commons.dbcp.DelegatingPreparedStatement.executeQuery(DelegatingPreparedStatement.java:205)&lt;br/&gt;
        at net.sf.hibernate.impl.BatcherImpl.getResultSet(BatcherImpl.java:87)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;...&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at net.sf.hibernate.impl.SessionImpl.find(SessionImpl.java:1505)&lt;br/&gt;
        at&lt;br/&gt;
se.csbnet.nvg.worksupport.actions.ViewTodoList.service(ViewTodoList.java:37)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;...&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at net.w_sys.mwa.filters.HibernateFilter.doFilter(HibernateFilter.java:142)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;...&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at java.lang.Thread.run(Thread.java:534)&lt;br/&gt;
End of Stack Trace&lt;/p&gt;

&lt;p&gt;        at org.postgresql.core.QueryExecutor.sendQueryV3(QueryExecutor.java:341)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;...&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at&lt;br/&gt;
org.postgresql.jdbc1.AbstractJdbc1Statement.executeQuery(AbstractJdbc1Statement.java:233)&lt;br/&gt;
        at&lt;br/&gt;
org.apache.commons.dbcp.DelegatingPreparedStatement.executeQuery(DelegatingPreparedStatement.java:205)&lt;br/&gt;
        at net.sf.hibernate.impl.BatcherImpl.getResultSet(BatcherImpl.java:87)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;...&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at net.sf.hibernate.impl.SessionImpl.find(SessionImpl.java:1536)&lt;br/&gt;
        ... 50 more&lt;br/&gt;
An IO erro occured while sending to the backend - Exception:&lt;br/&gt;
java.net.SocketException: Broken pipe&lt;br/&gt;
Stack Trace:&lt;/p&gt;

&lt;p&gt;java.net.SocketException: Broken pipe&lt;br/&gt;
        at java.net.SocketOutputStream.socketWrite0(Native Method)&lt;br/&gt;
        at java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:92)&lt;br/&gt;
        at java.net.SocketOutputStream.write(SocketOutputStream.java:136)&lt;br/&gt;
        at java.io.BufferedOutputStream.flushBuffer(BufferedOutputStream.java:66)&lt;br/&gt;
        at java.io.BufferedOutputStream.write(BufferedOutputStream.java:79)&lt;br/&gt;
        at org.postgresql.core.PGStream.SendChar(PGStream.java:66)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;...&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at&lt;br/&gt;
org.postgresql.jdbc1.AbstractJdbc1Statement.executeQuery(AbstractJdbc1Statement.java:233)&lt;br/&gt;
        at&lt;br/&gt;
org.apache.commons.dbcp.DelegatingPreparedStatement.executeQuery(DelegatingPreparedStatement.java:205)&lt;br/&gt;
        at net.sf.hibernate.impl.BatcherImpl.getResultSet(BatcherImpl.java:87)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;...&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at net.sf.hibernate.impl.SessionImpl.find(SessionImpl.java:1505)&lt;br/&gt;
        at&lt;br/&gt;
se.csbnet.nvg.worksupport.actions.ViewTodoList.service(ViewTodoList.java:37)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;...&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at net.w_sys.mwa.filters.HibernateFilter.doFilter(HibernateFilter.java:142)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;...&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.ajp.tomcat4.Ajp13Processor.process(Ajp13Processor.java:457)&lt;br/&gt;
        at org.apache.ajp.tomcat4.Ajp13Processor.run(Ajp13Processor.java:576)&lt;br/&gt;
        at java.lang.Thread.run(Thread.java:534)&lt;br/&gt;
End of Stack Trace&lt;/p&gt;

&lt;p&gt;org.postgresql.util.PSQLException: An IO erro occured while sending to the&lt;br/&gt;
backend - Exception: java.net.SocketException: Broken pipe&lt;br/&gt;
Stack Trace:&lt;/p&gt;

&lt;p&gt;java.net.SocketException: Broken pipe&lt;br/&gt;
        at java.net.SocketOutputStream.socketWrite0(Native Method)&lt;br/&gt;
        at java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:92)&lt;br/&gt;
        at java.net.SocketOutputStream.write(SocketOutputStream.java:136)&lt;br/&gt;
        at java.io.BufferedOutputStream.flushBuffer(BufferedOutputStream.java:66)&lt;br/&gt;
        at java.io.BufferedOutputStream.write(BufferedOutputStream.java:79)&lt;br/&gt;
        at org.postgresql.core.PGStream.SendChar(PGStream.java:66)&lt;br/&gt;
        at org.postgresql.core.QueryExecutor.sendQueryV3(QueryExecutor.java:320)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;...&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at&lt;br/&gt;
org.postgresql.jdbc1.AbstractJdbc1Statement.executeQuery(AbstractJdbc1Statement.java:233)&lt;br/&gt;
        at&lt;br/&gt;
org.apache.commons.dbcp.DelegatingPreparedStatement.executeQuery(DelegatingPreparedStatement.java:205)&lt;br/&gt;
        at net.sf.hibernate.impl.BatcherImpl.getResultSet(BatcherImpl.java:87)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;...&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at net.sf.hibernate.impl.SessionImpl.find(SessionImpl.java:1505)&lt;br/&gt;
        at&lt;br/&gt;
se.csbnet.nvg.worksupport.actions.ViewTodoList.service(ViewTodoList.java:37)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;...&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at net.w_sys.mwa.filters.HibernateFilter.doFilter(HibernateFilter.java:142)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;...&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.ajp.tomcat4.Ajp13Processor.process(Ajp13Processor.java:457)&lt;br/&gt;
        at org.apache.ajp.tomcat4.Ajp13Processor.run(Ajp13Processor.java:576)&lt;br/&gt;
        at java.lang.Thread.run(Thread.java:534)&lt;br/&gt;
End of Stack Trace&lt;/p&gt;

&lt;p&gt;        at org.postgresql.core.QueryExecutor.sendQueryV3(QueryExecutor.java:341)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;...&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at&lt;br/&gt;
org.postgresql.jdbc1.AbstractJdbc1Statement.executeQuery(AbstractJdbc1Statement.java:233)&lt;br/&gt;
        at&lt;br/&gt;
org.apache.commons.dbcp.DelegatingPreparedStatement.executeQuery(DelegatingPreparedStatement.java:205)&lt;br/&gt;
        at net.sf.hibernate.impl.BatcherImpl.getResultSet(BatcherImpl.java:87)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;...&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at net.sf.hibernate.impl.SessionImpl.find(SessionImpl.java:1505)&lt;br/&gt;
        at&lt;br/&gt;
se.csbnet.nvg.worksupport.actions.ViewTodoList.service(ViewTodoList.java:37)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;...&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at net.w_sys.mwa.filters.HibernateFilter.doFilter(HibernateFilter.java:142)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;...&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.ajp.tomcat4.Ajp13Processor.process(Ajp13Processor.java:457)&lt;br/&gt;
        at org.apache.ajp.tomcat4.Ajp13Processor.run(Ajp13Processor.java:576)&lt;br/&gt;
        at java.lang.Thread.run(Thread.java:534)&lt;/p&gt;


&lt;p&gt;The entry in Tomcat&apos;s server.xml looks like this:&lt;/p&gt;

&lt;p&gt;        &amp;lt;Context path=&quot;/nvg&quot; docBase=&quot;/some/where/&quot; reloadable=&quot;false&quot;&amp;gt;&lt;/p&gt;

&lt;p&gt;          &amp;lt;Resource name=&quot;jdbc/nvg&quot; scope=&quot;Shareable&quot; type=&quot;javax.sql.DataSource&quot; /&amp;gt;&lt;br/&gt;
          &amp;lt;ResourceParams name=&quot;jdbc/nvg&quot;&amp;gt;&lt;/p&gt;

&lt;p&gt;&amp;lt;parameter&amp;gt;&amp;lt;name&amp;gt;factory&amp;lt;/name&amp;gt;&amp;lt;value&amp;gt;org.apache.commons.dbcp.BasicDataSourceFactory&amp;lt;/value&amp;gt;&amp;lt;/parameter&amp;gt;&lt;br/&gt;
            &amp;lt;!-- JDBC params --&amp;gt;&lt;/p&gt;

&lt;p&gt;&amp;lt;parameter&amp;gt;&amp;lt;name&amp;gt;url&amp;lt;/name&amp;gt;&amp;lt;value&amp;gt;jdbc:postgresql://localhost/nvg&amp;lt;/value&amp;gt;&amp;lt;/parameter&amp;gt;&lt;/p&gt;

&lt;p&gt;&amp;lt;parameter&amp;gt;&amp;lt;name&amp;gt;driverClassName&amp;lt;/name&amp;gt;&amp;lt;value&amp;gt;org.postgresql.Driver&amp;lt;/value&amp;gt;&amp;lt;/parameter&amp;gt;&lt;br/&gt;
            &amp;lt;parameter&amp;gt;&amp;lt;name&amp;gt;username&amp;lt;/name&amp;gt;&amp;lt;value&amp;gt;username&amp;lt;/value&amp;gt;&amp;lt;/parameter&amp;gt;&lt;br/&gt;
            &amp;lt;parameter&amp;gt;&amp;lt;name&amp;gt;password&amp;lt;/name&amp;gt;&amp;lt;value&amp;gt;password&amp;lt;/value&amp;gt;&amp;lt;/parameter&amp;gt;&lt;br/&gt;
            &amp;lt;!-- DBCP params --&amp;gt;&lt;br/&gt;
            &amp;lt;parameter&amp;gt;&amp;lt;name&amp;gt;maxWait&amp;lt;/name&amp;gt;&amp;lt;value&amp;gt;600&amp;lt;/value&amp;gt;&amp;lt;/parameter&amp;gt;&lt;br/&gt;
            &amp;lt;parameter&amp;gt;&amp;lt;name&amp;gt;maxIdle&amp;lt;/name&amp;gt;&amp;lt;value&amp;gt;4&amp;lt;/value&amp;gt;&amp;lt;/parameter&amp;gt;&lt;br/&gt;
            &amp;lt;parameter&amp;gt;&amp;lt;name&amp;gt;maxActive&amp;lt;/name&amp;gt;&amp;lt;value&amp;gt;8&amp;lt;/value&amp;gt;&amp;lt;/parameter&amp;gt;&lt;br/&gt;
          &amp;lt;/ResourceParams&amp;gt;&lt;br/&gt;
        &amp;lt;/Context&amp;gt;&lt;/p&gt;

&lt;p&gt;Using commons-dbcp-1.2.1.jar&lt;br/&gt;
Postgres Version: 7.4.3-1&lt;br/&gt;
Postgres JDBC-driver: pg74.214.jdbc3.jar&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: Linux&lt;br/&gt;
Platform: Other&lt;/p&gt;</environment>
        <key id="12341621">DBCP-60</key>
            <summary>[dbcp] hands out connections though broken at back end</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="fredrik.wendt@linux.se">Fredrik Wendt</reporter>
                        <labels>
                    </labels>
                <created>Sun, 8 Aug 2004 22:36:11 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:30 +0000</updated>
                            <resolved>Tue, 25 Mar 2008 08:11:30 +0000</resolved>
                                    <version>1.0</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12407171" author="fredrik.wendt@linux.se" created="Sun, 8 Aug 2004 22:43:46 +0000"  >&lt;p&gt;I planned to attach the entire stack trace since it&apos;s rather long but I can&apos;t&lt;br/&gt;
find a place for attaching the attachment &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/tongue.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;br/&gt;
&lt;a href=&quot;http://www.csbnet.se/~ceda/commons-dbcp/stacktrace.txt&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.csbnet.se/~ceda/commons-dbcp/stacktrace.txt&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I should also add that in&lt;br/&gt;
net.w_sys.mwa.filters.HibernateFilter.doFilter(HibernateFilter.java:142) I test&lt;br/&gt;
and see that the Hibernate Session isOpen(), isConnected and it&apos;s connection(),&lt;br/&gt;
which is a org.apache.commons.dbcp.PoolableConnection, .isClosed() returns false. &lt;/p&gt;</comment>
                            <comment id="12407172" author="craig.mcclanahan@sun.com" created="Sun, 8 Aug 2004 23:22:19 +0000"  >&lt;p&gt;Set the validationQuery property and you&apos;ll get exactly the results you are&lt;br/&gt;
looking for.  The pool will find that the stale connections fail validation and&lt;br/&gt;
throw them away, leading to the creation of new connections to the restarted&lt;br/&gt;
database server.&lt;/p&gt;</comment>
                            <comment id="12407173" author="dirkv" created="Wed, 5 Jan 2005 08:55:02 +0000"  >&lt;p&gt;I assume the suggestion from Craig fixed the problem, mark issue as fixed&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>30523</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114343</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            20 years, 45 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uwk7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178416</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-59] AbandonedObjectPool.removeAbandoned never cleans up the trace</title>
                <link>https://issues.apache.org/jira/browse/DBCP-59</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;if there is an abandoned connection, it&apos;s never removed from the ArrayList &lt;br/&gt;
trace. it is closed correctly though.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: All&lt;br/&gt;
Platform: All&lt;/p&gt;</environment>
        <key id="12340629">DBCP-59</key>
            <summary>AbandonedObjectPool.removeAbandoned never cleans up the trace</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="2">Won&apos;t Fix</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="weiqingh@yahoo.com">weiqingh</reporter>
                        <labels>
                    </labels>
                <created>Sat, 29 Mar 2003 05:59:17 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:30 +0000</updated>
                            <resolved>Tue, 25 Mar 2008 08:11:30 +0000</resolved>
                                    <version>1.0</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12403937" author="dgraham@apache.org" created="Wed, 9 Apr 2003 02:58:50 +0000"  >&lt;p&gt;The abandoned pool functionality is now deprecated and will be removed in a &lt;br/&gt;
future release.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>18483</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114342</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            22 years, 32 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uzmf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178912</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-58] PoolableConnection.reallyClose() doesn&apos;t decrement active count</title>
                <link>https://issues.apache.org/jira/browse/DBCP-58</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;PoolableConnection.reallyClose() doesn&apos;t decrement the active count &lt;br/&gt;
(_numActive).  &lt;/p&gt;

&lt;p&gt;This not only makes it look like there are more active connections than there &lt;br/&gt;
really are, but it also causes functions which use this count (e.g., the pool &lt;br/&gt;
connection limit) to eventually fail.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: Windows XP&lt;br/&gt;
Platform: PC&lt;/p&gt;</environment>
        <key id="12340589">DBCP-58</key>
            <summary>PoolableConnection.reallyClose() doesn&apos;t decrement active count</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="4">Incomplete</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="flawlor@athensgroup.com">Frank Lawlor</reporter>
                        <labels>
                    </labels>
                <created>Thu, 6 Mar 2003 00:53:46 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:30 +0000</updated>
                            <resolved>Tue, 25 Mar 2008 08:11:30 +0000</resolved>
                                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12403800" author="rwaldhoff@apache.org" created="Fri, 7 Mar 2003 02:21:20 +0000"  >&lt;p&gt;PoolableConnection doesn&apos;t maintain an active count (_numActive), that&apos;s the &lt;br/&gt;
pool&apos;s responsiblity.  &lt;/p&gt;

&lt;p&gt;Some pool is maintaining an active count.  This pool is uses &lt;br/&gt;
PoolableConnectionFactory to create and destroy objects (in this case &lt;br/&gt;
PoolableConnection).  As part of the destroy, the factory invokes &lt;br/&gt;
PoolableConnection.reallyClose.  This is unrelated to the number of active &lt;br/&gt;
objects in the pool.&lt;/p&gt;</comment>
                            <comment id="12403801" author="flawlor@athensgroup.com" created="Fri, 7 Mar 2003 03:57:08 +0000"  >&lt;p&gt;You are missing the point.&lt;/p&gt;

&lt;p&gt;The user only has the connection to interact with, not the pool.&lt;/p&gt;

&lt;p&gt;When a user does a PoolableConnection.close() IT interacts with the&lt;br/&gt;
pool which decrements the active count.&lt;/p&gt;

&lt;p&gt;Likewise reallyClose() ALSO needs to interact with the pool and have it&lt;br/&gt;
decrement the count.  It doesn&apos;t.&lt;/p&gt;</comment>
                            <comment id="12403802" author="rwaldhoff@apache.org" created="Fri, 7 Mar 2003 05:40:30 +0000"  >&lt;p&gt;The user should not be calling PoolableConnection.reallyClose, or for that &lt;br/&gt;
matter, casting to PoolableConnection at all.  The &quot;external interface&quot; &lt;br/&gt;
(&amp;lt;&lt;a href=&quot;http://jakarta.apache.org/commons/versioning.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://jakarta.apache.org/commons/versioning.html&lt;/a&gt;&amp;gt;) of DBCP is JDBC.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>17680</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114341</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            22 years, 36 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0v0lb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>179069</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-57] [dbcp] Null pointer exception being thrown in SQLNestedException</title>
                <link>https://issues.apache.org/jira/browse/DBCP-57</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;If you have a logWriter installed via DriverManager.setLogWriter() and then the&lt;br/&gt;
code tries to create a SQLNestedException you will get a null pointer in&lt;br/&gt;
SQLNestedException.printStackTrace().&lt;/p&gt;

&lt;p&gt;This is due to  &lt;/p&gt;

&lt;p&gt;    super(msg);&lt;/p&gt;

&lt;p&gt;in SQLNestedException constructor. You can see that this called SQLException&lt;br/&gt;
constructor which (if you have a logWriter installed) called printStackTrace().&lt;br/&gt;
This method is overloaded in SQLNestedException and expects the instance&lt;br/&gt;
variable cause to be populated but it isn&apos;t as the method has not completed the&lt;br/&gt;
constructor.&lt;/p&gt;

&lt;p&gt;An example place this can occur is line 175 in PoolingDriver.connect(). This&lt;br/&gt;
method tries to create a SQLNestedException().&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: All&lt;br/&gt;
Platform: PC&lt;/p&gt;</environment>
        <key id="12341203">DBCP-57</key>
            <summary>[dbcp] Null pointer exception being thrown in SQLNestedException</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="john.neale@ieee.org">John Neale</reporter>
                        <labels>
                    </labels>
                <created>Tue, 13 Jan 2004 04:25:12 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:30 +0000</updated>
                            <resolved>Tue, 25 Mar 2008 08:11:30 +0000</resolved>
                                    <version>1.1</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12405805" author="dirkv" created="Mon, 19 Jan 2004 07:11:10 +0000"  >&lt;p&gt;Nullpointer fixed + enhance the printing of the stacktrace&lt;/p&gt;

&lt;p&gt;JUnit test: TestManual.testLogWriter&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>26072</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114340</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            21 years, 43 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uxwn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178634</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-56] No way to get at SQLException if connection to database fails in DriverManagerConnectionFactory</title>
                <link>https://issues.apache.org/jira/browse/DBCP-56</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;We&apos;re using the Commons DBCP for a project which uses l10n for error messages.  As such, we need access to the SQLException error code when connection fails.&lt;/p&gt;

&lt;p&gt;This patch to apply the &quot;root cause&quot; design pattern (as seen in ServletException, JspException, and InvocationTargetException of the official java API) works well for us.  We&apos;d like to see it included in future revisions of DBCP.&lt;/p&gt;

&lt;p&gt;Thanks!&lt;/p&gt;

&lt;p&gt;------- BEGIN DIFF&lt;br/&gt;
diff -c -r1.2 DriverManagerConnectionFactory.java&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;
	&lt;ul&gt;
		&lt;li&gt;
		&lt;ul&gt;
			&lt;li&gt;DriverManagerConnectionFactory.java	15 Apr 2001 17:31:40 -0000	1.2&lt;/li&gt;
		&lt;/ul&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;DriverManagerConnectionFactory.java	13 Jun 2002 20:20:56 -0000&lt;br/&gt;
***************&lt;/li&gt;
		&lt;/ul&gt;
		&lt;ul&gt;
			&lt;li&gt;70,75 ****&lt;/li&gt;
		&lt;/ul&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;70,77 ----&lt;br/&gt;
   *&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
	&lt;li&gt;@author Rodney Waldhoff&lt;/li&gt;
	&lt;li&gt;@author Ignacio J. Ortega&lt;br/&gt;
+  * @author Jonathan Fuerth&lt;br/&gt;
+  * @author Dan Fraser&lt;br/&gt;
   *&lt;/li&gt;
	&lt;li&gt;@version $Id: DriverManagerConnectionFactory.java,v 1.2 2001/04/15 17:31:40 nacho Exp $&lt;br/&gt;
   */&lt;br/&gt;
***************
	&lt;ul&gt;
		&lt;li&gt;
		&lt;ul&gt;
			&lt;li&gt;98,104 ****&lt;br/&gt;
                  return DriverManager.getConnection(_connectUri,_props);&lt;br/&gt;
              }&lt;br/&gt;
          } catch(SQLException e) 
{
!             throw new RuntimeException(e.toString());
          }
&lt;p&gt;      }&lt;/p&gt;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;&amp;#8212; 100,106 ----&lt;br/&gt;
                  return DriverManager.getConnection(_connectUri,_props);&lt;br/&gt;
              }&lt;br/&gt;
          } catch(SQLException e) &lt;/p&gt;
{
!             throw new DBCPException(e, &quot;Could not create database connection&quot;);
          }
&lt;p&gt;      }&lt;/p&gt;

&lt;p&gt;------- END DIFF&lt;/p&gt;

&lt;p&gt;And the addition of this new class:&lt;/p&gt;

&lt;p&gt;------- BEGIN DBCPException.java&lt;br/&gt;
package org.apache.commons.dbcp;&lt;/p&gt;

&lt;p&gt;/*&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(insert apache license here.. we disclaim everything about this file.)&lt;br/&gt;
 */&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;public class DBCPException extends RuntimeException {&lt;br/&gt;
	private Throwable _rootCause;&lt;/p&gt;

&lt;p&gt;	public DBCPException(Throwable rootCause, String message) &lt;/p&gt;
{
		super(message);
		_rootCause=rootCause;
	}

&lt;p&gt;	public Throwable getRootCause() &lt;/p&gt;
{
		return _rootCause;
	}
&lt;p&gt;}&lt;br/&gt;
------- END DBCPException.java&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: All&lt;br/&gt;
Platform: All&lt;/p&gt;</environment>
        <key id="12340244">DBCP-56</key>
            <summary>No way to get at SQLException if connection to database fails in DriverManagerConnectionFactory</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="fuerth@sqlpower.ca">Jonathan Fuerth</reporter>
                        <labels>
                    </labels>
                <created>Fri, 14 Jun 2002 03:23:51 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:30 +0000</updated>
                            <resolved>Tue, 25 Mar 2008 08:11:30 +0000</resolved>
                                    <version>Nightly Builds</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12402691" author="craig.mcclanahan@sun.com" created="Sun, 21 Jul 2002 05:57:00 +0000"  >&lt;p&gt;Fixed in nightly build 20020721.&lt;/p&gt;

&lt;p&gt;I tweaked the exception class to follow the JDK 1.4 exception handler pattern&lt;br/&gt;
(getCause() instead of getRootCause()), and also replaced all cases where a&lt;br/&gt;
generic RuntimeException was thrown with a DbcpException that wraps the actual&lt;br/&gt;
exception causing the problem.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9850</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114339</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            23 years, 17 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uw2v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178338</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-55] Pooled connection architecture vulnerable to double use</title>
                <link>https://issues.apache.org/jira/browse/DBCP-55</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;There are several circumstances where two different pieces of code can be &lt;br/&gt;
inadvertently sharing the same connection.  Obviously this is a serious &lt;br/&gt;
problem.  Oftentimes this manifests itself as an error about the connection &lt;br/&gt;
suddenly becoming closed, in an invalid state, etc.  Notice how often these &lt;br/&gt;
symptoms are reported in various forums when people start using connection &lt;br/&gt;
pools.&lt;/p&gt;

&lt;p&gt;In a transactional environment this can be especially serious since either of &lt;br/&gt;
the users of the connection may commit it while the other has made partial &lt;br/&gt;
updates.  This can easily lead to corruption of the database.&lt;/p&gt;

&lt;p&gt;Debugging this problem is especially difficult since it may only appear &lt;br/&gt;
intermittently and under load.  It can be very difficult to reproduce for &lt;br/&gt;
debugging.  This is even more of a problem when connections are closed in &lt;br/&gt;
finalize() methods (a common practice) because of their asynchronous and &lt;br/&gt;
delayed behavior.&lt;/p&gt;

&lt;p&gt;There is a fundamental architectural flaw which makes this all possible.  When &lt;br/&gt;
a pooled connection (e.g., org.apache.commons.dbcp.PoolableConnection) is &lt;br/&gt;
returned to the pool, the very same instance is later handed out.  Note that &lt;br/&gt;
this is not necessary for reuse of the underlying real connection (e.g.,  &lt;br/&gt;
java.sql.Connection).  A new wrapper class could be instantiated around the &lt;br/&gt;
existing real connection and the old one discarded.  Because the same wrapper &lt;br/&gt;
class instance is handed out multiple times, it makes it possible for &lt;br/&gt;
inadvertent sharing to occur.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: Windows XP&lt;br/&gt;
Platform: PC&lt;/p&gt;</environment>
        <key id="12340587">DBCP-55</key>
            <summary>Pooled connection architecture vulnerable to double use</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="4">Incomplete</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="flawlor@athensgroup.com">Frank Lawlor</reporter>
                        <labels>
                    </labels>
                <created>Thu, 6 Mar 2003 00:37:52 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:30 +0000</updated>
                            <resolved>Tue, 25 Mar 2008 08:11:30 +0000</resolved>
                                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12403790" author="mario@ops.co.at" created="Mon, 10 Mar 2003 04:50:23 +0000"  >&lt;p&gt;Created an attachment (id=5233)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;PATCH&amp;#93;&lt;/span&gt; I think this should be done fast, every closed connection instance should be invalid to the application.&lt;/p&gt;</comment>
                            <comment id="12403791" author="mario@ops.co.at" created="Mon, 10 Mar 2003 04:50:58 +0000"  >&lt;p&gt;Created an attachment (id=5234)&lt;br/&gt;
Needet after apply patch&lt;/p&gt;</comment>
                            <comment id="12403792" author="mario@ops.co.at" created="Mon, 10 Mar 2003 04:54:14 +0000"  >&lt;p&gt;The main idea behind my patch is to hand out only a ConnectionFacade. &lt;br/&gt;
When &quot;passivate&quot; the connection, the reference to the connection instance &lt;br/&gt;
within the ConnectionFacade is set to &quot;null&quot;&lt;br/&gt;
You could is isClosed() on the facade to safely check if this connection is &lt;br/&gt;
still valid.&lt;br/&gt;
isClosed() returns true if connection is null or connection isClosed()&lt;/p&gt;

&lt;p&gt;I havent had enough time to hardly test this, so please dont bother me if i &lt;br/&gt;
have something overseen.&lt;/p&gt;</comment>
                            <comment id="12403793" author="mario@ops.co.at" created="Fri, 14 Mar 2003 16:10:07 +0000"  >&lt;p&gt;Created an attachment (id=5334)&lt;br/&gt;
oops, my first patch has the wrong &quot;direction&quot;&lt;/p&gt;</comment>
                            <comment id="12403794" author="dgraham@apache.org" created="Mon, 24 Mar 2003 23:27:20 +0000"  >&lt;p&gt;&quot;Because the same wrapper &lt;/p&gt;


&lt;p&gt;class instance is handed out multiple times, it makes it possible for &lt;/p&gt;


&lt;p&gt;inadvertent sharing to occur.&quot;  This is exactly the way a pool should work so I &lt;br/&gt;
don&apos;t believe this is an architectural flaw.  Client code using the pool is &lt;br/&gt;
responsible for not sharing objects retrieved from the pool and returning them &lt;br/&gt;
to the pool ASAP.  Creating new wrapper objects on each request would lead to &lt;br/&gt;
performance degredation.&lt;/p&gt;</comment>
                            <comment id="12403795" author="mario@ops.co.at" created="Tue, 25 Mar 2003 00:26:30 +0000"  >&lt;p&gt;This is not true, if the pool has a function which automatically puts a &lt;br/&gt;
connection back into the pool.&lt;br/&gt;
This is, what this pool call an &quot;abandoned&quot; connection if an application do not &lt;br/&gt;
pass back the connection back within an specified time.&lt;/p&gt;

&lt;p&gt;Since not all programmers are perferct and not all programms are perfect, this &lt;br/&gt;
is a nice feature to prevent an db connection leak.&lt;/p&gt;

&lt;p&gt;But, if the connection is passed back to the pool, the object passed to the &lt;br/&gt;
application should never ever be valid.&lt;/p&gt;

&lt;p&gt;What, if the wrongly programmed thread which connection is passed back to the &lt;br/&gt;
pool, issues a &quot;commit&quot; while another thread is in the middle of an transaction?&lt;/p&gt;

&lt;p&gt;To the performance problem: If one uses abandoned connections, he/she has to &lt;br/&gt;
live with this performance gain. If i had a web application in mind, such &lt;br/&gt;
get/release is not very often and performance might not be a problem.&lt;/p&gt;

&lt;p&gt;Inconsistent Data is for sure a great problem.&lt;/p&gt;</comment>
                            <comment id="12403796" author="dgraham@apache.org" created="Tue, 25 Mar 2003 03:44:53 +0000"  >&lt;p&gt;Closing per commons-dev discussion.  It is up to the client code to not misuse &lt;br/&gt;
the pool.&lt;/p&gt;</comment>
                            <comment id="12403797" author="jmcnally" created="Sun, 1 Jun 2003 09:07:51 +0000"  >&lt;p&gt;I&apos;m not going to reopen this, but wanted to note that the jdbc2 specification&lt;br/&gt;
requires that a new Connection object be returned from a getConnection()&lt;br/&gt;
request.  commons.dbcp.jdbc2pool follows this specification.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12332169" name="ASF.LICENSE.NOT.GRANTED--ConnectionFacade.java" size="5159" author="mario@ops.co.at" created="Mon, 10 Mar 2003 04:50:58 +0000"/>
                            <attachment id="12332168" name="ASF.LICENSE.NOT.GRANTED--invalid_connection.patch" size="2071" author="mario@ops.co.at" created="Mon, 10 Mar 2003 04:50:23 +0000"/>
                            <attachment id="12332170" name="ASF.LICENSE.NOT.GRANTED--patch.txt" size="1859" author="mario@ops.co.at" created="Fri, 14 Mar 2003 16:10:07 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>17677</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114338</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            22 years, 24 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0v0of:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>179083</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-54] PreparedStatement cache should be different depending on the Catalog</title>
                <link>https://issues.apache.org/jira/browse/DBCP-54</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;When you use the setCatalog function there seesm to be an issue with the&lt;br/&gt;
PreparedStatement cache giving you cached statements corresponding to a&lt;br/&gt;
different database...&lt;/p&gt;

&lt;p&gt;Reproduction:&lt;/p&gt;

&lt;p&gt;0/ setup two databases (in my case it is mysql) with the same table with&lt;br/&gt;
different a different amount of lines in the table&lt;br/&gt;
1/ open a connection&lt;br/&gt;
2/ run a query to count number of lines of the table&lt;br/&gt;
3/ switch databases using setCatalog&lt;br/&gt;
4/ run the same query&lt;br/&gt;
5/ you get the same result as before (the result from the 1st database)&lt;/p&gt;

&lt;p&gt;Now if you do it the other way around, then you get the result from the second&lt;br/&gt;
database..&lt;br/&gt;
I believe the problem can only come from the prepared statement cache..&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: other&lt;br/&gt;
Platform: Other&lt;/p&gt;</environment>
        <key id="12341291">DBCP-54</key>
            <summary>PreparedStatement cache should be different depending on the Catalog</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="ludovic@pobox.com">Ludovic Dubost</reporter>
                        <labels>
                    </labels>
                <created>Thu, 26 Feb 2004 17:09:21 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:30 +0000</updated>
                            <resolved>Tue, 25 Mar 2008 08:11:30 +0000</resolved>
                                    <version>1.1</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12406086" author="ludovic@pobox.com" created="Thu, 26 Feb 2004 18:18:32 +0000"  >&lt;p&gt;Created an attachment (id=10566)&lt;br/&gt;
Patch taking account Catalog for the statement key&lt;/p&gt;</comment>
                            <comment id="12406087" author="ludovic@pobox.com" created="Thu, 26 Feb 2004 18:19:34 +0000"  >&lt;p&gt;My code works with this modification of the prepared statement key to take into&lt;br/&gt;
account the Catalog.. All tests are passing with this patch.&lt;/p&gt;

&lt;p&gt;Anybody want&apos;s to review it ?&lt;/p&gt;</comment>
                            <comment id="12406088" author="dirkv" created="Sun, 7 Mar 2004 23:32:24 +0000"  >&lt;p&gt;Patch applied + testcase written (see TestPStmtPoolingBasicDataSource)&lt;/p&gt;

&lt;p&gt;PoolingConnection   Revision : 1.14   Date : 2004/3/7&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12332760" name="ASF.LICENSE.NOT.GRANTED--PoolingConnection.patch" size="2837" author="ludovic@pobox.com" created="Thu, 26 Feb 2004 18:18:32 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>27246</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114337</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            21 years, 36 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uxrz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178613</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-52] unexpected &quot;exausted pool&quot; error</title>
                <link>https://issues.apache.org/jira/browse/DBCP-52</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;This is a repost of my bug submitted to Commons-Pool. I am not 100% positive &lt;br/&gt;
that it is Pool&apos;s problem and it affects DBCP users so I post it here too.&lt;br/&gt;
Please note that the problem only occure when using keyed pool &lt;br/&gt;
via getConnection(name, password).&lt;/p&gt;


&lt;p&gt;I have been having &quot;exausted pool&quot; problems while using DBCP. In reality there &lt;br/&gt;
were zero objects in the pool and I should not have gotten this error.&lt;br/&gt;
While testing I found out that problem seems to be in GenericKeyedObjectPool:&lt;br/&gt;
while total number of connections _totalActive is perfectly balanced by calls &lt;br/&gt;
to borrowObject and returnObject (and actually is zero)&lt;br/&gt;
number of active objects per keyed pool (I have only one) _activeMap.get(key)&lt;br/&gt;
does not get decremented properly under certain conditions. as a result  I have&lt;br/&gt;
_activeMap.get(key) greater then _totalActive. &lt;/p&gt;

&lt;p&gt;I put some debug output in borrow and return methods&lt;/p&gt;

&lt;p&gt;borrowObject() &lt;/p&gt;
{
&amp;lt;snip&amp;gt;
            }
&lt;p&gt; else {&lt;br/&gt;
                Integer active = (Integer)(_activeMap.get(key));&lt;br/&gt;
                if(null == active) &lt;/p&gt;
{
                    _activeMap.put(key,new Integer(1));
                }
&lt;p&gt; else &lt;/p&gt;
{
                    _activeMap.put(key,new Integer(active.intValue() + 1));
                }
&lt;p&gt;                System.out.println(&quot;BORROW: totalActive=&quot; + _totalActive + &quot;, &lt;br/&gt;
poolActive=&quot; + active);&lt;br/&gt;
                _totalActive++;&lt;br/&gt;
                return pair.value;&lt;br/&gt;
            }&lt;br/&gt;
        }&lt;br/&gt;
    }&lt;/p&gt;

&lt;p&gt;returnObject() {&lt;br/&gt;
&amp;lt;snip&amp;gt;&lt;br/&gt;
            System.out.println(&quot;RETURN: totalActive=&quot; + _totalActive + &quot;, &lt;br/&gt;
poolActive=&quot; + active);&lt;br/&gt;
            // if there&apos;s no space in the pool, flag the object&lt;br/&gt;
            // for destruction&lt;br/&gt;
            // else if we passivated succesfully, return it to the pool&lt;br/&gt;
            if(_maxIdle &amp;gt; 0 &amp;amp;&amp;amp; (pool.size() &amp;gt;= _maxIdle)) &lt;/p&gt;
{
                shouldDestroy = true;
            }
&lt;p&gt; else if(success) &lt;/p&gt;
{
                pool.addFirst(new ObjectTimestampPair(obj));
                _totalIdle++;
            }
&lt;p&gt;            notifyAll();&lt;br/&gt;
        }&lt;/p&gt;

&lt;p&gt;        if(shouldDestroy) {&lt;br/&gt;
            try &lt;/p&gt;
{
                _factory.destroyObject(key, obj);
            }
&lt;p&gt; catch(Exception e) &lt;/p&gt;
{
                // ignored?
            }
&lt;p&gt;        }&lt;br/&gt;
    }&lt;/p&gt;


&lt;p&gt;and got following output:&lt;/p&gt;

&lt;p&gt;BORROW: totalActive=0, poolActive=null&lt;br/&gt;
RETURN: totalActive=0, poolActive=1&lt;br/&gt;
BORROW: totalActive=0, poolActive=null&lt;br/&gt;
RETURN: totalActive=0, poolActive=null&lt;br/&gt;
BORROW: totalActive=0, poolActive=1&lt;br/&gt;
RETURN: totalActive=0, poolActive=null&lt;br/&gt;
BORROW: totalActive=0, poolActive=2&lt;br/&gt;
RETURN: totalActive=0, poolActive=null&lt;br/&gt;
BORROW: totalActive=0, poolActive=3&lt;br/&gt;
RETURN: totalActive=0, poolActive=null&lt;br/&gt;
BORROW: totalActive=0, poolActive=4&lt;br/&gt;
RETURN: totalActive=0, poolActive=null&lt;br/&gt;
BORROW: totalActive=0, poolActive=5&lt;br/&gt;
RETURN: totalActive=0, poolActive=null&lt;br/&gt;
BORROW: totalActive=0, poolActive=6&lt;br/&gt;
RETURN: totalActive=0, poolActive=null&lt;br/&gt;
BORROW: totalActive=0, poolActive=7&lt;br/&gt;
RETURN: totalActive=0, poolActive=null&lt;br/&gt;
BORROW: totalActive=0, poolActive=8&lt;br/&gt;
RETURN: totalActive=0, poolActive=null&lt;br/&gt;
BORROW: totalActive=0, poolActive=9&lt;br/&gt;
RETURN: totalActive=0, poolActive=null&lt;br/&gt;
BORROW: totalActive=0, poolActive=10&lt;br/&gt;
RETURN: totalActive=0, poolActive=null&lt;br/&gt;
BORROW: totalActive=0, poolActive=11&lt;br/&gt;
RETURN: totalActive=0, poolActive=null&lt;br/&gt;
BORROW: totalActive=0, poolActive=12&lt;br/&gt;
RETURN: totalActive=0, poolActive=null&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: other&lt;br/&gt;
Platform: Other&lt;/p&gt;</environment>
        <key id="12340343">DBCP-52</key>
            <summary>unexpected &quot;exausted pool&quot; error</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="roytmana@peacetech.com">Alex Roytman</reporter>
                        <labels>
                    </labels>
                <created>Tue, 1 Oct 2002 03:59:54 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:30 +0000</updated>
                            <resolved>Fri, 24 Nov 2006 20:45:36 +0000</resolved>
                                    <version>Nightly Builds</version>
                                                        <due></due>
                            <votes>1</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12403001" author="rwaldhof@us.britannica.com" created="Thu, 31 Oct 2002 08:26:07 +0000"  >&lt;p&gt;duplicate of 13235, yes?&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;
	&lt;ul&gt;
		&lt;li&gt;
		&lt;ul&gt;
			&lt;li&gt;This bug has been marked as a duplicate of 13235 ***&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>13155</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114336</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            23 years, 3 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uy6n:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178679</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-51] [dbcp] example .jocl in the docs contains errors</title>
                <link>https://issues.apache.org/jira/browse/DBCP-51</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;The example .jocl file contained in the docs at&lt;br/&gt;
&lt;a href=&quot;http://jakarta.apache.org/commons/dbcp/apidocs/org/apache/commons/dbcp/package-summary.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://jakarta.apache.org/commons/dbcp/apidocs/org/apache/commons/dbcp/package-summary.html&lt;/a&gt;&lt;br/&gt;
contains two errors: &lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;the reference to &quot;org.apache.commons.pool.StackKeyedObjectPoolFactory&quot; should&lt;br/&gt;
read &quot;org.apache.commons.pool.impl.StackKeyedObjectPoolFactory&quot; (the class is in&lt;br/&gt;
the &quot;impl&quot; subpackage)&lt;/li&gt;
	&lt;li&gt;the comment &quot;&amp;lt;;!-- validation query --&amp;gt;&quot; contains an invalid character &quot;;&quot;&lt;/li&gt;
&lt;/ul&gt;
</description>
                <environment>&lt;p&gt;Operating System: Windows XP&lt;br/&gt;
Platform: PC&lt;/p&gt;</environment>
        <key id="12341982">DBCP-51</key>
            <summary>[dbcp] example .jocl in the docs contains errors</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="jfrantzius">J&#246;rg von Frantzius</reporter>
                        <labels>
                    </labels>
                <created>Fri, 7 Jan 2005 01:19:11 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:30 +0000</updated>
                            <resolved>Tue, 25 Mar 2008 08:11:30 +0000</resolved>
                                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12408485" author="dirkv" created="Mon, 10 Jan 2005 06:54:54 +0000"  >&lt;p&gt;example in javadoc fixed&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>32966</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114335</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            20 years, 44 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0ux3j:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178503</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-50] Error in JOCL snippet in org.apache.commons.dbcp javadoc</title>
                <link>https://issues.apache.org/jira/browse/DBCP-50</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;The JavaDoc for org.apache.commons.dbcp contains an example JOCL snippet, this&lt;br/&gt;
has an error. The line:&lt;br/&gt;
   &amp;lt;object class=&quot;org.apache.commons.pool.StackKeyedObjectPoolFactory&quot;&amp;gt;&lt;br/&gt;
should read:&lt;br/&gt;
   &amp;lt;object class=&quot;org.apache.commons.pool.impl.StackKeyedObjectPoolFactory&quot;&amp;gt;&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: All&lt;br/&gt;
Platform: All&lt;/p&gt;</environment>
        <key id="12341647">DBCP-50</key>
            <summary>Error in JOCL snippet in org.apache.commons.dbcp javadoc</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="n.nicolson@kew.org">Nicky Nicolson</reporter>
                        <labels>
                    </labels>
                <created>Wed, 18 Aug 2004 17:01:44 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:30 +0000</updated>
                            <resolved>Tue, 25 Mar 2008 08:11:30 +0000</resolved>
                                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12407293" author="yoavs@computer.org" created="Sun, 22 Aug 2004 03:53:00 +0000"  >&lt;p&gt;Fixed, thank you.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>30721</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114334</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            21 years, 12 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uwm7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178425</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-49] race condition in PoolableConnection.close()</title>
                <link>https://issues.apache.org/jira/browse/DBCP-49</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;PoolableConnection.close() checks isClosed() but _closed=true is set (later) by&lt;br/&gt;
DelegatingConnection.passivate().&lt;/p&gt;

&lt;p&gt;It is therefore possible to &quot;close a connection&quot; more than once, numActive gets&lt;br/&gt;
decremented more than once, etc.&lt;/p&gt;

&lt;p&gt;isClosed() and _closed=true should be run atomically.&lt;/p&gt;

&lt;p&gt;I first thought of making the method synchronized, but this could cause&lt;br/&gt;
deadlocks, because AdandonedObjectPool.removeAbandoned(), which needs a lock on&lt;br/&gt;
the pool object, calls PoolableConnection.close().&lt;/p&gt;

&lt;p&gt;I therefore suppose the following patch:&lt;/p&gt;


&lt;p&gt;Index: PoolableConnection.java&lt;br/&gt;
===================================================================&lt;br/&gt;
RCS file:&lt;br/&gt;
/home/cvspublic/jakarta-commons/dbcp/src/java/org/apache/commons/dbcp/PoolableConnection.java,v&lt;br/&gt;
retrieving revision 1.5&lt;br/&gt;
diff -u -r1.5 PoolableConnection.java&lt;br/&gt;
&amp;#8212; PoolableConnection.java     1 Nov 2002 15:27:21 -0000       1.5&lt;br/&gt;
+++ PoolableConnection.java     12 Feb 2003 10:22:22 -0000&lt;br/&gt;
@@ -106,17 +106,19 @@&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Returns me to my pool.&lt;br/&gt;
      */&lt;br/&gt;
     public void close() throws SQLException {&lt;/li&gt;
&lt;/ul&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;if(isClosed()) 
{
-            throw new SQLException(&quot;Already closed.&quot;);
-        }
&lt;p&gt; else {&lt;/p&gt;&lt;/li&gt;
	&lt;li&gt;try 
{
-                _pool.returnObject(this);
-            }
&lt;p&gt; catch(SQLException e) &lt;/p&gt;
{
-                throw e;
-            } catch(RuntimeException e) {-                throw e;-            }
&lt;p&gt; catch(Exception e) {&lt;/p&gt;&lt;/li&gt;
	&lt;li&gt;throw new SQLException(e.toString());&lt;br/&gt;
+        synchronized (_pool) {&lt;br/&gt;
+            if (isClosed()) 
{
+                throw new SQLException(&quot;Already closed.&quot;);
+            }
&lt;p&gt; else &lt;/p&gt;
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {+                try {
+                    _pool.returnObject(this);
+                } catch (SQLException e) {
+                    throw e;
+                } catch (RuntimeException e) {+                    throw e;+                } catch (Exception e) {
+                    throw new SQLException(e.toString());
+                }             }&lt;/span&gt; &lt;/div&gt;
&lt;p&gt;         }&lt;br/&gt;
     }&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
</description>
                <environment>&lt;p&gt;Operating System: Linux&lt;br/&gt;
Platform: PC&lt;/p&gt;</environment>
        <key id="12340547">DBCP-49</key>
            <summary>race condition in PoolableConnection.close()</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="mic@schlund.de">Michael Salzmann</reporter>
                        <labels>
                    </labels>
                <created>Wed, 12 Feb 2003 18:41:21 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:30 +0000</updated>
                            <resolved>Fri, 24 Nov 2006 20:50:02 +0000</resolved>
                                                                        <due></due>
                            <votes>2</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12403613" author="mic@schlund.de" created="Thu, 13 Feb 2003 02:26:22 +0000"  >&lt;p&gt;A related problem:&lt;/p&gt;

&lt;p&gt;DelegatingConnection.isClosed() should be synchronized too.&lt;/p&gt;

&lt;p&gt;...which raises another problem:&lt;/p&gt;

&lt;p&gt;PoolableConnection.close() needs a lock on itself (and on _pool to avoid&lt;br/&gt;
deadlocks). I&apos;m afraid we need something like&lt;/p&gt;

&lt;p&gt;synchronized(_pool){&lt;br/&gt;
    synchronized(this) &lt;/p&gt;
{
...
    }
&lt;p&gt;}&lt;/p&gt;
</comment>
                            <comment id="12403614" author="rwaldhoff@apache.org" created="Sat, 15 Mar 2003 02:44:22 +0000"  >&lt;p&gt;I agree that there is a potential problem here, but it&apos;s not clear to me that &lt;br/&gt;
this patch fully addresses it.&lt;/p&gt;

&lt;p&gt;I think a cleanup of the DelegatingXXX stuff is in order, to restore it to &lt;br/&gt;
the &quot;pure proxy&quot; state (i.e., all DelegatingPreparedStatement does is pass all &lt;br/&gt;
calls down to the underlying PreparedStatement, etc.  Let subclasses of &lt;br/&gt;
DelegatingXXX deal with stuff like abandoned object detection, etc.)  With a &lt;br/&gt;
cleaner representation at that level, it may be easier to sort through some of &lt;br/&gt;
these thorny synchronization issues.&lt;/p&gt;</comment>
                            <comment id="12403615" author="dgraham@apache.org" created="Mon, 31 Mar 2003 08:23:26 +0000"  >&lt;p&gt;The javadoc for java.sql.Connection.close() say that closing a Connection that &lt;br/&gt;
has already been closed is a no-op.  Doesn&apos;t this implementation violate the &lt;br/&gt;
spec by throwing an SQLException?&lt;/p&gt;</comment>
                            <comment id="12403616" author="mohankishore@yahoo.com" created="Sat, 12 Apr 2003 08:59:17 +0000"  >&lt;p&gt;I didnt quite get the part about why we cant make the whole method &lt;br/&gt;
synchronized. Am appending two methods - wont this work?&lt;/p&gt;

&lt;p&gt;PoolableConnection:&lt;br/&gt;
    synchronized public void close() throws SQLException {&lt;br/&gt;
        if(isClosed()) &lt;/p&gt;
{
            // no-op
        }
&lt;p&gt; else {&lt;br/&gt;
            try &lt;/p&gt;
{
                _pool.returnObject(this);
            }
&lt;p&gt; catch(Exception e) &lt;/p&gt;
{
                // no-op
            }
&lt;p&gt;        }&lt;br/&gt;
    }&lt;/p&gt;


&lt;p&gt;GenericObjectPool:&lt;br/&gt;
    synchronized public void returnObject(Object obj) throws Exception {&lt;br/&gt;
        assertOpen();&lt;br/&gt;
        boolean shouldDestroy = false;&lt;br/&gt;
        if(_testOnReturn &amp;amp;&amp;amp; !(_factory.validateObject(obj))) &lt;/p&gt;
{
            shouldDestroy = true;
        }&lt;br/&gt;
        if((_maxIdle &amp;gt;= 0) &amp;amp;&amp;amp; (_pool.size() &amp;gt;= _maxIdle)) {            shouldDestroy = true;        }
&lt;p&gt;        try &lt;/p&gt;
{
            _factory.passivateObject(obj);
        }
&lt;p&gt; catch(Exception e) &lt;/p&gt;
{
            shouldDestroy = true;
        }

&lt;p&gt;        if(!shouldDestroy) &lt;/p&gt;
{
            _pool.addFirst(new ObjectTimestampPair(obj));
        }
&lt;p&gt; else {&lt;br/&gt;
            try &lt;/p&gt;
{
                _factory.destroyObject(obj);
            }
&lt;p&gt; catch(Exception e) &lt;/p&gt;
{
                // ignored
            }
&lt;p&gt;        }&lt;br/&gt;
        _numActive--;&lt;br/&gt;
        notifyAll(); // _numActive has changed&lt;br/&gt;
    }&lt;/p&gt;

&lt;p&gt;Am also going to attach the diff for comparision...&lt;/p&gt;</comment>
                            <comment id="12403617" author="mohankishore@yahoo.com" created="Sat, 12 Apr 2003 09:00:18 +0000"  >&lt;p&gt;Created an attachment (id=5810)&lt;br/&gt;
for PoolableConnection and GenericObjectPool&lt;/p&gt;</comment>
                            <comment id="12403618" author="mohankishore@yahoo.com" created="Wed, 16 Apr 2003 00:00:56 +0000"  >&lt;p&gt;Created an attachment (id=5839)&lt;br/&gt;
More changes to related test and cpds code&lt;/p&gt;</comment>
                            <comment id="12403619" author="mohankishore@yahoo.com" created="Wed, 16 Apr 2003 00:07:05 +0000"  >&lt;p&gt;Had submitted a patch which included making the close() method no-op when &lt;br/&gt;
called twice. Noticed that the test harness had a method called &lt;br/&gt;
CantCloseConnectionTwice - changed it to CanCloseConnectionTwice. Had to make &lt;br/&gt;
the CPDS ConnectionImpl&apos;s close() method conform to the no-op too.&lt;/p&gt;

&lt;p&gt;Admit that its slightly highjacking the original report. Maybe should open a &lt;br/&gt;
separate bug for these. btw, the problem also exists for Statement.close() &lt;br/&gt;
method - i.e. it should also be a no-op for a closed statement. Didnt find it &lt;br/&gt;
categorically stated for the ResultSet though...&lt;/p&gt;</comment>
                            <comment id="12403620" author="dirkv" created="Sun, 11 May 2003 21:38:13 +0000"  >&lt;p&gt;My 2 solutions for the race condition &lt;br/&gt;
(the no-op double close should be a different bugzilla entry IMHO)&lt;/p&gt;

&lt;p&gt;Solution 1:&lt;br/&gt;
------------&lt;br/&gt;
The race condition can be solved by using a pool that doesn&apos;t allow an object to&lt;br/&gt;
be returned in it twice. Subclassing GenericObjectPool will do the trick.&lt;br/&gt;
Changing the returnObject method in the following way will solve the problem.&lt;br/&gt;
Synchronizing on the returned object itself should be enough but _pool.contains&lt;br/&gt;
should be checked for thread safety. Maybe another _pool collection&lt;br/&gt;
implementation should be chosen. (for threading and/or speed)&lt;/p&gt;

&lt;p&gt;public void returnObject(Object obj) throws Exception {&lt;br/&gt;
    assertOpen();&lt;br/&gt;
    synchronized(obj) {&lt;br/&gt;
        if (_pool.contains(obj)) &lt;/p&gt;
{
            // do not returnObject to the pool when it is already in it
            return;
        }
&lt;p&gt;        boolean success = true;&lt;br/&gt;
...&lt;/p&gt;

&lt;p&gt;Solution 2:&lt;br/&gt;
------------&lt;br/&gt;
PoolableConnection:&lt;br/&gt;
    synchronized public void close() throws SQLException {&lt;/p&gt;

&lt;p&gt;This seems to be the the simplest solution, the _closed attribute is on the&lt;br/&gt;
connection object itself and doesn&apos;t depend on the pool for changing it&apos;s state&lt;br/&gt;
so I don&apos;t think a synchronization on the pool is needed.&lt;br/&gt;
Maybe I&apos;m overlooking something but I can&apos;t find any deadlock problems with this&lt;br/&gt;
solution.&lt;/p&gt;</comment>
                            <comment id="12403621" author="dirkv" created="Tue, 12 Aug 2003 07:13:08 +0000"  >&lt;p&gt;Applied solution 2&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12332138" name="ASF.LICENSE.NOT.GRANTED--Patch.txt" size="5623" author="mohankishore@yahoo.com" created="Wed, 16 Apr 2003 00:00:56 +0000"/>
                            <attachment id="12332137" name="ASF.LICENSE.NOT.GRANTED--Patch.txt" size="3159" author="mohankishore@yahoo.com" created="Sat, 12 Apr 2003 09:00:18 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>16987</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114333</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            22 years, 14 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uy4f:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178669</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-48] BasicDataSource cannot use many JDBC drivers</title>
                <link>https://issues.apache.org/jira/browse/DBCP-48</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;Many JDBC drivers (well, at least 2 that I use regularly) do not have a public &lt;br/&gt;
constructor, and therefore you can&apos;t call newInstance() on them (which &lt;br/&gt;
BasicDataSource.createDataSource() tries to do).  Drivers instantiate &lt;br/&gt;
themselves in a static {} block, as they are loaded and registered with driver &lt;br/&gt;
manager &amp;#8211; this is what the JavaDOC for javax.sql.Driver says they should do, &lt;br/&gt;
and every one I&apos;ve seen does do this... this is why they have private &lt;br/&gt;
constructors.&lt;/p&gt;

&lt;p&gt;The EASY solution is to replace this line (in createDataSource()):&lt;/p&gt;

&lt;p&gt;  driver = (Driver) driverClass.newInstance();&lt;/p&gt;

&lt;p&gt;with this one:&lt;/p&gt;

&lt;p&gt;  driver = DriverManager.getDriver(url);&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: All&lt;br/&gt;
Platform: All&lt;/p&gt;</environment>
        <key id="12340199">DBCP-48</key>
            <summary>BasicDataSource cannot use many JDBC drivers</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="james@interobjective.com">James House</reporter>
                        <labels>
                    </labels>
                <created>Thu, 4 Apr 2002 01:26:31 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:30 +0000</updated>
                            <resolved>Tue, 25 Mar 2008 08:11:30 +0000</resolved>
                                    <version>Nightly Builds</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12402590" author="craig.mcclanahan@sun.com" created="Sun, 21 Apr 2002 01:59:45 +0000"  >&lt;p&gt;Fixed in nightly build 20020421.  Verified that it works for Postgres.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>7728</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114332</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            23 years, 30 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uwhr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178405</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-47] [dbcp] Setting the defaultAutoCommit property to false breaks the MySQL DataSource</title>
                <link>https://issues.apache.org/jira/browse/DBCP-47</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;I&apos;m using the following datasource definition in Spring:&lt;/p&gt;

&lt;p&gt;	&amp;lt;bean id=&quot;dataSource&quot; class=&quot;org.apache.commons.dbcp.BasicDataSource&quot;&amp;gt;&lt;br/&gt;
		&amp;lt;property name=&quot;driverClassName&quot;&amp;gt;&amp;lt;value&amp;gt;${jdbc.driverClassName}&amp;lt;/value&amp;gt;&amp;lt;/property&amp;gt;&lt;br/&gt;
		&amp;lt;property name=&quot;url&quot;&amp;gt;&amp;lt;value&amp;gt;${jdbc.url}&amp;lt;/value&amp;gt;&amp;lt;/property&amp;gt;&lt;br/&gt;
		&amp;lt;property name=&quot;username&quot;&amp;gt;&amp;lt;value&amp;gt;${jdbc.username}&amp;lt;/value&amp;gt;&amp;lt;/property&amp;gt;&lt;br/&gt;
		&amp;lt;property name=&quot;password&quot;&amp;gt;&amp;lt;value&amp;gt;${jdbc.password}&amp;lt;/value&amp;gt;&amp;lt;/property&amp;gt;&lt;br/&gt;
	    &amp;lt;property name=&quot;maxActive&quot;&amp;gt;&amp;lt;value&amp;gt;8&amp;lt;/value&amp;gt;&amp;lt;/property&amp;gt;&lt;br/&gt;
	    &amp;lt;property name=&quot;maxIdle&quot;&amp;gt;&amp;lt;value&amp;gt;2&amp;lt;/value&amp;gt;&amp;lt;/property&amp;gt;&lt;br/&gt;
	    &amp;lt;property name=&quot;maxWait&quot;&amp;gt;&amp;lt;value&amp;gt;4000&amp;lt;/value&amp;gt;&amp;lt;/property&amp;gt;&lt;br/&gt;
	    &amp;lt;property name=&quot;defaultAutoCommit&quot;&amp;gt;&amp;lt;value&amp;gt;false&amp;lt;/value&amp;gt;&amp;lt;/property&amp;gt;&lt;br/&gt;
	    &amp;lt;property name=&quot;defaultTransactionIsolation&quot;&amp;gt;&amp;lt;value&amp;gt;2&amp;lt;/value&amp;gt;&amp;lt;/property&amp;gt;&lt;br/&gt;
	&amp;lt;/bean&amp;gt;&lt;/p&gt;

&lt;p&gt;When I comment out the &quot;defaultAutoCommit&quot; everything works fine. But when the&lt;br/&gt;
property is included a number of queries don&apos;t work. They don&apos;t return an error,&lt;br/&gt;
they just don&apos;t modify the database as they should.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: Windows 2000&lt;br/&gt;
Platform: PC&lt;/p&gt;</environment>
        <key id="12341958">DBCP-47</key>
            <summary>[dbcp] Setting the defaultAutoCommit property to false breaks the MySQL DataSource</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="5">Cannot Reproduce</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="jvdsandt@xs4all.nl">Jan</reporter>
                        <labels>
                    </labels>
                <created>Thu, 23 Dec 2004 17:37:46 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:30 +0000</updated>
                            <resolved>Mon, 10 Jul 2006 12:15:54 +0000</resolved>
                                    <version>1.2</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12408403" author="jvdsandt@xs4all.nl" created="Thu, 23 Dec 2004 17:39:16 +0000"  >&lt;p&gt;The jdbc properties are:&lt;/p&gt;

&lt;p&gt;jdbc.driverClassName=com.mysql.jdbc.Driver&lt;br/&gt;
jdbc.url=jdbc:mysql://localhost:3306/XXX&lt;br/&gt;
jdbc.username=developer&lt;br/&gt;
jdbc.password=XXX&lt;/p&gt;</comment>
                            <comment id="12408404" author="dirkv" created="Mon, 10 Jan 2005 07:01:49 +0000"  >&lt;p&gt;Do you (or the spring framework) call conn.commit() after the database update?&lt;br/&gt;
A small testcase would be helpfull to trace the problem.&lt;/p&gt;</comment>
                            <comment id="12419952" author="psteitz" created="Mon, 10 Jul 2006 12:15:54 +0000"  >&lt;p&gt;The behavior described is consistent with missing commit statements in user code.  &lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>32825</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114331</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            19 years, 18 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0v0rj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>179097</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-46] [DBCP] if connection closed twice *closed* connection is returned from the pool</title>
                <link>https://issues.apache.org/jira/browse/DBCP-46</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;As Daniel &amp;lt;daniel.bray@capetechnologies.com&amp;gt; has reported on commons-user&lt;/p&gt;

&lt;p&gt;DBC&amp;gt; If I &lt;br/&gt;
accidentally close DBCP connections twice, it will eventually cause the&lt;br/&gt;
DBC&amp;gt; JNDI datasource &lt;br/&gt;
to start returning connections that are already closed.&lt;/p&gt;

&lt;p&gt;I&apos;ve lost Daniels&apos; original &lt;br/&gt;
message, but the Subject was&lt;/p&gt;

&lt;p&gt;Subject: JNDI datasource returning &lt;b&gt;closed&lt;/b&gt; DBCP &lt;br/&gt;
connections&lt;/p&gt;

&lt;p&gt;The message was sent around late June-1 Aug 2003&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: other&lt;br/&gt;
Platform: Other&lt;/p&gt;</environment>
        <key id="12340881">DBCP-46</key>
            <summary>[DBCP] if connection closed twice *closed* connection is returned from the pool</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="tagunov@motor.ru">tagunov</reporter>
                        <labels>
                    </labels>
                <created>Sat, 2 Aug 2003 14:28:43 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:30 +0000</updated>
                            <resolved>Tue, 25 Mar 2008 08:11:30 +0000</resolved>
                                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12404780" author="dirkv" created="Sun, 10 Aug 2003 02:38:44 +0000"  >&lt;p&gt;Original mail from Daniel&lt;br/&gt;
--------------------------&lt;br/&gt;
If I accidentally close DBCP connections twice, it will eventually cause the&lt;br/&gt;
JNDI datasource to start returning connections that are already closed.&lt;/p&gt;

&lt;p&gt;Essentially my problem is this:&lt;/p&gt;

&lt;p&gt;while (true)&lt;br/&gt;
{&lt;br/&gt;
  DataSource ds = getDataSourceFromJNDI();&lt;br/&gt;
  Connection conn = ds.getConnection();&lt;br/&gt;
  PreparedStatement ps = conn.prepareStatement(&quot;SELECT * FROM ......&quot;);&lt;br/&gt;
  ResultSet rs = ps.executeQuery();&lt;/p&gt;

&lt;p&gt;  rs.close();&lt;br/&gt;
  ps.close();&lt;br/&gt;
  conn.close();&lt;/p&gt;

&lt;p&gt;  // make the mistake of closing it twice&lt;br/&gt;
  conn.close();&lt;br/&gt;
}&lt;/p&gt;

&lt;p&gt;Eventually getDataSourceFromJNDI() returns me a connection that&apos;s already&lt;br/&gt;
closed. In fact both it, and it&apos;s delegate, have the same object reference&lt;br/&gt;
IDs as the connections returned by the previous call.&lt;/p&gt;

&lt;p&gt;This only happens if I use the connection to do something, and not if I just&lt;br/&gt;
create it and then close it.&lt;/p&gt;

&lt;p&gt;I can always just wrap the connection in a proxy and then just not forward&lt;br/&gt;
on the close call if it&apos;s already been closed, but I figure that someone out&lt;br/&gt;
there might want to fix this properly and I can&apos;t find where I&apos;m supposed to&lt;br/&gt;
commit bugs.&lt;/p&gt;

&lt;p&gt;This sort of problem is best described in code, so I&apos;m attaching it below.&lt;br/&gt;
It&apos;s a simple enough servlet that exposes this problem.&lt;/p&gt;</comment>
                            <comment id="12404781" author="dirkv" created="Mon, 11 Aug 2003 19:07:47 +0000"  >&lt;p&gt;Created an attachment (id=7741)&lt;br/&gt;
example code&lt;/p&gt;</comment>
                            <comment id="12404782" author="dirkv" created="Wed, 13 Aug 2003 22:57:11 +0000"  >&lt;p&gt;Guard against pool misuse by wrapping a PoolGuardConnectionWrapper&lt;br/&gt;
around the PoolingConnection&lt;br/&gt;
(solution suggested by Daniel Bray)&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12332443" name="ASF.LICENSE.NOT.GRANTED--TestPoolableConnectionServlet.java" size="5897" author="dirkv" created="Mon, 11 Aug 2003 19:07:47 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>22079</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114330</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            22 years, 14 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uwef:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178390</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-45] validationQuery parameter hangs getConnection method.</title>
                <link>https://issues.apache.org/jira/browse/DBCP-45</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;I am using connection pool via the &quot;BasicDataSourceFactory.java&quot; in Tomcat &lt;br/&gt;
4.1.27 and MS SQL Server. I was having issues with having &quot;stale connections&quot; &lt;br/&gt;
because of the datbase dropping unused connections.&lt;/p&gt;

&lt;p&gt;TO fix this I added the validation query parameter with a query string to the &lt;br/&gt;
resource configuration but this causes the getConnection() withing &lt;br/&gt;
BasicDataSourceFactory to hang. It  is almost like a while(1) loop as no &lt;br/&gt;
exceptions are thrown.&lt;/p&gt;

&lt;p&gt;My server.xml snippet is below. If I remove the &quot;validationQuery&quot; parameter &lt;br/&gt;
everything works fine. Could somebody please point out what this issue is? Is &lt;br/&gt;
this a know bug? what is the workaround for this?&lt;br/&gt;
	&amp;lt;!-- Datasource config --&amp;gt;&lt;br/&gt;
	&amp;lt;Resource name=&quot;jdbc/TestDB&quot;&lt;br/&gt;
	               auth=&quot;Container&quot;&lt;br/&gt;
	               type=&quot;javax.sql.DataSource&quot;/&amp;gt;&lt;/p&gt;

&lt;p&gt;	  &amp;lt;ResourceParams name=&quot;jdbc/TestDB&quot;&amp;gt;&lt;br/&gt;
	    &amp;lt;parameter&amp;gt;&lt;br/&gt;
	      &amp;lt;name&amp;gt;factory&amp;lt;/name&amp;gt;&lt;br/&gt;
	      &amp;lt;value&amp;gt;org.apache.commons.dbcp.BasicDataSourceFactory&amp;lt;/value&amp;gt;&lt;br/&gt;
	    &amp;lt;/parameter&amp;gt;&lt;/p&gt;

&lt;p&gt;	    &amp;lt;!-- Maximum number of dB connections in pool. Make sure you&lt;br/&gt;
	         configure your mysqld max_connections large enough to handle&lt;br/&gt;
	         all of your db connections. Set to 0 for no limit.&lt;br/&gt;
	         --&amp;gt;&lt;br/&gt;
	    &amp;lt;parameter&amp;gt;&lt;br/&gt;
	      &amp;lt;name&amp;gt;maxActive&amp;lt;/name&amp;gt;&lt;br/&gt;
	      &amp;lt;value&amp;gt;100&amp;lt;/value&amp;gt;&lt;br/&gt;
	    &amp;lt;/parameter&amp;gt;&lt;/p&gt;

&lt;p&gt;	    &amp;lt;!-- Maximum number of idle dB connections to retain in pool.&lt;br/&gt;
	         Set to 0 for no limit.&lt;br/&gt;
	         --&amp;gt;&lt;br/&gt;
	    &amp;lt;parameter&amp;gt;&lt;br/&gt;
	      &amp;lt;name&amp;gt;maxIdle&amp;lt;/name&amp;gt;&lt;br/&gt;
	      &amp;lt;value&amp;gt;30&amp;lt;/value&amp;gt;&lt;br/&gt;
	    &amp;lt;/parameter&amp;gt;&lt;/p&gt;

&lt;p&gt;	    &amp;lt;!-- Maximum time to wait for a dB connection to become available&lt;br/&gt;
	         in ms, in this example 10 seconds. An Exception is thrown if&lt;br/&gt;
	         this timeout is exceeded.  Set to -1 to wait indefinitely.&lt;br/&gt;
	         --&amp;gt;&lt;br/&gt;
	    &amp;lt;parameter&amp;gt;&lt;br/&gt;
	      &amp;lt;name&amp;gt;maxWait&amp;lt;/name&amp;gt;&lt;br/&gt;
	      &amp;lt;value&amp;gt;10000&amp;lt;/value&amp;gt;&lt;br/&gt;
	    &amp;lt;/parameter&amp;gt;&lt;/p&gt;

&lt;p&gt;	    &amp;lt;!-- SQL server dB username and password for dB connections  --&amp;gt;&lt;br/&gt;
	    &amp;lt;parameter&amp;gt;&lt;br/&gt;
	     &amp;lt;name&amp;gt;username&amp;lt;/name&amp;gt;&lt;br/&gt;
	     &amp;lt;value&amp;gt;webapp&amp;lt;/value&amp;gt;&lt;br/&gt;
	    &amp;lt;/parameter&amp;gt;&lt;br/&gt;
	    &amp;lt;parameter&amp;gt;&lt;br/&gt;
	     &amp;lt;name&amp;gt;password&amp;lt;/name&amp;gt;&lt;br/&gt;
	     &amp;lt;value&amp;gt;webapp&amp;lt;/value&amp;gt;&lt;br/&gt;
	    &amp;lt;/parameter&amp;gt;&lt;br/&gt;
		&amp;lt;!-- valdationg query that will be run to validate a connection &lt;br/&gt;
object before returning&lt;br/&gt;
			helps avoid the &quot;stale conneciton&quot; issue.&lt;br/&gt;
		&amp;lt;parameter&amp;gt;&lt;br/&gt;
			&amp;lt;name&amp;gt;validationQuery&amp;lt;/name&amp;gt;&lt;br/&gt;
			&amp;lt;value&amp;gt;SELECT * FROM SEQUENCE_NUMBER&amp;lt;/value&amp;gt;&lt;br/&gt;
		&amp;lt;/parameter&amp;gt;&lt;br/&gt;
		--&amp;gt;&lt;/p&gt;

&lt;p&gt;	    &amp;lt;!-- Class name for SQL Server JDBC driver --&amp;gt;&lt;br/&gt;
	    &amp;lt;parameter&amp;gt;&lt;br/&gt;
	       &amp;lt;name&amp;gt;driverClassName&amp;lt;/name&amp;gt;&lt;br/&gt;
	       &amp;lt;value&amp;gt;com.microsoft.jdbc.sqlserver.SQLServerDriver&amp;lt;/value&amp;gt;&lt;br/&gt;
	    &amp;lt;/parameter&amp;gt;&lt;/p&gt;

&lt;p&gt;	    &amp;lt;!-- The JDBC connection url for connecting to your SQL dB.--&amp;gt;&lt;br/&gt;
	    &amp;lt;parameter&amp;gt;&lt;br/&gt;
	      &amp;lt;name&amp;gt;url&amp;lt;/name&amp;gt;&lt;/p&gt;

&lt;p&gt;&amp;lt;value&amp;gt;jdbc:microsoft:sqlserver://cgichi2klapsd:1433;SelectMethod=cursor;Databas&lt;br/&gt;
eName=nglic&amp;lt;/value&amp;gt;&lt;br/&gt;
	    &amp;lt;/parameter&amp;gt;&lt;br/&gt;
	  &amp;lt;/ResourceParams&amp;gt;&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: other&lt;br/&gt;
Platform: Other&lt;/p&gt;</environment>
        <key id="12340932">DBCP-45</key>
            <summary>validationQuery parameter hangs getConnection method.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="4">Incomplete</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="sudhir@myway.com">Sudhir</reporter>
                        <labels>
                    </labels>
                <created>Wed, 27 Aug 2003 03:46:21 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:29 +0000</updated>
                            <resolved>Tue, 25 Mar 2008 08:11:29 +0000</resolved>
                                    <version>1.0</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12404960" author="dirkv" created="Thu, 28 Aug 2003 00:02:04 +0000"  >&lt;p&gt;Please provide a thread dump with the &apos;kill -quit &amp;lt;pid&amp;gt;&apos; command in a Unix&lt;br/&gt;
environment, or with the CTRL+SHIFT+BREAK key combination in the command session&lt;br/&gt;
where the application is launched in a Windows environment.&lt;/p&gt;</comment>
                            <comment id="12404961" author="sudhir@myway.com" created="Thu, 28 Aug 2003 20:11:54 +0000"  >&lt;p&gt;I think I isolated the issue that was causing the thread to wait indefinitely.&lt;br/&gt;
I change the query from&lt;br/&gt;
SELECT (seq_policyid) FROM SEQUENCE_NUMBER&lt;br/&gt;
TO&lt;br/&gt;
SELECT MAX(seq_policyid) FROM SEQUENCE_NUMBER and that seemed to have solved &lt;br/&gt;
the issue.&lt;/p&gt;

&lt;p&gt;BUt could someone tell me what the issue here is?&lt;/p&gt;



&lt;p&gt;Here is the thread dump. The context I am running is &quot;/preneed&quot;.&lt;/p&gt;

&lt;p&gt;        at java.lang.Thread.run(Thread.java:536)&lt;/p&gt;

&lt;p&gt;&quot;Thread-5&quot; daemon prio=5 tid=0x0AF00830 nid=0x50c runnable &lt;span class=&quot;error&quot;&gt;&amp;#91;badf000..badfd8c&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at java.net.Inet4AddressImpl.getHostByAddr(Native Method)&lt;br/&gt;
        at java.net.InetAddress$1.getHostByAddr(InetAddress.java:722)&lt;br/&gt;
        at java.net.InetAddress.getHostFromNameService(InetAddress.java:464)&lt;br/&gt;
        at java.net.InetAddress.getHostName(InetAddress.java:407)&lt;br/&gt;
        at java.net.InetAddress.getHostName(InetAddress.java:379)&lt;br/&gt;
        at com.microsoft.jdbc.sqlserver.tds.TDSConnection.getLocalHostname(Unkno&lt;br/&gt;
wn Source)&lt;br/&gt;
        at com.microsoft.jdbc.sqlserver.tds.TDSLoginRequest.submitRequest(Unknow&lt;br/&gt;
n Source)&lt;br/&gt;
        at com.microsoft.jdbc.sqlserver.SQLServerImplConnection.open(Unknown Sou&lt;br/&gt;
rce)&lt;br/&gt;
        at com.microsoft.jdbc.base.BaseConnection.getNewImplConnection(Unknown S&lt;br/&gt;
ource)&lt;br/&gt;
        at com.microsoft.jdbc.base.BaseConnection.open(Unknown Source)&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;locked &amp;lt;02AD3DD8&amp;gt; (a com.microsoft.jdbc.sqlserver.SQLServerConnection)&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;        at com.microsoft.jdbc.base.BaseDriver.connect(Unknown Source)&lt;br/&gt;
        at org.apache.commons.dbcp.DriverConnectionFactory.createConnection(Driv&lt;br/&gt;
erConnectionFactory.java:83)&lt;br/&gt;
        at org.apache.commons.dbcp.PoolableConnectionFactory.makeObject(Poolable&lt;br/&gt;
ConnectionFactory.java:184)&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;locked &amp;lt;036668B8&amp;gt; (a org.apache.commons.dbcp.PoolableConnectionFactory&lt;br/&gt;
)&lt;br/&gt;
        at org.apache.commons.pool.impl.GenericObjectPool.borrowObject(Unknown S&lt;br/&gt;
ource)&lt;/li&gt;
	&lt;li&gt;locked &amp;lt;036668D8&amp;gt; (a org.apache.commons.dbcp.AbandonedObjectPool)&lt;br/&gt;
        at org.apache.commons.dbcp.AbandonedObjectPool.borrowObject(AbandonedObj&lt;br/&gt;
ectPool.java:117)&lt;/li&gt;
	&lt;li&gt;locked &amp;lt;036668D8&amp;gt; (a org.apache.commons.dbcp.AbandonedObjectPool)&lt;br/&gt;
        at org.apache.commons.dbcp.PoolingDataSource.getConnection(PoolingDataSo&lt;br/&gt;
urce.java:108)&lt;br/&gt;
        at org.apache.commons.dbcp.BasicDataSource.getConnection(BasicDataSource&lt;br/&gt;
.java:312)&lt;br/&gt;
        at nglic.webapp.utils.DAOUtils.getDBConnection(DAOUtils.java:84)&lt;br/&gt;
        at nglic.webapp.dao.UserDAO.getUser(UserDAO.java:51)&lt;br/&gt;
        at nglic.webapp.services.UserServicesImpl.authenticateUser(UserServicesI&lt;br/&gt;
mpl.java:159)&lt;br/&gt;
        at nglic.webapp.action.LoginAction.performAction(LoginAction.java:322)&lt;br/&gt;
        at nglic.webapp.action.BaseAction.execute(BaseAction.java:89)&lt;br/&gt;
        at org.apache.struts.action.RequestProcessor.processActionPerform(Reques&lt;br/&gt;
tProcessor.java:484)&lt;br/&gt;
        at org.apache.struts.action.RequestProcessor.process(RequestProcessor.ja&lt;br/&gt;
va:274)&lt;br/&gt;
        at org.apache.struts.action.ActionServlet.process(ActionServlet.java:148&lt;br/&gt;
0)&lt;br/&gt;
        at org.apache.struts.action.ActionServlet.doPost(ActionServlet.java:524)&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;        at javax.servlet.http.HttpServlet.service(HttpServlet.java:760)&lt;br/&gt;
        at javax.servlet.http.HttpServlet.service(HttpServlet.java:853)&lt;br/&gt;
        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(Appl&lt;br/&gt;
icationFilterChain.java:247)&lt;br/&gt;
        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationF&lt;br/&gt;
ilterChain.java:193)&lt;br/&gt;
        at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperV&lt;br/&gt;
alve.java:256)&lt;br/&gt;
        at org.apache.catalina.core.StandardPipeline$StandardPipelineValveContex&lt;br/&gt;
t.invokeNext(StandardPipeline.java:643)&lt;br/&gt;
        at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.jav&lt;br/&gt;
a:480)&lt;br/&gt;
        at org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:995)&lt;/p&gt;

&lt;p&gt;        at org.apache.catalina.core.StandardContextValve.invoke(StandardContextV&lt;br/&gt;
alve.java:191)&lt;br/&gt;
        at org.apache.catalina.core.StandardPipeline$StandardPipelineValveContex&lt;br/&gt;
t.invokeNext(StandardPipeline.java:643)&lt;br/&gt;
        at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.jav&lt;br/&gt;
a:480)&lt;br/&gt;
        at org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:995)&lt;/p&gt;

&lt;p&gt;        at org.apache.catalina.core.StandardContext.invoke(StandardContext.java:&lt;br/&gt;
2416)&lt;br/&gt;
        at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.j&lt;br/&gt;
ava:180)&lt;br/&gt;
        at org.apache.catalina.core.StandardPipeline$StandardPipelineValveContex&lt;br/&gt;
t.invokeNext(StandardPipeline.java:643)&lt;br/&gt;
        at org.apache.catalina.valves.ErrorDispatcherValve.invoke(ErrorDispatche&lt;br/&gt;
rValve.java:171)&lt;br/&gt;
        at org.apache.catalina.core.StandardPipeline$StandardPipelineValveContex&lt;br/&gt;
t.invokeNext(StandardPipeline.java:641)&lt;br/&gt;
        at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.j&lt;br/&gt;
ava:172)&lt;br/&gt;
        at org.apache.catalina.core.StandardPipeline$StandardPipelineValveContex&lt;br/&gt;
t.invokeNext(StandardPipeline.java:641)&lt;br/&gt;
        at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.jav&lt;br/&gt;
a:480)&lt;br/&gt;
        at org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:995)&lt;/p&gt;

&lt;p&gt;        at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineVal&lt;br/&gt;
ve.java:174)&lt;br/&gt;
        at org.apache.catalina.core.StandardPipeline$StandardPipelineValveContex&lt;br/&gt;
t.invokeNext(StandardPipeline.java:643)&lt;br/&gt;
        at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.jav&lt;br/&gt;
a:480)&lt;br/&gt;
        at org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:995)&lt;/p&gt;

&lt;p&gt;        at org.apache.coyote.tomcat4.CoyoteAdapter.service(CoyoteAdapter.java:22&lt;br/&gt;
3)&lt;br/&gt;
        at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java&lt;br/&gt;
:601)&lt;br/&gt;
        at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.proce&lt;br/&gt;
ssConnection(Http11Protocol.java:392)&lt;br/&gt;
        at org.apache.tomcat.util.net.TcpWorkerThread.runIt(PoolTcpEndpoint.java&lt;br/&gt;
:565)&lt;br/&gt;
        at org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run(ThreadP&lt;br/&gt;
ool.java:619)&lt;br/&gt;
        at java.lang.Thread.run(Thread.java:536)&lt;/p&gt;

&lt;p&gt;&quot;Thread-4&quot; daemon prio=5 tid=0x0AF552F0 nid=0x7b8 runnable &lt;span class=&quot;error&quot;&gt;&amp;#91;ba9f000..ba9fd8c&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at java.net.PlainSocketImpl.socketAccept(Native Method)&lt;br/&gt;
        at java.net.PlainSocketImpl.accept(PlainSocketImpl.java:353)&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;locked &amp;lt;03013110&amp;gt; (a java.net.PlainSocketImpl)&lt;br/&gt;
        at java.net.ServerSocket.implAccept(ServerSocket.java:439)&lt;br/&gt;
        at java.net.ServerSocket.accept(ServerSocket.java:410)&lt;br/&gt;
        at org.apache.tomcat.util.net.DefaultServerSocketFactory.acceptSocket(De&lt;br/&gt;
faultServerSocketFactory.java:107)&lt;br/&gt;
        at org.apache.tomcat.util.net.PoolTcpEndpoint.acceptSocket(PoolTcpEndpoi&lt;br/&gt;
nt.java:356)&lt;br/&gt;
        at org.apache.tomcat.util.net.TcpWorkerThread.runIt(PoolTcpEndpoint.java&lt;br/&gt;
:529)&lt;br/&gt;
        at org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run(ThreadP&lt;br/&gt;
ool.java:619)&lt;br/&gt;
        at java.lang.Thread.run(Thread.java:536)&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;&quot;Thread-3&quot; daemon prio=5 tid=0x0AF55198 nid=0x560 in Object.wait() [ba5f000..ba5&lt;br/&gt;
fd8c]&lt;br/&gt;
        at java.lang.Object.wait(Native Method)&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;waiting on &amp;lt;035842C8&amp;gt; (a org.apache.tomcat.util.threads.ThreadPool$Con&lt;br/&gt;
trolRunnable)&lt;br/&gt;
        at java.lang.Object.wait(Object.java:426)&lt;br/&gt;
        at org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run(ThreadP&lt;br/&gt;
ool.java:595)&lt;/li&gt;
	&lt;li&gt;locked &amp;lt;035842C8&amp;gt; (a org.apache.tomcat.util.threads.ThreadPool$Control&lt;br/&gt;
Runnable)&lt;br/&gt;
        at java.lang.Thread.run(Thread.java:536)&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;&quot;Thread-2&quot; daemon prio=5 tid=0x0AF55620 nid=0x85c in Object.wait() [ba1f000..ba1&lt;br/&gt;
fd8c]&lt;br/&gt;
        at java.lang.Object.wait(Native Method)&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;waiting on &amp;lt;03584340&amp;gt; (a org.apache.tomcat.util.threads.ThreadPool$Con&lt;br/&gt;
trolRunnable)&lt;br/&gt;
        at java.lang.Object.wait(Object.java:426)&lt;br/&gt;
        at org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run(ThreadP&lt;br/&gt;
ool.java:595)&lt;/li&gt;
	&lt;li&gt;locked &amp;lt;03584340&amp;gt; (a org.apache.tomcat.util.threads.ThreadPool$Control&lt;br/&gt;
Runnable)&lt;br/&gt;
        at java.lang.Thread.run(Thread.java:536)&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;&quot;HostConfig&lt;span class=&quot;error&quot;&gt;&amp;#91;localhost&amp;#93;&lt;/span&gt;&quot; daemon prio=5 tid=0x0AF54A40 nid=0x890 waiting on condit&lt;br/&gt;
ion &lt;span class=&quot;error&quot;&gt;&amp;#91;b9df000..b9dfd8c&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at java.lang.Thread.sleep(Native Method)&lt;br/&gt;
        at org.apache.catalina.startup.HostConfig.threadSleep(HostConfig.java:82&lt;br/&gt;
4)&lt;br/&gt;
        at org.apache.catalina.startup.HostConfig.run(HostConfig.java:848)&lt;br/&gt;
        at java.lang.Thread.run(Thread.java:536)&lt;/p&gt;

&lt;p&gt;&quot;StandardManager&lt;span class=&quot;error&quot;&gt;&amp;#91;/webdav&amp;#93;&lt;/span&gt;&quot; daemon prio=5 tid=0x0AF54010 nid=0x83c waiting on con&lt;br/&gt;
dition &lt;span class=&quot;error&quot;&gt;&amp;#91;b99f000..b99fd8c&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at java.lang.Thread.sleep(Native Method)&lt;br/&gt;
        at org.apache.catalina.session.StandardManager.threadSleep(StandardManag&lt;br/&gt;
er.java:810)&lt;br/&gt;
        at org.apache.catalina.session.StandardManager.run(StandardManager.java:&lt;br/&gt;
869)&lt;br/&gt;
        at java.lang.Thread.run(Thread.java:536)&lt;/p&gt;

&lt;p&gt;&quot;StandardManager&lt;span class=&quot;error&quot;&gt;&amp;#91;/tomcat-docs&amp;#93;&lt;/span&gt;&quot; daemon prio=5 tid=0x0ADF3B00 nid=0x51c waiting o&lt;br/&gt;
n condition &lt;span class=&quot;error&quot;&gt;&amp;#91;b95f000..b95fd8c&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at java.lang.Thread.sleep(Native Method)&lt;br/&gt;
        at org.apache.catalina.session.StandardManager.threadSleep(StandardManag&lt;br/&gt;
er.java:810)&lt;br/&gt;
        at org.apache.catalina.session.StandardManager.run(StandardManager.java:&lt;br/&gt;
869)&lt;br/&gt;
        at java.lang.Thread.run(Thread.java:536)&lt;/p&gt;

&lt;p&gt;&quot;StandardManager[]&quot; daemon prio=5 tid=0x0AE0A0C0 nid=0x7e4 waiting on condition&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;b91f000..b91fd8c&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at java.lang.Thread.sleep(Native Method)&lt;br/&gt;
        at org.apache.catalina.session.StandardManager.threadSleep(StandardManag&lt;br/&gt;
er.java:810)&lt;br/&gt;
        at org.apache.catalina.session.StandardManager.run(StandardManager.java:&lt;br/&gt;
869)&lt;br/&gt;
        at java.lang.Thread.run(Thread.java:536)&lt;/p&gt;

&lt;p&gt;&quot;StandardManager&lt;span class=&quot;error&quot;&gt;&amp;#91;/struts-example&amp;#93;&lt;/span&gt;&quot; daemon prio=5 tid=0x0AF4EB98 nid=0x7d8 waitin&lt;br/&gt;
g on condition &lt;span class=&quot;error&quot;&gt;&amp;#91;b8df000..b8dfd8c&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at java.lang.Thread.sleep(Native Method)&lt;br/&gt;
        at org.apache.catalina.session.StandardManager.threadSleep(StandardManag&lt;br/&gt;
er.java:810)&lt;br/&gt;
        at org.apache.catalina.session.StandardManager.run(StandardManager.java:&lt;br/&gt;
869)&lt;br/&gt;
        at java.lang.Thread.run(Thread.java:536)&lt;/p&gt;

&lt;p&gt;&quot;StandardManager&lt;span class=&quot;error&quot;&gt;&amp;#91;/struts-documentation&amp;#93;&lt;/span&gt;&quot; daemon prio=5 tid=0x0AE1A668 nid=0x88c&lt;br/&gt;
waiting on condition &lt;span class=&quot;error&quot;&gt;&amp;#91;b89f000..b89fd8c&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at java.lang.Thread.sleep(Native Method)&lt;br/&gt;
        at org.apache.catalina.session.StandardManager.threadSleep(StandardManag&lt;br/&gt;
er.java:810)&lt;br/&gt;
        at org.apache.catalina.session.StandardManager.run(StandardManager.java:&lt;br/&gt;
869)&lt;br/&gt;
        at java.lang.Thread.run(Thread.java:536)&lt;/p&gt;

&lt;p&gt;&quot;StandardManager&lt;span class=&quot;error&quot;&gt;&amp;#91;/manager&amp;#93;&lt;/span&gt;&quot; daemon prio=5 tid=0x0AE1A510 nid=0x3ac waiting on co&lt;br/&gt;
ndition &lt;span class=&quot;error&quot;&gt;&amp;#91;b85f000..b85fd8c&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at java.lang.Thread.sleep(Native Method)&lt;br/&gt;
        at org.apache.catalina.session.StandardManager.threadSleep(StandardManag&lt;br/&gt;
er.java:810)&lt;br/&gt;
        at org.apache.catalina.session.StandardManager.run(StandardManager.java:&lt;br/&gt;
869)&lt;br/&gt;
        at java.lang.Thread.run(Thread.java:536)&lt;/p&gt;

&lt;p&gt;&quot;StandardManager&lt;span class=&quot;error&quot;&gt;&amp;#91;/admin&amp;#93;&lt;/span&gt;&quot; daemon prio=5 tid=0x0AE1A3B8 nid=0x840 waiting on cond&lt;br/&gt;
ition &lt;span class=&quot;error&quot;&gt;&amp;#91;b81f000..b81fd8c&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at java.lang.Thread.sleep(Native Method)&lt;br/&gt;
        at org.apache.catalina.session.StandardManager.threadSleep(StandardManag&lt;br/&gt;
er.java:810)&lt;br/&gt;
        at org.apache.catalina.session.StandardManager.run(StandardManager.java:&lt;br/&gt;
869)&lt;br/&gt;
        at java.lang.Thread.run(Thread.java:536)&lt;/p&gt;

&lt;p&gt;&quot;StandardManager&lt;span class=&quot;error&quot;&gt;&amp;#91;/examples&amp;#93;&lt;/span&gt;&quot; daemon prio=5 tid=0x0AE1A260 nid=0x2ac waiting on c&lt;br/&gt;
ondition &lt;span class=&quot;error&quot;&gt;&amp;#91;b7df000..b7dfd8c&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at java.lang.Thread.sleep(Native Method)&lt;br/&gt;
        at org.apache.catalina.session.StandardManager.threadSleep(StandardManag&lt;br/&gt;
er.java:810)&lt;br/&gt;
        at org.apache.catalina.session.StandardManager.run(StandardManager.java:&lt;br/&gt;
869)&lt;br/&gt;
        at java.lang.Thread.run(Thread.java:536)&lt;/p&gt;

&lt;p&gt;&quot;WebappLoader&lt;span class=&quot;error&quot;&gt;&amp;#91;/examples&amp;#93;&lt;/span&gt;&quot; daemon prio=5 tid=0x0AD8A950 nid=0x860 waiting on cond&lt;br/&gt;
ition &lt;span class=&quot;error&quot;&gt;&amp;#91;b79f000..b79fd8c&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at java.lang.Thread.sleep(Native Method)&lt;br/&gt;
        at org.apache.catalina.loader.WebappLoader.threadSleep(WebappLoader.java&lt;br/&gt;
:1208)&lt;br/&gt;
        at org.apache.catalina.loader.WebappLoader.run(WebappLoader.java:1328)&lt;br/&gt;
        at java.lang.Thread.run(Thread.java:536)&lt;/p&gt;

&lt;p&gt;&quot;StandardManager&lt;span class=&quot;error&quot;&gt;&amp;#91;/preneed&amp;#93;&lt;/span&gt;&quot; daemon prio=5 tid=0x008E75C0 nid=0x678 waiting on co&lt;br/&gt;
ndition &lt;span class=&quot;error&quot;&gt;&amp;#91;b75f000..b75fd8c&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at java.lang.Thread.sleep(Native Method)&lt;br/&gt;
        at org.apache.catalina.session.StandardManager.threadSleep(StandardManag&lt;br/&gt;
er.java:810)&lt;br/&gt;
        at org.apache.catalina.session.StandardManager.run(StandardManager.java:&lt;br/&gt;
869)&lt;br/&gt;
        at java.lang.Thread.run(Thread.java:536)&lt;/p&gt;

&lt;p&gt;&quot;WebappLoader&lt;span class=&quot;error&quot;&gt;&amp;#91;/preneed&amp;#93;&lt;/span&gt;&quot; daemon prio=5 tid=0x0AD49DD8 nid=0x5b8 waiting on condi&lt;br/&gt;
tion &lt;span class=&quot;error&quot;&gt;&amp;#91;b71f000..b71fd8c&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at java.lang.Thread.sleep(Native Method)&lt;br/&gt;
        at org.apache.catalina.loader.WebappLoader.threadSleep(WebappLoader.java&lt;br/&gt;
:1208)&lt;br/&gt;
        at org.apache.catalina.loader.WebappLoader.run(WebappLoader.java:1328)&lt;br/&gt;
        at java.lang.Thread.run(Thread.java:536)&lt;/p&gt;

&lt;p&gt;&quot;Signal Dispatcher&quot; daemon prio=10 tid=0x008B5DC0 nid=0x638 waiting on condition&lt;br/&gt;
 &lt;span class=&quot;error&quot;&gt;&amp;#91;0..0&amp;#93;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&quot;Finalizer&quot; daemon prio=9 tid=0x008FF3E8 nid=0x318 in Object.wait() [ab4f000..ab&lt;br/&gt;
4fd8c]&lt;br/&gt;
        at java.lang.Object.wait(Native Method)&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;waiting on &amp;lt;02EE4E48&amp;gt; (a java.lang.ref.ReferenceQueue$Lock)&lt;br/&gt;
        at java.lang.ref.ReferenceQueue.remove(ReferenceQueue.java:111)&lt;/li&gt;
	&lt;li&gt;locked &amp;lt;02EE4E48&amp;gt; (a java.lang.ref.ReferenceQueue$Lock)&lt;br/&gt;
        at java.lang.ref.ReferenceQueue.remove(ReferenceQueue.java:127)&lt;br/&gt;
        at java.lang.ref.Finalizer$FinalizerThread.run(Finalizer.java:159)&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;&quot;Reference Handler&quot; daemon prio=10 tid=0x008FDF60 nid=0x310 in Object.wait() [ab&lt;br/&gt;
0f000..ab0fd8c]&lt;br/&gt;
        at java.lang.Object.wait(Native Method)&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;waiting on &amp;lt;02EE4EB0&amp;gt; (a java.lang.ref.Reference$Lock)&lt;br/&gt;
        at java.lang.Object.wait(Object.java:426)&lt;br/&gt;
        at java.lang.ref.Reference$ReferenceHandler.run(Reference.java:113)&lt;/li&gt;
	&lt;li&gt;locked &amp;lt;02EE4EB0&amp;gt; (a java.lang.ref.Reference$Lock)&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;&quot;main&quot; prio=5 tid=0x00235660 nid=0x52c runnable &lt;span class=&quot;error&quot;&gt;&amp;#91;6f000..6fc40&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at java.net.PlainSocketImpl.socketAccept(Native Method)&lt;br/&gt;
        at java.net.PlainSocketImpl.accept(PlainSocketImpl.java:353)&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;locked &amp;lt;035843E0&amp;gt; (a java.net.PlainSocketImpl)&lt;br/&gt;
        at java.net.ServerSocket.implAccept(ServerSocket.java:439)&lt;br/&gt;
        at java.net.ServerSocket.accept(ServerSocket.java:410)&lt;br/&gt;
        at org.apache.catalina.core.StandardServer.await(StandardServer.java:527&lt;br/&gt;
)&lt;br/&gt;
        at org.apache.catalina.startup.Catalina.start(Catalina.java:521)&lt;br/&gt;
        at org.apache.catalina.startup.Catalina.execute(Catalina.java:400)&lt;br/&gt;
        at org.apache.catalina.startup.Catalina.process(Catalina.java:180)&lt;br/&gt;
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&lt;br/&gt;
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.&lt;br/&gt;
java:39)&lt;br/&gt;
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAcces&lt;br/&gt;
sorImpl.java:25)&lt;br/&gt;
        at java.lang.reflect.Method.invoke(Method.java:324)&lt;br/&gt;
        at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:203)&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;&quot;VM Thread&quot; prio=5 tid=0x008FCD28 nid=0x5b4 runnable&lt;/p&gt;

&lt;p&gt;&quot;VM Periodic Task Thread&quot; prio=10 tid=0x008B4958 nid=0x3d0 waiting on condition&lt;/p&gt;

&lt;p&gt;&quot;Suspend Checker Thread&quot; prio=10 tid=0x008B53D8 nid=0x2a4 runnable&lt;/p&gt;</comment>
                            <comment id="12404962" author="dirkv" created="Fri, 29 Aug 2003 23:42:33 +0000"  >&lt;p&gt;Stacktrace shows normal connect.&lt;br/&gt;
Problem was an invalid query so I&apos;m marking this issue invalid.&lt;/p&gt;

&lt;p&gt;Database specific issue are best discussed on commons-user and recorded on the wiki.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>22736</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114329</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            22 years, 11 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0v0nz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>179081</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-44] [dbcp] Evictor thread in GenericObjectPool has potential for deadlock</title>
                <link>https://issues.apache.org/jira/browse/DBCP-44</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;The GenericObjectPool Evictor thread can potentially cause a deadlock between&lt;br/&gt;
its connection factory and java.sql.DriverManager.  The deadlock occurs when the&lt;br/&gt;
Evictor thread is trying to make enough connections to bring the pool&apos;s idle&lt;br/&gt;
connections up to what&apos;s specified in minIdle, at the same time a connection is&lt;br/&gt;
being requested through DriverManager.getConnection().  See the attached stack&lt;br/&gt;
trace dump:&lt;/p&gt;

&lt;p&gt;Found one Java-level deadlock:&lt;br/&gt;
=============================&lt;br/&gt;
&quot;Thread-0&quot;:&lt;br/&gt;
  waiting to lock monitor 0x0809a994 (object 0x698c2b48, a java.lang.Class),&lt;br/&gt;
  which is held by &quot;main&quot;&lt;br/&gt;
&quot;main&quot;:&lt;br/&gt;
  waiting to lock monitor 0x0809aad4 (object 0x65df7030, a&lt;br/&gt;
org.apache.commons.dbcp.PoolableConnectionFactory),&lt;br/&gt;
  which is held by &quot;Thread-0&quot;&lt;/p&gt;

&lt;p&gt;Java stack information for the threads listed above:&lt;br/&gt;
===================================================&lt;br/&gt;
&quot;Thread-0&quot;:&lt;br/&gt;
        at java.sql.DriverManager.getConnection(DriverManager.java:158)&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;waiting to lock &amp;lt;0x698c2b48&amp;gt; (a java.lang.Class)&lt;br/&gt;
        at&lt;br/&gt;
org.apache.commons.dbcp.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:48)&lt;br/&gt;
        at&lt;br/&gt;
org.apache.commons.dbcp.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:290)&lt;/li&gt;
	&lt;li&gt;locked &amp;lt;0x65df7030&amp;gt; (a org.apache.commons.dbcp.PoolableConnectionFactory)&lt;br/&gt;
        at&lt;br/&gt;
org.apache.commons.pool.impl.GenericObjectPool.addObject(GenericObjectPool.java:996)&lt;br/&gt;
        at&lt;br/&gt;
org.apache.commons.pool.impl.GenericObjectPool.ensureMinIdle(GenericObjectPool.java:978)&lt;br/&gt;
        at&lt;br/&gt;
org.apache.commons.pool.impl.GenericObjectPool.access$000(GenericObjectPool.java:124)&lt;br/&gt;
        at&lt;br/&gt;
org.apache.commons.pool.impl.GenericObjectPool$Evictor.run(GenericObjectPool.java:1090)&lt;br/&gt;
        at java.lang.Thread.run(Thread.java:595)&lt;br/&gt;
&quot;main&quot;:&lt;br/&gt;
        at&lt;br/&gt;
org.apache.commons.dbcp.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:290)&lt;/li&gt;
	&lt;li&gt;waiting to lock &amp;lt;0x65df7030&amp;gt; (a&lt;br/&gt;
org.apache.commons.dbcp.PoolableConnectionFactory)&lt;br/&gt;
        at&lt;br/&gt;
org.apache.commons.pool.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:771)&lt;br/&gt;
        at org.apache.commons.dbcp.PoolingDriver.connect(PoolingDriver.java:175)&lt;br/&gt;
        at java.sql.DriverManager.getConnection(DriverManager.java:525)&lt;/li&gt;
	&lt;li&gt;locked &amp;lt;0x698c2b48&amp;gt; (a java.lang.Class)&lt;br/&gt;
        at java.sql.DriverManager.getConnection(DriverManager.java:193)&lt;/li&gt;
	&lt;li&gt;locked &amp;lt;0x698c2b48&amp;gt; (a java.lang.Class)&lt;br/&gt;
        at Deadlock.main(Deadlock.java:83)&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Found 1 deadlock.&lt;/p&gt;


&lt;p&gt;The deadlock occurs when GenericObjectPool.addObject() calls synchronized method&lt;br/&gt;
PoolableConnectionFactory.makeObject(), meanwhile static synchronized&lt;br/&gt;
DriverManager.getConnection() is called.  makeObject() waits for the lock on&lt;br/&gt;
DriverManager to be released, whereas DriverManager waits for the lock on the&lt;br/&gt;
PoolableConnectionFactory instance to be released.&lt;/p&gt;

&lt;p&gt;The Java program below, based on ManualPoolingDriverExample.java provided with&lt;br/&gt;
DBCP, duplicates the deadlock for me within several seconds of being run:&lt;/p&gt;

&lt;p&gt;import java.sql.*;&lt;br/&gt;
import org.apache.commons.pool.*;&lt;br/&gt;
import org.apache.commons.pool.impl.*;&lt;br/&gt;
import org.apache.commons.dbcp.*;&lt;/p&gt;

&lt;p&gt;/**&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Duplicate DBCP pool deadlocking.&lt;br/&gt;
 *&lt;/li&gt;
	&lt;li&gt;Compile with:&lt;/li&gt;
	&lt;li&gt;/usr/java/jdk1.5.0/bin/javac&lt;/li&gt;
	&lt;li&gt;-classpath commons-collections.jar:commons-dbcp-1.2.1.jar:commons-pool-1.2.jar&lt;/li&gt;
	&lt;li&gt;Deadlock.java&lt;br/&gt;
 *&lt;/li&gt;
	&lt;li&gt;Run with:&lt;/li&gt;
	&lt;li&gt;/usr/java/jdk1.5.0/bin/java&lt;/li&gt;
	&lt;li&gt;-classpath&lt;br/&gt;
commons-collections.jar:commons-dbcp-1.2.1.jar:commons-pool-1.2.jar:ojdbc14.jar:xerces.jar:.&lt;/li&gt;
	&lt;li&gt;Deadlock&lt;br/&gt;
 *&lt;/li&gt;
	&lt;li&gt;Locks still occur when compiled and run with J2SDK 1.4.1_03.&lt;br/&gt;
 */&lt;br/&gt;
public class Deadlock {&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;        private static final int ACTIVE = 10;&lt;/p&gt;

&lt;p&gt;        private static void init() {&lt;br/&gt;
                System.out.println(&quot;Loading drivers&quot;);&lt;/p&gt;

&lt;p&gt;                try &lt;/p&gt;
{
                    Class.forName(&quot;oracle.jdbc.driver.OracleDriver&quot;);
                        Class.forName(&quot;org.apache.commons.dbcp.PoolingDriver&quot;);
                }
&lt;p&gt; catch (ClassNotFoundException e) &lt;/p&gt;
{
                    e.printStackTrace();
                }&lt;br/&gt;
 &lt;br/&gt;
                System.out.println(&quot;Setting up pool&quot;);&lt;br/&gt;
 &lt;br/&gt;
                try {
                        GenericObjectPool.Config config = new
GenericObjectPool.Config();
                        config.maxActive = ACTIVE;
                        config.minIdle = 2; // Idle limits are low to allow more
possibility of locking.
                        config.maxIdle = 4; // Locking only occurs when there
are 0 idle connections in the pool.
                        config.maxWait = 5000L;
                        config.testOnBorrow = true;
                        config.testOnReturn = false;
                        config.testWhileIdle = true;
                                // Locking still occurs whether these tests are
performed or not.
                        config.whenExhaustedAction =
GenericObjectPool.WHEN_EXHAUSTED_BLOCK;
                                // Locking still occurs regardless of the
exhausted action.
                        config.timeBetweenEvictionRunsMillis = 3000L; // The
Evictor thread is involved in the lock, so run it quite often.
                        config.minEvictableIdleTimeMillis = 6000L;
                        config.numTestsPerEvictionRun = 3;
 
                        ObjectPool op = new GenericObjectPool(null, config);
 
                        ConnectionFactory cf = new
DriverManagerConnectionFactory(&quot;jdbc:oracle:thin:@oracle8server:1521:sid&quot;,
&quot;username&quot;, &quot;password&quot;);
                        PoolableConnectionFactory pcf = new
PoolableConnectionFactory(cf, op, null, &quot;SELECT 1 FROM DUAL&quot;, false, true);
                                // Locking still occurs whether there is a
validation query or not.
 
                        PoolingDriver pd =
(PoolingDriver)DriverManager.getDriver(&quot;jdbc:apache:commons:dbcp:&quot;);
                        pd.registerPool(&quot;PoolName&quot;, op);
 
                } catch (SQLException e) {                    e.printStackTrace();                }

&lt;p&gt;                System.out.println(&quot;Done&quot;);&lt;br/&gt;
        }&lt;/p&gt;


&lt;p&gt;        public static void main(String[] args) {&lt;br/&gt;
                init();&lt;/p&gt;

&lt;p&gt;                Connection[] c = new Connection&lt;span class=&quot;error&quot;&gt;&amp;#91;ACTIVE&amp;#93;&lt;/span&gt;;&lt;/p&gt;

&lt;p&gt;                try {&lt;br/&gt;
                        printPoolStatus();&lt;/p&gt;

&lt;p&gt;                        // Loop forever to create a high load.&lt;br/&gt;
                        while (true) {&lt;br/&gt;
                                // Create a number of connections.&lt;br/&gt;
                                for (int i = 0; i &amp;lt; ACTIVE; ++i) &lt;/p&gt;
{
                                        c[i] =
DriverManager.getConnection(&quot;jdbc:apache:commons:dbcp:PoolName&quot;);
                                        printPoolStatus();
                                }
&lt;p&gt;                                // Then immmediately drop them.&lt;br/&gt;
                                for (int i = 0; i &amp;lt; ACTIVE; ++i) {&lt;br/&gt;
                                        try {&lt;br/&gt;
                                                if (c&lt;span class=&quot;error&quot;&gt;&amp;#91;i&amp;#93;&lt;/span&gt; != null) &lt;/p&gt;
{
                                                        c[i].close();
                                                        printPoolStatus();
                                                        c[i] = null;
                                                }
&lt;p&gt;                                        } catch (SQLException e) &lt;/p&gt;
{
                                                e.printStackTrace();
                                        }
&lt;p&gt;                                }&lt;br/&gt;
                        }&lt;/p&gt;

&lt;p&gt;                } catch (SQLException e) &lt;/p&gt;
{
                        e.printStackTrace();
 
                }
&lt;p&gt; finally {&lt;br/&gt;
                        // Close down any open connetions.&lt;br/&gt;
                        for (int i = 0; i &amp;lt; ACTIVE; ++i) {&lt;br/&gt;
                                try &lt;/p&gt;
{
                                        if (c[i] != null) c[i].close();
                                }
&lt;p&gt; catch (SQLException e) { }&lt;br/&gt;
                        }&lt;/p&gt;

&lt;p&gt;                        System.out.println(&quot;Closing pool&quot;);&lt;br/&gt;
                        try &lt;/p&gt;
{
                                PoolingDriver pd =
(PoolingDriver)DriverManager.getDriver(&quot;jdbc:apache:commons:dbcp:&quot;);
                                pd.closePool(&quot;PoolName&quot;);
                        }
&lt;p&gt; catch (SQLException e) &lt;/p&gt;
{
                                e.printStackTrace();
                        }
&lt;p&gt;                        System.out.println(&quot;Pool closed&quot;);&lt;br/&gt;
                }&lt;/p&gt;

&lt;p&gt;        }&lt;/p&gt;


&lt;p&gt;        /**&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Display pool status.  Locks still occur even if this method is never&lt;br/&gt;
called.&lt;br/&gt;
         */&lt;br/&gt;
        private static void printPoolStatus() throws SQLException 
{
                PoolingDriver pd =
(PoolingDriver)DriverManager.getDriver(&quot;jdbc:apache:commons:dbcp:&quot;);
                ObjectPool op = pd.getConnectionPool(&quot;PoolName&quot;);
 
                System.out.println(&quot;Active / idle: &quot; + op.getNumActive() + &quot; / &quot;
+ op.getNumIdle());
        }&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;}&lt;/p&gt;


&lt;p&gt;The patch I initially suggest is as follows (sorry for not providing a diff):&lt;/p&gt;

&lt;p&gt;In org.apache.commons.dbcp.PoolableConnectionFactory.java we have:&lt;/p&gt;

&lt;p&gt;    synchronized public Object makeObject() throws Exception {&lt;br/&gt;
        Connection conn = _connFactory.createConnection();&lt;br/&gt;
        if(null != _stmtPoolFactory) &lt;/p&gt;
{
            KeyedObjectPool stmtpool = _stmtPoolFactory.createPool();
            conn = new PoolingConnection(conn,stmtpool);
            stmtpool.setFactory((PoolingConnection)conn);
        }
&lt;p&gt;        return new PoolableConnection(conn,_pool,_config);&lt;br/&gt;
    }&lt;/p&gt;

&lt;p&gt;I suggest changing that to this:&lt;br/&gt;
    public Object makeObject() throws Exception {&lt;br/&gt;
        Connection conn = _connFactory.createConnection();&lt;br/&gt;
        synchronized (this) {&lt;br/&gt;
            if(null != _stmtPoolFactory) &lt;/p&gt;
{
                KeyedObjectPool stmtpool = _stmtPoolFactory.createPool();
                conn = new PoolingConnection(conn,stmtpool);
                stmtpool.setFactory((PoolingConnection)conn);
            }
&lt;p&gt;            return new PoolableConnection(conn,_pool,_config);&lt;br/&gt;
        }&lt;br/&gt;
    }&lt;/p&gt;


&lt;p&gt;Note the move of the synchronized block from the entire method to within the&lt;br/&gt;
method after the connection (obtained ultimately by DriverManager) is retrieved.&lt;/p&gt;

&lt;p&gt;I&apos;m afraid I don&apos;t know enough about DBCP and pooling to know the full&lt;br/&gt;
ramification of this change and other calls to makeObject().&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: All&lt;br/&gt;
Platform: All&lt;/p&gt;</environment>
        <key id="12342100">DBCP-44</key>
            <summary>[dbcp] Evictor thread in GenericObjectPool has potential for deadlock</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="3">Duplicate</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="elayton@novell.com">Eric Layton</reporter>
                        <labels>
                    </labels>
                <created>Wed, 9 Mar 2005 04:47:18 +0000</created>
                <updated>Mon, 15 Feb 2010 04:18:55 +0000</updated>
                            <resolved>Sun, 5 Apr 2009 22:38:30 +0000</resolved>
                                    <version>1.2.1</version>
                                    <fixVersion>1.3</fixVersion>
                                        <due></due>
                            <votes>4</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="12408849" author="dmarshall@vmsystems.net" created="Fri, 6 May 2005 20:09:00 +0000"  >&lt;p&gt;I&apos;ve encountered the same deadlock and have a couple of additional comments: the&lt;br/&gt;
bug is only when using PoolingDriver and a setting of minIdle &amp;gt; 0 in the&lt;br/&gt;
GenericObjectPool configuration.&lt;/p&gt;

&lt;p&gt;Suggested interim workarounds:&lt;br/&gt;
a) set minIdle = 0 in your configuration for the GenericObjectPool&lt;br/&gt;
b) if you know you are connection pooling within the application code, retrieve&lt;br/&gt;
a connection as follows:&lt;br/&gt;
    ObjectPool connectionPool = poolingDriver.getConnectionPool(name);&lt;br/&gt;
    Connection conn = (Connection)connectionPool.borrowObject();&lt;br/&gt;
This second method will allow you to have minIdle &amp;gt; 0 while avoiding the&lt;br/&gt;
deadlock code path between threads.&lt;/p&gt;</comment>
                            <comment id="12452481" author="psteitz" created="Fri, 24 Nov 2006 15:40:15 +0000"  >&lt;p&gt;Deadlock after suggested patch, generated by testConcurrency unit test&lt;/p&gt;</comment>
                            <comment id="12452482" author="psteitz" created="Fri, 24 Nov 2006 15:41:13 +0000"  >&lt;p&gt;Deadlock generated by testConcurrency&lt;/p&gt;</comment>
                            <comment id="12452484" author="psteitz" created="Fri, 24 Nov 2006 15:42:28 +0000"  >&lt;p&gt;Unit test generating deadlock using dbcp testDriver&lt;/p&gt;</comment>
                            <comment id="12452485" author="psteitz" created="Fri, 24 Nov 2006 15:52:09 +0000"  >&lt;p&gt;Like &lt;a href=&quot;https://issues.apache.org/jira/browse/DBCP-65&quot; title=&quot;[dbcp] Deadlock when evicting dbcp objects (testWhileIdle=true)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DBCP-65&quot;&gt;&lt;del&gt;DBCP-65&lt;/del&gt;&lt;/a&gt;, I don&apos;t think there is a backward compatible way to fix this bug.  The workaround suggested above (access the pool directly) is not pretty, but should avoid the deadlock. &lt;br/&gt;
I have attached a test case that will generate the deadlock using the dbcp test drivers.  The loop is bounded, so deadlock may not always happen.  Use ctrl-break (I think) under Windows or ctrl \ on unix command line to generate thread dump once the test case hangs.&lt;br/&gt;
I am moving this out to 1.3 fix version, at which time we will have to change either a) the pool impl or b) the way we dbcp uses the pool (see &lt;a href=&quot;http://issues.apache.org/jira/browse/DBCP-65#action_12451390&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/browse/DBCP-65#action_12451390&lt;/a&gt;).&lt;/p&gt;</comment>
                            <comment id="12460095" author="psteitz" created="Thu, 21 Dec 2006 00:39:23 +0000"  >&lt;p&gt;After looking at the deadlock traces and analyzing the code some more, I think that the root of the problem in this case is contention for the DriverManager.  The DriverManager methods in the traces are static synchronized.  What is going on is that direct client calls to DriverManager.getConnection immediately acquire the static lock on this class and then use PoolingDriver, which needs to lock the pool.  The pool Timer locks the pool and tries to use the DriverManager to access the the jdbc driver to create a new concrete connection, but can&apos;t acquire the static lock on DriverManager.  The order of locks here is beyond control of dbcp.   So, unless and until the Timer mechanism of pool is reworked somehow, I don&apos;t think this can be fixed.  &lt;/p&gt;

&lt;p&gt;The workaround is to either disable the pool Timer or avoid using the DriverManager as a client with PoolingDriver.&lt;/p&gt;</comment>
                            <comment id="12466859" author="bayard" created="Tue, 23 Jan 2007 23:53:43 +0000"  >&lt;p&gt;Should we make a Pool issue for this?&lt;/p&gt;</comment>
                            <comment id="12514350" author="dain" created="Fri, 20 Jul 2007 21:58:55 +0000"  >&lt;p&gt;This is an architectural problem in commons-pool.  GenericObjectPool.borrowObject() is synchronized so when it needs to make a new object, that method is called within a synchronized block.  Here are the stack traces of the deal lock in our case:&lt;/p&gt;

&lt;p&gt;main@1, priority=5, in group &apos;main&apos;, status: &apos;MONITOR&apos;&lt;br/&gt;
	 blocks Timer-0@fc&lt;br/&gt;
	 waiting for Timer-0@fc&lt;br/&gt;
	  borrowObject():781, GenericObjectPool.java&lt;br/&gt;
	  connect():176, PoolingDriver.java&lt;br/&gt;
	  getConnection():525, DriverManager.java&lt;br/&gt;
	  getConnection():140, DriverManager.java&lt;br/&gt;
	  main():107, Deadlock.java&lt;/p&gt;

&lt;p&gt;Timer-0@fc daemon, priority=5, in group &apos;main&apos;, status: &apos;MONITOR&apos;&lt;br/&gt;
	 blocks main@1&lt;br/&gt;
	 waiting for main@1&lt;br/&gt;
	  getConnection():138, DriverManager.java&lt;br/&gt;
	  createConnection():68, DriverManagerConnectionFactory.java&lt;br/&gt;
	  makeObject():329, PoolableConnectionFactory.java&lt;br/&gt;
	  addObject():1059, GenericObjectPool.java&lt;br/&gt;
	  ensureMinIdle():1040, GenericObjectPool.java&lt;br/&gt;
	  access$100():128, GenericObjectPool.java&lt;br/&gt;
	  run():1117, GenericObjectPool.java&lt;br/&gt;
	  mainLoop():512, Timer.java&lt;br/&gt;
	  run():462, Timer.java&lt;/p&gt;

&lt;p&gt;This is a classic two lock dead lock.  The main thread acquires the locks on DriveManager then GenericObjectPool, and at the same time the timer thread attempts to acquire them in the opposite order GenericObjectPool and then DriveManger.&lt;/p&gt;

&lt;p&gt;There are really only two ways to fix this 1) guarantee locks are always acquired in the same order or 2) eliminate one of the locks.  The first one is not really possible as both objects are generally publicly accessible, and the second fix will require a complex change to the GenericObjectPool code.  &lt;/p&gt;

&lt;p&gt;Attached is a patch that adds the Deadlock class, which has a main method that causes the dead lock.    The patch also fixes the synchronization in PoolableConnectionFactory.  I also added property to TesterDriver to cause the thread to sleep in getConnection so the dead lock can be reproduced.&lt;/p&gt;

&lt;p&gt;I&apos;m going to attempt to write a new pool using the Java5 concurrent code which doesn&apos;t call makeObject inside of a synchronized block.&lt;/p&gt;
</comment>
                            <comment id="12514358" author="h2o" created="Fri, 20 Jul 2007 22:32:21 +0000"  >&lt;p&gt;Hi Dain, I agree that the evictor thread is problematic (it should go away and/or be replaced by a custom evictor thingy that gets scheduled externally), but it is not clear to me how you could make makeObject() non-synchronized. If you want to go for the usual create-and-CAS pattern you risk a potential double allocation, and pool is definitely used for situations where this would be &lt;b&gt;very&lt;/b&gt; bad.&lt;br/&gt;
A multi-staged locking hierarchy (implemented with the new ReentrantReadWrite locks) could help us to the effect that you outlined wrt. the lock ordering. Entering readers (pool consumers) all would have to pass the global writer lock entrance; once someone is inside, the periodic evictor has to enqueue at the fron t door until he gets the write lock, and can proceed.&lt;br/&gt;
Completely concurrent (lock-free) eviction would be much harder.&lt;br/&gt;
A mutli-staged locking hierarchy would also enable us to properly decouple some of the other paths inside borrow/returnObject. For returnObject I have already submitted such a simple patch.&lt;/p&gt;</comment>
                            <comment id="12514362" author="dain" created="Fri, 20 Jul 2007 22:52:27 +0000"  >&lt;p&gt;This will take experimentation, but off the top of my head, I&apos;d do somthing like this:&lt;/p&gt;

&lt;p&gt;while(true) {&lt;br/&gt;
  synchronized(idleCollection) {&lt;br/&gt;
    if (!idleCollection.isEmpty()) &lt;/p&gt;
{
      return idleCollection.removeFirst();
    }
&lt;p&gt;  }&lt;/p&gt;

&lt;p&gt;  Future future = this.allocationFutureAtomic.get();&lt;br/&gt;
  if (allocationFuture == null) {&lt;br/&gt;
    future = new AllocationFuture();&lt;br/&gt;
    if  (this.allocationFutureAtomic.weakCompareAndSet(null, future)) &lt;/p&gt;
{
       future.get();
    }
&lt;p&gt;  }&lt;br/&gt;
}&lt;/p&gt;

&lt;p&gt;The AllocationFuture would create new connection(s), add them to the idle pool, and then clear the future atomic.  Of course this can be done with primitives, but it is more painful to code.  It would be cleaner to use an executor to process the future, so it can potentially be done on another thread which isn&apos;t holding locks, and if the makeObject() hangs you, don&apos;t have to interrupt an application thread.  All of this becomes more difficult when you try to implement a keyed pool due to double book keeping of a global count and per key count.&lt;/p&gt;

&lt;p&gt;Anyway, I&apos;ll experiment with some implementations and if I come up with anything good, I&apos;ll post it.&lt;/p&gt;
</comment>
                            <comment id="12514364" author="dain" created="Fri, 20 Jul 2007 22:57:31 +0000"  >&lt;p&gt;BTW it isn&apos;t the evictor thread that is problematic per say (it could have other issues &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;).  It is the fact that when generic object pool calls makeObject it is holding a lock on the whole pool.  This type of lock holding open out call is bound to cause dead locks.  The example in this issue is a dead lock between a thread using a DBCP pool to get a connection and a thread that goes directly to the DriveManager for a connection.  &lt;/p&gt;</comment>
                            <comment id="12514366" author="dain" created="Fri, 20 Jul 2007 23:05:31 +0000"  >&lt;p&gt;Ok one more comment before I get lunch....  My sample code above is bad.  It is a hard loop (duh).  Instead of hard looping, the second check on the idleCollection could wait for a item to become available (easy with a concurrent queue).  Which leave the possibility that someone sneaks  in and steals the new connection we were waiting for &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/sad.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;  As, I said it will take some experimentation to get this right, but that is the fun part.&lt;/p&gt;</comment>
                            <comment id="12527566" author="vinod_j" created="Fri, 14 Sep 2007 16:55:23 +0000"  >&lt;p&gt;We&apos;ve seen a deaklock in our env,  when thread 1 holds lock A then wants lock B, thread 2 holds lock B then wants lock A.  As other threads tried to obtain lock B they started to hang, until almost all threads were hung. Is this the same issue.&lt;/p&gt;


&lt;p&gt;2LKDEADLOCKTHR  Thread &quot;Thread-5351&quot; (0x7E9B46F0)&lt;br/&gt;
3LKDEADLOCKWTR    is waiting for:&lt;br/&gt;
4LKDEADLOCKMON      sys_mon_t:0x833AEF38 infl_mon_t: 0x00000000:&lt;br/&gt;
4LKDEADLOCKOBJ      org.apache.commons.pool.impl.GenericObjectPool@3B974CF0/3B974CF8:&lt;br/&gt;
3LKDEADLOCKOWN    which is owned by:&lt;br/&gt;
2LKDEADLOCKTHR  Thread &quot;Thread-42&quot; (0x7E563110)&lt;br/&gt;
3LKDEADLOCKWTR    which is waiting for:&lt;br/&gt;
4LKDEADLOCKMON      sys_mon_t:0x7C3C9168 infl_mon_t: 0x00000000:&lt;br/&gt;
4LKDEADLOCKOBJ      com.vignette.dbms.VgnConnectionPool$_PoolableConnectionFactory@3B826CB0/3B826CB8:&lt;br/&gt;
3LKDEADLOCKOWN    which is owned by:&lt;br/&gt;
2LKDEADLOCKTHR  Thread &quot;Thread-5351&quot; (0x7E9B46F0)&lt;br/&gt;
NULL           &lt;br/&gt;
NULL           &lt;br/&gt;
2LKDEADLOCKTHR  Thread &quot;Thread-42&quot; (0x7E563110)&lt;br/&gt;
3LKDEADLOCKWTR    is waiting for:&lt;br/&gt;
4LKDEADLOCKMON      sys_mon_t:0x7C3C9168 infl_mon_t: 0x00000000:&lt;br/&gt;
4LKDEADLOCKOBJ      com.vignette.dbms.VgnConnectionPool$_PoolableConnectionFactory@3B826CB0/3B826CB8:&lt;br/&gt;
3LKDEADLOCKOWN    which is owned by:&lt;br/&gt;
2LKDEADLOCKTHR  Thread &quot;Thread-5351&quot; (0x7E9B46F0)&lt;br/&gt;
3LKDEADLOCKWTR    which is waiting for:&lt;br/&gt;
4LKDEADLOCKMON      sys_mon_t:0x833AEF38 infl_mon_t: 0x00000000:&lt;br/&gt;
4LKDEADLOCKOBJ      org.apache.commons.pool.impl.GenericObjectPool@3B974CF0/3B974CF8:&lt;br/&gt;
3LKDEADLOCKOWN    which is owned by:&lt;br/&gt;
2LKDEADLOCKTHR  Thread &quot;Thread-42&quot; (0x7E563110)&lt;br/&gt;
NULL           &lt;/p&gt;</comment>
                            <comment id="12573129" author="drees" created="Thu, 28 Feb 2008 01:57:19 +0000"  >&lt;p&gt;I&apos;ve encountered what appears to be the same deadlock when returning a connection to the pool.&lt;/p&gt;

&lt;p&gt;commons-dbcp-1.2.2&lt;br/&gt;
commons-pool-1.4&lt;/p&gt;

&lt;p&gt;Is there any work being done on this? This bug has been open for quite some time.&lt;/p&gt;

&lt;p&gt;Are there any workarounds to avoid this issue? Googling simply reveals other deadlocks with similar stack traces.&lt;/p&gt;

&lt;p&gt;Here is my stack trace:&lt;/p&gt;

&lt;p&gt;&quot;Timer-0&quot;:&lt;br/&gt;
  at org.apache.commons.dbcp.AbandonedTrace.addTrace(AbandonedTrace.java:175)&lt;br/&gt;
    waiting to lock &amp;lt;0x0000002aa04d4be8&amp;gt; (a org.apache.commons.dbcp.PoolableConnection)&lt;br/&gt;
  at org.apache.commons.dbcp.AbandonedTrace.init(AbandonedTrace.java:92)&lt;br/&gt;
  at org.apache.commons.dbcp.AbandonedTrace.&amp;lt;init&amp;gt;(AbandonedTrace.java:82)&lt;br/&gt;
  at org.apache.commons.dbcp.DelegatingStatement.&amp;lt;init&amp;gt;(DelegatingStatement.java:61)&lt;br/&gt;
  at org.apache.commons.dbcp.DelegatingConnection.createStatement(DelegatingConnection.java:224)&lt;br/&gt;
  at org.apache.commons.dbcp.PoolableConnectionFactory.validateConnection(PoolableConnectionFactory.java:331)&lt;br/&gt;
  at org.apache.commons.dbcp.PoolableConnectionFactory.validateObject(PoolableConnectionFactory.java:312)&lt;br/&gt;
  at org.apache.commons.pool.impl.GenericObjectPool.evict(GenericObjectPool.java:1217)&lt;br/&gt;
    locked &amp;lt;0x0000002a9ee91bf8&amp;gt; (a org.apache.commons.pool.impl.GenericObjectPool)&lt;br/&gt;
  at org.apache.commons.pool.impl.GenericObjectPool$Evictor.run(GenericObjectPool.java:1341)&lt;br/&gt;
  at java.util.TimerThread.mainLoop(Timer.java:512)&lt;br/&gt;
  at java.util.TimerThread.run(Timer.java:462)&lt;br/&gt;
&quot;SocketRequest-8&quot;:&lt;br/&gt;
  at org.apache.commons.pool.impl.GenericObjectPool.addObjectToPool(GenericObjectPool.java:1137)&lt;br/&gt;
    waiting to lock &amp;lt;0x0000002a9ee91bf8&amp;gt; (a org.apache.commons.pool.impl.GenericObjectPool)&lt;br/&gt;
  at org.apache.commons.pool.impl.GenericObjectPool.returnObject(GenericObjectPool.java:1076)&lt;br/&gt;
  at org.apache.commons.dbcp.PoolableConnection.close(PoolableConnection.java:87)&lt;br/&gt;
    locked &amp;lt;0x0000002aa04d4be8&amp;gt; (a org.apache.commons.dbcp.PoolableConnection)&lt;br/&gt;
  at org.apache.commons.dbcp.PoolingDataSource$PoolGuardConnectionWrapper.close(PoolingDataSource.java:181)&lt;br/&gt;
  at my.package.DbUtil.close(DbUtil.java:545)&lt;br/&gt;
  at my.package.DbUtil.close(DbUtil.java:587)&lt;br/&gt;
  at my.package.Request.closeConnection(NZTABRequest.java:970)&lt;br/&gt;
  at my.package.SocketRequest.processRequest(SocketRequest.java:57)&lt;br/&gt;
  at my.package.SocketRequest.processRequest(SocketRequest.java:110)&lt;br/&gt;
  at my.package.SocketRequest.waitForWork(SocketRequest.java:82)&lt;br/&gt;
    locked &amp;lt;0x0000002a9ed88ef0&amp;gt; (a my.package.SocketRequest)&lt;br/&gt;
  at my.package.SocketRequest.run(SocketRequest.java:71)&lt;/p&gt;

&lt;p&gt;(Sorry for all the edits!)&lt;/p&gt;</comment>
                            <comment id="12573582" author="drees" created="Fri, 29 Feb 2008 03:59:37 +0000"  >&lt;p&gt;It&apos;s funny, I&apos;ve been using DBCP for years without having run across this issue once, and now I&apos;ve had two separate applications run across the same deadlock within a week.&lt;/p&gt;

&lt;p&gt;I have another deadlock which is identical to the one above, except that the thread closing the connection is a Servlet running in Tomcat, but the cause is the same.&lt;/p&gt;

&lt;p&gt;The Evictor thread runs, locks the GenericObjectPool, enters validateConnection and then attempts to lock a Poolable Connection.&lt;br/&gt;
Another thread Locks a PoolableConection, and attempts to lock the GenericObjectPool.&lt;/p&gt;

&lt;p&gt;I&apos;ve been analyzing the deadlock and it appears that the initial suggested workaround of setting minIdle to 0. In my previous comment, the application did have a minIdle setting of 1. However, in my latest deadlock, minIdle was set to zero.&lt;/p&gt;

&lt;p&gt;However, in both cases, the testWhileIdle is to true which appears to cause the Evictor to run.&lt;/p&gt;

&lt;p&gt;So to really avoid this issue, it appears that you should set minIdle to 0 AND turn off testWhileIdle. Or is minIdle really enough (and I am missing something?)&lt;/p&gt;</comment>
                            <comment id="12573584" author="drees" created="Fri, 29 Feb 2008 04:17:32 +0000"  >&lt;p&gt;I&apos;ve been commenting on the wrong bug it appears, my deadlock case appears to be the same as &lt;a href=&quot;https://issues.apache.org/jira/browse/DBCP-65&quot; title=&quot;[dbcp] Deadlock when evicting dbcp objects (testWhileIdle=true)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DBCP-65&quot;&gt;&lt;del&gt;DBCP-65&lt;/del&gt;&lt;/a&gt; (which is &quot;fixed&quot;?)&lt;/p&gt;</comment>
                            <comment id="12573607" author="psteitz" created="Fri, 29 Feb 2008 06:09:49 +0000"  >&lt;p&gt;This is a new issue, though the basic problem of contention between the Evictor and client threads is the same.  Turning off testWhileIdle or just setting timeBetweenEvictionRuns to the default (-1) so the evictor does not run should prevent this.&lt;/p&gt;

&lt;p&gt;Looks to me like what is going on here is&lt;/p&gt;

&lt;p&gt;1) Client thread (&quot;SocketRequest-8&quot;) calls close on a connection from the pool.  This locks the PoolableConnection.&lt;br/&gt;
2) The returned connection gets added back into the pool&lt;br/&gt;
3) The evictor starts and locks the pool&lt;br/&gt;
4) The evictor tries to validate the newly returned connection, but needs to acquire its lock&lt;br/&gt;
5) returnObject (actually addObjectToPool) needs to acquire the pool lock to complete&lt;br/&gt;
**&lt;b&gt;deadlock&lt;/b&gt;**&lt;/p&gt;

&lt;p&gt;This is new because pool 1.4 reduced synchronization scope in returnObject, which used to be fully synchronized (opening the door for 3).  We could revert to full synchronization of returnObject in pool, but that was a source of performance problems and I think the root cause here is really how DBCP uses the GOP Evictor without controlling client locks and we need to find a solution for that problem.&lt;/p&gt;

&lt;p&gt;Reverting to pool 1.3 will also eliminate this particular deadlock.&lt;/p&gt;</comment>
                            <comment id="12573633" author="drees" created="Fri, 29 Feb 2008 08:26:14 +0000"  >&lt;p&gt;Phil, thanks for the comment. Should I open a new bug with this particular deadlock scenario? Pool 1.4 could explain why I&apos;m hitting it recently, I&apos;ve only started using Pool 1.4 in the past month or so.&lt;/p&gt;</comment>
                            <comment id="12573723" author="psteitz" created="Fri, 29 Feb 2008 12:56:13 +0000"  >&lt;p&gt;The new deadlock is definitely due to pool 1.4. Lets keep tracking the DBCP issue here, since the basic problem is the same.  I will open a separate issue against pool.&lt;/p&gt;</comment>
                            <comment id="12608644" author="psteitz" created="Fri, 27 Jun 2008 02:54:36 +0000"  >&lt;p&gt;The last deadlock above should be resolved by the fix applied in r 672097 for &lt;a href=&quot;https://issues.apache.org/jira/browse/DBCP-270&quot; title=&quot;Dead lock using the evictor&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DBCP-270&quot;&gt;&lt;del&gt;DBCP-270&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="12689099" author="markt" created="Wed, 25 Mar 2009 12:56:48 +0000"  >&lt;p&gt;I have attached a possible solution to this issue that removes the sync from addObject()&lt;/p&gt;

&lt;p&gt;The upside is it should no longer be possible for the evcitor to be the source of a deadlock.&lt;/p&gt;

&lt;p&gt;The downside is a pool where (idle==0 &amp;amp;&amp;amp; (active + 1)==maxActive &amp;amp;&amp;amp; minIdle&amp;gt;0) may appear to be exhausted to a client if the evictor thread is in the process of creating the last object when the client calls borrowObject(). This is really only an issue if the pool is configured with WHEN_EXHAUSTED_FAIL.&lt;/p&gt;

&lt;p&gt;Assuming my patch is correct, the question becomes is it better to have the risk of a deadlock or better to have the risk of the edge case described above. My own view is that the deadlock is worse.&lt;/p&gt;

&lt;p&gt;Thoughts?&lt;/p&gt;</comment>
                            <comment id="12689254" author="psteitz" created="Wed, 25 Mar 2009 22:01:12 +0000"  >&lt;p&gt;Agree that if the patch works as designed, it should be applied. I am out of pocket for next few days but will analyze and test to verify. Need to make sure removing synch from addObject does not create possibility of maxActive exceeded.&lt;/p&gt;</comment>
                            <comment id="12694532" author="markt" created="Wed, 1 Apr 2009 13:59:43 +0000"  >&lt;p&gt;If the above patch is viewed as OK then similar patches will be required for the other pools to fully resolve this issue.&lt;/p&gt;</comment>
                            <comment id="12695757" author="psteitz" created="Sat, 4 Apr 2009 15:29:21 +0000"  >&lt;p&gt;I have reviewed and tested the patch and am +1 for applying it and resolving this issue, with closure pending pool 1.5 release.&lt;/p&gt;

&lt;p&gt;The change in AbandonedTrace synchronization scope made to address &lt;a href=&quot;https://issues.apache.org/jira/browse/DBCP-270&quot; title=&quot;Dead lock using the evictor&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DBCP-270&quot;&gt;&lt;del&gt;DBCP-270&lt;/del&gt;&lt;/a&gt; should eliminate the second deadlock scenario reported in this issue and the first one should be prevented by Mark&apos;s patch.  The unit test attached above,  TestConcurrency, consistently deadlocks under JDK 1.5 before Mark&apos;s pool patch, but succeeds with a pool jar patched with Mark&apos;s patch.  I am not sure why exactly, but neither the maven nor ant runner deadlocks on this test pre-patch under 1.6 (Apple JDK, at least).&lt;/p&gt;

&lt;p&gt;I agree that GenericKeyedObjectPool needs to be similarly patched.&lt;/p&gt;

&lt;p&gt;I agree with Dain&apos;s comment on &quot;lock holding open outcall..bound to cause deadlocks&quot; and opened &lt;a href=&quot;https://issues.apache.org/jira/browse/POOL-125&quot; title=&quot;Insufficient control over concurrent access to pooled objects by Evictor, client threads&quot; class=&quot;issue-link&quot; data-issue-key=&quot;POOL-125&quot;&gt;&lt;del&gt;POOL-125&lt;/del&gt;&lt;/a&gt; to address the general case.&lt;/p&gt;</comment>
                            <comment id="12695930" author="markt" created="Sun, 5 Apr 2009 22:38:30 +0000"  >&lt;p&gt;Just discovered that my proposed patch also fixes &lt;a href=&quot;https://issues.apache.org/jira/browse/DBCP-379&quot; title=&quot;number of connections created has crossed more than maxActive &quot; class=&quot;issue-link&quot; data-issue-key=&quot;DBCP-379&quot;&gt;&lt;del&gt;POOL-107&lt;/del&gt;&lt;/a&gt;. Since this is really a pool issue it makes more sense to track progress there rather than here.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10032">
                    <name>Blocker</name>
                                                                <inwardlinks description="is blocked by">
                                        <issuelink>
            <issuekey id="12356581">DBCP-202</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12390600">POOL-125</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12403604" name="DBCP-44-possible-solution.patch.txt" size="2820" author="markt" created="Wed, 25 Mar 2009 12:56:48 +0000"/>
                            <attachment id="12362270" name="DBCP-44.patch" size="11949" author="dain" created="Fri, 20 Jul 2007 21:58:55 +0000"/>
                            <attachment id="12345631" name="deadlock.txt" size="8580" author="psteitz" created="Fri, 24 Nov 2006 15:41:13 +0000"/>
                            <attachment id="12345630" name="deadlock_post_patch.txt" size="13755" author="psteitz" created="Fri, 24 Nov 2006 15:40:15 +0000"/>
                            <attachment id="12345632" name="testConcurrency.java" size="2038" author="psteitz" created="Fri, 24 Nov 2006 15:42:28 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>33912</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114328</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            16 years, 31 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uzyf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178966</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-43] BasicDataSource always sets testOnBorrow if given a validation query</title>
                <link>https://issues.apache.org/jira/browse/DBCP-43</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;BasicDataSource performs the following code if given a validation query:&lt;/p&gt;

&lt;p&gt;if (validationQuery != null) {&lt;br/&gt;
  connectionPool.setTestOnBorrow(true);&lt;br/&gt;
}&lt;/p&gt;

&lt;p&gt;This means that a validation query will always get executed on borrow, it can &lt;br/&gt;
only additionally get executed on return or idle too.&lt;/p&gt;

&lt;p&gt;To be able to run a validation query on either borrow, return, or idle, &lt;br/&gt;
BasicDataSource should just set testOnBorrow if no other strategy given:&lt;/p&gt;

&lt;p&gt;if (validationQuery != null &amp;amp;&amp;amp; !testOnReturn &amp;amp;&amp;amp; !testWhileIdle) {&lt;br/&gt;
  connectionPool.setTestOnBorrow(true);&lt;br/&gt;
}&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: All&lt;br/&gt;
Platform: All&lt;/p&gt;</environment>
        <key id="12340934">DBCP-43</key>
            <summary>BasicDataSource always sets testOnBorrow if given a validation query</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="juergen.hoeller@werk3at.com">Juergen Hoeller</reporter>
                        <labels>
                    </labels>
                <created>Wed, 27 Aug 2003 19:06:57 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:29 +0000</updated>
                            <resolved>Tue, 25 Mar 2008 08:11:29 +0000</resolved>
                                    <version>Nightly Builds</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12404968" author="dirkv" created="Wed, 27 Aug 2003 22:47:06 +0000"  >&lt;p&gt;Patch applied&lt;/p&gt;

&lt;p&gt;Thanks&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>22750</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114327</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            22 years, 12 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uvzz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178325</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-42] pool exhausted Tomcat - Informix</title>
                <link>https://issues.apache.org/jira/browse/DBCP-42</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;When creating Informix datasources on Tomcat 4.1.30 and 5.x.x, we get this error:&lt;/p&gt;

&lt;p&gt;-------- STACKTRACE - START ----------------&lt;/p&gt;

&lt;p&gt;Caused by: org.apache.commons.dbcp.SQLNestedException: Cannot get a connection,&lt;br/&gt;
pool exhausted, cause: Could not create a validated object&lt;br/&gt;
	at&lt;br/&gt;
org.apache.commons.dbcp.PoolingDataSource.getConnection(PoolingDataSource.java:148)&lt;br/&gt;
	at org.apache.commons.dbcp.BasicDataSource.getConnection(BasicDataSource.java:518)&lt;br/&gt;
	at&lt;br/&gt;
it.mict.mtfx.db.DataSourcePoolAdapter.getConnection(DataSourcePoolAdapter.java:27)&lt;br/&gt;
	at it.mict.mtfx.db.DBContext.getConnection(DBContext.java:155)&lt;br/&gt;
	at it.mict.abc.core.AbcEnv.&amp;lt;init&amp;gt;(AbcEnv.java:53)&lt;br/&gt;
	... 21 more&lt;br/&gt;
Caused by: java.util.NoSuchElementException: Could not create a validated object&lt;br/&gt;
	at&lt;br/&gt;
org.apache.commons.pool.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:851)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.commons.dbcp.AbandonedObjectPool.borrowObject(AbandonedObjectPool.java:119)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.commons.dbcp.PoolingDataSource.getConnection(PoolingDataSource.java:140)&lt;br/&gt;
	... 25 more&lt;/p&gt;

&lt;p&gt;-------- STACKTRACE - END ----------------&lt;/p&gt;

&lt;p&gt;Here is the server.xml fragment:&lt;/p&gt;

&lt;p&gt;-------- server.xml (fragments) - START ----------------&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;CUT&amp;#93;&lt;/span&gt;&lt;br/&gt;
&amp;lt;Resource auth=&quot;Container&quot;&lt;br/&gt;
          name=&quot;jdbc/Abc&quot;&lt;br/&gt;
          scope=&quot;Shareable&quot;&lt;br/&gt;
          type=&quot;javax.sql.DataSource&quot;/&amp;gt;&lt;br/&gt;
&amp;lt;ResourceParams name=&quot;jdbc/Abc&quot;&amp;gt;&lt;br/&gt;
  &amp;lt;parameter&amp;gt;&lt;br/&gt;
    &amp;lt;name&amp;gt;driverClassName&amp;lt;/name&amp;gt;&lt;br/&gt;
    &amp;lt;value&amp;gt;com.informix.jdbc.IfxDriver&amp;lt;/value&amp;gt;&lt;br/&gt;
  &amp;lt;/parameter&amp;gt;&lt;br/&gt;
  &amp;lt;parameter&amp;gt;&lt;br/&gt;
    &amp;lt;name&amp;gt;url&amp;lt;/name&amp;gt;&lt;br/&gt;
    &amp;lt;value&amp;gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;JDBC URL GO HERE&amp;#93;&lt;/span&gt;&amp;lt;/value&amp;gt;&lt;br/&gt;
  &amp;lt;/parameter&amp;gt;&lt;br/&gt;
  &amp;lt;parameter&amp;gt;&lt;br/&gt;
    &amp;lt;name&amp;gt;username&amp;lt;/name&amp;gt;&lt;br/&gt;
    &amp;lt;value&amp;gt;####&amp;lt;/value&amp;gt;&lt;br/&gt;
  &amp;lt;/parameter&amp;gt;&lt;br/&gt;
  &amp;lt;parameter&amp;gt;&lt;br/&gt;
    &amp;lt;name&amp;gt;password&amp;lt;/name&amp;gt;&lt;br/&gt;
    &amp;lt;value&amp;gt;####&amp;lt;/value&amp;gt;&lt;br/&gt;
  &amp;lt;/parameter&amp;gt;&lt;br/&gt;
  &amp;lt;parameter&amp;gt;&lt;br/&gt;
    &amp;lt;name&amp;gt;maxActive&amp;lt;/name&amp;gt;&lt;br/&gt;
    &amp;lt;value&amp;gt;4&amp;lt;/value&amp;gt;&lt;br/&gt;
  &amp;lt;/parameter&amp;gt;&lt;br/&gt;
  &amp;lt;parameter&amp;gt;&lt;br/&gt;
    &amp;lt;name&amp;gt;maxWait&amp;lt;/name&amp;gt;&lt;br/&gt;
    &amp;lt;value&amp;gt;5000&amp;lt;/value&amp;gt;&lt;br/&gt;
  &amp;lt;/parameter&amp;gt;&lt;br/&gt;
  &amp;lt;parameter&amp;gt;&lt;br/&gt;
    &amp;lt;name&amp;gt;maxIdle&amp;lt;/name&amp;gt;&lt;br/&gt;
    &amp;lt;value&amp;gt;2&amp;lt;/value&amp;gt;&lt;br/&gt;
  &amp;lt;/parameter&amp;gt;&lt;br/&gt;
&amp;lt;/ResourceParams&amp;gt;&lt;/p&gt;

&lt;p&gt;-------- server.xml (fragments) - END ----------------&lt;/p&gt;

&lt;p&gt;The workaround is to use DBCP 1.0, just substitute commons-dbcp-1.1.jar with the&lt;br/&gt;
1.0 version.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: other&lt;br/&gt;
Platform: Other&lt;/p&gt;</environment>
        <key id="12341588">DBCP-42</key>
            <summary>pool exhausted Tomcat - Informix</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="3">Duplicate</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="megadix@yahoo.it">Dimitri De Franciscis</reporter>
                        <labels>
                    </labels>
                <created>Thu, 22 Jul 2004 17:26:10 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:29 +0000</updated>
                            <resolved>Tue, 25 Mar 2008 08:11:29 +0000</resolved>
                                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12407057" author="megadix@yahoo.it" created="Thu, 22 Jul 2004 17:32:37 +0000"  >&lt;p&gt;Works well with DBCP 1.2.1: faster, no errors&lt;/p&gt;</comment>
                            <comment id="12407058" author="megadix@yahoo.it" created="Thu, 22 Jul 2004 18:08:38 +0000"  >

&lt;ul&gt;
	&lt;li&gt;
	&lt;ul&gt;
		&lt;li&gt;
		&lt;ul&gt;
			&lt;li&gt;This bug has been marked as a duplicate of 27320 ***&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>30256</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114326</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            21 years, 16 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0v02n:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178985</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-41] [dbcp][patch] docs lie: NOT maxIdle = 0 for no limit BUT -1</title>
                <link>https://issues.apache.org/jira/browse/DBCP-41</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;Documnentation for BasicDataSource and in a number of other places say: setMaxIdle( 0 ) for no limit. But GenericObjectPool says that &lt;em&gt;negative&lt;/em&gt; (-1 for instance) should be used for this purpose.&lt;/p&gt;

&lt;p&gt;In our neighbour project developers tried 0 and pool appeared to be non-functional: a new connection was created each time. They said: oh, well, drop dbcp, it does not work!&lt;/p&gt;

&lt;p&gt;I consider this doc update so critical that I&apos;m submitting a patch.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: other&lt;br/&gt;
Platform: Other&lt;/p&gt;</environment>
        <key id="12342344">DBCP-41</key>
            <summary>[dbcp][patch] docs lie: NOT maxIdle = 0 for no limit BUT -1</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="atagunov2">Anton Tagunov</reporter>
                        <labels>
                    </labels>
                <created>Wed, 29 Jun 2005 23:57:46 +0000</created>
                <updated>Thu, 2 May 2013 02:28:36 +0000</updated>
                            <resolved>Sat, 8 Mar 2008 22:59:00 +0000</resolved>
                                    <version>1.2.2</version>
                                    <fixVersion>1.3</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12409698" author="atagunov2" created="Wed, 29 Jun 2005 23:58:43 +0000"  >&lt;p&gt;Created an attachment (id=15558)&lt;br/&gt;
set maxIdle to negative value for no limit on idle connections&lt;/p&gt;</comment>
                            <comment id="12409699" author="atagunov2" created="Thu, 30 Jun 2005 00:12:34 +0000"  >&lt;p&gt;Created an attachment (id=15560)&lt;br/&gt;
fixed patch&lt;/p&gt;

&lt;p&gt;The patch contains exactly one code (not doc) fix:&lt;/p&gt;

&lt;p&gt;DriverAdapterCPDS.java&lt;br/&gt;
	 if (isPoolPreparedStatements()) {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;if (getMaxPreparedStatements() == -1)&lt;br/&gt;
+	     if (getMaxPreparedStatements() &amp;lt;= 0)&lt;br/&gt;
	     {&lt;br/&gt;
		 // since there is no limit&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;As docs now says that &quot;non-positive&quot; maxPreparedStatements stands for &quot;no&lt;br/&gt;
limit&quot;, and since this is the semantics of maxTotal in GenericKeyedObjectPool&lt;br/&gt;
(where _maxPreparedStatements ends in) I think it is appropriate to change code&lt;br/&gt;
like this.&lt;/p&gt;

&lt;p&gt;Sorry, my prev version of patch was in error at this exactly place.&lt;/p&gt;</comment>
                            <comment id="12424474" author="psteitz" created="Mon, 31 Jul 2006 04:45:14 +0000"  >&lt;p&gt;Patch applied.  Thanks.&lt;/p&gt;</comment>
                            <comment id="12576588" author="psteitz" created="Sat, 8 Mar 2008 19:28:51 +0000"  >&lt;p&gt;The patch applied in r427015 should not have changed the description for maxActive.&lt;/p&gt;</comment>
                            <comment id="12576592" author="psteitz" created="Sat, 8 Mar 2008 19:36:13 +0000"  >&lt;p&gt;maxActive documentation error applies to 1.2.2 configuration.xml.  Javadoc for BasicDataSource also needs to be fixed.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10001">
                    <name>dependent</name>
                                                                <inwardlinks description="is depended upon by">
                                        <issuelink>
            <issuekey id="12342345">POOL-33</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12333596" name="ASF.LICENSE.NOT.GRANTED--maxIdleNegativeForNoLimit.diff" size="10774" author="atagunov2" created="Wed, 29 Jun 2005 23:58:43 +0000"/>
                            <attachment id="12333597" name="ASF.LICENSE.NOT.GRANTED--maxIdleNegativeForNoLimitFixed.diff" size="10775" author="atagunov2" created="Thu, 30 Jun 2005 00:12:34 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>35542</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114325</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            17 years, 35 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0ux1b:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178493</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-40] NullPointerException  in DBCP when used for client-server applications</title>
                <link>https://issues.apache.org/jira/browse/DBCP-40</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;Nullpointerexception with the below JNDI settings for client-server app&lt;br/&gt;
My Server java file:&lt;/p&gt;

&lt;p&gt;private static String connectURI = &quot;jdbc:sapdb://LOCALHOST/mydb&quot;;&lt;br/&gt;
private static String username = &quot;myusername&quot;;&lt;br/&gt;
private static String password = &quot;mypassword&quot;;&lt;/p&gt;

&lt;p&gt;Properties env = new Properties();&lt;br/&gt;
env.put(Context.SECURITY_AUTHENTICATION,&quot;simple&quot;);&lt;br/&gt;
env.put(Context.REFERRAL,&quot;follow&quot;);&lt;br/&gt;
env.put(Context.SECURITY_PRINCIPAL, &quot;cn=myname&quot;);&lt;br/&gt;
env.put(Context.SECURITY_CREDENTIALS,&quot;mypassword&quot;);&lt;br/&gt;
env.put(&quot;com.sun.jndi.ldap.connect.pool&quot;, &quot;true&quot;);&lt;br/&gt;
env.put(&quot;databaseName&quot;, &quot;mydb&quot;);&lt;br/&gt;
env.put(&quot;user&quot;, username);&lt;br/&gt;
env.put(&quot;password&quot;, password);&lt;br/&gt;
env.put(&quot;url&quot;, connectURI);&lt;br/&gt;
env.put(&quot;driver&quot;, &quot;com.sap.dbtech.jdbc.DriverSapDB&quot;);&lt;br/&gt;
env.put(Context.INITIAL_CONTEXT_FACTORY, &quot;com.sun.jndi.ldap.LdapCtxFactory&quot;);&lt;br/&gt;
env.put(Context.PROVIDER_URL, &quot;ldap://localhost:389/&quot;);&lt;br/&gt;
Context ctx = new InitialContext(env);&lt;/p&gt;

&lt;p&gt;DriverAdapterCPDS cpds = new DriverAdapterCPDS();&lt;br/&gt;
cpds.setUrl(connectURI);&lt;br/&gt;
cpds.setUser(username);&lt;br/&gt;
cpds.setPassword(password);&lt;br/&gt;
cpds.setMaxActive(6);&lt;br/&gt;
cpds.setDriver(&quot;com.sap.dbtech.jdbc.DriverSapDB&quot;);&lt;br/&gt;
String dsbindString = &quot;cn=cpd,ou=JavaObjects,dc=mycompany,dc=com&quot;;&lt;br/&gt;
ctx.rebind(dsbindString, cpds);&lt;/p&gt;

&lt;p&gt;Jdbc2PoolDataSource tds = new Jdbc2PoolDataSource();&lt;br/&gt;
tds.setJndiEnvironment&lt;br/&gt;
(ctx.INITIAL_CONTEXT_FACTORY, &quot;com.sun.jndi.ldap.LdapCtxFactory&quot;);&lt;br/&gt;
tds.setJndiEnvironment(ctx.PROVIDER_URL, &quot;ldap://localhost:389/&quot;);&lt;br/&gt;
tds.setDefaultMaxActive(3);&lt;br/&gt;
tds.setDataSourceName(dsbindString);&lt;br/&gt;
String pooldsbindString &lt;br/&gt;
= &quot;cn=SapdbDSApacheJdbc,ou=JavaObjects,dc=mycompany,dc=com&quot;;&lt;br/&gt;
ctx.rebind(pooldsbindString,tds);&lt;/p&gt;


&lt;p&gt;My Client java file:&lt;/p&gt;

&lt;p&gt;private static String connectURI = &quot;jdbc:sapdb://LOCALHOST/mydb&quot;;&lt;br/&gt;
private static String username = &quot;myusername&quot;;&lt;br/&gt;
private static String password = &quot;mypassword&quot;;&lt;/p&gt;

&lt;p&gt;String pooldsbindString &lt;br/&gt;
= &quot;cn=SapdbDSApacheJdbc,ou=JavaObjects,dc=mycompany,dc=com&quot;;&lt;br/&gt;
Properties env2 = new Properties();&lt;br/&gt;
env2.put(Context.INITIAL_CONTEXT_FACTORY, &quot;com.sun.jndi.ldap.LdapCtxFactory&quot;);&lt;br/&gt;
env2.put(Context.PROVIDER_URL, &quot;ldap://localhost:389/&quot;);&lt;br/&gt;
env2.put(Context.SECURITY_AUTHENTICATION,&quot;simple&quot;);&lt;br/&gt;
env2.put(Context.REFERRAL,&quot;follow&quot;);&lt;br/&gt;
env2.put(Context.SECURITY_PRINCIPAL, &quot;cn=myname&quot;);&lt;br/&gt;
env2.put(Context.SECURITY_CREDENTIALS,&quot;mypassword&quot;);&lt;br/&gt;
env2.put(&quot;com.sun.jndi.ldap.connect.pool&quot;, &quot;true&quot;);&lt;br/&gt;
env2.put(&quot;databaseName&quot;, &quot;mydb&quot;);&lt;br/&gt;
env2.put(&quot;user&quot;, username);&lt;br/&gt;
env2.put(&quot;password&quot;, password);&lt;br/&gt;
env2.put(&quot;url&quot;, connectURI);&lt;br/&gt;
env2.put(&quot;driver&quot;, &quot;com.sap.dbtech.jdbc.DriverSapDB&quot;);&lt;br/&gt;
DirContext ctx2 = new InitialDirContext(env2);&lt;br/&gt;
Jdbc2PoolDataSource ref = (Jdbc2PoolDataSource)ctx2.lookup(pooldsbindString);&lt;/p&gt;

&lt;p&gt;Connection cn = (Connection)ref.getConnection(username,password);&lt;br/&gt;
Statement stmt = cn.createStatement();&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: All&lt;br/&gt;
Platform: PC&lt;/p&gt;</environment>
        <key id="12340846">DBCP-40</key>
            <summary>NullPointerException  in DBCP when used for client-server applications</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="4">Incomplete</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="vanitas@xentel.com">Vanita</reporter>
                        <labels>
                    </labels>
                <created>Thu, 10 Jul 2003 06:15:32 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:29 +0000</updated>
                            <resolved>Tue, 25 Mar 2008 08:11:29 +0000</resolved>
                                    <version>Nightly Builds</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12404686" author="dirkv" created="Tue, 12 Aug 2003 05:56:10 +0000"  >&lt;p&gt;Original mail from commons-user list (Vanita Shroff 2003-06-30)&lt;br/&gt;
----------------------------------------------------------------&lt;br/&gt;
Hello:&lt;br/&gt;
I am using DBCP  Jdbc2PoolDataSource and DriverAdapterCPDS for having a pool of&lt;br/&gt;
connections for a client-server application (without having an middle layer&lt;br/&gt;
application server tier). I am using Sun One Directory Server to bind my&lt;br/&gt;
Jdbc2PoolDataSource as a datasource object. I can successfully bind the object.&lt;br/&gt;
But from the client machine when I do JNDI lookup as:&lt;br/&gt;
Jdbc2PoolDataSource ref = (Jdbc2PoolDataSource)ctx2.lookup(pooldsbindString);&lt;/p&gt;

&lt;p&gt;Connection c = ref.getConnection();&lt;/p&gt;

&lt;p&gt;I get a nullpointerexception. Any idea what am I doing wrong here? How can I&lt;br/&gt;
create a pool of connections on the server and connect it from the client using&lt;br/&gt;
JNDI without using an application server tier?&lt;/p&gt;

&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;VS&lt;/p&gt;</comment>
                            <comment id="12404687" author="dirkv" created="Tue, 12 Aug 2003 06:21:25 +0000"  >&lt;p&gt;The question:&lt;br/&gt;
How can I create a pool of connections on the server and connect it from the&lt;br/&gt;
client using JNDI without using an application server tier?&lt;/p&gt;

&lt;p&gt;The answer:&lt;br/&gt;
Probably not. Even when we could transfer a kind of high level Connection object&lt;br/&gt;
from the application server to the client this Connection object would have to&lt;br/&gt;
reconnect to the database using a low level connection. So you wouldn&apos;t have any&lt;br/&gt;
advantage anyway.&lt;br/&gt;
If you want to do this setup to have a centralized configuration then only do&lt;br/&gt;
that. Store the configuration in the JNDI directory and create the pool on the&lt;br/&gt;
client.&lt;br/&gt;
If you are looking to solve a kind of network limit where the client cannot&lt;br/&gt;
directly connect to the database but has to go through the application server&lt;br/&gt;
and you want to use jdbc on the client then find a JDBC driver that works over&lt;br/&gt;
http or something similar.&lt;/p&gt;

&lt;p&gt;Take a look at &quot;Universal SQL Gateway&quot;&lt;br/&gt;
&lt;a href=&quot;http://www.opense.net/projects/sqlgateway/index.htm&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.opense.net/projects/sqlgateway/index.htm&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>21453</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114324</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            22 years, 14 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0v0nj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>179079</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-39] [PATCH] SharedPoolDataSource -  close() method closes pool instance only when pool available (initialized)</title>
                <link>https://issues.apache.org/jira/browse/DBCP-39</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;When SharedPoolDataSource is created and never initialized by call to&lt;br/&gt;
registerPool(String, String) method (called by getPooledConnectionAndInfo()&lt;br/&gt;
method , so no connection is requested from any caller), and the method close()&lt;br/&gt;
is called, the NullPointerException raises like this: &lt;br/&gt;
2005-11-04 16:24:15,990 [ContainerBackgroundProcessor[StandardEngine&lt;span class=&quot;error&quot;&gt;&amp;#91;Catalina&amp;#93;&lt;/span&gt;]]&lt;br/&gt;
ERROR org.apache.torque.dsfactory.SharedPoolDataSourceFactory - Exception caught&lt;br/&gt;
during close()&lt;br/&gt;
java.lang.NullPointerException&lt;br/&gt;
        at&lt;br/&gt;
org.apache.commons.dbcp.datasources.SharedPoolDataSource.close(SharedPoolDataSource.java:64)&lt;br/&gt;
        at&lt;br/&gt;
org.apache.torque.dsfactory.SharedPoolDataSourceFactory.close(SharedPoolDataSourceFactory.java:111)&lt;br/&gt;
        at org.apache.torque.TorqueInstance.shutdown(TorqueInstance.java:575)&lt;br/&gt;
        at org.apache.torque.avalon.TorqueComponent.stop(TorqueComponent.java:188)&lt;br/&gt;
        at&lt;br/&gt;
org.apache.avalon.framework.container.ContainerUtil.stop(ContainerUtil.java:314)&lt;br/&gt;
        at&lt;br/&gt;
org.apache.avalon.excalibur.component.DefaultComponentFactory.decommission(DefaultComponentFactory.java:381)&lt;br/&gt;
        at&lt;br/&gt;
org.apache.avalon.excalibur.component.ThreadSafeComponentHandler.dispose(ThreadSafeComponentHandler.java:198)&lt;br/&gt;
        at&lt;br/&gt;
org.apache.avalon.excalibur.component.ExcaliburComponentManager.dispose(ExcaliburComponentManager.java:654)&lt;br/&gt;
        at&lt;br/&gt;
org.apache.turbine.services.avaloncomponent.TurbineAvalonComponentService.dispose(TurbineAvalonComponentService.java:204)&lt;br/&gt;
        at&lt;br/&gt;
org.apache.turbine.services.avaloncomponent.TurbineAvalonComponentService.shutdown(TurbineAvalonComponentService.java:115)&lt;br/&gt;
        at&lt;br/&gt;
org.apache.turbine.services.BaseServiceBroker.shutdownService(BaseServiceBroker.java:383)&lt;br/&gt;
        at&lt;br/&gt;
org.apache.turbine.services.BaseServiceBroker.shutdownServices(BaseServiceBroker.java:429)&lt;br/&gt;
        at org.apache.turbine.Turbine.destroy(Turbine.java:628)&lt;br/&gt;
PooledConnection&lt;/p&gt;

&lt;p&gt;(output from logs of apache turbine, when the turbine application is deployed to&lt;br/&gt;
tomcat and then re-deployed ).&lt;/p&gt;

&lt;p&gt;To fix this, there is a patch:&lt;/p&gt;

&lt;p&gt;getPooledConnectionvimr@bene2:/var/data/src/java/commons-dbcp-cvs/jakarta-commons&amp;gt;&lt;br/&gt;
cvs diff -u&lt;br/&gt;
dbcp/src/java/org/apache/commons/dbcp/datasources/SharedPoolDataSource.java &lt;br/&gt;
Index: dbcp/src/java/org/apache/commons/dbcp/datasources/SharedPoolDataSource.java&lt;br/&gt;
===================================================================&lt;br/&gt;
RCS file:&lt;br/&gt;
/home/cvspublic/jakarta-commons/dbcp/src/java/org/apache/commons/dbcp/datasources/SharedPoolDataSource.java,v&lt;br/&gt;
retrieving revision 1.10&lt;br/&gt;
diff -u -r1.10 SharedPoolDataSource.java&lt;br/&gt;
&amp;#8212; dbcp/src/java/org/apache/commons/dbcp/datasources/SharedPoolDataSource.java&lt;br/&gt;
20 Oct 2004 20:46:30 -0000      1.10&lt;br/&gt;
+++ dbcp/src/java/org/apache/commons/dbcp/datasources/SharedPoolDataSource.java&lt;br/&gt;
4 Nov 2005 15:37:24 -0000&lt;br/&gt;
@@ -61,7 +61,10 @@&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Close pool being maintained by this datasource.&lt;br/&gt;
      */&lt;br/&gt;
     public void close() throws Exception 
{
-        pool.close();
+        
+        if(pool != null)
+            pool.close();
+
         InstanceKeyObjectFactory.removeInstance(instanceKey);
     }&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;Jindrich Vimr&lt;br/&gt;
&amp;lt;vimr@hsf.cz&amp;gt;&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: All&lt;br/&gt;
Platform: All&lt;/p&gt;</environment>
        <key id="12342678">DBCP-39</key>
            <summary>[PATCH] SharedPoolDataSource -  close() method closes pool instance only when pool available (initialized)</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="5" iconUrl="https://issues.apache.org/jira/images/icons/priorities/trivial.svg">Trivial</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="vimr@hsf.cz">Jindrich Vimr</reporter>
                        <labels>
                    </labels>
                <created>Sat, 5 Nov 2005 02:03:43 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:29 +0000</updated>
                            <resolved>Tue, 25 Mar 2008 08:11:29 +0000</resolved>
                                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12410755" author="phil@steitz.com" created="Sun, 12 Mar 2006 13:35:58 +0000"  >&lt;p&gt;Patch applied.  Thanks.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>37359</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114323</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            19 years, 35 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uzin:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178895</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-38] [dbcp] NullPointer with Oracle 9 driver</title>
                <link>https://issues.apache.org/jira/browse/DBCP-38</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;As per post on mailing list:&lt;/p&gt;

&lt;p&gt;I&apos;ve recently upgraded to the latest version of Tomcat (4.1.29), which&lt;br/&gt;
includes DBCP 1.1, over 1.0 in previous versions.&lt;/p&gt;

&lt;p&gt;On starting my application and attempting to logon to it, it falls over&lt;br/&gt;
with a NullPointerException, included here:&lt;br/&gt;
java.lang.NullPointerException&lt;br/&gt;
        at&lt;br/&gt;
oracle.jdbc.driver.ScrollableResultSet.close(ScrollableResultSet.java:14&lt;br/&gt;
9)&lt;br/&gt;
        at&lt;br/&gt;
org.apache.commons.dbcp.DelegatingResultSet.close(DelegatingResultSet.ja&lt;br/&gt;
va:193)&lt;br/&gt;
        at&lt;br/&gt;
org.apache.commons.dbcp.DelegatingResultSet.close(DelegatingResultSet.ja&lt;br/&gt;
va:193)&lt;br/&gt;
        at&lt;br/&gt;
org.apache.commons.dbcp.DelegatingPreparedStatement.passivate(Delegating&lt;br/&gt;
PreparedStatement.java:298)&lt;br/&gt;
        at&lt;br/&gt;
org.apache.commons.dbcp.DelegatingPreparedStatement.close(DelegatingPrep&lt;br/&gt;
aredStatement.java:185)&lt;br/&gt;
        at&lt;br/&gt;
com.pcmsgroup.v21.star.framework.persistence.BaseDbDAO.releaseResources(&lt;br/&gt;
BaseDbDAO.java:205)&lt;br/&gt;
        at&lt;br/&gt;
com.pcmsgroup.v21.star.persistence.logon.LogonDbDAO.fetchByLogonName(Log&lt;br/&gt;
onDbDAO.java:149)&lt;br/&gt;
        at&lt;br/&gt;
com.pcmsgroup.v21.star.domain.logon.Logon.logon(Logon.java:95)&lt;br/&gt;
        at&lt;br/&gt;
com.pcmsgroup.v21.star.service.logon.LogonService.logon(LogonService.jav&lt;br/&gt;
a:52)&lt;br/&gt;
        at&lt;br/&gt;
com.pcmsgroup.v21.star.application.logon.LogonCtrl.process(LogonCtrl.jav&lt;br/&gt;
a:87)&lt;br/&gt;
        at&lt;br/&gt;
com.pcmsgroup.v21.star.framework.application.BaseCtrl.execute(BaseCtrl.j&lt;br/&gt;
ava:180)&lt;br/&gt;
        at&lt;br/&gt;
org.apache.struts.action.RequestProcessor.processActionPerform(RequestPr&lt;br/&gt;
ocessor.java:484)&lt;br/&gt;
        at&lt;br/&gt;
org.apache.struts.action.RequestProcessor.process(RequestProcessor.java:&lt;br/&gt;
274)&lt;br/&gt;
        at&lt;br/&gt;
org.apache.struts.action.ActionServlet.process(ActionServlet.java:1482)&lt;br/&gt;
        at&lt;br/&gt;
org.apache.struts.action.ActionServlet.doPost(ActionServlet.java:525)&lt;br/&gt;
        at javax.servlet.http.HttpServlet.service(HttpServlet.java:760)&lt;br/&gt;
        at javax.servlet.http.HttpServlet.service(HttpServlet.java:853)&lt;br/&gt;
        at&lt;br/&gt;
org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(Applica&lt;br/&gt;
tionFilterChain.java:247)&lt;br/&gt;
        at&lt;br/&gt;
org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilt&lt;br/&gt;
erChain.java:193)&lt;br/&gt;
        at&lt;br/&gt;
com.pcmsgroup.v21.star.application.logon.LogonFilter.doFilter(LogonFilte&lt;br/&gt;
r.java:168)&lt;br/&gt;
        at&lt;br/&gt;
org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(Applica&lt;br/&gt;
tionFilterChain.java:213)&lt;br/&gt;
        ...&lt;/p&gt;

&lt;p&gt;I&apos;ve looked around the web, and in your CVS, and think that this is a&lt;br/&gt;
bug.&lt;/p&gt;

&lt;p&gt;The code in&lt;br/&gt;
com.pcmsgroup.v21.star.framework.persistence.BaseDbDAO.releaseResources&lt;br/&gt;
is as follows:&lt;/p&gt;

&lt;p&gt;  public final void releaseResources(Connection connection,&lt;br/&gt;
PreparedStatement ps, ResultSet rs) throws PersistenceException&lt;br/&gt;
  {&lt;br/&gt;
    try&lt;br/&gt;
    {&lt;br/&gt;
      if (rs != null)&lt;/p&gt;
      {
        rs.close();
      }
&lt;p&gt;      if (ps != null)&lt;/p&gt;
      {
        ps.close();
      }
&lt;p&gt;      if (connection != null)&lt;/p&gt;
      {
        // get the Factory
        ConnectionFactory factory = ConnectionFactory.getInstance();
        // turn the Connection back to pool
        factory.releaseConnection(connection);
      }
&lt;p&gt;    }&lt;br/&gt;
    catch (SQLException sqle)&lt;/p&gt;
    {
      thisLog.error(&quot;Failed to release resources&quot;, sqle);
    }
&lt;p&gt;    catch (Exception e)&lt;/p&gt;
    {
      thisLog.error(&quot;Failed to release resources&quot;, e);
      throw new PersistenceException(e);
    }
&lt;p&gt;  }&lt;/p&gt;

&lt;p&gt;As you can see, we close ResultSet, PreparedStatement and Connection in&lt;br/&gt;
the reverse order of that which we&lt;br/&gt;
got them in. On DBCP 1.0, this used to work fine. According to the JDK&lt;br/&gt;
API docs: &quot;When a Statement object is &lt;br/&gt;
closed, its current ResultSet object, if one exists, is also closed.&quot;&lt;br/&gt;
Thus closing the statement after closing the&lt;br/&gt;
result set is safe.&lt;/p&gt;

&lt;p&gt;However, for DBCP 1.1, a change was made to DelegatingPreparedStatement&lt;br/&gt;
(version 1.6 to 1.7), to &quot;ensure &lt;br/&gt;
PreparedStatment can only be closed once&quot;, which entailed changing:&lt;/p&gt;

&lt;p&gt;     public void close() throws SQLException &lt;/p&gt;
{
         passivate();
         _stmt.close();
     }

&lt;p&gt;to:&lt;/p&gt;

&lt;p&gt;     public void close() throws SQLException &lt;/p&gt;
{
         _stmt.close();
         passivate();
     }

&lt;p&gt;I believe this has introduced my problem and is a bug. As now, following&lt;br/&gt;
the logic:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;The statement is closed, and in accordance with the JDK docs, the&lt;br/&gt;
result set is closed.&lt;/li&gt;
	&lt;li&gt;The passivate method is then called, which calls ResultSet.close on&lt;br/&gt;
the underlying result set,&lt;br/&gt;
  regardless of whether it has been closed already.&lt;/li&gt;
	&lt;li&gt;This causes the underlying result set, which is already closed to try&lt;br/&gt;
to close again, thus&lt;br/&gt;
  the NullPointer.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;I couldn&apos;t spot this in the bug reports, so could someone answer if this&lt;br/&gt;
is a bug or not, or is there&lt;br/&gt;
something I am doing wrong, or should this be directed at the developers&lt;br/&gt;
list? I don&apos;t believe I should &lt;br/&gt;
quietly catch Exception&apos;s in the close() methods as per your examples,&lt;br/&gt;
as I&apos;d really like to know &lt;br/&gt;
if there are problems!&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: Windows XP&lt;br/&gt;
Platform: PC&lt;/p&gt;</environment>
        <key id="12341119">DBCP-38</key>
            <summary>[dbcp] NullPointer with Oracle 9 driver</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="simon.langford@pcmsgroup.com">Simon Matic Langford</reporter>
                        <labels>
                    </labels>
                <created>Tue, 25 Nov 2003 17:18:30 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:29 +0000</updated>
                            <resolved>Tue, 25 Mar 2008 08:11:29 +0000</resolved>
                                    <version>1.1</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12405540" author="dirkv" created="Fri, 26 Dec 2003 23:51:27 +0000"  >&lt;p&gt;Reversing the change would introduce other problems.&lt;br/&gt;
I have refactored the whole close() &amp;amp; passivate() methods in a way that they&lt;br/&gt;
don&apos;t call each other, this solves the whole problem.&lt;/p&gt;

&lt;p&gt;Activate &amp;amp; passivate in Delegate*Statement are now just delegating methods with&lt;br/&gt;
no side effects. The real implementation of passivate is pushed down into the&lt;br/&gt;
passivate method of PoolablePreparedStatement where it belongs.&lt;/p&gt;</comment>
                            <comment id="12405541" author="dennisl@apache.org" created="Thu, 28 Jul 2005 19:54:41 +0000"  >&lt;p&gt;This issue was resolved in release 1.2 of dbcp. Shouldn&apos;t it closed in bugzilla?&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>24966</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114322</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            20 years, 15 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uwtr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178459</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-37] getDelegate no longer useful since v1.7 of PoolingDataSource</title>
                <link>https://issues.apache.org/jira/browse/DBCP-37</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;Please refer to the communications between Dirk and I.&lt;/p&gt;

&lt;p&gt;Dirk&apos;s reply:&lt;/p&gt;

&lt;p&gt;OK, this needs to be fixed.&lt;/p&gt;

&lt;p&gt;I&apos;ll thinking about making PoolGuardConnectionWrapper a subclass of &lt;br/&gt;
 DelegatingConnection.&lt;br/&gt;
and implement the getDelegate() &amp;amp; getInnermostDelegate()&lt;/p&gt;

&lt;p&gt;You can then do:&lt;/p&gt;

&lt;p&gt;Connection conn = dataSource.getConnection();&lt;br/&gt;
Connection dconn = ((DelegatingConnection) conn).getInnermostDelegate();&lt;/p&gt;

&lt;p&gt;Make a bugzilla issue to keep track of this if you want.&lt;/p&gt;

&lt;p&gt;Cheers&lt;br/&gt;
Dirk&lt;/p&gt;


&lt;p&gt;Phillip Qin wrote:&lt;/p&gt;

&lt;p&gt;&amp;gt;PoolGuardConnectionWrapper was introduced to fix &quot;connection close &lt;br/&gt;
&amp;gt;twice&quot;. However it didn&apos;t consider some one like me rely on getDelegate &lt;br/&gt;
&amp;gt;to do something. I have removed PoolGuardConnectionWrapper from &lt;br/&gt;
&amp;gt;PoolingDataSource and rebuilt my own branch of commons-dbcp based on &lt;br/&gt;
&amp;gt;20030910 nightly build. Should I file a bug into bugzilla?&lt;br/&gt;
&amp;gt;&lt;br/&gt;
&amp;gt; ----&lt;del&gt;Original Message&lt;/del&gt;----&lt;br/&gt;
&amp;gt;From: Phillip Qin &lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;mailto:Phillip.Qin@shareowner.com&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Phillip.Qin@shareowner.com&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/mail_small.gif&quot; height=&quot;12&quot; width=&quot;13&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt;&lt;br/&gt;
&amp;gt;Sent: September 11, 2003 2:59 PM&lt;br/&gt;
&amp;gt;To: &apos;Jakarta Commons Users List&apos;&lt;br/&gt;
&amp;gt;Subject: RE: &lt;span class=&quot;error&quot;&gt;&amp;#91;dbcp&amp;#93;&lt;/span&gt;PoolableConnection BUG?&lt;br/&gt;
&amp;gt;&lt;br/&gt;
&amp;gt;I think I figured it out.&lt;br/&gt;
&amp;gt;&lt;br/&gt;
&amp;gt;In version 1.7, PoolGuardConnectionWrapper was added to wrap around &lt;br/&gt;
&amp;gt;PoolableConnection in PoolingDataSource.&lt;br/&gt;
&amp;gt;&lt;br/&gt;
&amp;gt;     public Connection getConnection() throws SQLException {&lt;br/&gt;
&amp;gt;         try {&lt;br/&gt;
&amp;gt;-            return (Connection)(_pool.borrowObject());&lt;br/&gt;
&amp;gt;+            Connection conn = (Connection)(_pool.borrowObject());&lt;br/&gt;
&amp;gt;+            if (conn != null) &lt;/p&gt;
{
&amp;gt;+                conn = new PoolGuardConnectionWrapper(conn);
&amp;gt;+            }
&lt;p&gt; &lt;br/&gt;
&amp;gt;+            return conn;&lt;br/&gt;
&amp;gt;&lt;br/&gt;
&amp;gt;-: 1.6, +: 1.7&lt;br/&gt;
&amp;gt;&lt;br/&gt;
&amp;gt;That&apos;s why the connection is not an instanceof PoolableConnection.&lt;br/&gt;
&amp;gt;&lt;br/&gt;
&amp;gt;Now my question is,&lt;br/&gt;
&amp;gt;&lt;br/&gt;
&amp;gt;I want to pass a SQL Array to Oracle stored procedure. In order to &lt;br/&gt;
&amp;gt;create an array descriptor, Oralce&apos;s &lt;br/&gt;
&amp;gt;ArrayDescriptor.createDescriptor(sqlArrayType,&lt;br/&gt;
&amp;gt;conn) requires conn a java.sql.Connection. It doesn&apos;t recognize a connection&lt;br/&gt;
&amp;gt;wrapper. In order to get the underlying Connection, I have to use&lt;br/&gt;
&amp;gt;getDelegate method. In order to use getDelegate method, I have to get a&lt;br/&gt;
&amp;gt;PoolableConnection or PoolGuardConnectionWrapper which has getDelegate&lt;br/&gt;
&amp;gt;method. If PoolGuardConnectionWrapper is private, how am I supposed to&lt;br/&gt;
&amp;gt;getDelegate?&lt;br/&gt;
&amp;gt;&lt;br/&gt;
&amp;gt;----&lt;del&gt;Original Message&lt;/del&gt;----&lt;br/&gt;
&amp;gt;From: Phillip Qin &lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;mailto:Phillip.Qin@shareowner.com&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Phillip.Qin@shareowner.com&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/mail_small.gif&quot; height=&quot;12&quot; width=&quot;13&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt;&lt;br/&gt;
&amp;gt;Sent: September 11, 2003 1:32 PM&lt;br/&gt;
&amp;gt;To: commons-user@jakarta.apache.org&lt;br/&gt;
&amp;gt;Subject: &lt;span class=&quot;error&quot;&gt;&amp;#91;dbcp&amp;#93;&lt;/span&gt;PoolableConnection BUG?&lt;br/&gt;
&amp;gt;&lt;br/&gt;
&amp;gt;BasicDataSource getConnection returns java.sql.Connection which is &lt;br/&gt;
&amp;gt;actually org.apache.commons.dbcp.PoolableConnection. When I cast this &lt;br/&gt;
&amp;gt;connection to PoolableConnection, I got ClassCastException.&lt;br/&gt;
&amp;gt;&lt;br/&gt;
&amp;gt;Connection conn = dataSource.getConnection();&lt;br/&gt;
&amp;gt;Connection dconn = ((PoolableConnection) conn).getDelegate() ;&lt;br/&gt;
&amp;gt;&lt;br/&gt;
&amp;gt;(PoolableConnection) conn throws ClassCastException.&lt;br/&gt;
&amp;gt;&lt;br/&gt;
&amp;gt;I didn&apos;t get the same exception in release 1.0. This happens on &lt;br/&gt;
&amp;gt;snapshot 20030910 and 20030911. I also use commons-pool snapshot &lt;br/&gt;
&amp;gt;20030910. Is it s bug?&lt;br/&gt;
&amp;gt;&lt;br/&gt;
&amp;gt;&lt;br/&gt;
&amp;gt;Regards,&lt;br/&gt;
&amp;gt;PQ&lt;br/&gt;
&amp;gt;&lt;br/&gt;
&amp;gt;  &lt;br/&gt;
&amp;gt;&lt;/p&gt;




&lt;p&gt;---------------------------------------------------------------------&lt;br/&gt;
To unsubscribe, e-mail: commons-user-unsubscribe@jakarta.apache.org&lt;br/&gt;
For additional commands, e-mail: commons-user-help@jakarta.apache.org&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: All&lt;br/&gt;
Platform: All&lt;/p&gt;</environment>
        <key id="12340962">DBCP-37</key>
            <summary>getDelegate no longer useful since v1.7 of PoolingDataSource</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="pqin@shareowner.com">Phillip Qin</reporter>
                        <labels>
                    </labels>
                <created>Fri, 12 Sep 2003 20:58:26 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:29 +0000</updated>
                            <resolved>Tue, 25 Mar 2008 08:11:29 +0000</resolved>
                                    <version>Nightly Builds</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12405047" author="dirkv" created="Sun, 14 Sep 2003 05:42:55 +0000"  >&lt;p&gt;Restored the getDelegate feature (access to the underlying connection)&lt;br/&gt;
If you set the &quot;accessToUnderlyingConnectionAllowed&quot; property to true then you&lt;br/&gt;
can do the following:&lt;/p&gt;

&lt;p&gt;    Connection conn = ds.getConnection();&lt;br/&gt;
    Connection dconn = ((DelegatingConnection) conn).getInnermostDelegate();&lt;br/&gt;
    ...&lt;br/&gt;
    conn.close()&lt;/p&gt;

&lt;p&gt;Default is false, it is a potential dangerous operation and misbehaving programs&lt;br/&gt;
can do harmfull things. (closing the underlying or continue using it when the&lt;br/&gt;
guarded connection is already closed)&lt;br/&gt;
Be carefull and only use when you need direct access to driver specific extentions.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>23138</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114321</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            22 years, 9 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uxzr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178648</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-36] BasicDataSource does not work with getConnection(String, String)</title>
                <link>https://issues.apache.org/jira/browse/DBCP-36</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;Using DBCP 1.2.1, I cannot get a BasicDataSource to work when credentials are &lt;br/&gt;
not supplied.  My application learns the username and password at runtime and &lt;br/&gt;
as a result has to use getConnection(String, String). The problem seems to &lt;br/&gt;
occur in the createDataSource() method.&lt;/p&gt;

&lt;p&gt;If a username and password are not supplied with the data source, they get &lt;br/&gt;
logged as missing, which is fine, but in the absence of the username/password &lt;br/&gt;
upon creation of the ConnectionPoolFactory, it bombs upon validation.  Since &lt;br/&gt;
createDataSource() is called without arguments regardless of the getConnection()&lt;br/&gt;
method that is called, validateConnectionFactory(PoolableConnectionFactory)&lt;br/&gt;
will always fail if the username and password are not supplied with the &lt;br/&gt;
original data source configuration.&lt;/p&gt;

&lt;p&gt;My application runs outside of an application server. I am using Spring 1.0 and &lt;br/&gt;
have tried HSQL and MySQL JDBC drivers. I can reproduce this error.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: Windows XP&lt;br/&gt;
Platform: PC&lt;/p&gt;</environment>
        <key id="12341559">DBCP-36</key>
            <summary>BasicDataSource does not work with getConnection(String, String)</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="fiddlerpianist@yahoo.com">Jonathan Whitall</reporter>
                        <labels>
                    </labels>
                <created>Thu, 8 Jul 2004 06:10:20 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:29 +0000</updated>
                            <resolved>Tue, 25 Mar 2008 08:11:29 +0000</resolved>
                                    <version>1.2</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12406975" author="dirkv" created="Fri, 9 Jul 2004 00:31:46 +0000"  >&lt;p&gt;BasicDataSource only supports the getConnection() method with the&lt;br/&gt;
username/password set globally on the datasource.&lt;/p&gt;

&lt;p&gt;If you want to use getConnection(String username, String password) &lt;br/&gt;
then you should use the org.apache.commons.dbcp.datasources.PerUserPoolDataSource&lt;/p&gt;</comment>
                            <comment id="12406976" author="fiddlerpianist@yahoo.com" created="Fri, 9 Jul 2004 01:18:07 +0000"  >&lt;p&gt;If a BasicDataSource claims to implement a javax.sql.DataSource, it needs to &lt;br/&gt;
implement all of javax.sql.DataSource&apos;s methods correctly, or else throw an &lt;br/&gt;
UnsupportedOperationException if the implementation chooses not to support such &lt;br/&gt;
operation (as in this case). Nowhere does the JavaDoc suggest that this &lt;br/&gt;
operation isn&apos;t supported for this class.&lt;/p&gt;</comment>
                            <comment id="12406977" author="dirkv" created="Sun, 11 Jul 2004 23:55:19 +0000"  >&lt;p&gt;Suggested code &amp;amp; javadoc enhancements implemented in revision 1.38&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;fail fast (throw UnsupportedOperationException)&lt;/li&gt;
	&lt;li&gt;update javadoc&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;&lt;a href=&quot;http://cvs.apache.org/viewcvs.cgi/jakarta-commons/dbcp/src/java/org/apache/commons/dbcp/BasicDataSource.java?r1=1.37&amp;amp;r2=1.38&amp;amp;diff_format=h&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://cvs.apache.org/viewcvs.cgi/jakarta-commons/dbcp/src/java/org/apache/commons/dbcp/BasicDataSource.java?r1=1.37&amp;amp;r2=1.38&amp;amp;diff_format=h&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>29963</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114320</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            21 years, 18 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0ux67:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178515</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-35] [dbcp] Old Xerces version in project.xml</title>
                <link>https://issues.apache.org/jira/browse/DBCP-35</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;The project.xml contains these dependecies:&lt;/p&gt;

&lt;p&gt;    &amp;lt;dependency&amp;gt;&lt;br/&gt;
      &amp;lt;groupId&amp;gt;xml-apis&amp;lt;/groupId&amp;gt;&lt;br/&gt;
      &amp;lt;artifactId&amp;gt;xml-apis&amp;lt;/artifactId&amp;gt;&lt;br/&gt;
      &amp;lt;version&amp;gt;2.0.2&amp;lt;/version&amp;gt;&lt;br/&gt;
    &amp;lt;/dependency&amp;gt;&lt;br/&gt;
    &amp;lt;!-- actually dbcp&apos;s tests need this too --&amp;gt;&lt;br/&gt;
    &amp;lt;dependency&amp;gt;&lt;br/&gt;
      &amp;lt;groupId&amp;gt;xerces&amp;lt;/groupId&amp;gt;&lt;br/&gt;
      &amp;lt;artifactId&amp;gt;xerces&amp;lt;/artifactId&amp;gt;&lt;br/&gt;
      &amp;lt;version&amp;gt;2.0.2&amp;lt;/version&amp;gt;&lt;br/&gt;
    &amp;lt;/dependency&amp;gt;&lt;/p&gt;

&lt;p&gt;2.0.2 is a &lt;b&gt;VERY&lt;/b&gt; old and buggy version of Xerces&lt;br/&gt;
. These two versions should be changed to 2.6.2. &lt;/p&gt;

&lt;p&gt;There&apos;s also a 2.7.1 but the Maven repositories are a little out of sync on that&lt;br/&gt;
version right now, and 2.6.2 fixes all the issues you&apos;re likely to encounter.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: other&lt;br/&gt;
Platform: Other&lt;/p&gt;</environment>
        <key id="12342631">DBCP-35</key>
            <summary>[dbcp] Old Xerces version in project.xml</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="elharo@metalab.unc.edu">elharo</reporter>
                        <labels>
                    </labels>
                <created>Fri, 14 Oct 2005 22:41:41 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:29 +0000</updated>
                            <resolved>Tue, 25 Mar 2008 08:11:29 +0000</resolved>
                                    <version>Nightly Builds</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12410618" author="phil@steitz.com" created="Mon, 13 Mar 2006 03:46:16 +0000"  >&lt;p&gt;Dependencies have been removed.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>37090</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114319</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            19 years, 35 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0ux73:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178519</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-34] [dbcp] SharedPoolDataSource raises exception while closing invalid connection</title>
                <link>https://issues.apache.org/jira/browse/DBCP-34</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;SharedPoolDataSource should ignore exception that happens when invalidated &lt;br/&gt;
connection is being closed (inside KeyedCPDSConnectionFactory&apos;s destroyObject() &lt;br/&gt;
method) when borrowing object from GenericKeyedObjectPool.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: All&lt;br/&gt;
Platform: All&lt;/p&gt;</environment>
        <key id="12341593">DBCP-34</key>
            <summary>[dbcp] SharedPoolDataSource raises exception while closing invalid connection</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="vjeran@tis.hr">Vjeran Marcinko</reporter>
                        <labels>
                    </labels>
                <created>Sat, 24 Jul 2004 19:06:48 +0000</created>
                <updated>Mon, 15 Feb 2010 04:19:26 +0000</updated>
                            <resolved>Tue, 17 Mar 2009 21:17:05 +0000</resolved>
                                                    <fixVersion>1.3</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12682809" author="markt" created="Tue, 17 Mar 2009 21:17:05 +0000"  >&lt;p&gt;I&apos;m not sure I understood this correctly. Working through the source, I believe the root cause is the issue I created and fixed as &lt;a href=&quot;https://issues.apache.org/jira/browse/POOL-133&quot; title=&quot;Failed object creation may result in invalid active count in GKOP&quot; class=&quot;issue-link&quot; data-issue-key=&quot;POOL-133&quot;&gt;&lt;del&gt;POOL-133&lt;/del&gt;&lt;/a&gt;. If I have mis-understood the point you were trying to make, please re-open this and correct me.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>30304</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114318</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            16 years, 34 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uwxr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178477</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-33] Incorrect stack trace shown when abandoned connections are closed</title>
                <link>https://issues.apache.org/jira/browse/DBCP-33</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;The stack trace shown when an abandoned connection is closed&lt;br/&gt;
(removeAbandoned=true, logAbandoned=true) is the wrong one: it&apos;s the trace of&lt;br/&gt;
where the connection was &lt;b&gt;first created&lt;/b&gt; from, not where it was &lt;b&gt;last allocated&lt;/b&gt;&lt;br/&gt;
from.&lt;/p&gt;

&lt;p&gt;I believe the cause is as simple as a missing setStackTrace() call in&lt;br/&gt;
AbandonedObjectPool.borrowObject(). (the createdBy object is only initialized in&lt;br/&gt;
the AbandonedTrace constructor, via the init() call, but is not reset each time&lt;br/&gt;
the object is allocated from the pool).&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: other&lt;br/&gt;
Platform: Other&lt;/p&gt;</environment>
        <key id="12340449">DBCP-33</key>
            <summary>Incorrect stack trace shown when abandoned connections are closed</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="shankarunni">Shankar Unni</reporter>
                        <labels>
                    </labels>
                <created>Fri, 6 Dec 2002 07:24:03 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:29 +0000</updated>
                            <resolved>Tue, 25 Mar 2008 08:11:29 +0000</resolved>
                                    <version>1.0</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12403315" author="rwaldhoff@apache.org" created="Fri, 7 Mar 2003 03:11:49 +0000"  >&lt;p&gt;I don&apos;t follow this well enough to be confident I&apos;m fixing it.  For example, I &lt;br/&gt;
don&apos;t see any other calls to setStackTrace.&lt;/p&gt;

&lt;p&gt;Perhaps someone more comfortable with the AbandonedObject stuff could take a &lt;br/&gt;
look, or submit a test case that demonstates this?&lt;/p&gt;</comment>
                            <comment id="12403316" author="shankarunni" created="Fri, 7 Mar 2003 03:23:43 +0000"  >&lt;p&gt;That may be the problem - that there are no other places that call setStackTrace().&lt;/p&gt;

&lt;p&gt;What does REMIND mean - does it mean that it&apos;s being shelved for the moment?&lt;br/&gt;
This problem makes logAbandoned nearly useless.&lt;/p&gt;

&lt;p&gt;I&apos;ll see if I can submit a patch for your approval.&lt;/p&gt;</comment>
                            <comment id="12403317" author="shankarunni" created="Fri, 22 Aug 2003 01:13:40 +0000"  >&lt;p&gt;I&apos;ll take a closer look at this (it&apos;s been bugging us a lot lately) and submit a&lt;br/&gt;
patch. It&apos;s definitely a problem.&lt;/p&gt;

&lt;p&gt;I hear Rodney&apos;s concern: the answer may be to have two separate trace objects:&lt;br/&gt;
one being a &quot;createdBy()&quot;, and one being a &quot;lastAllocatedBy()&quot;. If that&apos;s&lt;br/&gt;
important..&lt;/p&gt;</comment>
                            <comment id="12403318" author="dirkv" created="Fri, 22 Aug 2003 05:56:33 +0000"  >&lt;p&gt;You should use a more recent AbandonedObjectPool (nightly build) &lt;br/&gt;
(the fix is not included in dbcp release 1.0)&lt;/p&gt;

&lt;p&gt;This commit includes the missing setStackTrace().&lt;br/&gt;
Revision : 1.4&lt;br/&gt;
Date : 2003/3/6 19:25:34&lt;br/&gt;
Author : &apos;rwaldhoff&apos;&lt;br/&gt;
Description : scrub imports&lt;/p&gt;

&lt;p&gt;I have written a testcase:&lt;br/&gt;
&lt;a href=&quot;http://cvs.apache.org/viewcvs.cgi/jakarta-commons/dbcp/src/test/org/apache/commons/dbcp/TestAbandonedBasicDataSource.java?rev=1.1&amp;amp;content-type=text/vnd.viewcvs-markup&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://cvs.apache.org/viewcvs.cgi/jakarta-commons/dbcp/src/test/org/apache/commons/dbcp/TestAbandonedBasicDataSource.java?rev=1.1&amp;amp;content-type=text/vnd.viewcvs-markup&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;It gives the correct output.&lt;/p&gt;

&lt;p&gt;----------------------------------------&lt;br/&gt;
BEGIN getConnection1()&lt;br/&gt;
END getConnection1()&lt;br/&gt;
BEGIN getConnection2()&lt;br/&gt;
DBCP object created 2003-08-22 00:04:10 by the following code was never closed:&lt;br/&gt;
java.lang.Exception&lt;br/&gt;
	at org.apache.commons.dbcp.AbandonedTrace.setStackTrace(AbandonedTrace.java:201)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.commons.dbcp.AbandonedObjectPool.borrowObject(AbandonedObjectPool.java:120)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.commons.dbcp.PoolingDataSource.getConnection(PoolingDataSource.java:115)&lt;br/&gt;
	at org.apache.commons.dbcp.BasicDataSource.getConnection(BasicDataSource.java:416)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.commons.dbcp.TestAbandonedBasicDataSource.getConnection1(TestAbandonedBasicDataSource.java:110)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.commons.dbcp.TestAbandonedBasicDataSource.testAbandoned(TestAbandonedBasicDataSource.java:131)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)&lt;br/&gt;
	at&lt;br/&gt;
sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)&lt;br/&gt;
	at java.lang.reflect.Method.invoke(Method.java:324)&lt;br/&gt;
	at junit.framework.TestCase.runTest(TestCase.java:166)&lt;br/&gt;
	at junit.framework.TestCase.runBare(TestCase.java:140)&lt;br/&gt;
	at junit.framework.TestResult$1.protect(TestResult.java:106)&lt;br/&gt;
	at junit.framework.TestResult.runProtected(TestResult.java:124)&lt;br/&gt;
	at junit.framework.TestResult.run(TestResult.java:109)&lt;br/&gt;
	at junit.framework.TestCase.run(TestCase.java:131)&lt;br/&gt;
	at junit.framework.TestSuite.runTest(TestSuite.java:173)&lt;br/&gt;
	at junit.framework.TestSuite.run(TestSuite.java:168)&lt;br/&gt;
	at&lt;br/&gt;
org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:392)&lt;br/&gt;
	at&lt;br/&gt;
org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:276)&lt;br/&gt;
	at&lt;br/&gt;
org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.main(RemoteTestRunner.java:167)&lt;br/&gt;
END getConnection2()&lt;br/&gt;
BEGIN getConnection3()&lt;br/&gt;
DBCP object created 2003-08-22 00:04:10 by the following code was never closed:&lt;br/&gt;
java.lang.Exception&lt;br/&gt;
	at org.apache.commons.dbcp.AbandonedTrace.setStackTrace(AbandonedTrace.java:201)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.commons.dbcp.AbandonedObjectPool.borrowObject(AbandonedObjectPool.java:120)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.commons.dbcp.PoolingDataSource.getConnection(PoolingDataSource.java:115)&lt;br/&gt;
	at org.apache.commons.dbcp.BasicDataSource.getConnection(BasicDataSource.java:416)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.commons.dbcp.TestAbandonedBasicDataSource.getConnection2(TestAbandonedBasicDataSource.java:116)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.commons.dbcp.TestAbandonedBasicDataSource.testAbandoned(TestAbandonedBasicDataSource.java:132)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)&lt;br/&gt;
	at&lt;br/&gt;
sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)&lt;br/&gt;
	at java.lang.reflect.Method.invoke(Method.java:324)&lt;br/&gt;
	at junit.framework.TestCase.runTest(TestCase.java:166)&lt;br/&gt;
	at junit.framework.TestCase.runBare(TestCase.java:140)&lt;br/&gt;
	at junit.framework.TestResult$1.protect(TestResult.java:106)&lt;br/&gt;
	at junit.framework.TestResult.runProtected(TestResult.java:124)&lt;br/&gt;
	at junit.framework.TestResult.run(TestResult.java:109)&lt;br/&gt;
	at junit.framework.TestCase.run(TestCase.java:131)&lt;br/&gt;
	at junit.framework.TestSuite.runTest(TestSuite.java:173)&lt;br/&gt;
	at junit.framework.TestSuite.run(TestSuite.java:168)&lt;br/&gt;
	at&lt;br/&gt;
org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:392)&lt;br/&gt;
	at&lt;br/&gt;
org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:276)&lt;br/&gt;
	at&lt;br/&gt;
org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.main(RemoteTestRunner.java:167)&lt;br/&gt;
END getConnection3()&lt;br/&gt;
----------------------------------------&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>15123</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114317</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            22 years, 12 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uwv3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178465</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-32] Closing closed connection should be a no-op but throws exception</title>
                <link>https://issues.apache.org/jira/browse/DBCP-32</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;(Actually found in DBCP version 1.2.1)&lt;/p&gt;

&lt;p&gt;When a connection received from the DBCP pool has close() called upon it two&lt;br/&gt;
times, on the second call it will throw an SQL exception such as:&lt;/p&gt;

&lt;p&gt;java.sql.SQLException: Connection is closed.&lt;br/&gt;
        at&lt;br/&gt;
org.apache.commons.dbcp.PoolingDataSource$PoolGuardConnectionWrapper.checkOpen(PoolingDataSource.java:174)&lt;br/&gt;
        at&lt;br/&gt;
org.apache.commons.dbcp.PoolingDataSource$PoolGuardConnectionWrapper.close(PoolingDataSource.java:179)&lt;br/&gt;
        at... (calling code from here on)&lt;/p&gt;

&lt;p&gt;After browsing the docs/web site, this seems to be intended as a feature &amp;#8211; and&lt;br/&gt;
I can understand that, as it&apos;s generally indicative of poor logic to close a&lt;br/&gt;
connection twice. This is, however, directly in contradiction of the interface&lt;br/&gt;
defined by java.sql.Connection, which states in the javadocs of the close() method:&lt;/p&gt;

&lt;p&gt;&quot;Calling the method close on a Connection object that is already closed is a no-op.&quot;&lt;/p&gt;

&lt;p&gt;Functionally, what this means is that when a developer has an existing codebase&lt;br/&gt;
where connections are double-closed (which is legal within the interface&lt;br/&gt;
definition), he can switch to the DBCP pooling system from another system and&lt;br/&gt;
end up having exceptions thrown from double-closing Connections (as I did).&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: All&lt;br/&gt;
Platform: All&lt;/p&gt;</environment>
        <key id="12341734">DBCP-32</key>
            <summary>Closing closed connection should be a no-op but throws exception</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="3">Duplicate</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="amills@sensorlogic.com">Austin Mills</reporter>
                        <labels>
                    </labels>
                <created>Tue, 21 Sep 2004 05:20:20 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:29 +0000</updated>
                            <resolved>Tue, 25 Mar 2008 08:11:29 +0000</resolved>
                                    <version>1.2</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="12407611" author="amills@sensorlogic.com" created="Tue, 28 Sep 2004 04:41:15 +0000"  >

&lt;ul&gt;
	&lt;li&gt;
	&lt;ul&gt;
		&lt;li&gt;
		&lt;ul&gt;
			&lt;li&gt;This bug has been marked as a duplicate of 23185 ***&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>31319</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114316</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            21 years, 7 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0v05b:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178997</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-31] DBCP does not build under JDK 1.4</title>
                <link>https://issues.apache.org/jira/browse/DBCP-31</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;It appears that DBCP cannot be compiled with JDK 1.4.&lt;/p&gt;

&lt;p&gt;build-java:&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;javac&amp;#93;&lt;/span&gt; Compiling 9 source files to&lt;br/&gt;
/home/otis/cvs-repositories/jakarta/jakarta-commons/dbcp/dist/classes&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;javac&amp;#93;&lt;/span&gt;&lt;br/&gt;
/home/otis/cvs-repositories/jakarta/jakarta-commons/dbcp/src/java/org/ap&lt;br/&gt;
ache/commons/dbcp/PoolablePreparedStatement.java:79:&lt;br/&gt;
org.apache.commons.dbcp.PoolablePreparedStatement should be declared&lt;br/&gt;
abstract; it does not define getMoreResults(int) in&lt;br/&gt;
org.apache.commons.dbcp.PoolablePreparedStatement&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;javac&amp;#93;&lt;/span&gt; public class PoolablePreparedStatement extends&lt;br/&gt;
DelegatingPreparedStatement implements PreparedStatement {&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;javac&amp;#93;&lt;/span&gt; ^&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;javac&amp;#93;&lt;/span&gt;&lt;br/&gt;
/home/otis/cvs-repositories/jakarta/jakarta-commons/dbcp/src/java/org/ap&lt;br/&gt;
ache/commons/dbcp/PoolablePreparedStatement.java:79: warning:&lt;br/&gt;
setUnicodeStream(int,java.io.InputStream,int) in&lt;br/&gt;
java.sql.PreparedStatement has been deprecated&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;javac&amp;#93;&lt;/span&gt; public class PoolablePreparedStatement extends&lt;br/&gt;
DelegatingPreparedStatement implements PreparedStatement {&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;javac&amp;#93;&lt;/span&gt; ^&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;javac&amp;#93;&lt;/span&gt;&lt;br/&gt;
/home/otis/cvs-repositories/jakarta/jakarta-commons/dbcp/src/java/org/ap&lt;br/&gt;
ache/commons/dbcp/PoolingConnection.java:78:&lt;br/&gt;
org.apache.commons.dbcp.PoolingConnection should be declared abstract;&lt;br/&gt;
it does not define setHoldability(int) in&lt;br/&gt;
org.apache.commons.dbcp.PoolingConnection&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;javac&amp;#93;&lt;/span&gt; public class PoolingConnection extends DelegatingConnection&lt;br/&gt;
implements Connection, KeyedPoolableObjectFactory {&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;javac&amp;#93;&lt;/span&gt; ^&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;javac&amp;#93;&lt;/span&gt; 2 errors&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;javac&amp;#93;&lt;/span&gt; 1 warning&lt;/p&gt;

&lt;p&gt;BUILD FAILED&lt;/p&gt;



&lt;p&gt;Juozas Baliuka said:&lt;br/&gt;
&quot;We use reflection in Simplestore, it is not very fast, but it is very&lt;br/&gt;
trivial solution to implement version neutral Connection interface&lt;br/&gt;
(implementation generated at runtime).&quot;&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: other&lt;br/&gt;
Platform: Other&lt;/p&gt;</environment>
        <key id="12340181">DBCP-31</key>
            <summary>DBCP does not build under JDK 1.4</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="otis@apache.org">Otis Gospodnetic</reporter>
                        <labels>
                    </labels>
                <created>Tue, 12 Mar 2002 07:31:18 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:29 +0000</updated>
                            <resolved>Tue, 25 Mar 2008 08:11:29 +0000</resolved>
                                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12402541" author="craig.mcclanahan@sun.com" created="Tue, 19 Mar 2002 14:23:44 +0000"  >&lt;p&gt;Fixed in nightly build 20020319.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>7038</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114315</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            23 years, 35 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0ux6n:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178517</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-30] oracle connections in tomcat connection pool not reused</title>
                <link>https://issues.apache.org/jira/browse/DBCP-30</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;My configuration :  &lt;/p&gt;

&lt;p&gt;Dell PowerEdge 2650  &lt;br/&gt;
Mandrake Linux 10 (kernel 2.4)  &lt;br/&gt;
Sun Java  1.4.2_04  &lt;br/&gt;
Oracle 10g  &lt;br/&gt;
JDBC Drivers for oracle 10g (ojdbc14.jar)  &lt;br/&gt;
Apache 2.0.48  &lt;br/&gt;
Use of mod_jk2 and the apj13 coyote connector  &lt;br/&gt;
http application uses http sessions  &lt;/p&gt;


&lt;p&gt;Hello there,  &lt;/p&gt;


&lt;p&gt;I&apos;m having a very serious problem with my oracle database connections.  &lt;br/&gt;
To allow reuse of open connection we use a database connection pool.  &lt;/p&gt;

&lt;p&gt;The configuration in the server.xml is the following :  &lt;/p&gt;

&lt;p&gt;&amp;lt;Context debug=&quot;0&quot; docBase=&quot;macq&quot; path=&quot;/macq&quot; reloadable=&quot;false&quot;&amp;gt;  &lt;br/&gt;
                &amp;lt;Resource name=&quot;ed/macq&quot; auth=&quot;Container&quot;  &lt;br/&gt;
type=&quot;javax.sql.DataSource&quot;/&amp;gt;  &lt;br/&gt;
                &amp;lt;ResourceParams name=&quot;ed/macq&quot;&amp;gt;  &lt;br/&gt;
                &amp;lt;parameter&amp;gt;  &lt;br/&gt;
                        &amp;lt;name&amp;gt;factory&amp;lt;/name&amp;gt;  &lt;/p&gt;

&lt;p&gt;&amp;lt;value&amp;gt;org.apache.commons.dbcp.BasicDataSourceFactory&amp;lt;/value&amp;gt;  &lt;br/&gt;
                &amp;lt;/parameter&amp;gt;  &lt;br/&gt;
                &amp;lt;parameter&amp;gt;  &lt;br/&gt;
                        &amp;lt;name&amp;gt;driverClassName&amp;lt;/name&amp;gt;  &lt;br/&gt;
                        &amp;lt;value&amp;gt;oracle.jdbc.driver.OracleDriver&amp;lt;/value&amp;gt;  &lt;br/&gt;
                &amp;lt;/parameter&amp;gt;  &lt;br/&gt;
                &amp;lt;parameter&amp;gt;  &lt;br/&gt;
                        &amp;lt;name&amp;gt;url&amp;lt;/name&amp;gt;  &lt;/p&gt;

&lt;p&gt;&amp;lt;value&amp;gt;jdbc:oracle:thin:@turgon_02.disforce.be:1521:turgon2&amp;lt;/value&amp;gt;  &lt;br/&gt;
                &amp;lt;/parameter&amp;gt;  &lt;br/&gt;
                &amp;lt;parameter&amp;gt;  &lt;br/&gt;
                        &amp;lt;name&amp;gt;username&amp;lt;/name&amp;gt;  &lt;br/&gt;
                        &amp;lt;value&amp;gt;macqloader&amp;lt;/value&amp;gt;  &lt;br/&gt;
                &amp;lt;/parameter&amp;gt;  &lt;br/&gt;
                &amp;lt;parameter&amp;gt;  &lt;br/&gt;
                        &amp;lt;name&amp;gt;password&amp;lt;/name&amp;gt;  &lt;br/&gt;
                        &amp;lt;value&amp;gt;********&amp;lt;/value&amp;gt;  &lt;br/&gt;
                &amp;lt;/parameter&amp;gt;  &lt;br/&gt;
                &amp;lt;parameter&amp;gt;  &lt;br/&gt;
                        &amp;lt;name&amp;gt;maxActive&amp;lt;/name&amp;gt;  &lt;br/&gt;
                        &amp;lt;value&amp;gt;300&amp;lt;/value&amp;gt;  &lt;br/&gt;
                &amp;lt;/parameter&amp;gt;  &lt;br/&gt;
                &amp;lt;parameter&amp;gt;  &lt;br/&gt;
                        &amp;lt;name&amp;gt;maxIdle&amp;lt;/name&amp;gt;  &lt;br/&gt;
                        &amp;lt;value&amp;gt;10&amp;lt;/value&amp;gt;  &lt;br/&gt;
                &amp;lt;/parameter&amp;gt;  &lt;br/&gt;
                &amp;lt;parameter&amp;gt;  &lt;br/&gt;
                        &amp;lt;name&amp;gt;maxWait&amp;lt;/name&amp;gt;  &lt;br/&gt;
                        &amp;lt;value&amp;gt;10000&amp;lt;/value&amp;gt;  &lt;br/&gt;
                &amp;lt;/parameter&amp;gt;  &lt;br/&gt;
                ...  &lt;/p&gt;

&lt;p&gt;The behaviour we see is very strange.  &lt;br/&gt;
When starting up tomcat, we see a number of connections being opened.  &lt;br/&gt;
That is rather normal. Now for every jsp with database activity a new database  &lt;br/&gt;
connection is added until the maximum number of connections is achieved (300  &lt;br/&gt;
in this case).   &lt;/p&gt;

&lt;p&gt;In this first phase the maximum number of users is 5, logically we should see  &lt;br/&gt;
no more than five concurrent database connections open.  &lt;/p&gt;

&lt;p&gt;When looking in TOAD, we see all database connections as inactive so they  &lt;br/&gt;
should be reused.  &lt;/p&gt;

&lt;p&gt;In a second phase of my project a deployment on hundreds of workstations will  &lt;br/&gt;
start. I cannot continue with this if my database connections are not being  &lt;br/&gt;
resused.  &lt;/p&gt;

&lt;p&gt;Any help would be greatly appreciated.  &lt;/p&gt;

&lt;p&gt;Tom Colman  &lt;br/&gt;
Belgacom  &lt;br/&gt;
CBS/DIS/PTE&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: Linux&lt;br/&gt;
Platform: PC&lt;/p&gt;</environment>
        <key id="12341550">DBCP-30</key>
            <summary>oracle connections in tomcat connection pool not reused</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="4">Incomplete</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="tc@disforce.be">Tom Colman</reporter>
                        <labels>
                    </labels>
                <created>Tue, 29 Jun 2004 17:55:21 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:29 +0000</updated>
                            <resolved>Tue, 25 Mar 2008 08:11:29 +0000</resolved>
                                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12406954" author="dirkv" created="Wed, 30 Jun 2004 03:26:29 +0000"  >&lt;p&gt;Are you closing your connections everywhere?&lt;br/&gt;
Can you provide a simple test jsp showing the problem?&lt;/p&gt;

&lt;p&gt;The commons-user mailing list is a good place to debug this.&lt;/p&gt;</comment>
                            <comment id="12406955" author="tc@disforce.be" created="Wed, 30 Jun 2004 18:21:49 +0000"  >&lt;p&gt;Hello there, &lt;/p&gt;


&lt;p&gt;After long searching, I found a missing close statement. &lt;br/&gt;
Since our server has plenty of memory the connections are never closed  &lt;br/&gt;
or garbage collected. &lt;/p&gt;

&lt;p&gt;This has cost me a week. &lt;/p&gt;

&lt;p&gt;Sorry to have bothered you &lt;/p&gt;

&lt;p&gt;Greetings, &lt;br/&gt;
Tom &lt;/p&gt;


</comment>
                            <comment id="12406956" author="dirkv" created="Thu, 1 Jul 2004 00:20:20 +0000"  >&lt;p&gt;Issue is invalid&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>29859</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114314</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            21 years, 20 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0v0if:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>179056</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-29] DBCP doesn&apos;t work on Tomcat 4.1.12 and Oracle JDBC driver</title>
                <link>https://issues.apache.org/jira/browse/DBCP-29</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;I am unable to get to get Connection Pooling using DBCP to work in Tomcat &lt;br/&gt;
4.1.12. It works in 4.0.4, but when trying this in 4.1.12 I get:&lt;br/&gt;
&quot;Cannot load JDBC driver class &apos;null&apos;&quot;&lt;/p&gt;

&lt;p&gt;It seems a lot of people are getting this error.&lt;br/&gt;
I am able to create a regular DriverManager connection.&lt;/p&gt;

&lt;p&gt;My server.xml entry:&lt;br/&gt;
&amp;lt;ResourceParams name=&quot;jdbc/DronePool&quot;&amp;gt;&lt;br/&gt;
  &amp;lt;parameter&amp;gt;&lt;br/&gt;
    &amp;lt;name&amp;gt;factory&amp;lt;/name&amp;gt;&lt;br/&gt;
    &amp;lt;value&amp;gt;org.apache.commons.dbcp.BasicDataSourceFactory&amp;lt;/value&amp;gt;&lt;br/&gt;
  &amp;lt;/parameter&amp;gt;&lt;br/&gt;
  &amp;lt;parameter&amp;gt;&lt;br/&gt;
    &amp;lt;name&amp;gt;driverClassName&amp;lt;/name&amp;gt;&lt;br/&gt;
    &amp;lt;value&amp;gt;oracle.jdbc.driver.OracleDriver&amp;lt;/value&amp;gt;&lt;br/&gt;
  &amp;lt;/parameter&amp;gt;&lt;br/&gt;
  &amp;lt;parameter&amp;gt;&lt;br/&gt;
    &amp;lt;name&amp;gt;url&amp;lt;/name&amp;gt;&lt;br/&gt;
    &amp;lt;value&amp;gt;jdbc:oracle:thin:drnwebuser@mynode:1521:myinstance&amp;lt;/value&amp;gt;&lt;br/&gt;
  &amp;lt;/parameter&amp;gt;&lt;br/&gt;
  &amp;lt;parameter&amp;gt;&lt;br/&gt;
    &amp;lt;name&amp;gt;username&amp;lt;/name&amp;gt;&lt;br/&gt;
    &amp;lt;value&amp;gt;myuser&amp;lt;/value&amp;gt;&lt;br/&gt;
  &amp;lt;/parameter&amp;gt;&lt;br/&gt;
  &amp;lt;parameter&amp;gt;&lt;br/&gt;
    &amp;lt;name&amp;gt;password&amp;lt;/name&amp;gt;&lt;br/&gt;
    &amp;lt;value&amp;gt;mypassword&amp;lt;/value&amp;gt;&lt;br/&gt;
  &amp;lt;/parameter&amp;gt;&lt;br/&gt;
  &amp;lt;parameter&amp;gt;&lt;br/&gt;
    &amp;lt;name&amp;gt;maxActive&amp;lt;/name&amp;gt;&lt;br/&gt;
    &amp;lt;value&amp;gt;20&amp;lt;/value&amp;gt;&lt;br/&gt;
  &amp;lt;/parameter&amp;gt;&lt;br/&gt;
  &amp;lt;parameter&amp;gt;&lt;br/&gt;
    &amp;lt;name&amp;gt;maxIdle&amp;lt;/name&amp;gt;&lt;br/&gt;
    &amp;lt;value&amp;gt;10&amp;lt;/value&amp;gt;&lt;br/&gt;
  &amp;lt;/parameter&amp;gt;&lt;br/&gt;
  &amp;lt;parameter&amp;gt;&lt;br/&gt;
    &amp;lt;name&amp;gt;maxWait&amp;lt;/name&amp;gt;&lt;br/&gt;
    &amp;lt;value&amp;gt;-1&amp;lt;/value&amp;gt;&lt;br/&gt;
  &amp;lt;/parameter&amp;gt;&lt;br/&gt;
&amp;lt;/ResourceParams&amp;gt;&lt;/p&gt;


&lt;p&gt;And here is my web.xml:&lt;br/&gt;
&amp;lt;resource-ref&amp;gt;&lt;br/&gt;
 &amp;lt;description&amp;gt;Oracle Datasource example&amp;lt;/description&amp;gt;&lt;br/&gt;
 &amp;lt;res-ref-name&amp;gt;jdbc/DronePool&amp;lt;/res-ref-name&amp;gt;&lt;br/&gt;
 &amp;lt;res-type&amp;gt;javax.sql.DataSource&amp;lt;/res-type&amp;gt;&lt;br/&gt;
 &amp;lt;res-auth&amp;gt;Container&amp;lt;/res-auth&amp;gt;&lt;br/&gt;
&amp;lt;/resource-ref&amp;gt;&lt;/p&gt;




&lt;p&gt;Any ideas?&lt;/p&gt;


&lt;p&gt;thank you for the help!&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: Linux&lt;br/&gt;
Platform: PC&lt;/p&gt;</environment>
        <key id="12340400">DBCP-29</key>
            <summary>DBCP doesn&apos;t work on Tomcat 4.1.12 and Oracle JDBC driver</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="troy.campano@libertymutual.com">Troy Campano</reporter>
                        <labels>
                    </labels>
                <created>Wed, 6 Nov 2002 03:01:02 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:29 +0000</updated>
                            <resolved>Fri, 24 Nov 2006 20:48:06 +0000</resolved>
                                    <version>1.0</version>
                                                        <due></due>
                            <votes>1</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12403163" author="rwaldhof@us.britannica.com" created="Wed, 6 Nov 2002 19:39:17 +0000"  >&lt;p&gt;Maybe a classpath issue of some sort?&lt;/p&gt;

&lt;p&gt;Can you post the exact stack trace if any, and maybe some information about &lt;br/&gt;
your classpath?&lt;/p&gt;

&lt;p&gt;You wrote &quot;It works in 4.0.4, but when trying this in 4.1.12 &lt;span class=&quot;error&quot;&gt;&amp;#91;...&amp;#93;&lt;/span&gt;&quot;, does this &lt;br/&gt;
mean with precisely the same configuration and layout (classpath, etc.)?  &lt;br/&gt;
Anyone know what&apos;s changed between TC 4.0 and 4.1 that may be related?&lt;/p&gt;</comment>
                            <comment id="12403164" author="troy.campano@libertymutual.com" created="Wed, 6 Nov 2002 22:18:50 +0000"  >&lt;p&gt;Tomcat 4.0.6 (the working classpath):&lt;br/&gt;
/usr/local/java/lib/tools.jar:&lt;br/&gt;
/usr/local/tomcat/common/lib/commons-dbcp.jar:&lt;br/&gt;
/usr/local/tomcat/common/lib/commons-collections.jar:&lt;br/&gt;
/usr/local/tomcat/common/lib/commons-lang.jar:&lt;br/&gt;
/usr/local/tomcat/common/lib/commons-logging-api.jar:&lt;br/&gt;
/usr/local/tomcat/common/lib/commons-pool.jar:&lt;br/&gt;
/usr/local/tomcat/common/lib/classes12.jar:&lt;br/&gt;
/usr/local/tomcat/bin/bootstrap.jar&lt;/p&gt;

&lt;p&gt;Tomcat 4.1.12 (the not working classpath):&lt;br/&gt;
Tomcat 4.1.12 java.class.path --&amp;gt; /usr/local/java/lib/tools.jar:&lt;br/&gt;
/usr/local/tomcat4.1.12/bin/bootstrap.jar:&lt;br/&gt;
/usr/local/tomcat4.1.12/common/lib/activation.jar:&lt;br/&gt;
/usr/local/tomcat4.1.12/common/lib/commons-collections.jar:&lt;br/&gt;
/usr/local/tomcat4.1.12/common/lib/commons-pool.jar:&lt;br/&gt;
/usr/local/tomcat4.1.12/common/lib/jdbc2_0-stdext.jar:&lt;br/&gt;
/usr/local/tomcat4.1.12/common/lib/mail.jar:&lt;br/&gt;
/usr/local/tomcat4.1.12/common/lib/naming-resources.jar:&lt;br/&gt;
/usr/local/tomcat4.1.12/common/lib/ant.jar:&lt;br/&gt;
/usr/local/tomcat4.1.12/common/lib/commons-dbcp.jar:&lt;br/&gt;
/usr/local/tomcat4.1.12/common/lib/jasper-compiler.jar:&lt;br/&gt;
/usr/local/tomcat4.1.12/common/lib/jndi.jar:&lt;br/&gt;
/usr/local/tomcat4.1.12/common/lib/naming-common.jar:&lt;br/&gt;
/usr/local/tomcat4.1.12/common/lib/servlet.jar:&lt;br/&gt;
/usr/local/tomcat4.1.12/common/lib/classes12.jar:&lt;br/&gt;
/usr/local/tomcat4.1.12/common/lib/commons-logging-api.jar:&lt;br/&gt;
/usr/local/tomcat4.1.12/common/lib/jasper-runtime.jar:&lt;br/&gt;
/usr/local/tomcat4.1.12/common/lib/jta.jar:&lt;br/&gt;
/usr/local/tomcat4.1.12/common/lib/naming-factory.jar&lt;/p&gt;


&lt;p&gt;The error on Tomcat 4.1.12:&lt;br/&gt;
javax.servlet.ServletException: Cannot load JDBC driver class &apos;null&apos;&lt;br/&gt;
	at org.apache.jasper.runtime.PageContextImpl.handlePageException&lt;br/&gt;
(PageContextImpl.java:497)&lt;br/&gt;
	at org.apache.jsp.test_connectionpool_jsp._jspService&lt;br/&gt;
(test_connectionpool_jsp.java:104)&lt;br/&gt;
	at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:136)&lt;br/&gt;
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:853)&lt;br/&gt;
	at org.apache.jasper.servlet.JspServletWrapper.service&lt;br/&gt;
(JspServletWrapper.java:204)&lt;br/&gt;
	at org.apache.jasper.servlet.JspServlet.serviceJspFile&lt;br/&gt;
(JspServlet.java:289)&lt;br/&gt;
	at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:240)&lt;br/&gt;
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:853)&lt;br/&gt;
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter&lt;br/&gt;
(ApplicationFilterChain.java:247)&lt;br/&gt;
	at org.apache.catalina.core.ApplicationFilterChain.doFilter&lt;br/&gt;
(ApplicationFilterChain.java:193)&lt;br/&gt;
	at org.apache.catalina.core.StandardWrapperValve.invoke&lt;br/&gt;
(StandardWrapperValve.java:260)&lt;br/&gt;
	at &lt;br/&gt;
org.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNex&lt;br/&gt;
t(StandardPipeline.java:643)&lt;br/&gt;
	at org.apache.catalina.core.StandardPipeline.invoke&lt;br/&gt;
(StandardPipeline.java:480)&lt;br/&gt;
	at org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:995)&lt;br/&gt;
	at org.apache.catalina.core.StandardContextValve.invoke&lt;br/&gt;
(StandardContextValve.java:191)&lt;br/&gt;
	at &lt;br/&gt;
org.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNex&lt;br/&gt;
t(StandardPipeline.java:643)&lt;br/&gt;
	at org.apache.catalina.core.StandardPipeline.invoke&lt;br/&gt;
(StandardPipeline.java:480)&lt;br/&gt;
	at org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:995)&lt;br/&gt;
	at org.apache.catalina.core.StandardContext.invoke&lt;br/&gt;
(StandardContext.java:2396)&lt;br/&gt;
	at org.apache.catalina.core.StandardHostValve.invoke&lt;br/&gt;
(StandardHostValve.java:180)&lt;br/&gt;
	at &lt;br/&gt;
org.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNex&lt;br/&gt;
t(StandardPipeline.java:643)&lt;br/&gt;
	at org.apache.catalina.valves.ErrorDispatcherValve.invoke&lt;br/&gt;
(ErrorDispatcherValve.java:170)&lt;br/&gt;
	at &lt;br/&gt;
org.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNex&lt;br/&gt;
t(StandardPipeline.java:641)&lt;br/&gt;
	at org.apache.catalina.valves.ErrorReportValve.invoke&lt;br/&gt;
(ErrorReportValve.java:172)&lt;br/&gt;
	at &lt;br/&gt;
org.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNex&lt;br/&gt;
t(StandardPipeline.java:641)&lt;br/&gt;
	at org.apache.catalina.core.StandardPipeline.invoke&lt;br/&gt;
(StandardPipeline.java:480)&lt;br/&gt;
	at org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:995)&lt;br/&gt;
	at org.apache.catalina.core.StandardEngineValve.invoke&lt;br/&gt;
(StandardEngineValve.java:174)&lt;br/&gt;
	at &lt;br/&gt;
org.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNex&lt;br/&gt;
t(StandardPipeline.java:643)&lt;br/&gt;
	at org.apache.catalina.core.StandardPipeline.invoke&lt;br/&gt;
(StandardPipeline.java:480)&lt;br/&gt;
	at org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:995)&lt;br/&gt;
	at org.apache.coyote.tomcat4.CoyoteAdapter.service&lt;br/&gt;
(CoyoteAdapter.java:223)&lt;br/&gt;
	at org.apache.coyote.http11.Http11Processor.process&lt;br/&gt;
(Http11Processor.java:405)&lt;br/&gt;
	at &lt;br/&gt;
org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.processConnectio&lt;br/&gt;
n(Http11Protocol.java:380)&lt;br/&gt;
	at org.apache.tomcat.util.net.TcpWorkerThread.runIt&lt;br/&gt;
(PoolTcpEndpoint.java:508)&lt;br/&gt;
	at org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run&lt;br/&gt;
(ThreadPool.java:533)&lt;br/&gt;
	at java.lang.Thread.run(Thread.java:479)&lt;/p&gt;











</comment>
                            <comment id="12403165" author="rwaldhof@us.britannica.com" created="Wed, 6 Nov 2002 23:38:28 +0000"  >&lt;p&gt;Thanks.  Can you also post the code of test/connectionpool.jsp, or whatever is &lt;br/&gt;
invoking the pool?&lt;/p&gt;</comment>
                            <comment id="12403166" author="troy.campano@libertymutual.com" created="Thu, 7 Nov 2002 00:07:09 +0000"  >&lt;p&gt;Here&apos;s the code:&lt;/p&gt;

&lt;p&gt;thank you!&lt;/p&gt;


&lt;p&gt;&amp;lt;%@ page contentType=&quot;text/html; charset=iso-8859-1&quot; language=&quot;java&quot; &lt;br/&gt;
import=&quot;java.sql.&lt;b&gt;,javax.sql.&lt;/b&gt;,oracle.jdbc.pool.&lt;b&gt;,javax.naming.&lt;/b&gt;,java.io.*&quot; %&amp;gt;&lt;/p&gt;

&lt;p&gt;&amp;lt;%&lt;br/&gt;
Connection conn = null;&lt;br/&gt;
try&lt;/p&gt;
{
//******************************************************************************
*******************
// Request Connection from Connection Pool
//******************************************************************************
*******************
Context initContext = new InitialContext();
Context envContext  = (Context)initContext.lookup(&quot;java:/comp/env&quot;);
DataSource ds = (DataSource)envContext.lookup(&quot;jdbc/DronePool&quot;);
conn = ds.getConnection();

//******************************************************************************
*******************



String sSQL = &quot;SELECT table_name FROM all_tables&quot;;
Statement stmt = conn.createStatement();
ResultSet rs   = stmt.executeQuery(sSQL);
while (rs.next())
{
 out.println(&quot;the table name is: &quot; + rs.getString(&quot;table_name&quot;) + &quot;&amp;lt;br /&amp;gt;&quot;);
}
rs.close();
stmt.close();
rs = null;
stmt = null;



}
&lt;p&gt;catch(SQLException e)&lt;br/&gt;
{&lt;br/&gt;
 throw new SQLException(e.getMessage());&lt;br/&gt;
}&lt;/p&gt;

&lt;p&gt;  finally &lt;br/&gt;
  {&lt;br/&gt;
    if (conn != null) &lt;br/&gt;
	{&lt;br/&gt;
      try &lt;/p&gt;
	  {
        conn.close();
      } 
&lt;p&gt;	  catch (SQLException e) &lt;/p&gt;
	  {
          // Nothing coherent to do here.
          // Pray nothing else goes wrong.
          e.printStackTrace();
      }
&lt;p&gt;	}&lt;br/&gt;
  }&lt;br/&gt;
%&amp;gt;&lt;/p&gt;</comment>
                            <comment id="12403167" author="rwaldhof@us.britannica.com" created="Thu, 7 Nov 2002 23:23:37 +0000"  >&lt;p&gt;Just a thought, all of the examples I&apos;ve seen show:&lt;/p&gt;

&lt;p&gt; Context envContext = (Context)initContext.lookup(&quot;java:comp/env&quot;);&lt;/p&gt;

&lt;p&gt;but you&apos;ve got:&lt;/p&gt;

&lt;p&gt; Context envContext = (Context)initContext.lookup(&quot;java:/comp/env&quot;);&lt;br/&gt;
                                                       ^&lt;br/&gt;
Is that a problem?&lt;/p&gt;</comment>
                            <comment id="12403168" author="troy.campano@libertymutual.com" created="Thu, 7 Nov 2002 23:29:19 +0000"  >&lt;p&gt;Nope, didn&apos;t work.&lt;br/&gt;
Still get the same error &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/sad.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="12403169" author="troy.campano@libertymutual.com" created="Sun, 24 Nov 2002 02:29:56 +0000"  >&lt;p&gt;Hi I was wondering if the status of this has changed. I am still having this &lt;br/&gt;
problem.&lt;/p&gt;

&lt;p&gt;thank you for your time!&lt;/p&gt;

&lt;p&gt;~ Troy Campano ~&lt;/p&gt;</comment>
                            <comment id="12403170" author="boel@kapowtech.com" created="Mon, 6 Jan 2003 18:26:06 +0000"  >&lt;p&gt;I have the same problem in Tomcat 4.1.18, using the mysql vanilla example on&lt;br/&gt;
&lt;a href=&quot;http://jakarta.apache.org/tomcat/tomcat-4.1-doc/jndi-datasource-examples-howto.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://jakarta.apache.org/tomcat/tomcat-4.1-doc/jndi-datasource-examples-howto.html&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;I suspect it has something with the way we deploy the application, which is not&lt;br/&gt;
described exactly in the example. An oberservation is that the jdbc information&lt;br/&gt;
from server.xml only is available when the tomcat is restarted, but not after an&lt;br/&gt;
remove/install operation through the manager interface.&lt;/p&gt;</comment>
                            <comment id="12403171" author="rwaldhoff@apache.org" created="Thu, 6 Mar 2003 23:04:55 +0000"  >&lt;p&gt;Based on posts to commons-dev and commons-user, this is a &lt;br/&gt;
classpath/configuration issue.  It&apos;d be nice if someone could summarize the &lt;br/&gt;
distinction between a valid and invalid configuration, but I&apos;m not sure I&apos;m the &lt;br/&gt;
right guy for that.  See the commons-dev archive for more detail.&lt;/p&gt;

&lt;p&gt;Perhaps someone with more Tomcat expertise can comment here, or submit a doc &lt;br/&gt;
patch to the DBCP site?&lt;/p&gt;</comment>
                            <comment id="12403172" author="rituraj_tiwari@yahoo.com" created="Tue, 29 Apr 2003 06:28:32 +0000"  >&lt;p&gt;I had a DBCP setup running with Tomcat 4.0.6 and MySQL. In this setup I was&lt;br/&gt;
using commons libraries (DBCP, Collection, pooling) I got as a separate&lt;br/&gt;
download. I saved these jars under $TOMCAT_HOME/common/lib&lt;/p&gt;

&lt;p&gt;I later moved to Tomcat 4.1 and Oracle and started seeing the problem Troy is&lt;br/&gt;
experiencing. I reverted to 4.0.6 and the commons jars and started seeing a&lt;br/&gt;
different problem. I get the following NPE:&lt;/p&gt;

&lt;p&gt;2003-04-28 16:11:19 Init: General Exception launching LDAP Miner: java.lang.Null&lt;br/&gt;
PointerException&lt;br/&gt;
java.lang.NullPointerException&lt;br/&gt;
        at org.apache.commons.dbcp.DelegatingConnection.setAutoCommit(Delegating&lt;br/&gt;
Connection.java:237)&lt;br/&gt;
        at org.apache.commons.dbcp.PoolableConnectionFactory.activateObject(Pool&lt;br/&gt;
ableConnectionFactory.java:273)&lt;br/&gt;
        at org.apache.commons.pool.impl.GenericObjectPool.borrowObject(Unknown S&lt;br/&gt;
ource)&lt;br/&gt;
        at org.apache.commons.dbcp.AbandonedObjectPool.borrowObject(AbandonedObj&lt;br/&gt;
ectPool.java:117)&lt;br/&gt;
        at org.apache.commons.dbcp.PoolingDataSource.getConnection(PoolingDataSo&lt;br/&gt;
urce.java:110)&lt;br/&gt;
        at org.apache.commons.dbcp.BasicDataSource.getConnection(BasicDataSource&lt;br/&gt;
.java:312)&lt;br/&gt;
        at com.nuance.dialer.JdbcUserManager.getStringCell(JdbcUserManager.java:&lt;br/&gt;
611)&lt;br/&gt;
        at com.nuance.dialer.JdbcUserManager.queryUserExists(JdbcUserManager.jav&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>14267</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114313</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            22 years, 29 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0ux5b:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178511</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-28] [dbcp][PATCH] Connection leak in PoolableConnection.close() (Oracle 10g driver)</title>
                <link>https://issues.apache.org/jira/browse/DBCP-28</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;Mail from Hugh Winkler on commons-dev (15-2-2005)&lt;br/&gt;
--------------------------------------------------&lt;br/&gt;
PoolableConnection.close() does logic equivalent to :&lt;/p&gt;

&lt;p&gt;  if ( isClosed())&lt;/p&gt;
{
      throw new SQLException(.);
  }
&lt;p&gt; else &lt;/p&gt;
{
      _pool.returnObject(this);
  }&lt;br/&gt;
&lt;br/&gt;
The isClosed() method is that of ancestor DelegatingConnection, and it does:&lt;br/&gt;
  if(_closed || _conn.isClosed()) {
      return true;
  }&lt;br/&gt;
  return false;&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
Now nothing prevents the underlying connection from closing itself; that&apos;s&lt;br/&gt;
why isClosed() checks _conn.isClosed() &amp;#8211; &quot;did you close yourself while I&lt;br/&gt;
wasn&apos;t looking?&quot; But in that case PoolableConnection never calls&lt;br/&gt;
_pool.returnObject(). &lt;br/&gt;
&lt;br/&gt;
I&apos;ve got a query in Oracle 10g that causes Oracle&apos;s connection to close&lt;br/&gt;
itself: the famous &quot;end of file on connection&quot; message causes the connection&lt;br/&gt;
to enter the closed state. Doesn&apos;t take long to exhaust the pool.&lt;br/&gt;
&lt;br/&gt;
I think the logic we want in PoolableConnection.close() is like so:&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
  if ( _closed ){ // really ask, did *we* close the connection already
      throw new SQLException(.);
  } else {      _pool.returnObject(this);  }

&lt;p&gt;If I&apos;ve got some logic wrong please stop me before I deploy that change&lt;br/&gt;
here!&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: All&lt;br/&gt;
Platform: PC&lt;/p&gt;</environment>
        <key id="12342064">DBCP-28</key>
            <summary>[dbcp][PATCH] Connection leak in PoolableConnection.close() (Oracle 10g driver)</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="dirkv">Dirk Verbeeck</reporter>
                        <labels>
                    </labels>
                <created>Wed, 16 Feb 2005 02:44:55 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:29 +0000</updated>
                            <resolved>Fri, 24 Nov 2006 20:33:42 +0000</resolved>
                                    <version>1.2</version>
                                    <fixVersion>1.2.2</fixVersion>
                                        <due></due>
                            <votes>5</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12408744" author="dirkv" created="Wed, 16 Feb 2005 02:49:36 +0000"  >&lt;p&gt;You want to invalidate the pooled connection if the underlying connection is&lt;br/&gt;
closed. Try the following PoolableConnection.close() method.&lt;/p&gt;

&lt;p&gt;     public synchronized void close() throws SQLException {&lt;br/&gt;
        try {&lt;br/&gt;
            if (_conn.isClosed()) {&lt;br/&gt;
                // underlying connection closed behind our back&lt;br/&gt;
                try &lt;/p&gt;
{
                    _pool.invalidateObject(this);
                }
&lt;p&gt; catch (Exception ie) &lt;/p&gt;
{
                    // DO NOTHING
                }
&lt;p&gt;                throw new SQLException(&quot;Cannot close connection (underlying&lt;br/&gt;
connection already closed)&quot;);&lt;br/&gt;
            }&lt;br/&gt;
        } catch (SQLException e) {&lt;br/&gt;
            try &lt;/p&gt;
{
                _pool.invalidateObject(this);
            }
&lt;p&gt; catch (Exception ie) &lt;/p&gt;
{
                // DO NOTHING the original exception will be rethrown
            }
&lt;p&gt;            throw new SQLNestedException(&quot;Cannot close connection (isClosed&lt;br/&gt;
check failed)&quot;, e);&lt;br/&gt;
        }&lt;br/&gt;
        if (_closed) &lt;/p&gt;
{
            throw new SQLException(&quot;Already closed.&quot;);
        }
&lt;p&gt; else {&lt;br/&gt;
            try &lt;/p&gt;
{
                _pool.returnObject(this);
            }
&lt;p&gt; catch(SQLException e) &lt;/p&gt;
{
                throw e;
            } catch(RuntimeException e) {                throw e;            }
&lt;p&gt; catch(Exception e) &lt;/p&gt;
{
                throw new SQLNestedException(&quot;Cannot close connection (return to
pool failed)&quot;, e);
            }
&lt;p&gt;        }&lt;br/&gt;
    }&lt;/p&gt;</comment>
                            <comment id="12408745" author="h_u_w_lewis@hotmail.com" created="Tue, 14 Jun 2005 22:56:10 +0000"  >
&lt;p&gt;I also had some issues with this bug, has this bug solution been accepted yet?&lt;/p&gt;

&lt;p&gt;When will the new fix be included in a new release of dbcp?&lt;/p&gt;

&lt;p&gt;I recently fixed the problem myself with the code shown below for&lt;br/&gt;
PoolableConection.close() (i didn&apos;t notice Dirk Verbeeck had already posted a&lt;br/&gt;
solution),&lt;br/&gt;
I just invalidate any connection found to be already closed.&lt;br/&gt;
The JUnit tests all still pass with my fix, BUT if someone can see something&lt;br/&gt;
wrong with it please let me know.  I&apos;ve been using it for a while now and it&lt;br/&gt;
seems to have fixed the connection leak problem i was experiencing.&lt;/p&gt;


&lt;p&gt;public synchronized void close() throws SQLException {&lt;br/&gt;
        boolean isClosed = false;&lt;br/&gt;
        try &lt;/p&gt;
{
            isClosed = isClosed();
        }
&lt;p&gt; catch (SQLException e) {&lt;br/&gt;
            try &lt;/p&gt;
{
                _pool.invalidateObject(this);
            } catch (Exception ie) {
                // DO NOTHING the original exception will be rethrown
            }&lt;br/&gt;
            throw new SQLNestedException(&quot;Cannot close connection (isClosed&lt;br/&gt;
check failed)&quot;, e);&lt;br/&gt;
        }&lt;br/&gt;
        if (isClosed) {&lt;br/&gt;
            try {                _pool.invalidateObject(this);            }
&lt;p&gt; catch (Exception ie) &lt;/p&gt;
{
                // DO NOTHING, &quot;Already closed&quot; exception thrown below
            }
&lt;p&gt;            throw new SQLException(&quot;Already closed.&quot;);&lt;br/&gt;
        } else {&lt;br/&gt;
            try &lt;/p&gt;
{
                _pool.returnObject(this);
            }
&lt;p&gt; catch(SQLException e) &lt;/p&gt;
{
                throw e;
            } catch(RuntimeException e) {                throw e;            }
&lt;p&gt; catch(Exception e) &lt;/p&gt;
{
                throw new SQLNestedException(&quot;Cannot close connection (return to
pool failed)&quot;, e);
            }
&lt;p&gt;        }&lt;br/&gt;
    }&lt;/p&gt;</comment>
                            <comment id="12408746" author="wouter.zelle@gmail.com" created="Mon, 20 Feb 2006 17:11:16 +0000"  >&lt;p&gt;This problem also occurred for us and caused a great deal of trouble on our&lt;br/&gt;
production systems. We fixed the problem by building a custom DBCP with Lewis&apos;&lt;br/&gt;
fix. However, it makes me wonder why a bug that was reported and (cleanly) fixed&lt;br/&gt;
a year ago didn&apos;t make it into the mainline yet.&lt;/p&gt;</comment>
                            <comment id="12408747" author="rhasselbaum@alumni.ithaca.edu" created="Wed, 8 Mar 2006 05:34:58 +0000"  >&lt;p&gt;We have also experienced this problem at my company. Is the DBCP project dead?&lt;/p&gt;</comment>
                            <comment id="12408748" author="sjr" created="Wed, 8 Mar 2006 06:54:51 +0000"  >&lt;p&gt;Created an attachment (id=17845)&lt;br/&gt;
Huw Lewis&apos; change in patch format&lt;/p&gt;

&lt;p&gt;Not tested beyond regression tests.&lt;/p&gt;</comment>
                            <comment id="12408749" author="sjr" created="Wed, 8 Mar 2006 06:58:55 +0000"  >&lt;p&gt;There hasn&apos;t been a source code change to dbcp in like 12 months. If this patch fixes what seems &lt;br/&gt;
like a pretty nasty bug, can we get dbcp pushed out to release? Maybe 1.2.2?&lt;/p&gt;

&lt;p&gt;Thanks!&lt;/p&gt;

&lt;p&gt;Regards,&lt;br/&gt;
James&lt;/p&gt;</comment>
                            <comment id="12408750" author="sjr" created="Wed, 8 Mar 2006 13:24:25 +0000"  >&lt;p&gt;Created an attachment (id=17846)&lt;br/&gt;
Possible testcase to illustrate bug&lt;/p&gt;

&lt;p&gt;Hi there,&lt;/p&gt;

&lt;p&gt;The testPoolableConnectionLeak method in this test case &lt;b&gt;may&lt;/b&gt; illustrate the&lt;br/&gt;
bug. It shows that the connection pool has a getNumActive() equal to 1 even&lt;br/&gt;
after calling PoolableConnection.close() with already closed delegate&lt;br/&gt;
connection.&lt;/p&gt;

&lt;p&gt;Applying Huw&apos;s patch shows no active objects in the connection pool after the&lt;br/&gt;
connection is closed. This is what I&apos;d &lt;b&gt;expect&lt;/b&gt; to happen, but correct me if&lt;br/&gt;
I&apos;m wrong...&lt;/p&gt;

&lt;p&gt;I am new to DBCP and I might not completely understand the issue, so if&lt;br/&gt;
somebody with more experience with these classes could check this out, that&apos;d&lt;br/&gt;
be cool.&lt;/p&gt;

&lt;p&gt;Thanks!&lt;/p&gt;

&lt;p&gt;Regards,&lt;br/&gt;
James&lt;/p&gt;</comment>
                            <comment id="12408751" author="sandymac@apache.org" created="Wed, 8 Mar 2006 14:16:23 +0000"  >&lt;p&gt;James, the testPoolableConnectionLeak() in &quot;Possible testcase to illustrate bug&quot;&lt;br/&gt;
has a problem I think. GenericObjectPool (and any non-custom ObjectPool) doesn&apos;t&lt;br/&gt;
have any special knowledge about objects borrowed from it. That test cased:&lt;br/&gt;
1. borrows an object from the pool, in this case a Connection instance&lt;br/&gt;
2. closes said Connection&lt;br/&gt;
3. asks the pool again how many objects were borrowed from it&lt;/p&gt;

&lt;p&gt;The ObjectPool.getNumActive() method simply returns how many objects were&lt;br/&gt;
returned from ObjectPool.borrowObject() minus how many were returned with&lt;br/&gt;
ObjectPool.returnObject(...) or were invalidated with&lt;br/&gt;
ObjectPool.invalidateObject(...)&lt;/p&gt;

&lt;p&gt;For the ObjectPool to return the right value for getNumActive() you should&lt;br/&gt;
invalidate the connection by adding a pool.invalidateObject(conn); just before&lt;br/&gt;
the assertEquals().&lt;/p&gt;

&lt;p&gt;Now the added pool.invalidateObject(conn); line does thown an exception and it&lt;br/&gt;
really shouldn&apos;t. The point of the ObjectPool.invalidateObject(...) method is&lt;br/&gt;
that the object being invalidated is in a broken state and the&lt;br/&gt;
PoolableObjectFactory.destroyObject(...) method should be prepared for anything.&lt;/p&gt;</comment>
                            <comment id="12408752" author="sandymac@apache.org" created="Wed, 8 Mar 2006 14:27:48 +0000"  >&lt;p&gt;(In reply to comment #8)&lt;br/&gt;
Nevermind, pretend I never said that.&lt;/p&gt;</comment>
                            <comment id="12408753" author="phil@steitz.com" created="Thu, 9 Mar 2006 22:45:22 +0000"  >&lt;p&gt;Patches (17845, 17846) applied.  Thanks!  Leaving ticket open pending additional&lt;br/&gt;
user / developer validation.  These changes will be reflected in nightly builds&lt;br/&gt;
beginning 09-March-06.&lt;/p&gt;</comment>
                            <comment id="12408754" author="sandymac@apache.org" created="Thu, 9 Mar 2006 23:46:49 +0000"  >&lt;p&gt;I added some comments as a reminder to what should be changed in a non-bugfix&lt;br/&gt;
release. I think the correct changes would risk breaking compatability since the&lt;br/&gt;
_pool is protected and the class could be subclassed.&lt;br/&gt;
&lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/jakarta/commons/proper/dbcp/trunk/src/java/org/apache/commons/dbcp/PoolableConnection.java?rev=384536&amp;amp;r1=384516&amp;amp;r2=384536&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewcvs.cgi/jakarta/commons/proper/dbcp/trunk/src/java/org/apache/commons/dbcp/PoolableConnection.java?rev=384536&amp;amp;r1=384516&amp;amp;r2=384536&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Other than that, I say close this bug.&lt;/p&gt;</comment>
                            <comment id="12420733" author="p.mouawad@ubik-ingenierie.com" created="Thu, 13 Jul 2006 04:19:59 +0000"  >&lt;p&gt;Hello,&lt;br/&gt;
The files contain an illustration of the problem that will occur when the the previous patches will be applied in 1.2.2:&lt;br/&gt;
Case 1:&lt;br/&gt;
The client calls isClosed() before closing a connection since commons-dbcp does not allow double close without throwing (see &lt;a href=&quot;http://issues.apache.org/jira/browse/DBCP-3&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/browse/DBCP-3&lt;/a&gt;)&lt;br/&gt;
=&amp;gt; The problem is that since he calls isClosed, he encounters the same bug reported here because conn.isClosed() will return true and the client will not call close.&lt;br/&gt;
if (!conn.isClosed())&lt;br/&gt;
{&lt;br/&gt;
try{&lt;br/&gt;
conn.close();&lt;br/&gt;
}catch(Exception e){}&lt;br/&gt;
}&lt;br/&gt;
see what happens if the isClosed() in PoolableConnection returns true : ShowsLeaksIfCheckForIsClosed&lt;/p&gt;

&lt;p&gt;Case2:&lt;br/&gt;
The client tries to find a solution, and calls conn.close() without checking isClosed(), but the problem is that the client is in a Persistence fwk and the client may have already called close, so he ends up calling close() twice, see what happens if the isClosed() in PoolableConnection returns true : ShowsBasicDataSourceBadNumActiveIfNoCheckForIsClosedAndDoubleClose&lt;/p&gt;

&lt;p&gt;So My question is, what can I do if the double close is not allowed by DBCP&lt;/p&gt;</comment>
                            <comment id="12424054" author="asolntsev" created="Fri, 28 Jul 2006 10:19:10 +0000"  >&lt;p&gt;We are having this problem in our Production system.&lt;br/&gt;
Behind the NAT, any DB connection becomes expired after 30 minutes of inactivity.&lt;br/&gt;
When calling method &quot;close()&quot; on it, it throws SQLException &quot;already closed&quot;, but it&apos;s not returned to the pool.&lt;/p&gt;

&lt;p&gt;This problem still remains in DBCP 1.3&lt;br/&gt;
I will create a new issue for DBCP 1.3&lt;/p&gt;
</comment>
                            <comment id="12424060" author="asolntsev" created="Fri, 28 Jul 2006 10:48:35 +0000"  >&lt;p&gt;Sorry about confusion with versions.&lt;br/&gt;
This bug is present in DBCP 1.2.1, but it&apos;s fixed in DBCP 1.2.2 (which is not officially released yet).&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12333390" name="ASF.LICENSE.NOT.GRANTED--PoolableConnection.patch" size="723" author="sjr" created="Wed, 8 Mar 2006 06:54:51 +0000"/>
                            <attachment id="12333391" name="ASF.LICENSE.NOT.GRANTED--TestPoolableConnection.patch" size="5504" author="sjr" created="Wed, 8 Mar 2006 13:24:25 +0000"/>
                            <attachment id="12336768" name="ShowsBasicDataSourceBadNumActiveIfNoCheckForIsClosedAndDoubleClose.java" size="1555" author="p.mouawad@ubik-ingenierie.com" created="Thu, 13 Jul 2006 04:19:59 +0000"/>
                            <attachment id="12336769" name="ShowsLeaksIfCheckForIsClosed.java" size="1722" author="p.mouawad@ubik-ingenierie.com" created="Thu, 13 Jul 2006 04:19:59 +0000"/>
                            <attachment id="12336770" name="TestUtils.java" size="1505" author="p.mouawad@ubik-ingenierie.com" created="Thu, 13 Jul 2006 04:19:59 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>33591</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114312</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            19 years, 15 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uxk7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178578</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-27] ClassCastException in DriverAdapterCPDS when setPoolPreparedStatements(true)</title>
                <link>https://issues.apache.org/jira/browse/DBCP-27</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;Reported on commons-dev by Dave Oxley &amp;lt;dave AT daveoxley.co.uk&amp;gt; (20/10/2003)&lt;br/&gt;
-----------------------------------------------------------------------------&lt;br/&gt;
When setting up my pool like this:&lt;br/&gt;
           DriverAdapterCPDS cpds = new DriverAdapterCPDS();&lt;/p&gt;

&lt;p&gt;           cpds.setDriver(jdbc_driver_name);&lt;br/&gt;
           cpds.setUrl(url);&lt;br/&gt;
           cpds.setUser(user);&lt;br/&gt;
           cpds.setPassword(pwd);&lt;br/&gt;
           cpds.setPoolPreparedStatements(true);&lt;/p&gt;

&lt;p&gt;           SharedPoolDataSource tds = new SharedPoolDataSource();&lt;br/&gt;
           tds.setConnectionPoolDataSource(cpds);&lt;br/&gt;
           tds.setMaxActive(50);&lt;br/&gt;
           tds.setMaxWait(-1);&lt;br/&gt;
           tds.setMaxIdle(10);&lt;br/&gt;
           tds.setDefaultAutoCommit(false);&lt;/p&gt;

&lt;p&gt;I get the following exception when calling prepareStatement(sql):&lt;/p&gt;

&lt;p&gt;Caused by: java.lang.RuntimeException: java.lang.ClassCastException&lt;br/&gt;
   at&lt;br/&gt;
org.apache.commons.dbcp.cpdsadapter.PooledConnectionImpl.makeObject(PooledConnectionImpl.java:324)&lt;br/&gt;
   at&lt;br/&gt;
org.apache.commons.pool.impl.GenericKeyedObjectPool.borrowObject(GenericKeyedObjectPool.java:792)&lt;br/&gt;
   at&lt;br/&gt;
org.apache.commons.dbcp.cpdsadapter.PooledConnectionImpl.prepareStatement(PooledConnectionImpl.java:243)&lt;br/&gt;
   at&lt;br/&gt;
org.apache.commons.dbcp.cpdsadapter.ConnectionImpl.prepareStatement(ConnectionImpl.java:332)&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: All&lt;br/&gt;
Platform: All&lt;/p&gt;</environment>
        <key id="12341057">DBCP-27</key>
            <summary>ClassCastException in DriverAdapterCPDS when setPoolPreparedStatements(true)</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="dirkv">Dirk Verbeeck</reporter>
                        <labels>
                    </labels>
                <created>Sun, 26 Oct 2003 23:34:11 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:29 +0000</updated>
                            <resolved>Fri, 24 Nov 2006 20:49:33 +0000</resolved>
                                    <version>1.1</version>
                                                        <due></due>
                            <votes>1</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12405344" author="dirkv" created="Sun, 26 Oct 2003 23:36:19 +0000"  >&lt;p&gt;Looks like there is a bug in prepared statement pooling of DriverAdapterCPDS.&lt;/p&gt;

&lt;p&gt;Sort term solution:&lt;br/&gt;
Disable the statement pooling, cpds.setPoolPreparedStatements(false)&lt;br/&gt;
or switch to BasicDataSource (statement pooling included in v1.1)&lt;/p&gt;

&lt;p&gt;But this bug should be fixed of couse. &lt;/p&gt;</comment>
                            <comment id="12405345" author="dirkv" created="Mon, 27 Oct 2003 01:42:39 +0000"  >&lt;p&gt;testcase:&lt;br/&gt;
   TestSharedPoolDataSource.testPoolPrepareStatement&lt;/p&gt;</comment>
                            <comment id="12405346" author="ralfhauser" created="Mon, 29 Dec 2003 20:00:20 +0000"  >&lt;p&gt;Got today&apos;s source out of CVS and just did &quot;ant&quot;:&lt;br/&gt;
...&lt;br/&gt;
compile:&lt;/p&gt;

&lt;p&gt;compile-test:&lt;/p&gt;

&lt;p&gt;test:&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt; .........................................&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt; ----------------------------------------&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt; BEGIN getConnection1()&lt;br/&gt;
...&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt; Multithread test time = 2013 ms&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt; .E.....................Multithread test time = 50 ms&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt; Multithread test time = 2023 ms&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt; ........&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt; .........E&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt; Time: 28.562&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt; There were 2 errors:&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt; 1) testPoolPrepareStatement(org.apache.commons.dbcp.datasources.Test&lt;br/&gt;
SharedPoolDataSource)java.lang.ClassCastException: org.apache.commons.dbcp.Teste&lt;br/&gt;
rConnection&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt;     at org.apache.commons.dbcp.PoolablePreparedStatement.&amp;lt;init&amp;gt;(Pool&lt;br/&gt;
ablePreparedStatement.java:104)&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt;     at org.apache.commons.dbcp.cpdsadapter.PoolablePreparedStatement&lt;br/&gt;
Stub.&amp;lt;init&amp;gt;(PoolablePreparedStatementStub.java:89)&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt;     at org.apache.commons.dbcp.cpdsadapter.PooledConnectionImpl.make&lt;br/&gt;
Object(PooledConnectionImpl.java:311)&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt;     at org.apache.commons.pool.impl.GenericKeyedObjectPool.borrowObj&lt;br/&gt;
ect(GenericKeyedObjectPool.java:792)&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt;     at org.apache.commons.dbcp.cpdsadapter.PooledConnectionImpl.prep&lt;br/&gt;
areStatement(PooledConnectionImpl.java:243)&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt;     at org.apache.commons.dbcp.cpdsadapter.ConnectionImpl.prepareSta&lt;br/&gt;
tement(ConnectionImpl.java:332)&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt;     at org.apache.commons.dbcp.datasources.TestSharedPoolDataSource.&lt;br/&gt;
testPoolPrepareStatement(TestSharedPoolDataSource.java:469)&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt;     at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt;     at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAcces&lt;br/&gt;
sorImpl.java:39)&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt;     at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMet&lt;br/&gt;
hodAccessorImpl.java:25)&lt;/p&gt;</comment>
                            <comment id="12405347" author="toddc@concur.com" created="Fri, 30 Jan 2004 05:03:04 +0000"  >&lt;p&gt;I think this could be easily fixed by changing the following line in the&lt;br/&gt;
constructor of PoolablePreparedStatement&lt;/p&gt;

&lt;p&gt;It used to be:&lt;/p&gt;

&lt;p&gt;    public PoolablePreparedStatement(PreparedStatement stmt, Object key,&lt;br/&gt;
KeyedObjectPool pool, Connection conn) {&lt;br/&gt;
        super((DelegatingConnection)conn, stmt);&lt;/p&gt;

&lt;p&gt;Should be&lt;/p&gt;

&lt;p&gt;    public PoolablePreparedStatement(PreparedStatement stmt, Object key,&lt;br/&gt;
KeyedObjectPool pool, Connection conn) {&lt;br/&gt;
        super(new DelegatingConnection(conn), stmt);&lt;/p&gt;

</comment>
                            <comment id="12405348" author="dirkv" created="Sat, 7 Feb 2004 22:50:17 +0000"  >&lt;p&gt;Wrapping the original connection in a DelegatingConnection seems to work.&lt;br/&gt;
The following patch moves the creation of the DelegatingConnection into the&lt;br/&gt;
PooledConnectionImpl (one DelegatingConnection for each PooledConnectionImpl)&lt;/p&gt;</comment>
                            <comment id="12405349" author="dirkv" created="Sat, 7 Feb 2004 22:51:13 +0000"  >&lt;p&gt;Created an attachment (id=10266)&lt;br/&gt;
patch-24136&lt;/p&gt;</comment>
                            <comment id="12405350" author="dirkv" created="Sun, 29 Feb 2004 05:59:58 +0000"  >&lt;p&gt;Patch applied&lt;/p&gt;

&lt;p&gt;PooledConnectionImpl.java Revision : 1.15 Date : 2004/2/28 21:58:38&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12332589" name="ASF.LICENSE.NOT.GRANTED--patch-24136.txt" size="833" author="dirkv" created="Sat, 7 Feb 2004 22:51:13 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>24136</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114311</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            21 years, 37 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uxuf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178624</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-26] org.apache.commons.dbcp.jdbc2pool.Jdbc2PoolDataSource: setting testWhileIdle from server.xml does not work.</title>
                <link>https://issues.apache.org/jira/browse/DBCP-26</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;On setting testWhile from server.xml:&lt;br/&gt;
lines 1689-1694 in org.apache.commons.dbcp.jdbc2pool.Jdbc2PoolDataSource.java &lt;br/&gt;
now read:&lt;br/&gt;
                ra = ref.get(&quot;testWhileIdle&quot;);&lt;br/&gt;
                if (ra != null &amp;amp;&amp;amp; ra.getContent() != null) &lt;/p&gt;
                {
                    setTestWhileIdle
                        (Boolean.getBoolean(ra.getContent().toString()));
                }

&lt;p&gt;However, including:&lt;br/&gt;
&amp;lt;parameter&amp;gt;&lt;br/&gt;
	&amp;lt;name&amp;gt;testWhileIdle&amp;lt;/name&amp;gt;&lt;br/&gt;
	&amp;lt;value&amp;gt;true&amp;lt;/value&amp;gt;&lt;br/&gt;
&amp;lt;/parameter&amp;gt;                &lt;br/&gt;
In server.xml still sets testWhileIdle to false.&lt;/p&gt;

&lt;p&gt;I think the lines above should read:&lt;br/&gt;
                ra = ref.get(&quot;testWhileIdle&quot;);&lt;br/&gt;
                if (ra != null &amp;amp;&amp;amp; ra.getContent() != null) &lt;/p&gt;
                {
                    setTestWhileIdle
                        (Boolean.valueOf(ra.getContent().toString()));
                }</description>
                <environment>&lt;p&gt;Operating System: All&lt;br/&gt;
Platform: All&lt;/p&gt;</environment>
        <key id="12340524">DBCP-26</key>
            <summary>org.apache.commons.dbcp.jdbc2pool.Jdbc2PoolDataSource: setting testWhileIdle from server.xml does not work.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="remke.rutgers@brightalley.nl">Remke Rutgers</reporter>
                        <labels>
                    </labels>
                <created>Fri, 31 Jan 2003 17:18:47 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:29 +0000</updated>
                            <resolved>Tue, 25 Mar 2008 08:11:29 +0000</resolved>
                                    <version>Nightly Builds</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12403559" author="rwaldhoff@apache.org" created="Fri, 7 Mar 2003 02:12:34 +0000"  >&lt;p&gt;Fixed this and other uses of getBoolean instead of booleanValue found in this &lt;br/&gt;
file.  Thanks Remke.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>16629</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114310</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            22 years, 36 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uy07:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178650</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-25] DBCP should not be writing messages to stderr or stdout</title>
                <link>https://issues.apache.org/jira/browse/DBCP-25</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;DBCP should not be writing messages to stderr or stdout.  It should be using&lt;br/&gt;
commons-logging to log stuff.&lt;/p&gt;

&lt;p&gt;The current irritant is the message written to stderr from AbandonedObjectPool&apos;s&lt;br/&gt;
constructor.  But the AbandonedLog is also important to capture in the&lt;br/&gt;
application&apos;s log, not lost to stderr (without a timestamp or anything).&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: other&lt;br/&gt;
Platform: Other&lt;/p&gt;</environment>
        <key id="12340935">DBCP-25</key>
            <summary>DBCP should not be writing messages to stderr or stdout</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="shankarunni">Shankar Unni</reporter>
                        <labels>
                    </labels>
                <created>Thu, 28 Aug 2003 05:21:44 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:29 +0000</updated>
                            <resolved>Tue, 25 Mar 2008 08:11:29 +0000</resolved>
                                    <version>Nightly Builds</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12404969" author="shankarunni" created="Thu, 28 Aug 2003 05:22:26 +0000"  >&lt;p&gt;Created an attachment (id=7978)&lt;br/&gt;
Uses of System.out and System.err in dbcp and jocl directories&lt;/p&gt;</comment>
                            <comment id="12404970" author="dirkv" created="Thu, 28 Aug 2003 06:27:01 +0000"  >&lt;p&gt;I don&apos;t think we should add commons-logging.&lt;/p&gt;

&lt;p&gt;The &quot;Abandoned&quot; function should be considered for development only.&lt;br/&gt;
It should only be enabled when your application is broken and is loosing&lt;br/&gt;
connections. That is why I added those lines to the constructor (as a warning).&lt;/p&gt;

&lt;p&gt;The warning+default in BasicDataSourceFactory can be changed to an exception.&lt;br/&gt;
JOCLContentHandler has a test main method with the offending statement.&lt;/p&gt;

&lt;p&gt;Don&apos;t know about the other ones.&lt;/p&gt;</comment>
                            <comment id="12404971" author="shankarunni" created="Thu, 28 Aug 2003 07:04:26 +0000"  >&lt;p&gt;&amp;gt; I don&apos;t think we should add commons-logging.&lt;/p&gt;

&lt;p&gt;It&apos;s important for any messages from DBCP to be logged into the preferred&lt;br/&gt;
logging arena, and not lost to standard out or error, which may not even be&lt;br/&gt;
connected to anything (consider processes started as services on Windows).&lt;/p&gt;

&lt;p&gt;If the database goes down, it would be bad if the new connection creation error&lt;br/&gt;
got written only to stdout and thus lost, and no message was logged into the&lt;br/&gt;
official log location.  &lt;/p&gt;

&lt;p&gt;Commons-logging was created for precisely this purpose: for commons libraries to&lt;br/&gt;
be able to piggyback on an application&apos;s already-configured logging mechanism&lt;br/&gt;
and provide seamless logging.  Why is it not a good idea to use it?&lt;/p&gt;

&lt;p&gt;(I even have a patch ready that converts all the System.&lt;/p&gt;
{out,err}
&lt;p&gt;.println&apos;s to&lt;br/&gt;
log.{info,warning,error)(), along with the build.xml and build.properties.sample&lt;br/&gt;
changes..  Would it help if I attached it here?&lt;/p&gt;

&lt;p&gt;P.S. An editorial comment on another statement in that last add:&lt;/p&gt;

&lt;p&gt;Back to the &quot;AbandonedTimeout is only for development&quot; idea. Stuff does happen -&lt;br/&gt;
no app is perfect, and it&apos;s often preferable to get a temporary error when the&lt;br/&gt;
connection is reclaimed, than an application lockup or crash from leaked&lt;br/&gt;
connections. &lt;/p&gt;

&lt;p&gt;I guess the best way to put it is that a lot of webapps tend to live in a&lt;br/&gt;
different sort of world, where (unfortunately) testing cycles tend to be shorter&lt;br/&gt;
and things like this happen. Why make policy like this? Leave the thing in, log&lt;br/&gt;
a message (like you&apos;re doing, only send it to the logger!), and let the app&lt;br/&gt;
maintainer decide how they want to deal with whatever crisis pops up.. If a&lt;br/&gt;
connection loss bug escaped through the cracks in testing, this allows the app&lt;br/&gt;
to limp along until a fix is ready.&lt;/p&gt;</comment>
                            <comment id="12404972" author="shankarunni" created="Thu, 28 Aug 2003 07:48:01 +0000"  >&lt;p&gt;Argh. Changing this to use commons-logging also means fixes in the Tomcat&lt;br/&gt;
distribution, and anyone else distributing DBCP.  (Tomcat distributes&lt;br/&gt;
commons-logging-api.jar, but not commons-logging.jar).  Sigh!&lt;/p&gt;

&lt;p&gt;So the best thing is - just avoid logging stuff and thus avoid using&lt;br/&gt;
commons-logging. Throw exceptions where possible. But some of the locations from&lt;br/&gt;
where messages are printed are not amenable to throwing exceptions from (e.g.&lt;br/&gt;
CPDSConnectionFactory.java).&lt;/p&gt;</comment>
                            <comment id="12404973" author="dirkv" created="Sat, 20 Sep 2003 22:14:48 +0000"  >&lt;p&gt;Like Shankar said, we should only add a dependency on a logging package if&lt;br/&gt;
really needed.&lt;/p&gt;

&lt;p&gt;We could consider making more use of the logwriter on the datasource.&lt;br/&gt;
Or optionally provide a aspectj addon to do more detailed tracing/logging.&lt;br/&gt;
But that&apos;s another issue/enhancement...&lt;/p&gt;</comment>
                            <comment id="12404974" author="shmooth@lycos.co.uk" created="Wed, 1 Oct 2003 00:07:54 +0000"  >&lt;p&gt;My particular issue is with the &quot;DBCP borrowObject failed:&quot; msg in &lt;br/&gt;
AbandonedObjectPool.  Why not change the &apos;System.out.println(...)&apos; from this: &lt;/p&gt;

&lt;p&gt;    // current version&lt;br/&gt;
    public synchronized Object borrowObject() throws Exception {&lt;br/&gt;
        try &lt;/p&gt;
{
          ...foo...
        }
&lt;p&gt; catch(NoSuchElementException ne) &lt;/p&gt;
{
            throw new SQLException(
                &quot;DBCP could not obtain an idle db connection, pool exhausted&quot;);
        }
&lt;p&gt; catch(Exception e) &lt;/p&gt;
{
            // CURRENT VERSION
            System.out.println(&quot;DBCP borrowObject failed: &quot; + e.getMessage());
            throw e;
        }
&lt;p&gt;    }&lt;/p&gt;

&lt;p&gt;to this:&lt;/p&gt;

&lt;p&gt;    // NEW VERSION&lt;br/&gt;
    throw new Exception(&quot;DBCP borrowObject failed: &quot; + e.getMessage());&lt;/p&gt;


&lt;p&gt;If we can&apos;t/shouldn&apos;t do this, then why not make use of a simple/effective &lt;br/&gt;
GenericDataSource-like logWriter-type mechanism.  That way we can turn the &lt;br/&gt;
logging on or off by sending it to &apos;nul&apos; if we don&apos;t want it in our logs twice.&lt;/p&gt;

&lt;p&gt;Also, something else just struck me as odd.  I am getting the above exception &lt;br/&gt;
(on purpose for testing) when I am unable to get a connection to the db - &lt;br/&gt;
which seems to be very typical SQLException (at least on my network).  If this &lt;br/&gt;
is the case, then maybe we should add a catch block for SQLException and just &lt;br/&gt;
re-throw that exception type?  This makes more sense to me b/c, that the catch-&lt;br/&gt;
all &apos;catch (Exception e)&apos; block is printing an error to System.out seems like &lt;br/&gt;
an attempt to report &apos;something really weird and important&apos; rather than report &lt;br/&gt;
a typical exception.&lt;/p&gt;

&lt;p&gt;My exception trace to STDOUT:&lt;br/&gt;
&quot;DBCP borrowObject failed: java.sql.SQLException: Io exception: Connection &lt;br/&gt;
refused(DESCRIPTION=(TMP=)(etc...)&quot;&lt;/p&gt;

&lt;p&gt;One last thing.  I didn&apos;t think that by using BasicDataSource I&apos;d have a need &lt;br/&gt;
for AbandonedObjectPool, but apparently that is the case.  Why would that be?  &lt;br/&gt;
Here is my code that generates the above error:&lt;/p&gt;

&lt;p&gt;    BasicDataSource ds = new BasicDataSource();&lt;br/&gt;
    ds.setRemoveAbandoned(false);&lt;br/&gt;
    ds.setLogAbandoned(false);&lt;br/&gt;
    ...&lt;/p&gt;

&lt;p&gt;Apologies if these details in the wrong place!&lt;/p&gt;</comment>
                            <comment id="12404975" author="dirkv" created="Wed, 1 Oct 2003 03:45:42 +0000"  >&lt;p&gt;Making sure everything is logged to a logWriter-type mechanism is something for&lt;br/&gt;
the next release but your remarks are correct.&lt;br/&gt;
The borrowObject method allows Exceptions and they are handeled correctly by the&lt;br/&gt;
PoolingDataSource so there is no need to any Exception (including SQL &amp;amp;&lt;br/&gt;
NoSuchElement) to be catched.&lt;/p&gt;

&lt;p&gt;DBCP v1.0 always included a AbandonedObjectPool even when you do&lt;br/&gt;
setRemoveAbandoned(false) on a BasicDataSource.&lt;br/&gt;
This was fixed in (BasicDataSource Revision : 1.19 Date : 2003/8/21 22:21:37)&lt;br/&gt;
included in v1.1RC1&lt;/p&gt;</comment>
                            <comment id="12404976" author="dirkv" created="Wed, 1 Oct 2003 03:55:42 +0000"  >&lt;p&gt;Removed unneeded catch blocks.&lt;/p&gt;

&lt;p&gt;Fix will be included in v1.1RC2 and in following nightly builds.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12332495" name="ASF.LICENSE.NOT.GRANTED--x.txt" size="1957" author="shankarunni" created="Thu, 28 Aug 2003 05:22:26 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>22776</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114309</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            22 years, 7 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uwqv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178446</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-24] ConnectionFactory throws SQLException but implementations don&apos;t</title>
                <link>https://issues.apache.org/jira/browse/DBCP-24</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;Maybe I&apos;m missing something here but this seems like a problem.&lt;br/&gt;
The createConnection() method on the ConnectionFactory interface throws &lt;br/&gt;
SQLException.  However, all the implementations of the interface that I am&lt;br/&gt;
aware of do not throw SQLException but rather catch the SQLException and &lt;br/&gt;
throw an unchecked DbcpException.  The DbcpException does wrap the SQLException&lt;br/&gt;
so the original exception information is not lost but the behavior is unexpected&lt;br/&gt;
and the abstraction breaks down a bit.  For example, the &lt;br/&gt;
DriverManager.getConnection(String url)&lt;br/&gt;
javadoc says the method &quot;attempts to establish a connection to the given &lt;br/&gt;
database URL.&lt;br/&gt;
The DriverManager attempts to select an appropriate driver from the set of &lt;br/&gt;
registered JDBC drivers&quot;&lt;br/&gt;
and it throws SQLExcpetion &quot;if a database access error occurs.&quot;  If you are &lt;br/&gt;
using DBCP behind&lt;br/&gt;
the scenes, however, the DriverManager.getConnection method doesn&apos;t adhere to &lt;br/&gt;
that contract&lt;br/&gt;
because it throws the unchecked DbcpException rather than the checked &lt;br/&gt;
SQLException, if&lt;br/&gt;
there are problems accessing the database.  So if you want your code to deal &lt;br/&gt;
with a &lt;br/&gt;
down database in a specific way it must be aware that it is using DBCP and &lt;br/&gt;
explicitly&lt;br/&gt;
catch DbcpException.  This is where the abstraction leaks a bit and DBCP &lt;br/&gt;
becomes less&lt;br/&gt;
&quot;plug able&quot; and more tightly coupled with you client code.&lt;/p&gt;

&lt;p&gt;I&apos;m proposing the following change to the DriverManagerConnectionFactory (and &lt;br/&gt;
similar&lt;br/&gt;
changes to the other implementations of ConnectionFactory).&lt;/p&gt;

&lt;p&gt;Here&apos;s the code now:&lt;/p&gt;

&lt;p&gt;public Connection createConnection() {&lt;br/&gt;
  try {&lt;br/&gt;
      if(null == _props) {&lt;br/&gt;
          if((_uname == null) || (_passwd == null)) &lt;/p&gt;
{
              return DriverManager.getConnection(_connectUri);
          }
&lt;p&gt; else &lt;/p&gt;
{
              return DriverManager.getConnection(_connectUri,_uname,_passwd);
          }
&lt;p&gt;      } else &lt;/p&gt;
{
          return DriverManager.getConnection(_connectUri,_props);
      }
&lt;p&gt;  } catch(SQLException e) &lt;/p&gt;
{
      throw new DbcpException(e);
  }
&lt;p&gt;}&lt;/p&gt;

&lt;p&gt;Here&apos;s my proposed change:&lt;/p&gt;

&lt;p&gt;public Connection createConnection() throws SQLException {&lt;br/&gt;
   if(null == _props) {&lt;br/&gt;
       if((_uname == null) || (_passwd == null)) &lt;/p&gt;
{
           return DriverManager.getConnection(_connectUri);
       }
&lt;p&gt; else &lt;/p&gt;
{
           return DriverManager.getConnection(_connectUri,_uname,_passwd);
       }
&lt;p&gt;   } else &lt;/p&gt;
{
       return DriverManager.getConnection(_connectUri,_props);
   }
&lt;p&gt;}&lt;/p&gt;


&lt;p&gt;Not much to it really but I believe that makes the basic abstraction much &lt;br/&gt;
stronger.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: All&lt;br/&gt;
Platform: All&lt;/p&gt;</environment>
        <key id="12340832">DBCP-24</key>
            <summary>ConnectionFactory throws SQLException but implementations don&apos;t</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="bcampbell@servicemagic.com">Brian Campbell</reporter>
                        <labels>
                    </labels>
                <created>Tue, 1 Jul 2003 21:28:07 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:28 +0000</updated>
                            <resolved>Tue, 25 Mar 2008 08:11:28 +0000</resolved>
                                    <version>1.0</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12404651" author="dirkv" created="Mon, 11 Aug 2003 21:58:43 +0000"  >&lt;p&gt;Deprecated DbcpException and created a SQLNestedException class to allow non&lt;br/&gt;
SQLExceptions to be reported to the user code.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>21229</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114308</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            22 years, 14 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uxz3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178645</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-23] [dbcp] SQLException When PoolablePreparedStatement Already Closed</title>
                <link>https://issues.apache.org/jira/browse/DBCP-23</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;When closing an already closed&lt;br/&gt;
org.apache.commons.dbcp.PoolablePreparedStatement, a SQLException is thrown when&lt;br/&gt;
the isClosed() method returns true.&lt;/p&gt;

&lt;p&gt;This seems to violate the contract of java.sql.Statement (super interface of&lt;br/&gt;
implemented PreparedStatement) whose javadoc reads &quot; Calling the method close on&lt;br/&gt;
a Statement  object that is already closed has no effect.&quot; &lt;/p&gt;

&lt;p&gt;Work around exists &amp;#8211; when ever closing a statement, also null out.  Then,&lt;br/&gt;
before closing, check that it&apos;s non-null.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: All&lt;br/&gt;
Platform: All&lt;/p&gt;</environment>
        <key id="12341902">DBCP-23</key>
            <summary>[dbcp] SQLException When PoolablePreparedStatement Already Closed</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="apache_bugzilla@zwiers.ca">Jacob Zwiers</reporter>
                        <labels>
                    </labels>
                <created>Tue, 30 Nov 2004 12:33:28 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:28 +0000</updated>
                            <resolved>Thu, 19 Jul 2007 04:13:41 +0000</resolved>
                                    <version>1.2</version>
                                    <fixVersion>1.3</fixVersion>
                                        <due></due>
                            <votes>3</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="12408204" author="apache_bugzilla@zwiers.ca" created="Wed, 1 Dec 2004 00:42:53 +0000"  >&lt;p&gt;Created an attachment (id=13595)&lt;br/&gt;
Patch for &lt;a href=&quot;https://issues.apache.org/jira/browse/DBCP-23&quot; title=&quot;[dbcp] SQLException When PoolablePreparedStatement Already Closed&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DBCP-23&quot;&gt;&lt;del&gt;COM-1750&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="12408205" author="apache_bugzilla@zwiers.ca" created="Tue, 18 Jan 2005 23:40:56 +0000"  >&lt;p&gt;Note this is realated to 23185.  Same type of problem.  This is with prepared&lt;br/&gt;
statements, that with Connections.  In both cases, the general contract says&lt;br/&gt;
they should be close()-able multiple times.&lt;/p&gt;</comment>
                            <comment id="12458824" author="akomakom" created="Fri, 15 Dec 2006 15:36:05 +0000"  >&lt;p&gt;This may perhaps qualify as a separate bug but here goes anyway:&lt;/p&gt;

&lt;p&gt;This has much bigger impact (than I&apos;ve seen indicated so far) when used with&lt;br/&gt;
mysql connector 5.0.4 (and perhaps other versions), and commons-pool 1.3 .  &lt;br/&gt;
Mysql Connection&apos;s have the annoying ability to close themselves (specifically&lt;br/&gt;
when there is a communication breakdown with the server and they are not in High&lt;br/&gt;
Availability mode).  &lt;/p&gt;

&lt;p&gt;Since the isClosed method checks both the local flag AND the underlying&lt;br/&gt;
connection&apos;s, it returns true, meaning that the mentioned code in close() throws&lt;br/&gt;
instead of returning the object to the pool!!!   This quickly starves the object&lt;br/&gt;
pool and causes the developer a lot of grief.&lt;/p&gt;

&lt;p&gt;I am currently patching DBCP for internal use, replacing the close() method&lt;br/&gt;
in PoolableConnection with:&lt;/p&gt;

&lt;p&gt;public synchronized void close() throws SQLException {&lt;br/&gt;
        boolean isClosed = false;&lt;br/&gt;
//        try &lt;/p&gt;
{
            //isClosed = isClosed();
        	isClosed = _closed;
//        }
&lt;p&gt; catch (SQLException e) {&lt;br/&gt;
//            try &lt;/p&gt;
{
//                _pool.invalidateObject(this);
//            }
&lt;p&gt; catch (Exception ie) &lt;/p&gt;
{
//                // DO NOTHING the original exception will be rethrown
//            }
&lt;p&gt;//            throw new SQLNestedException(&quot;Cannot close connection (isClosed check failed)&quot;, e);&lt;br/&gt;
//        }&lt;br/&gt;
        if (isClosed) &lt;/p&gt;
{
            throw new SQLException(&quot;Already closed.&quot;);
        }
&lt;p&gt; else {&lt;br/&gt;
            try &lt;/p&gt;
{
                _pool.returnObject(this);
            }
&lt;p&gt; catch(SQLException e) &lt;/p&gt;
{
                throw e;
            } catch(RuntimeException e) {                throw e;            }
&lt;p&gt; catch(Exception e) &lt;/p&gt;
{
                throw new SQLNestedException(&quot;Cannot close connection (return to pool failed)&quot;, e);
            }
&lt;p&gt;        }&lt;br/&gt;
    }&lt;/p&gt;

&lt;p&gt;While I acknowledge that the check of the wrapped connections&apos; closed state may&lt;br/&gt;
be useful for something else, it is not compatible with the current close()&lt;br/&gt;
method - the two unmatched strategies cause a disastrous situation.&lt;/p&gt;

&lt;p&gt;As for how to reproduce this behavior (if desired), the application I own is a&lt;br/&gt;
very high throughput multithreaded server running on high powered boxes which&lt;br/&gt;
writes medium sized chunks (20K) of data to MySQL using 50 threads concurrently,&lt;br/&gt;
some of the writing is done via stored procedures.  Generally the &quot;mysql&lt;br/&gt;
self-closing&quot; behavior occurs only when mysql server is overwhelmed, or if I&lt;br/&gt;
slow it down intentionally by doing a dump, etc.  I&apos;ve also seen this problem&lt;br/&gt;
happen when mysql server crashes naturally or via &quot;kill -9&quot;, or when disk is full.&lt;/p&gt;

&lt;p&gt;References:&lt;/p&gt;

&lt;p&gt;com.mysql.jdbc.Connection:Line 3200:&lt;br/&gt;
------------------------&lt;br/&gt;
if ((sqlState != null) &amp;amp;&amp;amp;&lt;br/&gt;
sqlState.equals(SQLError.SQL_STATE_COMMUNICATION_LINK_FAILURE)) &lt;br/&gt;
  cleanup(sqlE);&lt;br/&gt;
------------------------&lt;br/&gt;
(Cleanup method sets it to closed)&lt;/p&gt;</comment>
                            <comment id="12458826" author="akomakom" created="Fri, 15 Dec 2006 15:38:59 +0000"  >&lt;p&gt;Patch to have the close method only check the local _closed flag, fixing pool starvation issue when underlying connection closes itself (eg MySQL)&lt;/p&gt;</comment>
                            <comment id="12513805" author="psteitz" created="Thu, 19 Jul 2007 04:13:41 +0000"  >&lt;p&gt;Fixed in r 557176.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12333264" name="ASF.LICENSE.NOT.GRANTED--issue32441.patch" size="475" author="apache_bugzilla@zwiers.ca" created="Wed, 1 Dec 2004 00:42:53 +0000"/>
                            <attachment id="12347290" name="patch.txt" size="1438" author="akomakom" created="Fri, 15 Dec 2006 15:38:59 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>32441</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114307</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            18 years, 17 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uvk7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178254</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-22] BasicDataSource - invalid connections are not checked</title>
                <link>https://issues.apache.org/jira/browse/DBCP-22</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;Hi all!&lt;/p&gt;

&lt;p&gt;I recently moved from Struts 1.0 to Struts 1.1 b1 running on Tomcat 3.3.1 &lt;br/&gt;
final. I use the standard implementation for javax.sql.DataSource provided with &lt;br/&gt;
Struts, org.apache.struts.util.GenericDataSource, to handle my database &lt;br/&gt;
connections.&lt;br/&gt;
I found that, if the database server went down and came up again afterwards &lt;br/&gt;
while my application was running, I was not able to get a valid &lt;br/&gt;
java.sql.Connection instance from GenericDataSource after that. Executing any &lt;br/&gt;
SQL query on such a Connection failed.&lt;/p&gt;

&lt;p&gt;After looking through the source code I found the following:&lt;/p&gt;

&lt;p&gt;In Struts 1.1 GenericDataSource delegates most of its functionality to &lt;br/&gt;
org.apache.commons.dbcp.BasicDataSource. This class provides a String &lt;br/&gt;
property &quot;validationQuery&quot; representing, as the javadoc comment says, the SQL &lt;br/&gt;
query that will be used to validate connections from this pool before returning &lt;br/&gt;
them to the caller.&lt;br/&gt;
This field &quot;validationQuery&quot; is passed to an instance of &lt;br/&gt;
org.apache.commons.dbcp.PoolableConnectionFactory while initializing the &lt;br/&gt;
underlying DataSource implementation for BasicDataSource.&lt;/p&gt;

&lt;p&gt;The SQL query contained in &quot;validationQuery&quot; is executed when the &lt;br/&gt;
method &quot;validateObject()&quot; of PoolableConnectionFactory is called. This call &lt;br/&gt;
should be done by org.apache.commons.pool.impl.GenericObjectPool which is &lt;br/&gt;
internally used for pooling the database connections by BasicDataSource, at &lt;br/&gt;
least if a connection from the pool is requested by calling the &quot;borrowObject&lt;br/&gt;
()&quot; method.&lt;br/&gt;
But, if we want GenericObjectPool to validate an object from the pool before it &lt;br/&gt;
is returned to the caller, we have to explicitly set its &lt;br/&gt;
property &quot;testOnBorrow&quot; to true, as it defaults to false. This is not done &lt;br/&gt;
while initializing the underlying DataSource implementation for BasicDataSource.&lt;/p&gt;

&lt;p&gt;Therefore I propose the following patch to solve the encountered problem:&lt;/p&gt;

&lt;p&gt;diff -u -r1.6 BasicDataSource.java&lt;br/&gt;
&amp;#8212; src/java/org/apache/commons/dbcp/BasicDataSource.java       1 May 2002 &lt;br/&gt;
06:27:52 -0000       1.6&lt;br/&gt;
+++ src/java/org/apache/commons/dbcp/BasicDataSource.java       14 May 2002 &lt;br/&gt;
15:22:35 -0000&lt;br/&gt;
@@ -476,6 +476,7 @@&lt;br/&gt;
         connectionPool.setMaxActive(maxActive);&lt;br/&gt;
         connectionPool.setMaxIdle(maxIdle);&lt;br/&gt;
         connectionPool.setMaxWait(maxWait);&lt;br/&gt;
+        connectionPool.setTestOnBorrow(true);&lt;/p&gt;

&lt;p&gt;         // Set up the driver connection factory we will use&lt;br/&gt;
         connectionProperties.put(&quot;user&quot;, username);&lt;/p&gt;

&lt;p&gt;Thanks for considering this proposal. I hope I found the right place for this &lt;br/&gt;
change in the impressively structured code mass built by you.&lt;/p&gt;

&lt;p&gt;Alex.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: Linux&lt;br/&gt;
Platform: PC&lt;/p&gt;</environment>
        <key id="12340224">DBCP-22</key>
            <summary>BasicDataSource - invalid connections are not checked</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="alexander.lamm@livinglogic.de">Alexander Lamm</reporter>
                        <labels>
                    </labels>
                <created>Tue, 14 May 2002 22:35:21 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:28 +0000</updated>
                            <resolved>Tue, 25 Mar 2008 08:11:28 +0000</resolved>
                                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12402639" author="craig.mcclanahan@sun.com" created="Sun, 21 Jul 2002 07:39:16 +0000"  >&lt;p&gt;Fixed in nightly build 20020721.&lt;/p&gt;

&lt;p&gt;Thanks for the patch!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9073</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114306</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            23 years, 17 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0ux4f:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178507</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-21] Broken link</title>
                <link>https://issues.apache.org/jira/browse/DBCP-21</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;The link to the Naming subproject is broken. It was migrated to&lt;br/&gt;
&lt;a href=&quot;http://incubator.apache.org/directory/subprojects/directory-naming/index.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://incubator.apache.org/directory/subprojects/directory-naming/index.html&lt;/a&gt;.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: All&lt;br/&gt;
Platform: All&lt;/p&gt;</environment>
        <key id="12341670">DBCP-21</key>
            <summary>Broken link</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="yury.fedorov@esistema.it">Yury Fedorov</reporter>
                        <labels>
                    </labels>
                <created>Mon, 30 Aug 2004 19:40:35 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:28 +0000</updated>
                            <resolved>Tue, 25 Mar 2008 08:11:28 +0000</resolved>
                                    <version>1.2</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12407384" author="yoavs@computer.org" created="Wed, 1 Sep 2004 04:58:39 +0000"  >&lt;p&gt;OK, fixed &amp;#8211; thanks &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>30938</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114305</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            21 years, 11 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uwz3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178483</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-20] [DBCP] per-user pooling with Oracle driver and default isolation settings</title>
                <link>https://issues.apache.org/jira/browse/DBCP-20</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;Issue reported by Chris Nappin on commons-dev 18 okt 2004&lt;br/&gt;
----------------------------------------------------------&lt;br/&gt;
  I&apos;m trying to configure per-user connection pooling with Tomcat, DBCP&lt;br/&gt;
and the Oracle 9i JDBC driver. A connection with default driver settings&lt;br/&gt;
seems to work, but when setting auto-commit to false I get errors. I&apos;ve&lt;br/&gt;
tried DBCP 1.1 and 1.2.1 (with Pool 1.1 or 1.2).&lt;/p&gt;

&lt;p&gt;This works fine, once (a read query using a new connection). However,&lt;br/&gt;
when DBCP tries to re-use a pooled connection, I get:&lt;br/&gt;
java.sql.SQLException: ORA-01453: SET TRANSACTION must be first&lt;br/&gt;
statement of transaction&lt;br/&gt;
 at oracle.jdbc.dbaccess.DBError.throwSqlException(DBError.java:134)&lt;br/&gt;
 at oracle.jdbc.ttc7.TTIoer.processError(TTIoer.java:289)&lt;/p&gt;

&lt;p&gt;The bug I&apos;m seeing seems very similar to the following, which was&lt;br/&gt;
resolved in DBCP 1.2.1: &lt;br/&gt;
Bugzilla &lt;a href=&quot;https://issues.apache.org/jira/browse/DBCP-70&quot; title=&quot;PATCH: Oracle 9i and default isolation settings&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DBCP-70&quot;&gt;&lt;del&gt;COM-973&lt;/del&gt;&lt;/a&gt; &lt;br/&gt;
  PATCH: Oracle 9i and default isolation settings&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: All&lt;br/&gt;
Platform: All&lt;/p&gt;</environment>
        <key id="12341818">DBCP-20</key>
            <summary>[DBCP] per-user pooling with Oracle driver and default isolation settings</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="dirkv">Dirk Verbeeck</reporter>
                        <labels>
                    </labels>
                <created>Thu, 21 Oct 2004 03:24:48 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:28 +0000</updated>
                            <resolved>Tue, 25 Mar 2008 08:11:28 +0000</resolved>
                                    <version>1.2</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12407848" author="dirkv" created="Thu, 21 Oct 2004 03:42:41 +0000"  >&lt;p&gt;Chris, Your analysis is correct, it is the same error.&lt;br/&gt;
The issue was fixed in BasicdataSource, unfortunately the same error still&lt;br/&gt;
exists in SharedPoolDataSource &amp;amp; PerUserPoolDataSource.&lt;/p&gt;</comment>
                            <comment id="12407849" author="dirkv" created="Thu, 21 Oct 2004 03:51:00 +0000"  >&lt;p&gt;Applied the same fix as in issue 25001&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://cvs.apache.org/viewcvs.cgi/jakarta-commons/dbcp/src/java/org/apache/commons/dbcp/datasources/PerUserPoolDataSource.java?r1=1.10&amp;amp;r2=1.11&amp;amp;diff_format=h&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://cvs.apache.org/viewcvs.cgi/jakarta-commons/dbcp/src/java/org/apache/commons/dbcp/datasources/PerUserPoolDataSource.java?r1=1.10&amp;amp;r2=1.11&amp;amp;diff_format=h&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>31811</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114304</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            21 years, 4 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0ux4v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178509</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-19] [dbcp]DelegatatingPreparedStatement does not override toString() method</title>
                <link>https://issues.apache.org/jira/browse/DBCP-19</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;PreparedStatement of a JDBC driver of MySQL can output an SQL Statement by &lt;br/&gt;
using a toString() method. But DelegatatingPreparedStatement does not override &lt;br/&gt;
toString() method, so cannot output SQL Statement.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: All&lt;br/&gt;
Platform: All&lt;/p&gt;</environment>
        <key id="12343062">DBCP-19</key>
            <summary>[dbcp]DelegatatingPreparedStatement does not override toString() method</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="oonaka@fieldnotes.jp">Hiroyuki Oonaka</reporter>
                        <labels>
                    </labels>
                <created>Thu, 4 May 2006 03:25:07 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:28 +0000</updated>
                            <resolved>Mon, 25 Sep 2006 05:37:28 +0000</resolved>
                                                    <fixVersion>1.2.2</fixVersion>
                                        <due></due>
                            <votes>1</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12411841" author="oonaka@fieldnotes.jp" created="Thu, 4 May 2006 03:29:33 +0000"  >&lt;p&gt;Created an attachment (id=18220)&lt;br/&gt;
patch for commons-dbcp-1.2.1/src/java/org/apache/commmons/dbcp&lt;/p&gt;</comment>
                            <comment id="12437462" author="psteitz" created="Mon, 25 Sep 2006 05:37:28 +0000"  >&lt;p&gt;This issue was resolved in r132220.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12334130" name="ASF.LICENSE.NOT.GRANTED--DelegatingPreparedStatement.patch" size="390" author="oonaka@fieldnotes.jp" created="Thu, 4 May 2006 03:29:33 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>39478</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114303</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            19 years, 7 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0ux33:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178501</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-18] Deadlock in AbandonedObjectPool when firewall closes connections</title>
                <link>https://issues.apache.org/jira/browse/DBCP-18</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;I have a 3 year old web application that at one time had a custom connection &lt;br/&gt;
pool, then upgraded to Tomcat 4.0.x using the Tyrex DataSource, and recently &lt;br/&gt;
upgraded to Tomcat 4.1.x using DBCP.  After a few hours of operation all &lt;br/&gt;
threads hang on AbandonedObjectPool.borrowObject and returnObject.  The &lt;br/&gt;
database is Oracle 8.1.6 using thin driver and it is firewalled.  Solaris 8 on &lt;br/&gt;
sparc, 64-bit JDK 1.4.1_01.&lt;/p&gt;

&lt;p&gt;I believe what is happening is that the firewall is closing connections after &lt;br/&gt;
an hour of inactivity.  When a borrowObject has a lock on the pool and is &lt;br/&gt;
restoring the state of a Connection, setAutoCommit(true) blocks indefinately on &lt;br/&gt;
one of these closed sockets.  Meanwhile the other threads are trying to &lt;br/&gt;
borrowObject too, waiting for the pool to unlock, and some threads are even &lt;br/&gt;
trying to returnObject.  So the problem is introduced when the webapp gets a &lt;br/&gt;
lot of attention (but getting nowhere near maxActive), then slows down a little &lt;br/&gt;
so that some open sockets to the database get automatically closed by the &lt;br/&gt;
firewall, and finally the app picks up a little so that a stale socket gets &lt;br/&gt;
reused.&lt;/p&gt;

&lt;p&gt;I&apos;m attaching a huge thread dump, that contains the following threads:&lt;/p&gt;

&lt;p&gt;  There are a total 100 maxConnection threads&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;1 of which is hanging on setAutoCommit and has the lock on&lt;br/&gt;
      AbandonedObjectPool.borrowObject (Thread-42)&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;5 of which are trying to returnObject (Thread-32, 18, 15, 10, and 5)&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;95 other threads all blocked on borrowObject&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;  There are a few more idle connector threads because the server.xml is&lt;br/&gt;
  partitioned for another web application which isn&apos;t active.&lt;/p&gt;

&lt;p&gt;Earlier today I futilely attempted to set maxIdle to 0 so that all connections &lt;br/&gt;
were closed, it still crashed and I found that returnObject tests for &quot;_maxIdle &lt;br/&gt;
&amp;gt; 0&quot;, so perhaps I&apos;ll test it with maxIdle set to 1.  That should provide a lot &lt;br/&gt;
longer uptime, but still not 100% safe.&lt;/p&gt;

&lt;p&gt;I also decompiled the Oracle driver and confirmed that it makes no attempt to &lt;br/&gt;
setSoTimeout (nor construct with a timeout) and looking at &lt;br/&gt;
java.net.PlainSocketImpl, the default is indeed 0 (blocking).&lt;/p&gt;

&lt;p&gt;I believe a good workaround would be to move &lt;br/&gt;
PoolableConnectionFactory.activateObject calling setAutoCommit out of the way &lt;br/&gt;
of path the locked pool.&lt;/p&gt;

&lt;p&gt;Soon I&apos;ll try sub-classing BasicDataSourceFactory and try enabling the idle &lt;br/&gt;
eviction features of GenericObjectPool.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: Solaris&lt;br/&gt;
Platform: Sun&lt;/p&gt;</environment>
        <key id="12340520">DBCP-18</key>
            <summary>Deadlock in AbandonedObjectPool when firewall closes connections</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="gturner@unzane.com">Gerald Turner</reporter>
                        <labels>
                    </labels>
                <created>Thu, 30 Jan 2003 14:50:59 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:28 +0000</updated>
                            <resolved>Tue, 25 Mar 2008 08:11:28 +0000</resolved>
                                    <version>1.0</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12403547" author="gturner@unzane.com" created="Thu, 30 Jan 2003 14:52:03 +0000"  >&lt;p&gt;Created an attachment (id=4638)&lt;br/&gt;
Java thread dump at time of deadlock&lt;/p&gt;</comment>
                            <comment id="12403548" author="gturner@unzane.com" created="Thu, 30 Jan 2003 14:52:50 +0000"  >&lt;p&gt;Created an attachment (id=4639)&lt;br/&gt;
Tomcat 4.1.18 configuration&lt;/p&gt;</comment>
                            <comment id="12403549" author="gturner@unzane.com" created="Sat, 1 Feb 2003 08:57:45 +0000"  >&lt;p&gt;Created an attachment (id=4676)&lt;br/&gt;
Expose idle eviction properties of GenericObjectPool to BasicDataSource&lt;/p&gt;</comment>
                            <comment id="12403550" author="gturner@unzane.com" created="Sat, 1 Feb 2003 09:10:49 +0000"  >&lt;p&gt;The patch I&apos;ve contributed works with DBCP 1.0 (the version which is bundled&lt;br/&gt;
with Tomcat 4.1.18).  It merely enables properties available in the&lt;br/&gt;
GenericObjectPool so that timed pool evictions can close the connections before&lt;br/&gt;
the firewall automatically does so.  The patch fits nicely with the property&lt;br/&gt;
copying thats already being done from BasicDataSourceFactory to BasicDataSource&lt;br/&gt;
to GenericPoolObject.&lt;/p&gt;

&lt;p&gt;The following section of XML can now be added to the factory configuration in&lt;br/&gt;
server.xml:&lt;br/&gt;
                  &amp;lt;parameter&amp;gt;&lt;br/&gt;
                    &amp;lt;name&amp;gt;testOnBorrow&amp;lt;/name&amp;gt;&lt;br/&gt;
                    &amp;lt;value&amp;gt;false&amp;lt;/value&amp;gt;&lt;br/&gt;
                  &amp;lt;/parameter&amp;gt;&lt;br/&gt;
                  &amp;lt;parameter&amp;gt;&lt;br/&gt;
                    &amp;lt;name&amp;gt;testOnReturn&amp;lt;/name&amp;gt;&lt;br/&gt;
                    &amp;lt;value&amp;gt;false&amp;lt;/value&amp;gt;&lt;br/&gt;
                  &amp;lt;/parameter&amp;gt;&lt;br/&gt;
                  &amp;lt;parameter&amp;gt;&lt;br/&gt;
                    &amp;lt;name&amp;gt;timeBetweenEvictionRunsMillis&amp;lt;/name&amp;gt;&lt;br/&gt;
                    &amp;lt;value&amp;gt;300000&amp;lt;/value&amp;gt;&lt;br/&gt;
                  &amp;lt;/parameter&amp;gt;&lt;br/&gt;
                  &amp;lt;parameter&amp;gt;&lt;br/&gt;
                    &amp;lt;name&amp;gt;numTestsPerEvictionRun&amp;lt;/name&amp;gt;&lt;br/&gt;
                    &amp;lt;value&amp;gt;5&amp;lt;/value&amp;gt;&lt;br/&gt;
                  &amp;lt;/parameter&amp;gt;&lt;br/&gt;
                  &amp;lt;parameter&amp;gt;&lt;br/&gt;
                    &amp;lt;name&amp;gt;minEvictableIdleTimeMillis&amp;lt;/name&amp;gt;&lt;br/&gt;
                    &amp;lt;value&amp;gt;300000&amp;lt;/value&amp;gt;&lt;br/&gt;
                  &amp;lt;/parameter&amp;gt;&lt;br/&gt;
                  &amp;lt;parameter&amp;gt;&lt;br/&gt;
                    &amp;lt;name&amp;gt;testWhileIdle&amp;lt;/name&amp;gt;&lt;br/&gt;
                    &amp;lt;value&amp;gt;true&amp;lt;/value&amp;gt;&lt;br/&gt;
                  &amp;lt;/parameter&amp;gt;&lt;/p&gt;

&lt;p&gt;BTW, prior to writing the patch I had tested this application in production with&lt;br/&gt;
maxIdle=1 and it has not crashed (since the app is never idle for longer than&lt;br/&gt;
the firewalls connection timeout).&lt;/p&gt;</comment>
                            <comment id="12403551" author="rwaldhoff@apache.org" created="Thu, 6 Mar 2003 23:00:42 +0000"  >&lt;p&gt;Patch applied, thanks Gerald!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12332124" name="ASF.LICENSE.NOT.GRANTED--catalina.out" size="421787" author="gturner@unzane.com" created="Thu, 30 Jan 2003 14:52:03 +0000"/>
                            <attachment id="12332126" name="ASF.LICENSE.NOT.GRANTED--commons-dbcp-1.0-bug-16581.diff" size="6139" author="gturner@unzane.com" created="Sat, 1 Feb 2003 08:57:45 +0000"/>
                            <attachment id="12332125" name="ASF.LICENSE.NOT.GRANTED--server.xml" size="8047" author="gturner@unzane.com" created="Thu, 30 Jan 2003 14:52:50 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>16581</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114302</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            22 years, 36 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uy1j:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178656</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-17] Can&apos;t configure PerUserPoolDataSource for use with tomcat</title>
                <link>https://issues.apache.org/jira/browse/DBCP-17</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;This bug was originally submitted by Mike Hanafey:&lt;/p&gt;

&lt;p&gt;If have been trying to get connection pooling to work in tomcat 5.0.9&lt;br/&gt;
and Sybase. I downloaded a nightly DBCP yesterday, but cannot get&lt;br/&gt;
the factory right for defining a &quot;PerUserPoolDataSource&quot;. The&lt;br/&gt;
&quot;ctx.lookup&quot; returns null. This what I have in server.xml:&lt;/p&gt;

&lt;p&gt;                    &amp;lt;Resource name=&quot;jdbc/pubs2new&quot; auth=&quot;Container&quot;&lt;/p&gt;

&lt;p&gt;type=&quot;org.apache.commons.dbcp.datasources.PerUserPoolDataSource&quot;&lt;br/&gt;
                        description=&quot;The infamous pub2 test database&quot;/&amp;gt;&lt;br/&gt;
                    &amp;lt;ResourceParams name=&quot;jdbc/pubs2new&quot;&amp;gt;&lt;br/&gt;
                        &amp;lt;parameter&amp;gt;&lt;br/&gt;
                            &amp;lt;name&amp;gt;factory&amp;lt;/name&amp;gt;&lt;/p&gt;

&lt;p&gt;&amp;lt;value&amp;gt;org.apache.commons.dbcp.datasources.InstanceKeyObjectFactory&amp;lt;/value&amp;gt;&lt;br/&gt;
                        &amp;lt;/parameter&amp;gt;&lt;br/&gt;
                        &amp;lt;parameter&amp;gt;&lt;br/&gt;
                            &amp;lt;name&amp;gt;dataSourceName&amp;lt;/name&amp;gt;&lt;br/&gt;
                            &amp;lt;value&amp;gt;java:comp/env/jdbc/pubsCPDS&amp;lt;/value&amp;gt;&lt;br/&gt;
                        &amp;lt;/parameter&amp;gt;&lt;br/&gt;
                        &amp;lt;parameter&amp;gt;&lt;br/&gt;
                            &amp;lt;name&amp;gt;defaultMaxActive&amp;lt;/name&amp;gt;&lt;br/&gt;
                            &amp;lt;value&amp;gt;30&amp;lt;/value&amp;gt;&lt;br/&gt;
                        &amp;lt;/parameter&amp;gt;&lt;br/&gt;
                    &amp;lt;/ResourceParams&amp;gt;&lt;br/&gt;
                &amp;lt;/DefaultContext&amp;gt;&lt;/p&gt;

&lt;p&gt;I, John McNally, attempted to test this using a &amp;lt;Context&amp;gt; element instead of&lt;br/&gt;
&amp;lt;DefaultContext&amp;gt; and using Tomcat/4.1.24.&lt;/p&gt;

&lt;p&gt;&amp;lt;Resource name=&quot;pubs&quot; auth=&quot;Container&quot;&lt;br/&gt;
    type=&quot;org.apache.commons.dbcp.datasources.PerUserPoolDataSource&quot;&lt;br/&gt;
    description=&quot;The infamous pub2 test database&quot;/&amp;gt;&lt;/p&gt;

&lt;p&gt;  &amp;lt;ResourceParams name=&quot;pubs&quot;&amp;gt;&lt;br/&gt;
    &amp;lt;parameter&amp;gt;&lt;br/&gt;
      &amp;lt;name&amp;gt;factory&amp;lt;/name&amp;gt;                    &lt;br/&gt;
&amp;lt;value&amp;gt;org.apache.commons.dbcp.datasources.InstanceKeyObjectFactory&amp;lt;/value&amp;gt;&lt;br/&gt;
    &amp;lt;/parameter&amp;gt;&lt;br/&gt;
  &amp;lt;/ResourceParams&amp;gt;&lt;br/&gt;
&amp;lt;/Context&amp;gt;&lt;/p&gt;

&lt;p&gt;And web.xml:&lt;/p&gt;

&lt;p&gt;&amp;lt;resource-ref&amp;gt;&lt;br/&gt;
  &amp;lt;description&amp;gt;&lt;br/&gt;
    foo&lt;br/&gt;
  &amp;lt;/description&amp;gt;&lt;br/&gt;
  &amp;lt;res-ref-name&amp;gt;pubs&amp;lt;/res-ref-name&amp;gt;&lt;br/&gt;
  &amp;lt;res-type&amp;gt;org.apache.commons.dbcp.datasources.PerUserPoolDataSource&amp;lt;/res-type&amp;gt;    &lt;br/&gt;
  &amp;lt;res-auth&amp;gt;&lt;br/&gt;
    Container&lt;br/&gt;
  &amp;lt;/res-auth&amp;gt;&lt;br/&gt;
&amp;lt;/resource-ref&amp;gt;&lt;/p&gt;

&lt;p&gt;From my debugging, it appears InstanceKeyObjectFactory.getObjectInstance is&lt;br/&gt;
never called.  And the following&lt;/p&gt;

&lt;p&gt;javax.naming.Context ctx = new javax.naming.InitialContext();&lt;br/&gt;
DataSource ds = (DataSource)ctx.lookup(&quot;java:comp/env/pubs&quot;);&lt;/p&gt;

&lt;p&gt;fails with&lt;/p&gt;

&lt;p&gt;java.lang.ClassCastException: org.apache.naming.ResourceRef&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: other&lt;br/&gt;
Platform: Other&lt;/p&gt;</environment>
        <key id="12341006">DBCP-17</key>
            <summary>Can&apos;t configure PerUserPoolDataSource for use with tomcat</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="jmcnally">John McNally</reporter>
                        <labels>
                    </labels>
                <created>Tue, 30 Sep 2003 00:00:34 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:28 +0000</updated>
                            <resolved>Tue, 25 Mar 2008 08:11:28 +0000</resolved>
                                    <version>Nightly Builds</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12405184" author="dirkv" created="Wed, 1 Oct 2003 04:35:39 +0000"  >&lt;p&gt;If I make a PerUserPoolDataSourceFactory then I can make it work&lt;/p&gt;

&lt;p&gt;PerUserPoolDataSourceFactory.java:&lt;br/&gt;
import java.util.Hashtable;&lt;br/&gt;
import javax.naming.Context;&lt;br/&gt;
import javax.naming.Name;&lt;br/&gt;
import javax.naming.spi.ObjectFactory;&lt;/p&gt;

&lt;p&gt;public class PerUserPoolDataSourceFactory implements ObjectFactory {&lt;br/&gt;
    public Object getObjectInstance(Object obj, Name name, Context nameCtx,&lt;br/&gt;
Hashtable environment) throws Exception &lt;/p&gt;
{
        return new PerUserPoolDataSource();
    }
&lt;p&gt;}&lt;br/&gt;
----------------------------------&lt;br/&gt;
server.xml:&lt;br/&gt;
&amp;lt;Resource name=&quot;jdbc/PerUserEmployeeAppDb&quot; auth=&quot;SERVLET&quot;&lt;br/&gt;
          type=&quot;javax.sql.DataSource&quot;/&amp;gt;&lt;br/&gt;
&amp;lt;ResourceParams name=&quot;jdbc/PerUserEmployeeAppDb&quot;&amp;gt;&lt;br/&gt;
  &amp;lt;parameter&amp;gt;&lt;br/&gt;
    &amp;lt;name&amp;gt;factory&amp;lt;/name&amp;gt;&lt;br/&gt;
    &amp;lt;value&amp;gt;org.apache.commons.dbcp.datasources.PerUserPoolDataSourceFactory&amp;lt;/value&amp;gt;&lt;br/&gt;
  &amp;lt;/parameter&amp;gt;&lt;br/&gt;
&amp;lt;/ResourceParams&amp;gt;&lt;br/&gt;
----------------------------------&lt;br/&gt;
I deployed on tomcat 4.1.27 and the JNDI lookup was successfull.&lt;/p&gt;</comment>
                            <comment id="12405185" author="jmcnally" created="Fri, 3 Oct 2003 00:07:50 +0000"  >&lt;p&gt;I was missing a jar in my common/lib directory as I was not testing with a stock&lt;br/&gt;
tomcat installation.  Unfortunately I was too tired to continue testing after&lt;br/&gt;
crossing that barrier, I will test further tonight.&lt;/p&gt;</comment>
                            <comment id="12405186" author="jmcnally" created="Mon, 6 Oct 2003 23:05:00 +0000"  >&lt;p&gt;AFAICT it appears tomcat is not invoking getReference, which might indicate that&lt;br/&gt;
it is not binding the object to the context.  On first invocation of&lt;/p&gt;

&lt;p&gt;context.lookup(url) &lt;/p&gt;

&lt;p&gt;tomcat passes the ObjectFactory a Reference which contains the parameters given&lt;br/&gt;
in server.xml.  I can get this working, but then each context.lookup is forced&lt;br/&gt;
to receive an independent set of Connections, which is not the desired behavior.&lt;/p&gt;

&lt;p&gt;PerUserPoolDataSource needs to be bound to the jndi context at some point, so&lt;br/&gt;
that it can add appropriate reference data.&lt;/p&gt;</comment>
                            <comment id="12405187" author="jmcnally" created="Mon, 13 Oct 2003 12:35:30 +0000"  >&lt;p&gt;InstanceKeyObjectFactory is replaced by PerUserPoolDataSourceFactory and&lt;br/&gt;
SharedPoolDataSourceFactory and these factories can be used by tomcat.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>23491</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114301</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            22 years, 5 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uvbz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178217</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-16] dataSource.getConnection never returns in Tomcat using DBCP</title>
                <link>https://issues.apache.org/jira/browse/DBCP-16</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;I&apos;m using Tomcat and I have a JNDI resource referencing an MSSQL database. &lt;br/&gt;
The context looks like this&lt;/p&gt;

&lt;p&gt;&amp;lt;Context path=&quot;/AddressBook&quot; docBase=&quot;AddressBook&quot; debug=&quot;0&quot;  &lt;br/&gt;
reloadable=&quot;true&quot;&amp;gt;&lt;br/&gt;
  &amp;lt;Logger className=&quot;org.apache.catalina.logger.SystemOutLogger&quot; &lt;br/&gt;
timestamp=&quot;true&quot;/&amp;gt;&lt;br/&gt;
  &amp;lt;Loader checkInterval=&quot;3&quot;/&amp;gt;&lt;br/&gt;
  &amp;lt;Resource name=&quot;jdbc/WhitePages&quot; auth=&quot;Container&quot;  &lt;br/&gt;
type=&quot;javax.sql.DataSource&quot;/&amp;gt;&lt;br/&gt;
  &amp;lt;ResourceParams name=&quot;jdbc/WhitePages&quot;&amp;gt;&lt;br/&gt;
    &amp;lt;parameter&amp;gt;&lt;br/&gt;
      &amp;lt;name&amp;gt;username&amp;lt;/name&amp;gt;&lt;br/&gt;
      &amp;lt;value&amp;gt;sa&amp;lt;/value&amp;gt;&lt;br/&gt;
    &amp;lt;/parameter&amp;gt;&lt;br/&gt;
    &amp;lt;parameter&amp;gt;&lt;br/&gt;
      &amp;lt;name&amp;gt;password&amp;lt;/name&amp;gt;&lt;br/&gt;
      &amp;lt;value&amp;gt;&amp;lt;/value&amp;gt;&lt;br/&gt;
    &amp;lt;/parameter&amp;gt;&lt;br/&gt;
    &amp;lt;parameter&amp;gt;&lt;br/&gt;
      &amp;lt;name&amp;gt;driverClassName&amp;lt;/name&amp;gt;&lt;br/&gt;
      &amp;lt;value&amp;gt;com.microsoft.jdbc.sqlserver.SQLServerDriver&amp;lt;/value&amp;gt;&lt;br/&gt;
    &amp;lt;/parameter&amp;gt;&lt;br/&gt;
    &amp;lt;parameter&amp;gt;&lt;br/&gt;
      &amp;lt;name&amp;gt;url&amp;lt;/name&amp;gt;&lt;/p&gt;

&lt;p&gt;&amp;lt;value&amp;gt;jdbc:microsoft:sqlserver://localhost:1433;DatabaseName=WhitePages&amp;lt;/value&lt;br/&gt;
&amp;gt;&lt;br/&gt;
    &amp;lt;/parameter&amp;gt;&lt;br/&gt;
  &amp;lt;/ResourceParams&amp;gt;&lt;br/&gt;
&amp;lt;/Context&amp;gt;&lt;/p&gt;

&lt;p&gt;In my I do&lt;/p&gt;

&lt;p&gt;            ctx = new javax.naming.InitialContext();&lt;br/&gt;
            ds = (javax.sql.DataSource)ctx.lookup &lt;br/&gt;
(&quot;java:comp/env/jdbc/WhitePages&quot;);&lt;/p&gt;

&lt;p&gt;followed by&lt;/p&gt;

&lt;p&gt;        java.sql.Connection conn = null;&lt;br/&gt;
        try&lt;br/&gt;
        {&lt;br/&gt;
            System.err.println(&quot;getConnection&quot;);&lt;br/&gt;
            synchronized(ds)&lt;/p&gt;
            {
                System.err.println(&quot;getConnection&quot;);
                conn = ds.getConnection();
            }

&lt;p&gt;and the call to getConnection &lt;b&gt;never&lt;/b&gt; returns&lt;/p&gt;

&lt;p&gt;This happens in Tomcat 4.0.4 and later if their running DBCP&lt;/p&gt;

&lt;p&gt;To get this to work I also have to add&lt;/p&gt;

&lt;p&gt;    &amp;lt;parameter&amp;gt;&lt;br/&gt;
      &amp;lt;name&amp;gt;maxActive&amp;lt;/name&amp;gt;&lt;br/&gt;
      &amp;lt;value&amp;gt;20&amp;lt;/value&amp;gt;&lt;br/&gt;
    &amp;lt;/parameter&amp;gt;&lt;/p&gt;

&lt;p&gt;to my configuration&lt;/p&gt;

&lt;p&gt;(I guess the value is irrelevant but I haven&apos;t tried that)&lt;/p&gt;

&lt;p&gt;Surely this should work with the default maxActive value?&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: other&lt;br/&gt;
Platform: Other&lt;/p&gt;</environment>
        <key id="12340256">DBCP-16</key>
            <summary>dataSource.getConnection never returns in Tomcat using DBCP</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="3">Duplicate</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="kevinj@develop.com">Kevin Jones</reporter>
                        <labels>
                    </labels>
                <created>Tue, 9 Jul 2002 21:42:10 +0000</created>
                <updated>Tue, 16 May 2006 11:27:58 +0000</updated>
                            <resolved>Tue, 16 May 2006 11:27:58 +0000</resolved>
                                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12402732" author="glenn@apache.org" created="Sun, 21 Jul 2002 03:43:02 +0000"  >&lt;p&gt;The default values were not functional.  Fixed now and will be&lt;br/&gt;
available in the next nightly build.&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;
	&lt;ul&gt;
		&lt;li&gt;
		&lt;ul&gt;
			&lt;li&gt;This bug has been marked as a duplicate of 10969 ***&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>10592</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114300</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            23 years, 17 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0v01b:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178979</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-15] ClassNotFoundException: org.apache.xerces.parsers.SAXParser</title>
                <link>https://issues.apache.org/jira/browse/DBCP-15</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;Tried to compile dbcp.&lt;br/&gt;
Adapted the build.properties to include the &lt;br/&gt;
sax2.jar=../jarLibs/sax2r2.jar&lt;br/&gt;
that I got from &lt;a href=&quot;http://www.saxproject.org/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.saxproject.org/&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;If this is the wrong place to get it from, I suggest to enhance the &lt;br/&gt;
build.properties.sample with a hint where to get it from...&lt;/p&gt;

&lt;p&gt;Then, I got:&lt;br/&gt;
&amp;lt;&amp;lt;compile:&lt;/p&gt;

&lt;p&gt;compile-test:&lt;/p&gt;

&lt;p&gt;test:&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt; org.apache.commons.dbcp.SQLNestedException: Could not parse configur&lt;br/&gt;
ation file, cause:&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt; java.lang.ClassNotFoundException: org.apache.xerces.parsers.SAXParser&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt;     at org.xml.sax.helpers.XMLReaderFactory.createXMLReader(XMLReade&lt;br/&gt;
rFactory.java:121)&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt;     at org.xml.sax.helpers.XMLReaderFactory.createXMLReader(XMLReade&lt;br/&gt;
rFactory.java:96)&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt;     at org.apache.commons.jocl.JOCLContentHandler.parse(JOCLContentH&lt;br/&gt;
andler.java:377)&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt;     at org.apache.commons.jocl.JOCLContentHandler.parse(JOCLContentH&lt;br/&gt;
andler.java:309)&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt;     at org.apache.commons.dbcp.PoolingDriver.getConnectionPool(Pooli&lt;br/&gt;
ngDriver.java:126)&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt;     at org.apache.commons.dbcp.PoolingDriver.connect(PoolingDriver.j&lt;br/&gt;
ava:185)&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt;     at java.sql.DriverManager.getConnection(DriverManager.java:512)&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt;     at java.sql.DriverManager.getConnection(DriverManager.java:193)&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt;     at org.apache.commons.dbcp.TestJOCLed.getConnection(TestJOCLed.j&lt;br/&gt;
ava:87)&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt;     at org.apache.commons.dbcp.TestConnectionPool$TestThread.run(Tes&lt;br/&gt;
tConnectionPool.java:467)&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt;     at java.lang.Thread.run(Thread.java:534)&lt;br/&gt;
...&amp;gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;Finally, I ended up getting Xerces-J-bin.2.6.0.tar.gz from&lt;br/&gt;
&lt;a href=&quot;http://xml.apache.org/xerces2-j/download.cgi&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://xml.apache.org/xerces2-j/download.cgi&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;with my build.properties adapted to &lt;br/&gt;
sax2.jar=../jarLibs/xerces-2_6_0/xercesImpl.jar:../jarLibs/xerces-2_6_0/xml-apis.jar:../jarLibs/xerces-2_6_0/xmlParserAPIs.jar&lt;/p&gt;

&lt;p&gt;it seems to work ==&amp;gt; suggestion: add the &quot;Xerces-J-bin.2.6.0.tar.gz &lt;br/&gt;
&lt;a href=&quot;http://xml.apache.org/xerces2-j/download.cgi&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://xml.apache.org/xerces2-j/download.cgi&lt;/a&gt;&quot; to the build.properties.sample&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: other&lt;br/&gt;
Platform: Other&lt;/p&gt;</environment>
        <key id="12341176">DBCP-15</key>
            <summary>ClassNotFoundException: org.apache.xerces.parsers.SAXParser</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="ralfhauser">Ralf Hauser</reporter>
                        <labels>
                    </labels>
                <created>Mon, 29 Dec 2003 19:50:19 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:28 +0000</updated>
                            <resolved>Tue, 25 Mar 2008 08:11:28 +0000</resolved>
                                    <version>1.0</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12405720" author="dirkv" created="Tue, 30 Dec 2003 04:50:57 +0000"  >&lt;p&gt;reference to xerces added to build.properties.sample&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>25794</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114299</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            21 years, 46 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uxvr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178630</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-14] Closed Connection Exception on setAutoCommit</title>
                <link>https://issues.apache.org/jira/browse/DBCP-14</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;After roughly a half dozen successful uses, I throw a SQLException when doing &lt;br/&gt;
a setAutoCommit(false) on a connection returned from DBCP.  I have tested this &lt;br/&gt;
with both Microsoft SQL Server 2000 using JSQLConnect and Oracle 8.1.7.0.0 &lt;br/&gt;
using the Oracle provided thin drivers.  My application makes heavy use of &lt;br/&gt;
transactions, if that could be part of the problem.  If I set both validations &lt;br/&gt;
to be true, then it always rejects the connection on return to the pool, and &lt;br/&gt;
everything works fine (except that I&apos;m not reusing connections, of course).  &lt;br/&gt;
If I don&apos;t do validation, then I get this exception after a few successful &lt;br/&gt;
connections:&lt;/p&gt;

&lt;p&gt;java.sql.SQLException: Closed Connection&lt;br/&gt;
        at oracle.jdbc.dbaccess.DBError.throwSqlException(DBError.java:180)&lt;br/&gt;
        at oracle.jdbc.dbaccess.DBError.throwSqlException(DBError.java:222)&lt;br/&gt;
        at oracle.jdbc.dbaccess.DBError.throwSqlException(DBError.java:285)&lt;br/&gt;
        at oracle.jdbc.driver.OracleConnection.setAutoCommit&lt;br/&gt;
(OracleConnection.java:991)&lt;br/&gt;
        at org.apache.commons.dbcp.DelegatingConnection.setAutoCommit(Unknown &lt;br/&gt;
Source)&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: Windows XP&lt;br/&gt;
Platform: PC&lt;/p&gt;</environment>
        <key id="12340209">DBCP-14</key>
            <summary>Closed Connection Exception on setAutoCommit</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="4">Incomplete</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="dan@wellogic.com">J. Daniel Powell</reporter>
                        <labels>
                    </labels>
                <created>Mon, 29 Apr 2002 20:57:03 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:28 +0000</updated>
                            <resolved>Tue, 25 Mar 2008 08:11:28 +0000</resolved>
                                                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="12402612" author="rwaldhof@us.britannica.com" created="Mon, 29 Apr 2002 21:08:22 +0000"  >&lt;p&gt;Can you provide a more complete example?&lt;/p&gt;

&lt;p&gt;How have you set up the pool? Which DBCP impl are you using (PoolingDriver? &lt;br/&gt;
PoolingDataSource? BasicDataSource?)&lt;/p&gt;

&lt;p&gt;How are you doing the validations? It&apos;s curious that all your connections fail &lt;br/&gt;
when validated.&lt;/p&gt;</comment>
                            <comment id="12402613" author="dan@wellogic.com" created="Mon, 29 Apr 2002 21:16:36 +0000"  >&lt;p&gt;This connection in particular is set up by Tomcat using the DBCP factory, but &lt;br/&gt;
I can reproduce the problem by creating the pool myself.  I do not know what &lt;br/&gt;
kind of implementation Tomcat uses, but I tried with a GenericObjectPool with &lt;br/&gt;
the default factory, then created a PoolableConnectionFactory using a &lt;br/&gt;
DriverManagerConnectionFactory, and then created a DataSource using &lt;br/&gt;
PoolingDataSource.&lt;/p&gt;</comment>
                            <comment id="12402614" author="rwaldhof@us.britannica.com" created="Mon, 29 Apr 2002 21:24:53 +0000"  >&lt;p&gt;I think Tomcat&apos;s using BasicDataSource, so it looks like you can recreate this &lt;br/&gt;
problem with more than one configuration.&lt;/p&gt;

&lt;p&gt;From your stack trace, it would seem that something&apos;s called setAutoCommit on &lt;br/&gt;
DelegeatingConnection when the underlying connection is already closed. Perhaps &lt;br/&gt;
we could add a test to see if the underlying connection is closed in &lt;br/&gt;
setAutoCommit, but I&apos;m not sure the exception in that case is incorrect.&lt;/p&gt;

&lt;p&gt;I&apos;m guessing that for some reason the underlying Connection is already closed &lt;br/&gt;
when it is returned to the pool. That would explain why the validations fail &lt;br/&gt;
also.  &lt;/p&gt;

&lt;p&gt;Can you provide a more complete example of what you are doing?  A unit test &lt;br/&gt;
would be ideal, but just a small example of how the pool and its connections &lt;br/&gt;
are being used would suffice.&lt;/p&gt;</comment>
                            <comment id="12402615" author="dan@wellogic.com" created="Tue, 30 Apr 2002 00:29:05 +0000"  >&lt;p&gt;Created an attachment (id=1736)&lt;br/&gt;
Test Class&lt;/p&gt;</comment>
                            <comment id="12402616" author="dan@wellogic.com" created="Tue, 30 Apr 2002 00:30:30 +0000"  >&lt;p&gt;I am definitely calling close() on the connection to return it to the pool, I &lt;br/&gt;
don&apos;t know how else to return it, since the connection is not pool-aware in &lt;br/&gt;
any way.  According to the JavaDocs on PoolableConnection, I believe this is &lt;br/&gt;
what I&apos;m supposed to do:&lt;/p&gt;

&lt;p&gt;A delegating connection that, rather than closing the underlying connection, &lt;br/&gt;
returns itself to an ObjectPool when closed.&lt;/p&gt;

&lt;p&gt;Perhaps PoolableConnection should check to make sure the connection is not &lt;br/&gt;
closed before returning?&lt;/p&gt;

&lt;p&gt;Of course, this still doesn&apos;t really answer the question of why is the &lt;br/&gt;
connection closed, huh?&lt;/p&gt;

&lt;p&gt;Anyway, I&apos;ve attached a hacked together test.  Please excuse the sloppiness, I &lt;br/&gt;
had to combine a half dozen classes to get it into one file.  You&apos;ll need to &lt;br/&gt;
provide a SQL command on line 47, and change the connection url on line 189.&lt;/p&gt;</comment>
                            <comment id="12402617" author="rwaldhof@us.britannica.com" created="Tue, 30 Apr 2002 01:08:42 +0000"  >&lt;p&gt;&amp;gt; I am definitely calling close() on the connection &lt;br/&gt;
&amp;gt; to return it to the pool, I  don&apos;t know how else &lt;br/&gt;
&amp;gt; to return it, &lt;/p&gt;

&lt;p&gt;That&apos;s what you should be doing (but it shouldn&apos;t in general be closing the &lt;br/&gt;
underlying connection).&lt;/p&gt;

&lt;p&gt;Lemme take a look at your example, and I&apos;ll see what I can figure out.&lt;/p&gt;</comment>
                            <comment id="12402618" author="dan@wellogic.com" created="Tue, 30 Apr 2002 01:33:46 +0000"  >&lt;p&gt;The problem appears to be that I was explicitly closing connections a second &lt;br/&gt;
time.  I&apos;m not sure why this caused a problem, but by not doing it, things &lt;br/&gt;
work better.  &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;  Now I&apos;m having another problem.  When I do call close() on &lt;br/&gt;
my connection, the PreparedStatements aren&apos;t being closed, unless I close them &lt;br/&gt;
myself.  Shouldn&apos;t close() close the statements as well?&lt;/p&gt;</comment>
                            <comment id="12402619" author="rwaldhof@us.britannica.com" created="Tue, 30 Apr 2002 01:41:30 +0000"  >&lt;p&gt;(Just saw your comment, but since I already wrote this I&apos;ll post it anyway)&lt;/p&gt;

&lt;p&gt;If I&apos;m reading this correctly, you&apos;re closing your connection multiple times:&lt;/p&gt;

&lt;p&gt;Your main loop calls ConnectionManager.commit(), which will call &lt;br/&gt;
connection.close() in its finally block (or in ConnectionManager.rollback(), or &lt;br/&gt;
both).&lt;/p&gt;

&lt;p&gt;Your main loop also calls con.close(), which references the same connection.&lt;/p&gt;

&lt;p&gt;Both calls will attempt to return the Connection to the pool, leading the pool &lt;br/&gt;
to have multiple references to the same Connection, which will probably cause &lt;br/&gt;
unexpected results.&lt;/p&gt;

&lt;p&gt;You should probably either close the Connection directly of via &lt;br/&gt;
ConnectionManager, but not both.&lt;/p&gt;

&lt;p&gt;I would expect similiar results if you were to use Oracle directly (replace &lt;br/&gt;
your DriverManager.getConnection(&quot;jdbc:apache:commons:dbcp:example&quot;) call &lt;br/&gt;
with &quot;jdbc:oracle:thin:scott/tiger@hostname:1521:mysid&quot;). This is a generally &lt;br/&gt;
useful heurstic when working with DBCP, get it working using the underlying &lt;br/&gt;
driver directly, and then add the pooling behaviour.&lt;/p&gt;
</comment>
                            <comment id="12402620" author="rwaldhof@us.britannica.com" created="Tue, 30 Apr 2002 02:03:32 +0000"  >&lt;p&gt;&amp;gt; Now I&apos;m having another problem.  When I do &lt;br/&gt;
&amp;gt; call close() on  my connection, the PreparedStatements &lt;br/&gt;
&amp;gt; aren&apos;t being closed, unless I close them &lt;br/&gt;
&amp;gt; myself.  Shouldn&apos;t close() close the statements &lt;br/&gt;
&amp;gt; as well?&lt;/p&gt;

&lt;p&gt;I&apos;m not exactly sure. The JDBC JavaDocs don&apos;t seem very specific on this point, &lt;br/&gt;
and I don&apos;t find any mention of it in the JBDC 2.x specs.  Here&apos;s the JDBC 3.0 &lt;br/&gt;
specification, section 11.6.2:&lt;/p&gt;

&lt;p&gt;&quot;Closing a Pooled Statement&lt;br/&gt;
An application closes a pooled statement exactly the same way it closes a &lt;br/&gt;
nonpooled statement. Whether it is pooled or not, a statement that has been &lt;br/&gt;
closed is no longer available for use by the application, and an attempt to &lt;br/&gt;
reuse it will cause an exception to be thrown.&lt;/p&gt;

&lt;p&gt;The following methods can close a pooled statement:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Statement.close &#151; called by an application; if the statement is being pooled,&lt;br/&gt;
closes the logical statement used by the application but does not close the&lt;br/&gt;
physical statement being pooled&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;Connection.close &#151; called by an application&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;Nonpooled connection &#151; closes the physical connection and all statements&lt;br/&gt;
created by that connection. This is necessary because the garbage collection&lt;br/&gt;
mechanism is unable to detect when externally managed resources can be&lt;br/&gt;
released.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;Pooled connection &#151; closes the logical connection and the logical statements&lt;br/&gt;
it returned but leaves open the underlying PooledConnection object and any&lt;br/&gt;
associated pooled statements&quot;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;But that&apos;s not totally clear to me either. In your case, we&apos;re pooling &lt;br/&gt;
connections but not statements.  Should we close them in that case?&lt;/p&gt;

&lt;p&gt;I don&apos;t think we&apos;re really doing a full JDBC 3.0 connection pooling impl anyway.&lt;/p&gt;

&lt;p&gt;The best practice would probably be to close the statements on your own &lt;br/&gt;
anyway.  Certainly the current DBCP impl won&apos;t make an effort to close them for &lt;br/&gt;
you (although the underlying driver implementations might on a real close).  &lt;br/&gt;
Someone with a better understanding of the spec than I will need to tell me if &lt;br/&gt;
there&apos;s a bug there or not. &lt;/p&gt;

&lt;p&gt;If there&apos;s a bug, please submit submit it as a new Bugzilla entry.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12331963" name="ASF.LICENSE.NOT.GRANTED--PersonTest.java" size="5246" author="dan@wellogic.com" created="Tue, 30 Apr 2002 00:29:05 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>8620</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114298</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            23 years, 29 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0v0ov:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>179085</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-13] Abandoned Connections are never closed</title>
                <link>https://issues.apache.org/jira/browse/DBCP-13</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;Abandoned Connections are never closed even when all the correct properties &lt;br/&gt;
have been set and there are the requisite number of active and idle &lt;br/&gt;
Connections.  This appears to be because lastUsed property is not updated on &lt;br/&gt;
the PoolableConnection.  When the removedAbandoned() is called on the &lt;br/&gt;
AbandonedObjectPool it ignores all the abandoned connections because they have &lt;br/&gt;
lastUsed times of 0.&lt;/p&gt;

&lt;p&gt;Modifying the activate() method on DelegatingConnection to update the lastUsed &lt;br/&gt;
time corrects the problem for me.  I&apos;m not sure if that is the best way of &lt;br/&gt;
fixing it.&lt;/p&gt;

&lt;p&gt;    protected void activate() {&lt;br/&gt;
        _closed = false;&lt;br/&gt;
+       this.setLastUsed();&lt;br/&gt;
        if(_conn instanceof DelegatingConnection) &lt;/p&gt;
{
            ((DelegatingConnection)_conn).activate();
        }
&lt;p&gt;    }&lt;/p&gt;

&lt;p&gt;Since Tomcat 4.1 went stable I expect lots of people are going to be hitting &lt;br/&gt;
this problem soon.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: other&lt;br/&gt;
Platform: Other&lt;/p&gt;</environment>
        <key id="12340326">DBCP-13</key>
            <summary>Abandoned Connections are never closed</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="richard_atkinson@hotmail.com">Richard Atkinson</reporter>
                        <labels>
                    </labels>
                <created>Sat, 21 Sep 2002 00:51:54 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:27 +0000</updated>
                            <resolved>Tue, 25 Mar 2008 08:11:27 +0000</resolved>
                                    <version>1.0</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12402932" author="rwaldhof@us.britannica.com" created="Fri, 1 Nov 2002 23:48:32 +0000"  >&lt;p&gt;fixed in rev. 1.8 of DelegatingConnection&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>12869</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114297</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            23 years, 2 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0ux3z:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178505</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-12] Foul connection causes livelock of all pool operations</title>
                <link>https://issues.apache.org/jira/browse/DBCP-12</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;We have a configuration where it can happen that opening a new database &lt;br/&gt;
connection fouls up and gets stuck waiting for a long timeout:&lt;/p&gt;

&lt;p&gt;Thread-2288:&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; oracle.jdbc.oci8.OCIDBAccess.do_open (native method)&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;2&amp;#93;&lt;/span&gt; oracle.jdbc.oci8.OCIDBAccess.logon (OCIDBAccess.java:359)&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;3&amp;#93;&lt;/span&gt; oracle.jdbc.driver.OracleConnection.&amp;lt;init&amp;gt; (OracleConnection.java:252)&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;4&amp;#93;&lt;/span&gt; oracle.jdbc.driver.OracleDriver.getConnectionInstance &lt;br/&gt;
(OracleDriver.java:365)&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;5&amp;#93;&lt;/span&gt; oracle.jdbc.driver.OracleDriver.connect (OracleDriver.java:260)&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;6&amp;#93;&lt;/span&gt; org.apache.commons.dbcp.DriverConnectionFactory.createConnection &lt;br/&gt;
(DriverConnectionFactory.java:83)&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;7&amp;#93;&lt;/span&gt; org.apache.commons.dbcp.PoolableConnectionFactory.makeObject &lt;br/&gt;
(PoolableConnectionFactory.java:184)&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;8&amp;#93;&lt;/span&gt; org.apache.commons.pool.impl.GenericObjectPool.borrowObject (null)&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;9&amp;#93;&lt;/span&gt; org.apache.commons.dbcp.AbandonedObjectPool.borrowObject &lt;br/&gt;
(AbandonedObjectPool.java:117)&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;10&amp;#93;&lt;/span&gt; org.apache.commons.dbcp.PoolingDataSource.getConnection &lt;br/&gt;
(PoolingDataSource.java:110)&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;11&amp;#93;&lt;/span&gt; org.apache.commons.dbcp.BasicDataSource.getConnection &lt;br/&gt;
(BasicDataSource.java:312)&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;12&amp;#93;&lt;/span&gt; swx.eservices.db.DbManager.getConnection (DbManager.java:197)&lt;br/&gt;
...&lt;/p&gt;

&lt;p&gt;The problem is that during that time the foul thread holds the lock on the &lt;br/&gt;
AbandonedObjectPool that all other threads doing returnObject or borrowObject &lt;br/&gt;
queue:&lt;/p&gt;

&lt;p&gt;Thread-2278:&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; org.apache.commons.dbcp.AbandonedObjectPool.returnObject &lt;br/&gt;
(AbandonedObjectPool.java:137)&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;2&amp;#93;&lt;/span&gt; org.apache.commons.dbcp.PoolableConnection.close &lt;br/&gt;
(PoolableConnection.java:110)&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;3&amp;#93;&lt;/span&gt; swx.eservices.db.DbTransaction.commit (DbTransaction.java:158)&lt;br/&gt;
...&lt;/p&gt;

&lt;p&gt;So perfectly working pooled connections can no longer be returned or borrowed, &lt;br/&gt;
therefore freezing all threads with database access.  One foul apple makes the &lt;br/&gt;
full basket rot.&lt;/p&gt;

&lt;p&gt;If one waits long enough (30 minutes) the do_open will finally timeout and &lt;br/&gt;
everything will continue except for the failed connection.  But of course that &lt;br/&gt;
timeout is far to long to go unnoticed on a webserver.&lt;/p&gt;

&lt;p&gt;What needs to be done is to open a new connection (or do the validationQuery) &lt;br/&gt;
without holding the lock on the pool.  NB borrow/returnObject in &lt;br/&gt;
dbcp/AbandonedObjectPool.java was made synchronized just before the DBCP_1_0 to &lt;br/&gt;
fix a threading bug (commit comment to r1.2).&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: All&lt;br/&gt;
Platform: All&lt;/p&gt;</environment>
        <key id="12340893">DBCP-12</key>
            <summary>Foul connection causes livelock of all pool operations</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="alfred.nathaniel@swx.com">Alfred Nathaniel</reporter>
                        <labels>
                    </labels>
                <created>Fri, 8 Aug 2003 02:59:33 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:27 +0000</updated>
                            <resolved>Tue, 25 Mar 2008 08:11:27 +0000</resolved>
                                    <version>1.0</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12404817" author="dirkv" created="Wed, 13 Aug 2003 19:50:04 +0000"  >&lt;p&gt;Fixed by removing the method synchronization on GenericObjectPool.borrowObject&lt;br/&gt;
(AbandonedObjectPool.borrowObject was already removed in nightly dbcp build)&lt;/p&gt;

&lt;p&gt;You need to update your commons-pool implementation&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>22229</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114296</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            22 years, 14 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uvev:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178230</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-11] [dbcp] stmt.getConnection() != Connection used to create the statement</title>
                <link>https://issues.apache.org/jira/browse/DBCP-11</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;Hi,&lt;/p&gt;

&lt;p&gt;I&apos;m not an expert in implementing connection pools or jdbc itself. But shouldn&apos;t&lt;br/&gt;
the following code work?&lt;/p&gt;

&lt;p&gt;Connection con = pool.getConnection()&lt;br/&gt;
PreparedStatement ps = con.prepareStatement()&lt;/p&gt;

&lt;p&gt;con.equals(ps.getConnection) // returns false!&lt;/p&gt;

&lt;p&gt;Ok, I don&apos;t need it to be equal, but the following also does not work:&lt;/p&gt;

&lt;p&gt;ps.getConnection().close()&lt;br/&gt;
con.isClosed() // is false!!!&lt;/p&gt;

&lt;p&gt;That means, if I have a Statment and want to close its connection, I have to&lt;br/&gt;
remember the conncetion. Is that the requested behavior? Because of this my pool&lt;br/&gt;
is running over.&lt;/p&gt;

&lt;p&gt;The java.sql API says that Statment.getConnection() has to be the connection&lt;br/&gt;
which created the statement.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: other&lt;br/&gt;
Platform: All&lt;/p&gt;</environment>
        <key id="12342450">DBCP-11</key>
            <summary>[dbcp] stmt.getConnection() != Connection used to create the statement</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="alexander.rupsch@gmx.de">Alexander Rupsch</reporter>
                        <labels>
                    </labels>
                <created>Mon, 8 Aug 2005 20:38:24 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:27 +0000</updated>
                            <resolved>Sat, 21 Jul 2007 15:48:55 +0000</resolved>
                                    <version>1.2</version>
                                    <fixVersion>1.3</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12437457" author="psteitz" created="Mon, 25 Sep 2006 05:25:26 +0000"  >&lt;p&gt;Changing the fix version to 1.3.  We may in fact decide on WONTFIX eventually, but I want to hold off on that judgement until we have reworked close() systematically.&lt;/p&gt;

&lt;p&gt;If we interpret the spec to mean that Statment.getConnection()  has to return the physical connection that created the statement, this is in general &lt;b&gt;not&lt;/b&gt; going to be equal to the connection object that the user has a reference to and may also be open when the user&apos;s connection is closed.&lt;/p&gt;</comment>
                            <comment id="12480224" author="bayard" created="Mon, 12 Mar 2007 23:44:55 +0000"  >&lt;p&gt;My vote (with a few minutes thought) is that the Statements should be returning the Connection they came from and not the underlying physical connection. ie) We should change things.&lt;/p&gt;</comment>
                            <comment id="12513689" author="dain" created="Wed, 18 Jul 2007 19:27:41 +0000"  >&lt;p&gt;This patch assures that all all returned Statements, PreparedStatements, CallableStatements and ResultSets are wrapped with a delegating object, which already properly handle the back pointers for Connection and Statement.  This patch includes an extensive test to assure that the &lt;b&gt;same&lt;/b&gt; object used to create the statement or result set is returned from either the getConnection() or getStatementMethod().  &lt;/p&gt;</comment>
                            <comment id="12514420" author="psteitz" created="Sat, 21 Jul 2007 15:48:55 +0000"  >&lt;p&gt;Patch applied.  Thanks.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12362088" name="back-pointers.patch" size="21605" author="dain" created="Wed, 18 Jul 2007 19:27:41 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>36077</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114295</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            18 years, 16 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0ux27:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178497</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-10] NPE in Oracle driver when using DBCP PoolingDataSource</title>
                <link>https://issues.apache.org/jira/browse/DBCP-10</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;Using the following code fragment:&lt;/p&gt;

&lt;p&gt;    // m_pool is a PoolingDataSource&lt;br/&gt;
    Connection conn = m_pool.getConnection();&lt;br/&gt;
    PreparedStatement stmt =&lt;br/&gt;
        conn.prepareStatement(&quot;select * from foo&quot;,&lt;br/&gt;
                              ResultSet.TYPE_SCROLL_INSENSITIVE,&lt;br/&gt;
                              ResultSet.CONCUR_READ_ONLY);&lt;/p&gt;

&lt;p&gt;    ResultSet rs = stmt.executeQuery();&lt;br/&gt;
    while (rs.next()) &lt;/p&gt;
{
        // Do something 
    }

&lt;p&gt;    stmt.close()  // NPE happens here&lt;br/&gt;
    conn.close();&lt;/p&gt;

&lt;p&gt;I get the following NPE:&lt;/p&gt;

&lt;p&gt;java.lang.NullPointerException&lt;br/&gt;
	at oracle.jdbc.driver.ScrollableResultSet.close&lt;br/&gt;
(ScrollableResultSet.java:143)&lt;br/&gt;
	at org.apache.commons.dbcp.DelegatingResultSet.close&lt;br/&gt;
(DelegatingResultSet.java:146)&lt;br/&gt;
	at org.apache.commons.dbcp.DelegatingPreparedStatement.passivate&lt;br/&gt;
(DelegatingPreparedStatement.java:270)&lt;br/&gt;
	at org.apache.commons.dbcp.DelegatingPreparedStatement.close&lt;br/&gt;
(DelegatingPreparedStatement.java:157)&lt;/p&gt;

&lt;p&gt;I believe this happens because calling close() on DelegatingPreparedStatement &lt;br/&gt;
winds up calling close() on Oracle&apos;s ScrollableResultSet object more than once &lt;br/&gt;
(once as a result of DelegatingPreparedStatement calling close() on the wrapped &lt;br/&gt;
PreparedStatement, and the second time as a result of calling close() on &lt;br/&gt;
DelegatingResultSet, in DelegatingPreparedStatement.passivate()).  When I de-&lt;br/&gt;
compile the Oracle driver it seems that calling close() more than once on a &lt;br/&gt;
ScrollableResultSet will always result in an NPE.&lt;/p&gt;

&lt;p&gt;I tried the above with default ResultSet type and concurrency, i.e.:&lt;/p&gt;

&lt;p&gt;    PreparedStatement stmt =&lt;br/&gt;
        conn.prepareStatement(&quot;select * from foo&quot;);&lt;/p&gt;

&lt;p&gt;and could not reproduce.  I believe that this is because a different Oracle &lt;br/&gt;
ResultSet implementation (OracleResultSetImpl) is used in the default case.&lt;/p&gt;

&lt;p&gt;I also tried both these cases against v1.0 DBCP and could not reproduce at &lt;br/&gt;
all.  So, something changed between 1.0 in Aug 2002 and the present that is &lt;br/&gt;
responsible.  I spent some time looking for a cause with no luck.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: All&lt;br/&gt;
Platform: PC&lt;/p&gt;</environment>
        <key id="12340568">DBCP-10</key>
            <summary>NPE in Oracle driver when using DBCP PoolingDataSource</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="rmilliken@smartops.com">Russ Milliken</reporter>
                        <labels>
                    </labels>
                <created>Sat, 22 Feb 2003 05:10:33 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:27 +0000</updated>
                            <resolved>Fri, 24 Nov 2006 20:50:46 +0000</resolved>
                                    <version>Nightly Builds</version>
                                                        <due></due>
                            <votes>1</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12403693" author="mohankishore@yahoo.com" created="Tue, 8 Apr 2003 08:27:45 +0000"  >&lt;p&gt;&lt;a href=&quot;http://otn.oracle.com/software/tech/java/sqlj_jdbc/content.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://otn.oracle.com/software/tech/java/sqlj_jdbc/content.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Are you using Oracle9i Release 1 (9.0.1)? Migrate to Oracle9i Release 2 &lt;br/&gt;
(9.2.0.1).&lt;/p&gt;

&lt;p&gt;Checked the source. The release 1 calls certain operations on m_cache and then &lt;br/&gt;
sets it to null. Hence the second time round, it will throw a NPE. In release &lt;br/&gt;
2, it has been fixed to always check for null, before calling any operations...&lt;/p&gt;

&lt;p&gt;Let us know if that does not work...&lt;/p&gt;</comment>
                            <comment id="12403694" author="dgraham@apache.org" created="Wed, 9 Apr 2003 07:51:24 +0000"  >&lt;p&gt;The ResultSet javadoc does not say that close() cannot be called more than once &lt;br/&gt;
and Oracle has fixed the problem.  Thanks for researching this Mohan.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>17301</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114294</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            22 years, 32 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uy1z:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178658</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-9] [dbcp] Error in JOCL document in javadoc</title>
                <link>https://issues.apache.org/jira/browse/DBCP-9</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;There is an extraneous semicolon in the JOCL document in the package&lt;br/&gt;
documentation, which means it is not well formed :&lt;/p&gt;

&lt;p&gt;   &amp;lt;string value=&quot;SELECT COUNT&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/star_yellow.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; FROM DUAL&quot;/&amp;gt; &amp;lt;;!-- validation query --&amp;gt;&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: All&lt;br/&gt;
Platform: All&lt;/p&gt;</environment>
        <key id="12341744">DBCP-9</key>
            <summary>[dbcp] Error in JOCL document in javadoc</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="adrian.baker@orion.co.nz">Adrian Baker</reporter>
                        <labels>
                    </labels>
                <created>Thu, 23 Sep 2004 11:22:31 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:27 +0000</updated>
                            <resolved>Tue, 25 Mar 2008 08:11:27 +0000</resolved>
                                    <version>1.2</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12407633" author="dirkv" created="Wed, 5 Jan 2005 09:19:23 +0000"  >&lt;p&gt;fixed in CVS, thanks&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>31379</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114293</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            20 years, 45 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uypr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178765</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-8] [dbcp][PATCH] Handle changed passwords in SharedPoolDataSource</title>
                <link>https://issues.apache.org/jira/browse/DBCP-8</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;Problem Summary:&lt;br/&gt;
Currently, DBCP does not provide support for dealing with password changes when&lt;br/&gt;
using InstanceKeyDataSources.  This means that when using a concrete&lt;br/&gt;
implementation of InstanceKeyDataSource, such as SharedPoolDataSource or&lt;br/&gt;
PerUserPoolDataSource, if a user changes his/her password, the entire connection&lt;br/&gt;
pool must be restarted for DBCP to recognize the new password.  In the event the&lt;br/&gt;
connection pool is being managed by a container, such as Tomcat, it requires&lt;br/&gt;
restarting the container.  Users have previously requested an ability to handle&lt;br/&gt;
these situations (see&lt;br/&gt;
&lt;a href=&quot;http://mail-archives.eu.apache.org/mod_mbox/jakarta-commons-user/200405.mbox/%3C40B5F9DC.1080101@pandora.be%3E&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://mail-archives.eu.apache.org/mod_mbox/jakarta-commons-user/200405.mbox/%3C40B5F9DC.1080101@pandora.be%3E&lt;/a&gt;&lt;br/&gt;
and&lt;br/&gt;
&lt;a href=&quot;http://mail-archives.eu.apache.org/mod_mbox/jakarta-commons-user/200405.mbox/%3c40ACA3DE.8080302@pandora.be%3e&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://mail-archives.eu.apache.org/mod_mbox/jakarta-commons-user/200405.mbox/%3c40ACA3DE.8080302@pandora.be%3e&lt;/a&gt;&lt;br/&gt;
for examples).&lt;/p&gt;

&lt;p&gt;Proposed Patch:&lt;/p&gt;

&lt;p&gt;The attached patch provides support for using the SharedPoolDataSource in&lt;br/&gt;
situations where user passwords may be changed.  Support is provided by changing&lt;br/&gt;
UserPassKey and SharedPoolDataSource to use the concatenation of the username&lt;br/&gt;
and password as the key.  In this way, after a user changes password, a&lt;br/&gt;
getConnection(String, String) method call will cause the pool to create a new&lt;br/&gt;
Connection using the new username and password.  The Connection that was created&lt;br/&gt;
using the old username and password remains in the pool, where--assuming the&lt;br/&gt;
pool is set up to remove idle objects--it will be collected by the idle object&lt;br/&gt;
eviction thread or eventually (once the pool is full) be discarded according to&lt;br/&gt;
the LRU algorithm provided by the pool.&lt;/p&gt;

&lt;p&gt;Other Solutions Considered:&lt;/p&gt;

&lt;p&gt;In making this patch, I considered several other possible algorithms but chose&lt;br/&gt;
the implemented algorithm as the best combination of safety and ease of use. &lt;br/&gt;
And-&lt;del&gt;as a bonus&lt;/del&gt;-it is a very unobtrusive solution. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;The &quot;public void close(String name)&quot; method recommended by Dirk Verbeeck in&lt;br/&gt;
the first link above is relatively complex to implement in the case of a&lt;br/&gt;
SharedPoolDataSource (but would be much easier for a PerUserPoolDataSource, as&lt;br/&gt;
he suggested).  In the case of a SharedPoolDataSource, it&apos;s possible that&lt;br/&gt;
multiple Connections exist for the specified user, in which case&lt;br/&gt;
SharedPoolDataSource would have to provide logic to deal with the cases where&lt;br/&gt;
one or more existing connections for the user are checked out at the time the&lt;br/&gt;
method is called--not to mention the logic required to find all existing&lt;br/&gt;
connections and close them without needlessly opening new connections (since all&lt;br/&gt;
users share the same pool in a SharedPoolDataSource instead of having a pool per&lt;br/&gt;
user as in PerUserPoolDataSource).&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Adding a method &quot;public void getConnection(String username, String password,&lt;br/&gt;
boolean closeAndReconnectOnPasswordMismatch)&quot; has similar problems with the&lt;br/&gt;
possibility of the existence of multiple open connections for the given&lt;br/&gt;
username.  If only the current connection is closed, we may be leaving&lt;br/&gt;
connections that are associated with the old password in the pool; therefore,&lt;br/&gt;
the application would need to use the closeAndReconnect functionality in&lt;br/&gt;
most-&lt;del&gt;if not all&lt;/del&gt;-cases where a connection is required.  If all connections are&lt;br/&gt;
closed, we have the same situation described above.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Furthermore, neither of the above methods is a part of the DataSource interface;&lt;br/&gt;
and, therefore, both would require the application to downcast to the&lt;br/&gt;
appropriate DBCP type to make the method call.  For all practical purposes, this&lt;br/&gt;
negates the benefits of using an interface in the first place.&lt;/p&gt;

&lt;p&gt;Additionally, adding new methods as above requires the application to know when&lt;br/&gt;
the user has changed his/her password, and provides a potential failure mode&lt;br/&gt;
when the user changes his/her password through an external application (i.e.&lt;br/&gt;
directly on the database or using some other application).  Although it is&lt;br/&gt;
possible for the application to catch the plain-vanilla SQLException thrown by&lt;br/&gt;
the getConnection(String, String) method of InstanceKeyDataSource and parse the&lt;br/&gt;
exception message looking for the expected text (&quot;Given password did not match&lt;br/&gt;
password used to create the PooledConnection.&quot;), doing so is not at all an&lt;br/&gt;
elegant solution.  Even if a new PasswordChangedException (which extends&lt;br/&gt;
SQLException) were created, the application would then need to downcast the&lt;br/&gt;
DataSource to make the appropriate call, so the previously mentioned problems&lt;br/&gt;
with the solution apply.&lt;/p&gt;

&lt;p&gt;Also, both of the new methods allow a Denial-of-Service-type attack against the&lt;br/&gt;
connection pool wherein a user may prevent the connection pool from reusing&lt;br/&gt;
connections by forcing it to close connections and attempt a reconnect when&lt;br/&gt;
given an incorrect password.  Depending on the application design, this weakness&lt;br/&gt;
could be exploited from a login page, knowing only valid usernames.  The&lt;br/&gt;
proposed solution does not suffer from this problem as the existing connections&lt;br/&gt;
are kept, so a user requesting a connection with a bad password would simply&lt;br/&gt;
cause DBCP to attempt to make a connection that the database would refuse&lt;br/&gt;
because of an invalid password.&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Checking the given password in the getPooledConnectionAndInfo( ) method and,&lt;br/&gt;
if different from the originally given password, attempting to connect to the&lt;br/&gt;
database with the new username/password combination and changing the password&lt;br/&gt;
associated with the UserPassKey after a successful connection would also work,&lt;br/&gt;
but requires duplicating the password check done by the InstanceKeyDataSource in&lt;br/&gt;
subclasses wanting to support use after password changes (or removing the check&lt;br/&gt;
from InstanceKeyDataSource and requiring subclasses to handle the situation&lt;br/&gt;
appropriately).  Furthermore, since database behavior regarding usability of&lt;br/&gt;
Connections after a password change is database-dependent, we cannot be sure&lt;br/&gt;
that the existing connections-&lt;del&gt;which were created with the old password&lt;/del&gt;-are&lt;br/&gt;
still valid, so this approach would require users to run a validation query. &lt;br/&gt;
Therefore, it seems more reasonable to simply leave the existing connections and&lt;br/&gt;
let them be evicted or thrown away when the pool becomes full.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Design Decisions for the Attached Patch:&lt;/p&gt;

&lt;p&gt;The first required change was to modify the hashCode() method in the UserPassKey&lt;br/&gt;
class to create a hash based upon both the username and password.  This was done&lt;br/&gt;
simply by concatenating username and password and returning the hashCode of the&lt;br/&gt;
combined String.  If the username is null, 0 is returned.  If the password is&lt;br/&gt;
null but the username is not, the String &quot;null&quot; will be concatenated to the&lt;br/&gt;
username and the hashCode of the combined String will be returned.  Although it&lt;br/&gt;
would have been prettier to only append the password if it is not null, the&lt;br/&gt;
additional logic and extra processing time required for the change did not seem&lt;br/&gt;
worthwhile.&lt;/p&gt;

&lt;p&gt;Next, the getUserPassKey(String username, String password) method was modified&lt;br/&gt;
to ensure the username and password were used as the key for the Map.  In the&lt;br/&gt;
event that username and password are both null, the key will be &quot;nullnull&quot;. &lt;br/&gt;
Similarly, the String &quot;null&quot; will be used for the part associated with username&lt;br/&gt;
or password if one is null.  This means that we will never use a null value for&lt;br/&gt;
a key; however, the effect is the same--since the hashCode() of the String&lt;br/&gt;
&quot;nullnull&quot; will always be the same, we&apos;ll have only one entry for the&lt;br/&gt;
UserPassKey having null username and password.  We only create a new Map entry&lt;br/&gt;
when either username or password is different (as opposed to before, where we&lt;br/&gt;
only create a new entry when username is different).&lt;/p&gt;

&lt;p&gt;Although using the password in the key may be considered to have security&lt;br/&gt;
implications (as a hash of username and password could be considered a password&lt;br/&gt;
equivalent), the data will only be available to the application--which, itself,&lt;br/&gt;
is handling the password.  Furthermore, since the UserPassKey is storing the&lt;br/&gt;
unencoded password, and since the UserPassKey&apos;s toString() method returns the&lt;br/&gt;
unencoded username and password, the proposed patch does not seem to negatively&lt;br/&gt;
impact security of the class.&lt;/p&gt;

&lt;p&gt;The patch also modifies testIncorrectPassword() in TestSharedPoolDataSource. &lt;br/&gt;
After the patch is applied, the SharedPoolDataSource will attempt to connect&lt;br/&gt;
with the new (incorrect) password.  The DataSource throws a SQLNestedException&lt;br/&gt;
(&quot;Could not retrieve connection info from pool&quot;) chained to a SQLException (&quot;x&lt;br/&gt;
is not the correct password for u1.  The correct password is p1&quot;).&lt;/p&gt;

&lt;p&gt;While the existing patch only applies to the SharedPoolDataSource, I would be&lt;br/&gt;
happy to provide a similar patch for the PerUserPoolDataSource (for the reasons&lt;br/&gt;
given above, I feel this approach is also the best approach for the&lt;br/&gt;
PerUserPoolDataSource).  If interested, let me know and I&apos;ll file a patch on&lt;br/&gt;
another bug report.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: other&lt;br/&gt;
Platform: Other&lt;/p&gt;</environment>
        <key id="12342194">DBCP-8</key>
            <summary>[dbcp][PATCH] Handle changed passwords in SharedPoolDataSource</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="markt">Mark Thomas</assignee>
                                    <reporter username="mtdean@thirdcontact.com">Michael T. Dean</reporter>
                        <labels>
                    </labels>
                <created>Mon, 18 Apr 2005 08:35:22 +0000</created>
                <updated>Mon, 15 Feb 2010 04:19:47 +0000</updated>
                            <resolved>Sat, 6 Feb 2010 19:54:56 +0000</resolved>
                                                    <fixVersion>1.3</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12409167" author="mtdean@thirdcontact.com" created="Mon, 18 Apr 2005 08:36:45 +0000"  >&lt;p&gt;Created an attachment (id=14741)&lt;br/&gt;
Proposed Patch&lt;/p&gt;</comment>
                            <comment id="12479661" author="mtdean@thirdcontact.com" created="Fri, 9 Mar 2007 17:36:45 +0000"  >&lt;p&gt;Updated patch that applies cleanly to current SVN trunk&lt;/p&gt;</comment>
                            <comment id="12689124" author="markt" created="Wed, 25 Mar 2009 14:55:39 +0000"  >&lt;p&gt;Thanks for the patch. It has been applied to trunk.&lt;/p&gt;</comment>
                            <comment id="12769867" author="markt" created="Sun, 25 Oct 2009 21:12:53 +0000"  >&lt;p&gt;Re-opening as the fix needs to be extended to the PerUserPoolDataSource&lt;/p&gt;</comment>
                            <comment id="12769868" author="markt" created="Sun, 25 Oct 2009 21:16:23 +0000"  >&lt;p&gt;Fixed in trunk and will be in 1.3 onwards.&lt;/p&gt;</comment>
                            <comment id="12801636" author="psteitz" created="Mon, 18 Jan 2010 00:50:13 +0000"  >&lt;p&gt;I am concerned that the implemented solution creates a security problem, or at least a misleading security contract.  If the use case we are trying to satisfy is database passwords being changed,  it seems to me that we really do need to implement a close() method as Dirk suggested.  Under the current implementation, getConnection(username, password) will continue to work with the &quot;old&quot; password, returning pooled connections created using the old password if these still exist in the pool.   &lt;/p&gt;</comment>
                            <comment id="12801647" author="sebb@apache.org" created="Mon, 18 Jan 2010 02:07:59 +0000"  >&lt;p&gt;Seems to me that the only way that the code can know that the password has been changed is when an application calls getConnection() using the new password.&lt;/p&gt;

&lt;p&gt;So if the login succeeds, then this becomes the new password for the user, and any connections in the pool which have a different password for that user can be dropped, and any connections that are returned to the pool subsequently can be dropped if they don&apos;t match the new password.&lt;/p&gt;

&lt;p&gt;I&apos;ve not looked at the code in detail - and it seems a bit too simple - so I may have overlooked something here.&lt;/p&gt;</comment>
                            <comment id="12801655" author="psteitz" created="Mon, 18 Jan 2010 02:47:14 +0000"  >&lt;p&gt;You are describing one reasonable scenario.  The code does not do this or anything similar.  So if we keep it as is, we at least need to document the behavior.  &lt;/p&gt;</comment>
                            <comment id="12801656" author="psteitz" created="Mon, 18 Jan 2010 02:52:20 +0000"  >&lt;p&gt;To qualify my first statement above, after the patch the code is no less secure than before - i.e., before the patch, after a password change, the old password would continue to work as long as there were connections available in the pool (and they were not killed on the server side).  After the patch, the changed password will work as well.&lt;/p&gt;</comment>
                            <comment id="12801665" author="sebb@apache.org" created="Mon, 18 Jan 2010 03:44:55 +0000"  >&lt;p&gt;Sorry, I see my previous comment was ambiguous.&lt;/p&gt;

&lt;p&gt;What I meant was that the code could be AMENDED to keep track of the current user/password combination, and use that to invalidate connections which were set up using a different password.&lt;/p&gt;

&lt;p&gt;As far as I can tell, that would prevent the old password from being used again when getting a new connection from the pool.&lt;/p&gt;

&lt;p&gt;It would not stop an active connection from being used, but IMO that&apos;s really up to the database engine whether or not a password change has any effect on an open connection. Indeed, the database might insist all connections are closed before permitting a password change.&lt;/p&gt;

&lt;p&gt;With my suggestion, there&apos;s no need to change to the API, the user just needs to provide the new password, which is what they would do anyway.&lt;/p&gt;

&lt;p&gt;If the user provides a wrong new password, then the database connection will fail, and in that case obviously the current user/password mapping should not be changed.&lt;/p&gt;

&lt;p&gt;Won&apos;t that work?&lt;/p&gt;</comment>
                            <comment id="12801941" author="psteitz" created="Mon, 18 Jan 2010 20:36:58 +0000"  >&lt;p&gt;I agree that the code could be modified to do what you are suggesting, but it will be tricky to do so, especially for SharedPoolDataSource.  &lt;/p&gt;

&lt;p&gt;Here is another problem with the patch.  While unlikely, it is possible that username+password combinations can collide.  This would not result in credential sharing, but it would result in getConnection failures, as the password comparison in InstanceKeyDatasource.getConnection would fail.  Note that other than in this case, the check will now never fail.&lt;/p&gt;

&lt;p&gt;Here is one idea, which I have not fully thought through, but which may work:&lt;/p&gt;

&lt;p&gt;Modify the following code that validates the password in InstanceKeyDataSource.getConnection&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!(&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; == password ? &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; == info.getPassword() 
                : password.equals(info.getPassword()))) {
            closeDueToException(info);
            &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; SQLException(&lt;span class=&quot;code-quote&quot;&gt;&quot;Given password did not match password used&quot;&lt;/span&gt;
                                   + &lt;span class=&quot;code-quote&quot;&gt;&quot; to create the PooledConnection.&quot;&lt;/span&gt;);
 }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;to call testCPDS(username, password) before throwing.  If it succeeds, that means the password has been changed, so at this point, you go into a loop, calling getPooledConnectionAndInfo(username, password) up to maxActive times until you get an info object with the new password, calling closeDueToException on the &quot;bad&quot; ones.  This should clear any idle connections with the old password and will also take care of the ones that are out as they would meet a similar fate when they come back and are subsequently checked out.&lt;/p&gt;

&lt;p&gt;Unfortunately, closeDueToExcption really just returns the connection to the pool, so to actually make this work, we would need to add the ability to mark a PooledConnectionAndInfo object as bad and modify CPDSConnectionFactory.passivate to inspect this property and destroy the object if it is marked as bad.&lt;/p&gt;

&lt;p&gt;I apologize for not digging deeply enough into this when the patch was originally applied.&lt;/p&gt;
</comment>
                            <comment id="12801949" author="sebb@apache.org" created="Mon, 18 Jan 2010 20:56:26 +0000"  >&lt;p&gt;The same key is generated for both (&quot;foo&quot;,&quot;bar&quot;) and (&quot;foob&quot;,&quot;ar&quot;) in .PerUserPoolDataSource.getPoolKey(String username, String password).&lt;/p&gt;

&lt;p&gt;So the code in InstanceKeyDataSource.getConnection is required in order to ensure that the key of username+password only matches the correct username - it&apos;s not just needed to check that the correct password has been used.&lt;/p&gt;</comment>
                            <comment id="12803525" author="psteitz" created="Thu, 21 Jan 2010 23:05:02 +0000"  >&lt;p&gt;Here is a patch that implements changed password functionality in SharedPoolDataSource, PerUserPoolDataSource with the &lt;br/&gt;
following semantics for both datasources:&lt;/p&gt;

&lt;p&gt;When a getConnection(username, password) request is processed, an attempt is made to borrow a connection from the backing pool.  If successful, a PooledConnectionAndInfo instance is provided by the backing pool.  The password field is then compared to the actual parameter provided to getConnection and if it matches, the PooledConnection that it contains is returned to the client.  If the password does not match, an attempt is made to connect to the database using the parameters supplied by the client (using testCPDS).  If this succeeds, the password must have changed since the PooledConnectionAndInfo instance was created.  In this case, the PooledConnectionAndInfo instance is destroyed and removed from the backing pool, and the pool associated with &amp;lt;username&amp;gt; is cleared (using a newly added invalidate method and a reference that it maintains to its parent factoryl).  The getConnection implementation (in InstanceKeyDataSource) then proceeds to retry up to 10 times (number could be set lower, as retries should not in general be necessary, but threads returning old connections could force retries), until it gets a PooledConnectionAndInfo with the correct password or encounters a pool error (e.g. NoSuchElementException).&lt;/p&gt;

&lt;p&gt;Summary of changes&lt;/p&gt;

&lt;p&gt;InstanceKeyDataSource: &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;modified getConnection(username, password) to implement the algorithm above.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;PooledConnectionAndInfo: &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;added a &quot;factory&quot; field to hold a reference to the factory that created the instance.  This is typed as ConnectionEventListener, which is perhaps misleading, but this is the only interface or parent that CPDSConnectionFactory, KeyedCPDSConnectionFactory share.&lt;/li&gt;
	&lt;li&gt;added a setFactoryPassword method to support resetting the password used by the factory when creating connections.  This is a no-op if the factory is KeyedCPDSConnectionFactory (SharedPoolDataSource), but is needed for CPDSConnectionFactory (PerUsserPoolDataSpource).&lt;/li&gt;
	&lt;li&gt;added an invalidate method.  The implementation of this method uses the factory reference to get a reference to the backing pool and then invokes the pool&apos;s invalidate method.  This ensures that the PooledConnection is destroyed and pool counters are appropriately updated.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;CPDSConnectionFactory:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;added setPassword method to reset the password used for a user pool (PerUserPoolDataSource)&lt;/li&gt;
	&lt;li&gt;passed reference to itself in PooledConnectionAndInfo constructor in makeObject&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;KeyedCPDSConnectionFactory:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;passed reference to itself in PooledConnectionAndInfo constructor in makeObject&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;PoolKey:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;revert to using only the username in the key&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;PerUserPoolDataSource:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;add logic to check to see if getPooledConnectionAndInfo borrowObject failure is due to factory makeObject failure as a result of password change.  In this case, check to see if the password provided in the call works to establish a connection and, if so, reset the factory password, clear the pool and retry.&lt;/li&gt;
	&lt;li&gt;changed getPoolKey to only use the username (reverting prior change)&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;UserKey:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;changed equals and hashCode to identify keys with equal user names.  The password field is retained, as it is needed by the KeyedCPDSConnectionFactory.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;TestPerUserPoolDataSource, TestSharedPoolDataSource&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;modified test cases to ensure that after password changes, old passwords do not continue to work in getConnection and idle instances with old passwords are removed from the pool&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Comments / suggestions for improvement / arguments for no change welcome.  If we do go down this path, the pool fields (and constructor arguments) in CPDSConnectionFactory and KeyedCPDSConnectionFactory should be changed to GenericObjectPool, GenericKeyedObjectPool, respectively.  The patch casts to the concrete implementations because invalidation requires the clear methods which are sadly missing from the interfaces.  This would not be an incompatible change as these classes have package scope.&lt;/p&gt;

&lt;p&gt;Side note:  the last observation above (package scope) means that we can take care of the protected fields in these classes that should be private &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;
</comment>
                            <comment id="12803546" author="sebb@apache.org" created="Thu, 21 Jan 2010 23:57:09 +0000"  >&lt;p&gt;What about connections which are returned to the pool? &lt;br/&gt;
If these have the old password, I assume this will be detected when the pool item is next considered for use.&lt;br/&gt;
However, this may be much later - would it not be better to drop them before returning to the pool? Or is that too much work?&lt;/p&gt;

&lt;p&gt;Some minor points:&lt;/p&gt;

&lt;p&gt;The PooledConnectionAndInfo ctor Javadoc says:&lt;/p&gt;

&lt;p&gt;The factory must be an instance of either&lt;br/&gt;
CPDSConnectionFactory (used by PerUserPoolDataSource) or &lt;br/&gt;
KeyedCPDSConnectionFactory (used by SharedPoolDataSource). &lt;/p&gt;

&lt;p&gt;However, it does not check this. Perhaps it should, rather than waiting until invalidate() causes a ClassCastException&lt;/p&gt;

&lt;p&gt;==&lt;/p&gt;

&lt;p&gt;In the code&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (factory != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
  &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (factory &lt;span class=&quot;code-keyword&quot;&gt;instanceof&lt;/span&gt; CPDSConnectionFactory) {
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;the null check is redundant as null can be used in the instanceof check without a problem.&lt;/p&gt;
</comment>
                            <comment id="12803555" author="psteitz" created="Fri, 22 Jan 2010 00:26:57 +0000"  >&lt;p&gt;Good points.  Detecting and killing &quot;old password&quot; connections when they are returned would be possible for PerUserPoolDataSource, since the CPDSConnectionFactory stores the (single user) password.  The only way that I can think of to do this for SharedPoolDataSource would be to attempt a database authenication each time a connection is returned, which is obviously not a good idea.  I will look more fully into what would be required to do this for PerUserPoolDataSource. &lt;/p&gt;

&lt;p&gt;Agree on the null check and I guess the PooledConnectionAndInfo constructor should check and throw.&lt;/p&gt;</comment>
                            <comment id="12803577" author="psteitz" created="Fri, 22 Jan 2010 02:35:02 +0000"  >&lt;p&gt;I had forgotten that both CPDSConnectionFactory and KeyedCPDSConnectionFactory maintain maps holding (weak) references to each of the PooledConnectionAndInfo instances managed by their pools - including the wrappers for the PooledConnections that are checked out.  So the invalidate method in the patch could, in addition to clearing the idle instance pool for the affected user, somehow mark the PooledConnectionAndInfo instances corresponding to &quot;old password&quot; connections checked out and then the factory could invalidate them when it gets a connectionClosed event on a marked connection.  The factories could even be configured to close the connections before they are returned, if that is the desired behavior (I would not recommend that by default, but it could be a config option).&lt;/p&gt;

&lt;p&gt;Another problem that I have been worried a little about is the &quot;denial of service&quot; issue raised above.  Both the original patch and the alternative suffer from the problem that if bad passwords supplied in getConnection(username, password) are common (for previously authenticated usernames), this may strain database resources, as the testCPDS check requires a database connection.  Note that the only net new load is the case where connections have been successfully established for a given username and then bad passwords are supplied frequently for the same username.  Random bad pairs would have the same load effect as they do in 1.2.2.  If we want to be conservative here, we might make the changed password functionality configurable, with default turned off.&lt;/p&gt;</comment>
                            <comment id="12803723" author="sebb@apache.org" created="Fri, 22 Jan 2010 15:20:25 +0000"  >&lt;p&gt;Minor issue: setPassword() does not need to be synch., because the variable is volatile.&lt;/p&gt;

&lt;p&gt;On further reflection, I&apos;m not sure I like the proposed patch - for example I&apos;m not sure that PooledConnectionAndInfo should have a reference to the factory used to create it.&lt;/p&gt;

&lt;p&gt;However I don&apos;t (yet) know the DBCP design well enough to know if there is any other way to solve the problem.&lt;/p&gt;</comment>
                            <comment id="12803777" author="psteitz" created="Fri, 22 Jan 2010 17:50:14 +0000"  >&lt;p&gt;I think I was planning to clean up the access on _password, making it private, so access could be syched.&lt;/p&gt;

&lt;p&gt;Agree that it is a little smelly and inefficient to have PooledConnectionAndInfo instances hold factory references.  For SharedPoolDataSource, the datasource itself could hold a reference to the factory.  PerUserPoolDataSoures would have to maintain a map of such references.   I will look into alternatives.   Suggestions welcome.&lt;/p&gt;</comment>
                            <comment id="12803843" author="sebb@apache.org" created="Fri, 22 Jan 2010 19:42:09 +0000"  >&lt;p&gt;Seems to me that PerUserPoolDataSource could store the factory in the map, instead of the pool - or failing that a wrapper object that contained both.&lt;br/&gt;
This would allow PUPDS to track the password.&lt;/p&gt;

&lt;p&gt;BTW, it seems to me that CPDSConnectionFactory really ought not to have any way of changing the CPDS or Pool once the factory has been created.&lt;br/&gt;
Not sure it makes sense for either to be changed on the fly - I suspect it would seriously mess things up.&lt;/p&gt;</comment>
                            <comment id="12806859" author="psteitz" created="Sun, 31 Jan 2010 19:09:53 +0000"  >&lt;p&gt;Here is an updated patch that accomplishes what changePassword.patch did without adding a factory reference to PooledConnectionAndInfo.  Instead, a new interface is added - PooledConnectionManager - including methods to invalidate PooledConnections and this interface is implemented by the connection factories.  PerUserPoolDataSource is modified to replace its pools map with a &quot;managers&quot; map holding references to source factories rather than host pools.  Otherwise changes are similar to changePassword.patch.  The invalidate method is a useful enhancement which could potentially be exposed by the datasources, allowing users to selectively &quot;realy close&quot; pooled connections without messing up the pool or its counters.&lt;/p&gt;

&lt;p&gt;This patch also reduces mutability of the factories. &lt;/p&gt;

&lt;p&gt;For SharedPooleDataSource / KeyedCPDSConnectionFactory, connections returning after password reset are still not closed immediately.  To implement this would require more work.&lt;/p&gt;</comment>
                            <comment id="12828070" author="sebb@apache.org" created="Mon, 1 Feb 2010 11:34:22 +0000"  >&lt;p&gt;Latest patch looks good, except I&apos;m not sure that CPDSConnectionFactory should allow the username to be changed, only the password.&lt;/p&gt;

&lt;p&gt;It&apos;s a pity that CPDSConnectionFactory is not quite immutable, but I suspect it might be rather complicated to update the stored factory when the password changes.&lt;/p&gt;</comment>
                            <comment id="12828140" author="sebb@apache.org" created="Mon, 1 Feb 2010 15:19:40 +0000"  >&lt;p&gt;Just noticed a minor issue in the existing testChangePassword() methods:&lt;/p&gt;

&lt;p&gt;In the following sample:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
    ds.getConnection(&lt;span class=&quot;code-quote&quot;&gt;&quot;foo&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;bar&quot;&lt;/span&gt;).close(); &lt;span class=&quot;code-comment&quot;&gt;// old password
&lt;/span&gt;    fail(&lt;span class=&quot;code-quote&quot;&gt;&quot;Should have generated SQLException&quot;&lt;/span&gt;); 
} &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; etc
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;the .close() should be removed - the test is supposed to be checking getConnection(), not close().&lt;br/&gt;
In theory the get could succeed and the close() fail.&lt;/p&gt;

&lt;p&gt;Need to fix these at some point.&lt;/p&gt;</comment>
                            <comment id="12830555" author="psteitz" created="Sat, 6 Feb 2010 19:54:56 +0000"  >&lt;p&gt;Committed passwordChange2.patch with one change in r907288.  Per Sebb&apos;s comment, the only mutability needed in CPDSConnectionFactory is the password, so PooledConnectionManager exposes only setPassword, rather than setUserPassKey.&lt;/p&gt;

&lt;p&gt;Dropped extraneous close in the changePassword tests in r907290.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12333469" name="ASF.LICENSE.NOT.GRANTED--dbcp-SharedPoolWithPasswordChange.patch" size="2470" author="mtdean@thirdcontact.com" created="Mon, 18 Apr 2005 08:36:45 +0000"/>
                            <attachment id="12431077" name="changePassword.patch" size="26504" author="psteitz" created="Thu, 21 Jan 2010 23:05:02 +0000"/>
                            <attachment id="12353003" name="dbcp-SharedPoolWithPasswordChange-20070309.patch" size="2474" author="mtdean@thirdcontact.com" created="Fri, 9 Mar 2007 17:36:45 +0000"/>
                            <attachment id="12431918" name="passwordChange2.patch" size="45269" author="psteitz" created="Sun, 31 Jan 2010 19:09:53 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>34490</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114292</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            15 years, 39 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uw7j:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178359</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-7] [dbcp] about preparestatement</title>
                <link>https://issues.apache.org/jira/browse/DBCP-7</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;Hello,&lt;/p&gt;

&lt;p&gt;I send preparedstatement against MSSQLServer by using dbcp library.&lt;br/&gt;
But, I couldn&apos;t got a data from MSSQLServer and I got the following exception.&lt;/p&gt;

&lt;p&gt;java.sql.SQLException: &lt;span class=&quot;error&quot;&gt;&amp;#91;Microsoft&amp;#93;&lt;/span&gt;[SQLServer 2000 Driver for &lt;br/&gt;
JDBC]??????????????????????????????????&lt;br/&gt;
	at com.microsoft.jdbc.base.BaseExceptions.createException(Unknown &lt;br/&gt;
Source)&lt;br/&gt;
	at com.microsoft.jdbc.base.BaseExceptions.getException(Unknown Source)&lt;br/&gt;
	at com.microsoft.jdbc.base.BaseConnection.getImplConnection(Unknown &lt;br/&gt;
Source)&lt;br/&gt;
	at com.microsoft.jdbc.base.BaseStatement.setupImplConnection(Unknown &lt;br/&gt;
Source)&lt;br/&gt;
	at com.microsoft.jdbc.base.BaseStatement.&amp;lt;init&amp;gt;(Unknown Source)&lt;br/&gt;
	at com.microsoft.jdbc.base.BasePreparedStatement.&amp;lt;init&amp;gt;(Unknown Source)&lt;br/&gt;
	at com.microsoft.jdbc.base.BaseConnection.prepareStatement(Unknown &lt;br/&gt;
Source)&lt;br/&gt;
	at &lt;br/&gt;
org.apache.commons.dbcp.cpdsadapter.PooledConnectionImpl.prepareStatement&lt;br/&gt;
(PooledConnectionImpl.java:231)&lt;br/&gt;
	at org.apache.commons.dbcp.cpdsadapter.ConnectionImpl.prepareStatement&lt;br/&gt;
(ConnectionImpl.java:302)&lt;br/&gt;
	at RunSql.getTableData(RunSql.java:38)&lt;br/&gt;
	at SelectDataAction.run(SelectDataAction.java:25)&lt;br/&gt;
	at org.eclipse.jface.action.Action.runWithEvent(Action.java:842)&lt;br/&gt;
	at &lt;br/&gt;
org.eclipse.jface.action.ActionContributionItem.handleWidgetSelection&lt;br/&gt;
(ActionContributionItem.java:456)&lt;br/&gt;
	at org.eclipse.jface.action.ActionContributionItem.handleWidgetEvent&lt;br/&gt;
(ActionContributionItem.java:403)&lt;br/&gt;
	at org.eclipse.jface.action.ActionContributionItem.access$0&lt;br/&gt;
(ActionContributionItem.java:397)&lt;br/&gt;
	at &lt;br/&gt;
org.eclipse.jface.action.ActionContributionItem$ActionListener.handleEvent&lt;br/&gt;
(ActionContributionItem.java:72)&lt;br/&gt;
	at org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:81)&lt;br/&gt;
	at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:840)&lt;br/&gt;
	at org.eclipse.swt.widgets.Display.runDeferredEvents(Display.java:2022)&lt;br/&gt;
	at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:1729)&lt;br/&gt;
	at org.eclipse.jface.window.Window.runEventLoop(Window.java:583)&lt;br/&gt;
	at org.eclipse.jface.window.Window.open(Window.java:563)&lt;br/&gt;
	at SampleWindow.main(SampleWindow.java:75)&lt;/p&gt;

&lt;p&gt;I tested it against oracle and I got a data successfully.&lt;br/&gt;
And, when I tested it by using the program which I created without dbcp &lt;br/&gt;
library, I got a data from MSSQLServer.&lt;br/&gt;
Is it a bug?&lt;/p&gt;

&lt;p&gt;Thanks &amp;amp; Regards&lt;br/&gt;
Keiichi Tanihara&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: Windows XP&lt;br/&gt;
Platform: PC&lt;/p&gt;</environment>
        <key id="12341523">DBCP-7</key>
            <summary>[dbcp] about preparestatement</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="4">Incomplete</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="tanihara@imkk.jp">Tanihara Keiichi</reporter>
                        <labels>
                    </labels>
                <created>Fri, 18 Jun 2004 15:56:02 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:27 +0000</updated>
                            <resolved>Tue, 25 Mar 2008 08:11:27 +0000</resolved>
                                    <version>1.2</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12406872" author="tanihara@imkk.jp" created="Fri, 18 Jun 2004 16:00:58 +0000"  >
&lt;p&gt;MSSQLServer&apos;s version is 2000.&lt;br/&gt;
Oralce&apos;s version is 9i.&lt;/p&gt;</comment>
                            <comment id="12406873" author="dirkv" created="Fri, 18 Jun 2004 23:16:44 +0000"  >&lt;p&gt;Can you get an english error message from the Microsoft driver?&lt;br/&gt;
?????????????????????????????????? is not very useful &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;Also the jdbc driver you use is important.&lt;br/&gt;
Maybe you can try:&lt;br/&gt;
&lt;a href=&quot;http://jtds.sourceforge.net/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://jtds.sourceforge.net/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="12406874" author="tanihara@imkk.jp" created="Mon, 21 Jun 2004 11:09:12 +0000"  >&lt;p&gt;english error message is as follows.&lt;br/&gt;
java.sql.SQLException: &lt;span class=&quot;error&quot;&gt;&amp;#91;JRun&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;SQLServer JDBC Driver&amp;#93;&lt;/span&gt;Can&apos;t start a cloned &lt;br/&gt;
connection while in manual transaction mode. &lt;/p&gt;

&lt;p&gt;So, I could get a data from SQLServer by setting URL parameter &lt;br/&gt;
selectMethod=cursor.&lt;/p&gt;

&lt;p&gt;Thanks&lt;/p&gt;</comment>
                            <comment id="12406875" author="dirkv" created="Tue, 22 Jun 2004 00:39:37 +0000"  >&lt;p&gt;Driver problem so I&apos;m marking this issue invalid.&lt;/p&gt;

&lt;p&gt;reference:&lt;br/&gt;
&lt;a href=&quot;http://support.microsoft.com/default.aspx?scid=kb%3BEN-US%3BQ313181&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://support.microsoft.com/default.aspx?scid=kb%3BEN-US%3BQ313181&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>29663</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114291</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            21 years, 21 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0v0jr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>179062</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-6] Broken pipe despite validation query set</title>
                <link>https://issues.apache.org/jira/browse/DBCP-6</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;I got a broken pipe error sometimes when trying to&lt;br/&gt;
execute a prepared statement. I am using DBCP 1.0 and&lt;br/&gt;
I set the validation query as &quot;select sysdate from&lt;br/&gt;
dual&quot;. However, I still get the error. What I do is:&lt;br/&gt;
prst = conn.prepareStatement(strbuff.toString());&lt;br/&gt;
prst.setInt(1, extSysCode);&lt;br/&gt;
prst.setString(2, extSysTxnID);&lt;br/&gt;
rs = prst.executeQuery();&lt;br/&gt;
The error occurs when I call executeQuery, but no&lt;br/&gt;
error when I call prepareStatement. &lt;br/&gt;
The error is SQLException: Io exception: Broken pipe&lt;br/&gt;
The error disappears after the application server is&lt;br/&gt;
restarted. But it occurs again later. Not sure about&lt;br/&gt;
the pattern yet, but this is in production, so need to&lt;br/&gt;
solve it asap.&lt;/p&gt;

&lt;p&gt;Other facts: &lt;br/&gt;
Application server: struts 1.1b2, tomcat 4.1.24,&lt;br/&gt;
Oracle JDBC driver 8.1.7 (classes12.zip), thin driver.&lt;br/&gt;
Solaris 8.&lt;br/&gt;
DB server: Oracle 8.1.7, Solaris 8.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: other&lt;br/&gt;
Platform: All&lt;/p&gt;</environment>
        <key id="12340823">DBCP-6</key>
            <summary>Broken pipe despite validation query set</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="3">Duplicate</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="xucheng_chn@yahoo.com.sg">Xu Cheng</reporter>
                        <labels>
                    </labels>
                <created>Fri, 27 Jun 2003 07:44:00 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:27 +0000</updated>
                            <resolved>Tue, 25 Mar 2008 08:11:27 +0000</resolved>
                                    <version>1.0</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12404632" author="dirkv" created="Tue, 12 Aug 2003 07:14:53 +0000"  >

&lt;ul&gt;
	&lt;li&gt;
	&lt;ul&gt;
		&lt;li&gt;
		&lt;ul&gt;
			&lt;li&gt;This bug has been marked as a duplicate of 22078 ***&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>21132</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114290</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            22 years, 14 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uzxb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178961</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-5] [dbcp] PoolGuardConnectionWrapper violates close() contract</title>
                <link>https://issues.apache.org/jira/browse/DBCP-5</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;org.apache.commons.dbcp.PoolingDatasource.PoolGuardConnectionWrapper.close()&lt;br/&gt;
violates the Connection.close() contract specified in the Java 1.5 API.  The&lt;br/&gt;
current API specifies that calling close() on an already-closed connection is a&lt;br/&gt;
no-op.  (Blame Sun for the bug.  The API didn&apos;t used to say that.)  &lt;/p&gt;

&lt;p&gt;PoolGuardConnectionWrapper.close() first calls checkOpen() which throws an&lt;br/&gt;
exception if close() has already been called.  Clearly that&apos;s not a no-op.&lt;/p&gt;

&lt;p&gt;The simplest fix is to change the first line in the close() method from this:&lt;br/&gt;
checkOpen();&lt;/p&gt;

&lt;p&gt;to this:&lt;br/&gt;
if (this.delegate == null) return;&lt;/p&gt;


&lt;p&gt;As of today (2006-03-22) this bug is in the latest SVN source (and has been in&lt;br/&gt;
previous versions as well).&lt;/p&gt;


&lt;p&gt;DelegatingConnection and PoolingConnection don&apos;t seem (from a quick glance) to&lt;br/&gt;
have this problem.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: All&lt;br/&gt;
Platform: All&lt;/p&gt;</environment>
        <key id="12342989">DBCP-5</key>
            <summary>[dbcp] PoolGuardConnectionWrapper violates close() contract</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="dpark@gelaed.com">Derek Park</reporter>
                        <labels>
                    </labels>
                <created>Thu, 23 Mar 2006 09:40:08 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:27 +0000</updated>
                            <resolved>Thu, 19 Jul 2007 04:12:35 +0000</resolved>
                                                    <fixVersion>1.3</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12411646" author="sandymac@apache.org" created="Thu, 23 Mar 2006 11:15:31 +0000"  >&lt;p&gt;This has come up before and a few weeks ago I found a number of close methods&lt;br/&gt;
that needed to be changed. See:&lt;br/&gt;
&lt;a href=&quot;http://mail-archives.apache.org/mod_mbox/jakarta-commons-dev/200603.mbox/%3c6bde122b0603072304h20460a9ewc7d7e1eaa70f440@mail.gmail.com%3e&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://mail-archives.apache.org/mod_mbox/jakarta-commons-dev/200603.mbox/%3c6bde122b0603072304h20460a9ewc7d7e1eaa70f440@mail.gmail.com%3e&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="12513803" author="psteitz" created="Thu, 19 Jul 2007 04:12:35 +0000"  >&lt;p&gt;Fixed in r 557176.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>39069</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114289</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            18 years, 17 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uxgv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178563</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-4] [dbcp] Use commons-logging for debugging instead of System.out.println</title>
                <link>https://issues.apache.org/jira/browse/DBCP-4</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;At the source code of commons-dbcp, some System.out.println() and&lt;br/&gt;
System.err.println() statements can be found, noticeably in the constructor of &lt;br/&gt;
&quot;java.org.apache.commons.dbcp.AbandonedObjectPool&quot;.&lt;/p&gt;

&lt;p&gt;These statements are annoying, because none of the developers want to see these&lt;br/&gt;
messages but they occuplied the precious space in the log files.&lt;/p&gt;

&lt;p&gt;I think it is still appropriate to use this method to emit errors, but for&lt;br/&gt;
normal behavior, we should have an option never seeing them.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: All&lt;br/&gt;
Platform: All&lt;/p&gt;</environment>
        <key id="12341600">DBCP-4</key>
            <summary>[dbcp] Use commons-logging for debugging instead of System.out.println</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="tam@siulung.com">Alan Tam</reporter>
                        <labels>
                    </labels>
                <created>Thu, 29 Jul 2004 14:52:24 +0000</created>
                <updated>Mon, 15 Feb 2010 04:20:13 +0000</updated>
                            <resolved>Wed, 18 Feb 2009 16:49:23 +0000</resolved>
                                    <version>Nightly Builds</version>
                                    <fixVersion>1.3</fixVersion>
                                        <due></due>
                            <votes>5</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="12407114" author="phil-apache@whirlycott.com" created="Fri, 10 Sep 2004 09:29:05 +0000"  >&lt;p&gt;Created an attachment (id=12689)&lt;br/&gt;
patch to get commons-logging in dbcp&lt;/p&gt;</comment>
                            <comment id="12407115" author="tam@siulung.com" created="Fri, 10 Sep 2004 09:35:33 +0000"  >&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;System.out.println(&quot;AbandonedObjectPool is used (&quot; + this + &quot;)&quot;);&lt;/li&gt;
	&lt;li&gt;System.out.println(&quot;   LogAbandoned: &quot; + config.getLogAbandoned());&lt;/li&gt;
	&lt;li&gt;System.out.println(&quot;   RemoveAbandoned: &quot; + config.getRemoveAbandoned());&lt;/li&gt;
	&lt;li&gt;System.out.println(&quot;   RemoveAbandonedTimeout: &quot; +&lt;br/&gt;
config.getRemoveAbandonedTimeout());&lt;br/&gt;
+        log.error(&quot;AbandonedObjectPool is used (&quot; + this + &quot;)&quot;);&lt;br/&gt;
+        log.error(&quot;   LogAbandoned: &quot; + config.getLogAbandoned());&lt;br/&gt;
+        log.error(&quot;   RemoveAbandoned: &quot; + config.getRemoveAbandoned());&lt;br/&gt;
+        log.error(&quot;   RemoveAbandonedTimeout: &quot; +&lt;br/&gt;
config.getRemoveAbandonedTimeout());&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;I suppose they are info, or even debug.&lt;/p&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;System.err.println(&quot;Could not parse&lt;br/&gt;
defaultTransactionIsolation: &quot; + value);&lt;/li&gt;
	&lt;li&gt;System.err.println(&quot;WARNING: defaultTransactionIsolation&lt;br/&gt;
not set&quot;);&lt;/li&gt;
	&lt;li&gt;System.err.println(&quot;using default value of database driver&quot;);&lt;br/&gt;
+                    log.error(&quot;Could not parse defaultTransactionIsolation: &quot; +&lt;br/&gt;
value);&lt;br/&gt;
+                    log.error(&quot;WARNING: defaultTransactionIsolation not set&quot;);&lt;br/&gt;
+                    log.error(&quot;using default value of database driver&quot;);&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;I think they are warning instead.&lt;/p&gt;</comment>
                            <comment id="12407116" author="phil-apache@whirlycott.com" created="Fri, 10 Sep 2004 09:48:34 +0000"  >&lt;p&gt;Created an attachment (id=12690)&lt;br/&gt;
patch taking alan&apos;s comments into consideration, plus more use of commons logging&lt;/p&gt;</comment>
                            <comment id="12407117" author="tam@siulung.com" created="Thu, 24 Feb 2005 23:15:20 +0000"  >&lt;p&gt;Any idea when it can be checked in?&lt;/p&gt;</comment>
                            <comment id="12407118" author="dirkv" created="Fri, 25 Feb 2005 02:24:40 +0000"  >&lt;p&gt;This patch introduces a new dependency on commons-logging.&lt;br/&gt;
I&apos;m not planning to commit this patch because of this new dependency.&lt;br/&gt;
If the dependency is made optional (runtime detection unsing refection) then&lt;br/&gt;
I&apos;ll maybe consider it. &lt;/p&gt;

&lt;p&gt;Another (and maybe better) option is to use DriverManager.getLogWriter() and log&lt;br/&gt;
using this writer.&lt;/p&gt;</comment>
                            <comment id="12407119" author="pedxing" created="Thu, 1 Dec 2005 02:20:48 +0000"  >&lt;p&gt;I&apos;d like to disagree with the logic in the rejection of this patch, and I hope I&lt;br/&gt;
can pursuade you to change your mind.&lt;/p&gt;

&lt;p&gt;Either DBCP should log information or it shouldn&apos;t. If it should, then it should&lt;br/&gt;
be using a logging package to provide that behaviour rather than trying to do&lt;br/&gt;
the job poorly itself. If DBCP should not log information, then the System.out&lt;br/&gt;
and System.err lines should be removed altogether.&lt;/p&gt;

&lt;p&gt;The commons-logging package is extremely lightweight, and is a good choice for a&lt;br/&gt;
dependency in a library like DBCP that is itself fairly low level. Think of it&lt;br/&gt;
as the set of classes to do reflection that are suggested in the rejection of&lt;br/&gt;
the patch.&lt;/p&gt;

&lt;p&gt;Why this matters is that libraries putting anything on stdout or stderr is an&lt;br/&gt;
Antipattern. It is a side effect that the user of the library can&apos;t control. It&lt;br/&gt;
is especially incomprehensible in text-mode programs. Consider this dialog:&lt;/p&gt;

&lt;p&gt;  bash$ animal&lt;br/&gt;
  GUESS WHAT KIND OF ANIMAL I AM&lt;br/&gt;
  Pick an animal for you to be. I&apos;ll ask you a series of questions.&lt;br/&gt;
  Answer YES or NO to each one, and I&apos;ll guess what kind you are.&lt;br/&gt;
  AbandonedObjectPool is used (org.apache.commons.dbcp.AbandonedObjectPool@113f501)&lt;br/&gt;
    LogAbandoned: false&lt;br/&gt;
    RemoveAbandoned: true&lt;br/&gt;
    RemoveAbandonedTimeout: 300&lt;br/&gt;
  Are you a mammal?&lt;/p&gt;

&lt;p&gt;If you absolutely must keep the output, and you absolutely refuse to send it to&lt;br/&gt;
a logging package where it belongs, at least give a configuration option to&lt;br/&gt;
suppress the output to stdout and stderr, please.&lt;/p&gt;</comment>
                            <comment id="12480229" author="bayard" created="Mon, 12 Mar 2007 23:55:47 +0000"  >&lt;p&gt;Or move to JDK 1.4 as a minimum supported version of Java and use standard logging.&lt;/p&gt;</comment>
                            <comment id="12539666" author="pagadala1" created="Fri, 2 Nov 2007 18:56:44 +0000"  >&lt;p&gt;This is very very important to change to commons-logging, also I prefer to add some more debug or info statements like, creating new connections and closing old connections, and properties used by the pooling, this type of logging should be there to optimize DB connections in pools, and debug the production problems, this package is causing vey annoying because of there is no logging, EVEN I AM THINKING OF OWNING COPY OF DBCP SOURCE and ADD LOGGING, finally Decided to raise this as an issue, with fouram, I also created a JIRA, but this seems already sheduled to 1.3, It will be very nice, THIS MESSAGE NOT ONLY MINE, IN MY OFFICE NEARLY 100 DEVELOPERS VOTED FOR THIS CHANGE, I AM SENDING YOU THIS MESSAGE BEHALF ALL OF THEM.&lt;/p&gt;

&lt;p&gt;I AM STRONGLY SUPPORT THIS CHANGE WITH 100/100 PREIORITY.&lt;/p&gt;


&lt;p&gt;Thanks,&lt;br/&gt;
Madhu.&lt;/p&gt;</comment>
                            <comment id="12541432" author="pagadala1" created="Fri, 9 Nov 2007 20:30:25 +0000"  >&lt;p&gt;Anyone working on this issue??&lt;/p&gt;</comment>
                            <comment id="12585087" author="jonathan_amir" created="Thu, 3 Apr 2008 12:46:51 +0000"  >&lt;p&gt;yeah, I vote for fixing this as well. It doesn&apos;t make sense that a commons library won&apos;t use commons-logging and instead throw its output to stdout or stderr. Very annoying.&lt;/p&gt;</comment>
                            <comment id="12674597" author="markt" created="Wed, 18 Feb 2009 13:00:32 +0000"  >&lt;p&gt;Of the places were System.out is currently used:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;AbandonedObjectpool and AbandonedTrace have been deprecated&lt;/li&gt;
	&lt;li&gt;The remaining uses are for the default logWriter which may be replaced if required by the developer&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Therefore, I see no need for any changes to DBCP.&lt;/p&gt;</comment>
                            <comment id="12674626" author="jspiewak" created="Wed, 18 Feb 2009 14:14:05 +0000"  >&lt;p&gt;AbandonedObjectpool and AbandonedTrace have been deprecated for at least the same 4.5 years that this issue has been opened.  A quick look at the 1.3 JIRA issues did not turn up something replacing them.  You are trading off your desire to not introduce a dependency with the consumers of the library being forced to use System.out as part of their logging system that they must monitor.&lt;/p&gt;</comment>
                            <comment id="12674649" author="markt" created="Wed, 18 Feb 2009 15:16:30 +0000"  >&lt;p&gt;I have been reading through the archives. There may be a case for removing the deprecation in which case the System.out usage will need to be fixed. I want to look at this some more so am re-opening so I don&apos;t forget to come back to it.&lt;/p&gt;

&lt;p&gt;Whatever the end result, I am pretty certain commons-logging won&apos;t be the solution. Using the logWriters looks like a better bet.&lt;/p&gt;</comment>
                            <comment id="12674689" author="markt" created="Wed, 18 Feb 2009 16:49:23 +0000"  >&lt;p&gt;Compromise patch applied.&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Logging to stdout on pool creation was removed as a generally bad idea and inconsistent with the other pool impls&lt;/li&gt;
	&lt;li&gt;Logging location of traces was made configurable. Developers using DBCP directly can change the PrintWriter. App servers embedding DBCP (such as Tomcat) will probably need to retain their mechanisms for handling libraries that use stdout.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="12354101">DBCP-200</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12333009" name="ASF.LICENSE.NOT.GRANTED--dbcp-commons-logging-2.patch" size="18933" author="phil-apache@whirlycott.com" created="Fri, 10 Sep 2004 09:48:34 +0000"/>
                            <attachment id="12333008" name="ASF.LICENSE.NOT.GRANTED--dbcp-commons-logging.patch" size="13148" author="phil-apache@whirlycott.com" created="Fri, 10 Sep 2004 09:29:05 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>30375</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114288</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            16 years, 38 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uydz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178712</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-3] [dbcp] PoolableConnection.close() won&apos;t allow multiple close</title>
                <link>https://issues.apache.org/jira/browse/DBCP-3</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;Sun&apos;s javadoc for java.sql.Connection.close() specifies that calling close on an&lt;br/&gt;
already closed Connection is a no-op.  However, PoolableConnection.close() (v&lt;br/&gt;
1.10) throws a SQLException if close() is called on a closed Connection. &lt;br/&gt;
PoolableConnection.close() should just return if the Connection is already&lt;br/&gt;
closed.  Here is a patch:&lt;/p&gt;

&lt;p&gt;To demonstrate the bug, just obtain an open PoolableConnection and call close()&lt;br/&gt;
on it twice; the second call will produce a SQLException.  According to Sun&apos;s&lt;br/&gt;
spec, the second close() should just be a no-op.  The current behaviour is&lt;br/&gt;
preferable to the old behaviour where it returned the Connection to the pool&lt;br/&gt;
twice, but it&apos;s still not according to the spec.&lt;/p&gt;

&lt;p&gt;Here&apos;s a patch:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;
	&lt;ul&gt;
		&lt;li&gt;
		&lt;ul&gt;
			&lt;li&gt;PoolableConnection.java.orig        2003-09-15 16:07:53.000000000 -0400&lt;/li&gt;
		&lt;/ul&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;PoolableConnection.java     2003-09-15 16:08:11.000000000 -0400&lt;br/&gt;
***************&lt;/li&gt;
		&lt;/ul&gt;
		&lt;ul&gt;
			&lt;li&gt;108,114 ****&lt;br/&gt;
       */&lt;br/&gt;
       public synchronized void close() throws SQLException {&lt;br/&gt;
          if(isClosed()) 
{
!             throw new SQLException(&quot;Already closed.&quot;);
          }
&lt;p&gt; else {&lt;br/&gt;
              try {&lt;br/&gt;
                  _pool.returnObject(this);&lt;/p&gt;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;108,114 ----&lt;br/&gt;
       */&lt;br/&gt;
       public synchronized void close() throws SQLException {&lt;br/&gt;
          if(isClosed()) 
{
!             return;
          }
&lt;p&gt; else {&lt;br/&gt;
              try {&lt;br/&gt;
                  _pool.returnObject(this);&lt;/p&gt;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;
</description>
                <environment>&lt;p&gt;Operating System: All&lt;br/&gt;
Platform: All&lt;/p&gt;</environment>
        <key id="12340970">DBCP-3</key>
            <summary>[dbcp] PoolableConnection.close() won&apos;t allow multiple close</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="adam@thejenkins.org">Adam Jenkins</reporter>
                        <labels>
                    </labels>
                <created>Tue, 16 Sep 2003 03:16:20 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:27 +0000</updated>
                            <resolved>Wed, 18 Jul 2007 06:48:22 +0000</resolved>
                                    <version>Nightly Builds</version>
                                    <fixVersion>1.3</fixVersion>
                                        <due></due>
                            <votes>3</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="12405074" author="dirkv" created="Sat, 20 Sep 2003 22:04:30 +0000"  >&lt;p&gt;I believe this behaviour is intended.&lt;br/&gt;
There is a junit test that fails if no exception is thrown:&lt;br/&gt;
testCantCloseConnectionTwice()&lt;/p&gt;

&lt;p&gt;Also the alternative datasource implementation does the same in&lt;br/&gt;
org.apache.commons.dbcp.cpdsadapter.ConnectionImpl&lt;/p&gt;

&lt;p&gt;I&apos;m marking this issue WONTFIX until more evidence is presented that throwing an&lt;br/&gt;
exception is illegal / undesired.&lt;/p&gt;</comment>
                            <comment id="12405075" author="adam@thejenkins.org" created="Mon, 22 Sep 2003 10:19:04 +0000"  >&lt;p&gt;For evidence that Connection.close() shouldn&apos;t throw an exception just because   the connection is already closed, see Sun&apos;s API spec for the Connction.close()   method.      &lt;a href=&quot;http://java.sun.com/j2se/1.4.2/docs/api/java/sql/Connection.html#close(&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://java.sun.com/j2se/1.4.2/docs/api/java/sql/Connection.html#close(&lt;/a&gt;)      The relevent quote is: &quot;Calling the method close on a Connection object that   is already closed is a no-op.&quot;  That makes it pretty clear to me that the   PoolableConnection.close implementation is not what the spec intended in this  regard.      Note, I can well believe that the current behaviour was intended, and I think  good arguments can be made for the spec&apos;s behaviour and for  PoolableConnection&apos;s behaviour.  However, I don&apos;t think there&apos;s any great  advantage to either implementation, so I think the spec should win out.    I found this problem because we actually had code which called close twice; once when the connection was done being used, and later in the finally block in case there was an error before the normal close.  We were using DriverManager but recently decided to use connection pooling, and so switched to commons-dbcp and started getting exceptions.  If I&apos;d written the code, I wouldn&apos;t have called Connection.close twice anyway, but I can&apos;t really fault the original programmer since he was following Sun&apos;s spec, so I must fault the PoolableConnection implementation. &lt;/p&gt;</comment>
                            <comment id="12405076" author="mauro@e-botelho.com" created="Fri, 24 Sep 2004 01:41:33 +0000"  >&lt;p&gt;This is a bug. According to &lt;br/&gt;
&lt;a href=&quot;http://java.sun.com/j2se/1.4.2/docs/api/java/sql/Statement.html#close(&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://java.sun.com/j2se/1.4.2/docs/api/java/sql/Statement.html#close(&lt;/a&gt;)&lt;/p&gt;

&lt;p&gt;&quot;Calling the method close on a Statement  object that is already closed has no&lt;br/&gt;
effect.&quot;&lt;/p&gt;</comment>
                            <comment id="12405077" author="amills@sensorlogic.com" created="Tue, 28 Sep 2004 04:41:16 +0000"  >&lt;ul&gt;
	&lt;li&gt;
	&lt;ul&gt;
		&lt;li&gt;
		&lt;ul&gt;
			&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/DBCP-32&quot; title=&quot;Closing closed connection should be a no-op but throws exception&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DBCP-32&quot;&gt;&lt;del&gt;COM-1582&lt;/del&gt;&lt;/a&gt; has been marked as a duplicate of this bug. ***&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="12405078" author="apache_bugzilla@zwiers.ca" created="Tue, 18 Jan 2005 23:42:15 +0000"  >&lt;p&gt;Note this is also related to 32441 - that one refers to the same problem with&lt;br/&gt;
PoolablePreparedStatements.&lt;/p&gt;</comment>
                            <comment id="12405079" author="preuss@disy.net" created="Tue, 30 Aug 2005 20:07:31 +0000"  >&lt;p&gt;Anyone working on this? This has been reported two years ago now, and it&apos;s &lt;br/&gt;
really a PITA when trying to introduce DBCP for a legacy app.&lt;/p&gt;</comment>
                            <comment id="12405080" author="lacostej" created="Sat, 25 Mar 2006 03:08:54 +0000"  >&lt;p&gt;Can this be fixed? It&apos;s an obvious violation of the API contract and breaks&lt;br/&gt;
legacy applications. Thanks.&lt;/p&gt;</comment>
                            <comment id="12405081" author="sandymac@apache.org" created="Sat, 25 Mar 2006 03:31:15 +0000"  >&lt;p&gt;(In reply to comment #7)&lt;br/&gt;
&amp;gt; Can this be fixed? It&apos;s an obvious violation of the API contract and breaks&lt;br/&gt;
&amp;gt; legacy applications. Thanks.&lt;/p&gt;

&lt;p&gt;Yes, it needs to be fixed. Working on Dbcp is next on my personal todo list,&lt;br/&gt;
maybe someone else will get to it sooner.&lt;/p&gt;

&lt;p&gt;In the existing code&apos;s defense the contract for close changed from Java 1.3 to 1.4:&lt;br/&gt;
&lt;a href=&quot;http://java.sun.com/j2se/1.3/docs/api/java/sql/Connection.html#close(&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://java.sun.com/j2se/1.3/docs/api/java/sql/Connection.html#close(&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;http://java.sun.com/j2se/1.4.2/docs/api/java/sql/Connection.html#close(&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://java.sun.com/j2se/1.4.2/docs/api/java/sql/Connection.html#close(&lt;/a&gt;)&lt;/p&gt;</comment>
                            <comment id="12420734" author="p.mouawad@ubik-ingenierie.com" created="Thu, 13 Jul 2006 04:24:01 +0000"  >&lt;p&gt;See Comment of &lt;span class=&quot;error&quot;&gt;&amp;#91;Philippe Mouawad&amp;#93;&lt;/span&gt; 12/Jul/06 09:19 PM for a problem that occurs if this bug is not corrected.&lt;br/&gt;
&lt;a href=&quot;http://issues.apache.org/jira/browse/DBCP-28&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/browse/DBCP-28&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Philippe.&lt;/p&gt;</comment>
                            <comment id="12421104" author="sjr" created="Fri, 14 Jul 2006 12:40:32 +0000"  >&lt;p&gt;Is there anything wrong with Adam Jenkin&apos;s patch that was posted nearly 3 years ago now?&lt;/p&gt;</comment>
                            <comment id="12421454" author="psteitz" created="Sun, 16 Jul 2006 16:35:57 +0000"  >&lt;p&gt;This represents a behavior change that may break some existing code, so fix version is set to 1.3.  &lt;/p&gt;</comment>
                            <comment id="12421744" author="sjr" created="Mon, 17 Jul 2006 23:49:37 +0000"  >&lt;p&gt;Shouldn&apos;t we at least apply the patch to the trunk so that it appears in our nightlies?&lt;/p&gt;</comment>
                            <comment id="12445751" author="bayard" created="Tue, 31 Oct 2006 01:46:39 +0000"  >&lt;p&gt;Maybe time to branch 1.2.2 off and have trunk be 1.3?&lt;/p&gt;</comment>
                            <comment id="12513454" author="psteitz" created="Wed, 18 Jul 2007 06:48:22 +0000"  >&lt;p&gt;Fixed in r 557176.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10001">
                    <name>dependent</name>
                                                                <inwardlinks description="is depended upon by">
                                        <issuelink>
            <issuekey id="12345888">DBCP-193</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>23185</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114287</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            18 years, 17 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uvhb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178241</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-2] referenced UserPassKey instances get erroneously returned to the pool and subsequently reinitialized</title>
                <link>https://issues.apache.org/jira/browse/DBCP-2</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;I discovered this problem because my Jdbc2PoolDataSource would exaust its &lt;br/&gt;
capacyty with no apparen reason. So I did some debugging and found out that An &lt;br/&gt;
instance of UserPassKey which is referenced by &lt;br/&gt;
GenericKeyedObjectPool._activeMap gets returned to a pool and reinitialized (so &lt;br/&gt;
username/password becomes null). After that all subsequent returnObject() calls &lt;br/&gt;
fail to decrement count in _activeMap &lt;/p&gt;

&lt;p&gt;This bug is a blocker. Jdbc2PoolDataSource can not be used while it is present.&lt;br/&gt;
My personal opinion is that keys should be immutable making them mutable and &lt;br/&gt;
pooling them is asking for troubles. May be a user name keyed map of &lt;br/&gt;
&lt;b&gt;immutable&lt;/b&gt; UserPassKey instances is a safer way to avoid needless object &lt;br/&gt;
creation.&lt;br/&gt;
Another thing. I do not understand why you need to have static map of &lt;br/&gt;
datasources. I suppose you do it to make sure you do not create pool over and &lt;br/&gt;
over again when jndi object factory is asked for an instance. I believe&lt;br/&gt;
Tomcat&apos;s environment jndi will cache data source instance after first lookup &lt;br/&gt;
and will not recreate it again  but return cached instance instead.&lt;/p&gt;

&lt;p&gt;I understand it is not a politically correct to ask for timeframe &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; but if &lt;br/&gt;
you can give me an idea when do you think you can fix it I would greatly &lt;br/&gt;
appreciate. If you feel it will take a while I will probably will have to write &lt;br/&gt;
my own lite weight version of jdbc2 pool because I need it soon.&lt;/p&gt;

&lt;p&gt;Pease let me know if I can help you in any way&lt;/p&gt;

&lt;p&gt;Alex&lt;/p&gt;

&lt;p&gt;Please analyze following debug output. @21726407 and other @#### are identity &lt;br/&gt;
hash codes of UserPassKey instances&lt;/p&gt;

&lt;p&gt;getConnection(USORG, peacetech)&lt;br/&gt;
 BORROW: totalActive=1, activeMap=&lt;/p&gt;
{UserPassKey@21726407(USORG, peacetech, false)
=1}
&lt;p&gt; :: UserPassKey@21726407(USORG, peacetech, false&lt;br/&gt;
 RETURN: totalActive=0, activeMap={} :: UserPassKey@21726407(USORG, peacetech, &lt;br/&gt;
false)&lt;br/&gt;
getConnection(USORG, peacetech)&lt;br/&gt;
 BORROW: totalActive=1, activeMap=&lt;/p&gt;
{UserPassKey@14327460(USORG, peacetech, true)
=1}
&lt;p&gt; :: UserPassKey@14327460(USORG, peacetech, true)&lt;br/&gt;
 RETURN: totalActive=0, activeMap=&lt;/p&gt;
{UserPassKey@14327460(null, null, true)=1}
&lt;p&gt; :: &lt;br/&gt;
UserPassKey@21726407(USORG, peacetech, false)&lt;br/&gt;
getConnection(USORG, peacetech)&lt;br/&gt;
 BORROW: totalActive=1, activeMap=&lt;/p&gt;
{UserPassKey@14327460(USORG, peacetech, true)
=2}
&lt;p&gt; :: UserPassKey@14327460(USORG, peacetech, true)&lt;br/&gt;
 RETURN: totalActive=0, activeMap=&lt;/p&gt;
{UserPassKey@14327460(null, null, true)=2}
&lt;p&gt; :: &lt;br/&gt;
UserPassKey@21726407(USORG, peacetech, false)&lt;br/&gt;
getConnection(USORG, peacetech)&lt;br/&gt;
 BORROW: totalActive=1, activeMap=&lt;/p&gt;
{UserPassKey@14327460(USORG, peacetech, true)
=3}
&lt;p&gt; :: UserPassKey@14327460(USORG, peacetech, true)&lt;br/&gt;
 RETURN: totalActive=0, activeMap=&lt;/p&gt;
{UserPassKey@14327460(null, null, true)=3}
&lt;p&gt; :: &lt;br/&gt;
UserPassKey@21726407(USORG, peacetech, false)&lt;br/&gt;
getConnection(USORG, peacetech)&lt;br/&gt;
 BORROW: totalActive=1, activeMap=&lt;/p&gt;
{UserPassKey@14327460(USORG, peacetech, true)
=4}
&lt;p&gt; :: UserPassKey@14327460(USORG, peacetech, true)&lt;br/&gt;
 RETURN: totalActive=0, activeMap=&lt;/p&gt;
{UserPassKey@14327460(null, null, true)=4}
&lt;p&gt; :: &lt;br/&gt;
UserPassKey@21726407(USORG, peacetech, false)&lt;br/&gt;
getConnection(USORG, peacetech)&lt;br/&gt;
 BORROW: totalActive=1, activeMap=&lt;/p&gt;
{UserPassKey@14327460(USORG, peacetech, true)
=5}
&lt;p&gt; :: UserPassKey@14327460(USORG, peacetech, true)&lt;br/&gt;
 RETURN: totalActive=0, activeMap=&lt;/p&gt;
{UserPassKey@14327460(null, null, true)=5}
&lt;p&gt; :: &lt;br/&gt;
UserPassKey@21726407(USORG, peacetech, false)&lt;br/&gt;
getConnection(USORG, peacetech)&lt;br/&gt;
 BORROW: totalActive=1, activeMap=&lt;/p&gt;
{UserPassKey@14327460(USORG, peacetech, true)
=6}
&lt;p&gt; :: UserPassKey@14327460(USORG, peacetech, true)&lt;br/&gt;
 RETURN: totalActive=0, activeMap=&lt;/p&gt;
{UserPassKey@14327460(null, null, true)=6}
&lt;p&gt; :: &lt;br/&gt;
UserPassKey@21726407(USORG, peacetech, false)&lt;br/&gt;
getConnection(USORG, peacetech)&lt;br/&gt;
 BORROW: totalActive=1, activeMap=&lt;/p&gt;
{UserPassKey@14327460(USORG, peacetech, true)
=7}
&lt;p&gt; :: UserPassKey@14327460(USORG, peacetech, true)&lt;br/&gt;
 RETURN: totalActive=0, activeMap=&lt;/p&gt;
{UserPassKey@14327460(null, null, true)=7}
&lt;p&gt; :: &lt;br/&gt;
UserPassKey@21726407(USORG, peacetech, false)&lt;br/&gt;
getConnection(USORG, peacetech)&lt;br/&gt;
 BORROW: totalActive=1, activeMap=&lt;/p&gt;
{UserPassKey@14327460(USORG, peacetech, true)
=8}
&lt;p&gt; :: UserPassKey@14327460(USORG, peacetech, true)&lt;br/&gt;
 RETURN: totalActive=0, activeMap=&lt;/p&gt;
{UserPassKey@14327460(null, null, true)=8}
&lt;p&gt; :: &lt;br/&gt;
UserPassKey@21726407(USORG, peacetech, false)&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: other&lt;br/&gt;
Platform: Other&lt;/p&gt;</environment>
        <key id="12340346">DBCP-2</key>
            <summary>referenced UserPassKey instances get erroneously returned to the pool and subsequently reinitialized</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="roytmana@peacetech.com">Alex Roytman</reporter>
                        <labels>
                    </labels>
                <created>Thu, 3 Oct 2002 13:23:27 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:27 +0000</updated>
                            <resolved>Tue, 25 Mar 2008 08:11:27 +0000</resolved>
                                    <version>Nightly Builds</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12403017" author="roytmana@peacetech.com" created="Thu, 3 Oct 2002 13:25:54 +0000"  >&lt;p&gt;Created an attachment (id=3330)&lt;br/&gt;
attached is the same debug output as in the message but without line wraps - much easer to read&lt;/p&gt;</comment>
                            <comment id="12403018" author="rwaldhof@us.britannica.com" created="Thu, 31 Oct 2002 04:41:59 +0000"  >&lt;ul&gt;
	&lt;li&gt;
	&lt;ul&gt;
		&lt;li&gt;
		&lt;ul&gt;
			&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/POOL-41&quot; title=&quot;GenericKeyedObjectPool: _activeMap.get(key) increment is not balanced with decrements&quot; class=&quot;issue-link&quot; data-issue-key=&quot;POOL-41&quot;&gt;&lt;del&gt;COM-190&lt;/del&gt;&lt;/a&gt; has been marked as a duplicate of this bug. ***&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="12403019" author="rwaldhof@us.britannica.com" created="Thu, 31 Oct 2002 08:26:08 +0000"  >&lt;ul&gt;
	&lt;li&gt;
	&lt;ul&gt;
		&lt;li&gt;
		&lt;ul&gt;
			&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/DBCP-52&quot; title=&quot;unexpected &amp;quot;exausted pool&amp;quot; error&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DBCP-52&quot;&gt;&lt;del&gt;COM-192&lt;/del&gt;&lt;/a&gt; has been marked as a duplicate of this bug. ***&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="12403020" author="rwaldhof@us.britannica.com" created="Sat, 9 Nov 2002 03:39:09 +0000"  >&lt;p&gt;There are several aspects of Jdbc2PoolDataSource that I&apos;m not sure I fully &lt;br/&gt;
grok, and your analysis makes sense to me, but I&apos;m having trouble reproducing &lt;br/&gt;
an actual problem here (and I&apos;m loathe to change this without some test case &lt;br/&gt;
that fails).&lt;/p&gt;

&lt;p&gt;Can you provide details on the configuration and driver program that leads to &lt;br/&gt;
the output you posted?&lt;/p&gt;</comment>
                            <comment id="12403021" author="jmcnally" created="Sun, 17 Nov 2002 03:49:27 +0000"  >&lt;p&gt;I could not reproduce the problem either, but the use of immutable keys is a&lt;br/&gt;
better approach and so I have re-implemented as such.&lt;/p&gt;

&lt;p&gt;Your assumption on the reason for the static map of pools is correct.  It is&lt;br/&gt;
needed in the event multiple instances referring to the same pool of connections&lt;br/&gt;
are created by the jndi service.  Craig has noted that it is correct behavior&lt;br/&gt;
for the object factory to return a new instance for each lookup.  But perhaps it&lt;br/&gt;
would be clearer to move the logic in the ObjectFactory implementation and&lt;br/&gt;
maintain instance fields for the pools in the datasource implementation.  I&lt;br/&gt;
still wonder about jndi service providers which use serialization.&lt;/p&gt;

&lt;p&gt;The mutable key problem is solved though.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12332036" name="ASF.LICENSE.NOT.GRANTED--debug.txt" size="2637" author="roytmana@peacetech.com" created="Thu, 3 Oct 2002 13:25:54 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>13235</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114286</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            23 years, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uv87:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178200</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[DBCP-1] NumberFormatException: For input string: &quot;myDB&quot;</title>
                <link>https://issues.apache.org/jira/browse/DBCP-1</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;got today&apos;s source from cvs, did &quot;ant&quot;&lt;/p&gt;

&lt;p&gt;...&lt;br/&gt;
compile:&lt;/p&gt;

&lt;p&gt;compile-test:&lt;/p&gt;

&lt;p&gt;test:&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt; .........................................&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt; ----------------------------------------&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt; BEGIN getConnection1()&lt;br/&gt;
...&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt; Multithread test time = 2013 ms&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt; .E.....................Multithread test time = 50 ms&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt; Multithread test time = 2023 ms&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt; ........&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt; .........E&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt; Time: 28.562&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt; There were 2 errors:&lt;br/&gt;
...&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt; 2) testJNDI2Pools(org.apache.commons.dbcp.datasources.TestFactory)ja&lt;br/&gt;
va.lang.NumberFormatException: For input string: &quot;myDB&quot;&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt;     at java.lang.NumberFormatException.forInputString(NumberFormatEx&lt;br/&gt;
ception.java:48)&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt;     at java.lang.Integer.parseInt(Integer.java:468)&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt;     at java.lang.Integer.parseInt(Integer.java:518)&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt;     at org.apache.commons.dbcp.datasources.InstanceKeyObjectFactory.&lt;br/&gt;
registerNewInstance(InstanceKeyObjectFactory.java:96)&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt;     at org.apache.commons.dbcp.datasources.InstanceKeyDataSource.set&lt;br/&gt;
DataSourceName(InstanceKeyDataSource.java:266)&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt;     at org.apache.commons.dbcp.datasources.InstanceKeyObjectFactory.&lt;br/&gt;
setCommonProperties(InstanceKeyObjectFactory.java:176)&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt;     at org.apache.commons.dbcp.datasources.InstanceKeyObjectFactory.&lt;br/&gt;
getObjectInstance(InstanceKeyObjectFactory.java:157)&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt;     at org.apache.commons.dbcp.datasources.TestFactory.testJNDI2Pool&lt;br/&gt;
s(TestFactory.java:108)&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt;     at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt;     at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAcces&lt;br/&gt;
sorImpl.java:39)&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt;     at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMet&lt;br/&gt;
hodAccessorImpl.java:25)&lt;/p&gt;

&lt;p&gt;     &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt; FAILURES!!!&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt; Tests run: 173,  Failures: 0,  Errors: 2&lt;/p&gt;

&lt;p&gt;occurs together with &lt;a href=&quot;https://issues.apache.org/jira/browse/DBCP-27&quot; title=&quot;ClassCastException in DriverAdapterCPDS when setPoolPreparedStatements(true)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DBCP-27&quot;&gt;&lt;del&gt;COM-906&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: other&lt;br/&gt;
Platform: Other&lt;/p&gt;</environment>
        <key id="12341177">DBCP-1</key>
            <summary>NumberFormatException: For input string: &quot;myDB&quot;</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="3">Duplicate</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="ralfhauser">Ralf Hauser</reporter>
                        <labels>
                    </labels>
                <created>Mon, 29 Dec 2003 20:04:02 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:27 +0000</updated>
                            <resolved>Tue, 25 Mar 2008 08:11:27 +0000</resolved>
                                    <version>Nightly Builds</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12405721" author="dirkv" created="Tue, 30 Dec 2003 04:01:48 +0000"  >

&lt;ul&gt;
	&lt;li&gt;
	&lt;ul&gt;
		&lt;li&gt;
		&lt;ul&gt;
			&lt;li&gt;This bug has been marked as a duplicate of 24082 ***&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>25795</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114285</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            21 years, 46 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0v027:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178983</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>