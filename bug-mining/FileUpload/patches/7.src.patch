diff --git a/src/changes/changes.xml b/src/changes/changes.xml
index 3ebdeee5..1a21086d 100644
--- a/src/changes/changes.xml
+++ b/src/changes/changes.xml
@@ -55,6 +55,11 @@ The <action> type attribute can be add,update,fix,remove.
           due-to="Michael Macaluso" due-to-email="michael.public@wavecorp.com">
         Added support for accessing the file item headers.
       </action>
+      <action dev="jochen" type="fix" issue="FILEUPLOAD-116"
+          due-to="Amichai Rothman" due-to-email="amichai2@amichais.net">
+        A MalformedStreamException is now thrown, if the size of an items
+        headers exceeds HEADER_PART_SIZE_MAX;
+      </action>
     </release>
 
 	<release version="1.2" date="2007-02-13">
diff --git a/src/java/org/apache/commons/fileupload/MultipartStream.java b/src/java/org/apache/commons/fileupload/MultipartStream.java
index 0a7800a0..5b1e5278 100644
--- a/src/java/org/apache/commons/fileupload/MultipartStream.java
+++ b/src/java/org/apache/commons/fileupload/MultipartStream.java
@@ -530,26 +530,27 @@ public class MultipartStream {
     public String readHeaders()
     throws MalformedStreamException {
         int i = 0;
-        byte[] b = new byte[1];
+        byte b;
         // to support multi-byte characters
         ByteArrayOutputStream baos = new ByteArrayOutputStream();
-        int sizeMax = HEADER_PART_SIZE_MAX;
         int size = 0;
         while (i < HEADER_SEPARATOR.length) {
             try {
-                b[0] = readByte();
+                b = readByte();
             } catch (IOException e) {
                 throw new MalformedStreamException("Stream ended unexpectedly");
             }
-            size++;
-            if (b[0] == HEADER_SEPARATOR[i]) {
+            if (++size > HEADER_PART_SIZE_MAX) {
+                throw new MalformedStreamException(
+                        "Header section has more than " + HEADER_PART_SIZE_MAX
+                        + " bytes (maybe it is not properly terminated)");
+            }
+            if (b == HEADER_SEPARATOR[i]) {
                 i++;
             } else {
                 i = 0;
             }
-            if (size <= sizeMax) {
-                baos.write(b[0]);
-            }
+            baos.write(b);
         }
 
         String headers = null;
