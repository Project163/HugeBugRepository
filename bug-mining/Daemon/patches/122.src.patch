diff --git a/src/changes/changes.xml b/src/changes/changes.xml
index 591dd37..3994e55 100644
--- a/src/changes/changes.xml
+++ b/src/changes/changes.xml
@@ -47,6 +47,10 @@
       <action type="fix" dev="ggregory" due-to="Marc Wrobel">
         Fix typos in Javadoc and comments #50, #51.
       </action>
+      <action issue="DAEMOM-446" type="fix" dev="markt">
+        Procrun. The DependdON parameter is no longer ignored when updating the
+        service configuration.
+      </action>
       <!-- UPDATES -->
       <action type="update" dev="ggregory" due-to="Gary Gregory">
         Bump actions/cache from 3.0.3 to 3.0.8.
diff --git a/src/native/windows/apps/prunmgr/prunmgr.c b/src/native/windows/apps/prunmgr/prunmgr.c
index 12eb506..d1fbb55 100644
--- a/src/native/windows/apps/prunmgr/prunmgr.c
+++ b/src/native/windows/apps/prunmgr/prunmgr.c
@@ -322,7 +322,7 @@ BOOL __generalPropertySave(HWND hDlg)
     else if (i == 3)
         dwStartType = SERVICE_DISABLED;
     apxServiceSetNames(hService, NULL, szN, szD, NULL, NULL);
-    apxServiceSetOptions(hService, SERVICE_NO_CHANGE, dwStartType, bDelayedStart, SERVICE_NO_CHANGE);
+    apxServiceSetOptions(hService, NULL, SERVICE_NO_CHANGE, dwStartType, bDelayedStart, SERVICE_NO_CHANGE);
 
     if (!(TST_BIT_FLAG(_propertyChanged, 2)))
         PostMessage(_gui_store->hMainWnd, WM_COMMAND, MAKEWPARAM(IDMS_REFRESH, 0), 0);
@@ -391,12 +391,12 @@ BOOL __generalLogonSave(HWND hDlg)
         }
         lstrlcpyW(_currentEntry->szObjectName, SIZ_RESLEN, STAT_SYSTEM);
         if (IsDlgButtonChecked(hDlg, IDC_PPSLID) == BST_CHECKED) {
-            apxServiceSetOptions(hService,
+            apxServiceSetOptions(hService, NULL,
                 _currentEntry->stServiceStatus.dwServiceType | SERVICE_INTERACTIVE_PROCESS,
                 SERVICE_NO_CHANGE, FALSE, SERVICE_NO_CHANGE);
         }
         else {
-            apxServiceSetOptions(hService,
+            apxServiceSetOptions(hService, NULL,
                 _currentEntry->stServiceStatus.dwServiceType & ~SERVICE_INTERACTIVE_PROCESS,
                 SERVICE_NO_CHANGE, FALSE, SERVICE_NO_CHANGE);
         }
diff --git a/src/native/windows/apps/prunsrv/prunsrv.c b/src/native/windows/apps/prunsrv/prunsrv.c
index 56663b0..30db33a 100644
--- a/src/native/windows/apps/prunsrv/prunsrv.c
+++ b/src/native/windows/apps/prunsrv/prunsrv.c
@@ -838,6 +838,7 @@ static BOOL docmdInstallService(LPAPXCMDLINE lpCmdline)
     /* Configure as delayed start */
     if (rv & bDelayedStart) {
     	if (!apxServiceSetOptions(hService,
+    	                          NULL,
                                   dwType,
                                   dwStart,
                                   bDelayedStart,
@@ -1079,6 +1080,7 @@ static BOOL docmdUpdateService(LPAPXCMDLINE lpCmdline)
                 dwType = SERVICE_WIN32_OWN_PROCESS | SERVICE_INTERACTIVE_PROCESS;
         }
         rv = (rv && apxServiceSetOptions(hService,
+                                         SO_DEPENDSON,
                                          dwType,
                                          dwStart,
                                          bDelayedStart,
diff --git a/src/native/windows/include/service.h b/src/native/windows/include/service.h
index 6cef97c..8064381 100644
--- a/src/native/windows/include/service.h
+++ b/src/native/windows/include/service.h
@@ -41,9 +41,9 @@ BOOL        apxServiceSetNames(APXHANDLE hService, LPCWSTR szImagePath,
                                LPCWSTR szDisplayName, LPCWSTR szDescription,
                                LPCWSTR szUsername, LPCWSTR szPassword);
 
-BOOL        apxServiceSetOptions(APXHANDLE hService, DWORD dwServiceType,
-								 DWORD dwStartType, BOOL bDelayedStart,
-								 DWORD dwErrorControl);
+BOOL        apxServiceSetOptions(APXHANDLE hService, LPCWSTR lpDependencies,
+                                 DWORD dwServiceType, DWORD dwStartType,
+                                 BOOL bDelayedStart, DWORD dwErrorControl);
 
 BOOL        apxServiceControl(APXHANDLE hService, DWORD dwControl, UINT uMsg,
                               LPAPXFNCALLBACK fnControlCallback,
diff --git a/src/native/windows/src/service.c b/src/native/windows/src/service.c
index 22f0b62..538e980 100644
--- a/src/native/windows/src/service.c
+++ b/src/native/windows/src/service.c
@@ -280,6 +280,7 @@ apxServiceSetNames(APXHANDLE hService,
 
 BOOL
 apxServiceSetOptions(APXHANDLE hService,
+    LPCWSTR lpDependencies,
     DWORD dwServiceType,
     DWORD dwStartType,
     BOOL bDelayedStart,
@@ -305,10 +306,19 @@ apxServiceSetOptions(APXHANDLE hService,
         return FALSE;
     }
 
+    /* Add the mandatory dependencies */
+    if (lpDependencies) {
+        lpDependencies = apxMultiSzCombine(NULL, lpDependencies,
+                                           L"Tcpip\0Afd\0", NULL);
+    } else {
+        lpDependencies = L"Tcpip\0Afd\0";
+    }
+
     if (!ChangeServiceConfig(lpService->hService, dwServiceType,
                                    dwStartType, dwErrorControl,
-                                   NULL, NULL, NULL, NULL, NULL,
-                                   NULL, NULL)) {
+                                   NULL, NULL, NULL,
+                                   lpDependencies,
+                                   NULL, NULL, NULL)) {
         apxLogWrite(APXLOG_MARK_WARN "Can't set options for service: Failed to change the configuration parameters.");
     	return FALSE;
     }
