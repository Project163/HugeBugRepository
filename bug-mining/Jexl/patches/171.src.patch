diff --git a/src/main/java/org/apache/commons/jexl3/JexlException.java b/src/main/java/org/apache/commons/jexl3/JexlException.java
index 7c0e3346..34231a85 100644
--- a/src/main/java/org/apache/commons/jexl3/JexlException.java
+++ b/src/main/java/org/apache/commons/jexl3/JexlException.java
@@ -236,15 +236,19 @@ public class JexlException extends RuntimeException {
         if (length < MAX_EXCHARLOC) {
             return prefix + " error in '" + expr + "'";
         } else {
-            int begin = info.getColumn();
-            int end = begin + (MAX_EXCHARLOC / 2);
-            begin -= (MAX_EXCHARLOC / 2);
-            if (begin < 0) {
-                end -= begin;
+            int me = MAX_EXCHARLOC / 2;
+            int begin = info.getColumn() - me;
+            if (begin < 0 || length < me) {
                 begin = 0;
+            } else if (begin > length) {
+                begin = me;
+            }
+            int end = begin + MAX_EXCHARLOC;
+            if (end > length) {
+                end = length;
             }
             return prefix + " error near '... "
-                    + expr.substring(begin, end > length ? length : end) + " ...'";
+                    + expr.substring(begin, end) + " ...'";
         }
     }
     
diff --git a/src/main/java/org/apache/commons/jexl3/parser/JexlParser.java b/src/main/java/org/apache/commons/jexl3/parser/JexlParser.java
index bab6c632..85b21d12 100644
--- a/src/main/java/org/apache/commons/jexl3/parser/JexlParser.java
+++ b/src/main/java/org/apache/commons/jexl3/parser/JexlParser.java
@@ -572,7 +572,7 @@ public abstract class JexlParser extends StringParser {
         }
         if (tok != null) {
             xinfo = info.at(tok.beginLine, tok.beginColumn);
-            msg = readSourceLine(source, tok.beginLine);
+            msg = tok.image;
             if (xclazz != null) {
                 try {
                     Constructor<T> ctor = xclazz.getConstructor(JexlInfo.class, String.class);
diff --git a/src/main/java/org/apache/commons/jexl3/parser/Parser.jjt b/src/main/java/org/apache/commons/jexl3/parser/Parser.jjt
index e637d599..fb5ae370 100644
--- a/src/main/java/org/apache/commons/jexl3/parser/Parser.jjt
+++ b/src/main/java/org/apache/commons/jexl3/parser/Parser.jjt
@@ -70,8 +70,8 @@ public final class Parser extends JexlParser
         } catch (TokenMgrError xtme) {
             throw new JexlException.Tokenization(info, xtme).clean();
         } catch (ParseException xparse) {
-            Token errortok = errorToken(token, jj_lastpos, jj_scanpos, token.next);
-            throw new JexlException.Parsing(info.at(errortok.beginLine, errortok.beginColumn), jexlSrc).clean();
+            Token errortok = errorToken(jj_lastpos, jj_scanpos, token.next, token);
+            throw new JexlException.Parsing(info.at(errortok.beginLine, errortok.beginColumn), errortok.image).clean();
         } finally {
             token_source.defaultLexState = DEFAULT;
             cleanup(previous);
