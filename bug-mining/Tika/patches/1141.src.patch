diff --git a/CHANGES.txt b/CHANGES.txt
index d55b3958f..13200e1f2 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -5,6 +5,10 @@ Release 2.0.0 - ???
 
    Other changes
 
+Release 1.24 - ???
+
+   * Fix bug in ASM parser configuration (TIKA-2992).
+
 Release 1.23 - 12/02/2019
 
    * NOTE: The PDFParser now relies on OCRDPI to render page images when
diff --git a/tika-parsers/pom.xml b/tika-parsers/pom.xml
index 95d1f21e7..ed515cfe1 100644
--- a/tika-parsers/pom.xml
+++ b/tika-parsers/pom.xml
@@ -299,6 +299,10 @@
       <artifactId>tagsoup</artifactId>
       <version>1.2.1</version>
     </dependency>
+    <!-- WARNING: when you upgrade asm make sure that you update the
+      OpCode in the initializer in org.apache.tika.parser.asm.XHTMLClassVisitor
+      See TIKA-2992.
+    -->
     <dependency>
       <groupId>org.ow2.asm</groupId>
       <artifactId>asm</artifactId>
diff --git a/tika-parsers/src/main/java/org/apache/tika/parser/asm/XHTMLClassVisitor.java b/tika-parsers/src/main/java/org/apache/tika/parser/asm/XHTMLClassVisitor.java
index 45597daaf..4b6c53fb9 100644
--- a/tika-parsers/src/main/java/org/apache/tika/parser/asm/XHTMLClassVisitor.java
+++ b/tika-parsers/src/main/java/org/apache/tika/parser/asm/XHTMLClassVisitor.java
@@ -49,7 +49,7 @@ class XHTMLClassVisitor extends ClassVisitor {
     private String packageName;
 
     public XHTMLClassVisitor(ContentHandler handler, Metadata metadata) {
-        super(Opcodes.ASM5);
+        super(Opcodes.ASM7);
         this.xhtml = new XHTMLContentHandler(handler, metadata);
         this.metadata = metadata;
     }
diff --git a/tika-parsers/src/test/java/org/apache/tika/parser/asm/ClassParserTest.java b/tika-parsers/src/test/java/org/apache/tika/parser/asm/ClassParserTest.java
index f864ee7cc..5e0874995 100644
--- a/tika-parsers/src/test/java/org/apache/tika/parser/asm/ClassParserTest.java
+++ b/tika-parsers/src/test/java/org/apache/tika/parser/asm/ClassParserTest.java
@@ -18,7 +18,7 @@ package org.apache.tika.parser.asm;
 
 import static org.junit.Assert.assertEquals;
 import static org.junit.Assert.assertTrue;
-import org.apache.tika.Tika;
+import org.apache.tika.TikaTest;
 import org.apache.tika.metadata.Metadata;
 import org.apache.tika.metadata.TikaCoreProperties;
 import org.junit.Test;
@@ -26,15 +26,12 @@ import org.junit.Test;
 /**
  * Test case for parsing Java class files.
  */
-public class ClassParserTest {
+public class ClassParserTest extends TikaTest {
 
     @Test
     public void testClassParsing() throws Exception {
-        String path = "/test-documents/AutoDetectParser.class";
         Metadata metadata = new Metadata();
-        String content = new Tika().parseToString(
-                ClassParserTest.class.getResourceAsStream(path), metadata);
-
+        String content = getText("AutoDetectParser.class", metadata);
         assertEquals("AutoDetectParser", metadata.get(TikaCoreProperties.TITLE));
         assertEquals(
                 "AutoDetectParser.class",
@@ -56,4 +53,12 @@ public class ClassParserTest {
                 + " throws java.io.IOException;"));
     }
 
+    @Test
+    public void testJava11() throws Exception {
+        //Make sure that this java 11 target .class
+        //file doesn't throw an exception
+        //TIKA-2992
+        XMLResult xmlResult = getXML("AppleSingleFileParser.class");
+        assertContains("<title>AppleSingleFileParser</title>", xmlResult.xml);
+    }
 }
diff --git a/tika-parsers/src/test/resources/test-documents/AppleSingleFileParser.class b/tika-parsers/src/test/resources/test-documents/AppleSingleFileParser.class
new file mode 100644
index 000000000..1b402d950
Binary files /dev/null and b/tika-parsers/src/test/resources/test-documents/AppleSingleFileParser.class differ
