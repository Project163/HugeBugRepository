diff --git a/tika-parsers/src/main/java/org/apache/tika/parser/microsoft/HSLFExtractor.java b/tika-parsers/src/main/java/org/apache/tika/parser/microsoft/HSLFExtractor.java
index 22bb30458..ed9c4ba5f 100644
--- a/tika-parsers/src/main/java/org/apache/tika/parser/microsoft/HSLFExtractor.java
+++ b/tika-parsers/src/main/java/org/apache/tika/parser/microsoft/HSLFExtractor.java
@@ -226,17 +226,15 @@ public class HSLFExtractor extends AbstractPOIFSExtractor {
         long persistId = vbaAtom.getPersistIdRef();
         for (HSLFObjectData objData : ppt.getEmbeddedObjects()) {
             if (objData.getExOleObjStg().getPersistId() == persistId) {
-                NPOIFSFileSystem npoifsFileSystem = null;
-                try {
-                    npoifsFileSystem = new NPOIFSFileSystem(objData.getData());
+                try (NPOIFSFileSystem npoifsFileSystem = new NPOIFSFileSystem(objData.getData())) {
+                    try {
+                        OfficeParser.extractMacros(npoifsFileSystem, xhtml,
+                                EmbeddedDocumentUtil.getEmbeddedDocumentExtractor(context));
+                    } catch (IOException|SAXException inner) {
+                        EmbeddedDocumentUtil.recordException(inner, parentMetadata);
+                    }
                 } catch (IOException e) {
-                    //swallow
-                }
-                try {
-                    OfficeParser.extractMacros(npoifsFileSystem, xhtml,
-                            EmbeddedDocumentUtil.getEmbeddedDocumentExtractor(context));
-                } catch (IOException|SAXException e) {
-                    //swallow
+                    EmbeddedDocumentUtil.recordEmbeddedStreamException(e, parentMetadata);//swallow
                 }
             }
         }
