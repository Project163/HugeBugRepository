diff --git a/tika-core/src/main/java/org/apache/tika/detect/XmlRootExtractor.java b/tika-core/src/main/java/org/apache/tika/detect/XmlRootExtractor.java
index 6f1b45bfc..88dec5145 100644
--- a/tika-core/src/main/java/org/apache/tika/detect/XmlRootExtractor.java
+++ b/tika-core/src/main/java/org/apache/tika/detect/XmlRootExtractor.java
@@ -23,6 +23,7 @@ import javax.xml.XMLConstants;
 import javax.xml.namespace.QName;
 import javax.xml.parsers.SAXParserFactory;
 
+import org.apache.tika.io.CloseShieldInputStream;
 import org.apache.tika.sax.OfflineContentHandler;
 import org.xml.sax.Attributes;
 import org.xml.sax.SAXException;
@@ -51,7 +52,8 @@ public class XmlRootExtractor {
             factory.setValidating(false);
             factory.setFeature(XMLConstants.FEATURE_SECURE_PROCESSING, true);
             factory.newSAXParser().parse(
-                    stream, new OfflineContentHandler(handler));
+                    new CloseShieldInputStream(stream),
+                    new OfflineContentHandler(handler));
         } catch (Exception ignore) {
         }
         return handler.rootElement;
diff --git a/tika-parsers/src/main/java/org/apache/tika/parser/iwork/IWorkPackageParser.java b/tika-parsers/src/main/java/org/apache/tika/parser/iwork/IWorkPackageParser.java
index a210f76ed..0cfc4bef5 100644
--- a/tika-parsers/src/main/java/org/apache/tika/parser/iwork/IWorkPackageParser.java
+++ b/tika-parsers/src/main/java/org/apache/tika/parser/iwork/IWorkPackageParser.java
@@ -122,8 +122,7 @@ public class IWorkPackageParser extends AbstractParser {
        }
        
        private static IWORKDocumentType detectType(InputStream stream) {
-          QName qname =
-             new XmlRootExtractor().extractRootElement(stream);
+          QName qname = new XmlRootExtractor().extractRootElement(stream);
           String uri = qname.getNamespaceURI();
           String local = qname.getLocalPart();
          
@@ -163,8 +162,7 @@ public class IWorkPackageParser extends AbstractParser {
                 continue;
             }
 
-            InputStream entryStream = new CloseShieldInputStream(
-                  new BufferedInputStream(zip, 4096));
+            InputStream entryStream = new BufferedInputStream(zip, 4096);
             entryStream.mark(4096);
             IWORKDocumentType type = IWORKDocumentType.detectType(entryStream);
             entryStream.reset();
@@ -190,7 +188,7 @@ public class IWorkPackageParser extends AbstractParser {
                metadata.add(Metadata.CONTENT_TYPE, type.getType().toString());
                xhtml.startDocument();
                context.getSAXParser().parse(
-                       entryStream, 
+                       new CloseShieldInputStream(entryStream),
                        new OfflineContentHandler(contentHandler)
                );
                xhtml.endDocument();
