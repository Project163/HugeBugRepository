diff --git a/src/java/org/apache/commons/dbcp/PoolableConnectionFactory.java b/src/java/org/apache/commons/dbcp/PoolableConnectionFactory.java
index 6b91db5d..2c13fd0c 100644
--- a/src/java/org/apache/commons/dbcp/PoolableConnectionFactory.java
+++ b/src/java/org/apache/commons/dbcp/PoolableConnectionFactory.java
@@ -292,6 +292,9 @@ public class PoolableConnectionFactory implements PoolableObjectFactory {
 
     synchronized public Object makeObject() throws Exception {
         Connection conn = _connFactory.createConnection();
+        if (conn == null) {
+            throw new IllegalStateException("Connection factory returned null from createConnection");
+        }
         if(null != _stmtPoolFactory) {
             KeyedObjectPool stmtpool = _stmtPoolFactory.createPool();
             conn = new PoolingConnection(conn,stmtpool);
diff --git a/src/java/org/apache/commons/dbcp/datasources/CPDSConnectionFactory.java b/src/java/org/apache/commons/dbcp/datasources/CPDSConnectionFactory.java
index 747fd540..4a8259a2 100644
--- a/src/java/org/apache/commons/dbcp/datasources/CPDSConnectionFactory.java
+++ b/src/java/org/apache/commons/dbcp/datasources/CPDSConnectionFactory.java
@@ -175,6 +175,11 @@ class CPDSConnectionFactory
             } else {
                 pc = _cpds.getPooledConnection(_username, _password);
             }
+
+            if (pc == null) {
+                throw new IllegalStateException("Connection pool data source returned null from getPooledConnection");
+            }
+
             // should we add this object as a listener or the pool.
             // consider the validateObject method in decision
             pc.addConnectionEventListener(this);
diff --git a/src/java/org/apache/commons/dbcp/datasources/KeyedCPDSConnectionFactory.java b/src/java/org/apache/commons/dbcp/datasources/KeyedCPDSConnectionFactory.java
index ce53e7ba..e477d638 100644
--- a/src/java/org/apache/commons/dbcp/datasources/KeyedCPDSConnectionFactory.java
+++ b/src/java/org/apache/commons/dbcp/datasources/KeyedCPDSConnectionFactory.java
@@ -159,6 +159,11 @@ class KeyedCPDSConnectionFactory
         } else {
             pc = _cpds.getPooledConnection(username, password);
         }
+
+        if (pc == null) {
+            throw new IllegalStateException("Connection pool data source returned null from getPooledConnection");
+        }
+
         // should we add this object as a listener or the pool.
         // consider the validateObject method in decision
         pc.addConnectionEventListener(this);
