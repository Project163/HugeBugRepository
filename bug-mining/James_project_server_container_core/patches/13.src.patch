diff --git a/server/container/core/src/main/java/org/apache/james/server/core/MailImpl.java b/server/container/core/src/main/java/org/apache/james/server/core/MailImpl.java
index 106d46f9c1..2e9aa38694 100644
--- a/server/container/core/src/main/java/org/apache/james/server/core/MailImpl.java
+++ b/server/container/core/src/main/java/org/apache/james/server/core/MailImpl.java
@@ -40,15 +40,17 @@ import javax.mail.MessagingException;
 import javax.mail.internet.MimeMessage;
 import javax.mail.internet.ParseException;
 
+import org.apache.james.core.MailAddress;
 import org.apache.james.lifecycle.api.Disposable;
 import org.apache.james.lifecycle.api.LifecycleUtil;
-import org.apache.james.core.MailAddress;
 import org.apache.mailet.Mail;
 import org.apache.mailet.PerRecipientHeaders;
 import org.apache.mailet.PerRecipientHeaders.Header;
 import org.slf4j.Logger;
 import org.slf4j.LoggerFactory;
 
+import com.google.common.base.Preconditions;
+
 /**
  * <p>
  * Wraps a MimeMessage adding routing information (from SMTP) and some simple
@@ -589,6 +591,7 @@ public class MailImpl implements Disposable, Mail {
 
     @Override
     public Serializable setAttribute(String key, Serializable object) {
+        Preconditions.checkNotNull(key, "Key of an attribute should not be null");
         return (Serializable) attributes.put(key, object);
     }
 
diff --git a/server/container/core/src/test/java/org/apache/james/server/core/MailImplTest.java b/server/container/core/src/test/java/org/apache/james/server/core/MailImplTest.java
index ab5d9b78c8..5ab4cd04f7 100644
--- a/server/container/core/src/test/java/org/apache/james/server/core/MailImplTest.java
+++ b/server/container/core/src/test/java/org/apache/james/server/core/MailImplTest.java
@@ -18,6 +18,7 @@
  ****************************************************************/
 package org.apache.james.server.core;
 
+import static org.assertj.core.api.Assertions.assertThatThrownBy;
 import static org.junit.Assert.assertEquals;
 import static org.junit.Assert.assertFalse;
 import static org.junit.Assert.assertNotNull;
@@ -112,4 +113,12 @@ public class MailImplTest extends MailTestAllImplementations {
         helperTestInitialState(duplicate);
         helperTestMessageSize(duplicate, 0);
     }
+
+    @Test
+    public void setAttributeShouldThrowOnNullAttributeName() throws MessagingException {
+        MailImpl mail = new MailImpl();
+
+        assertThatThrownBy(() -> mail.setAttribute(null, "toto"))
+            .isInstanceOf(NullPointerException.class);
+    }
 }
