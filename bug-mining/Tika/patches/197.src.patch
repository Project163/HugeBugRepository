diff --git a/tika-core/src/main/java/org/apache/tika/sax/xpath/MatchingContentHandler.java b/tika-core/src/main/java/org/apache/tika/sax/xpath/MatchingContentHandler.java
index da0582fe2..ea5f153da 100644
--- a/tika-core/src/main/java/org/apache/tika/sax/xpath/MatchingContentHandler.java
+++ b/tika-core/src/main/java/org/apache/tika/sax/xpath/MatchingContentHandler.java
@@ -72,7 +72,11 @@ public class MatchingContentHandler extends ContentHandlerDecorator {
         if (matcher.matchesElement()) {
             super.endElement(uri, localName, name);
         }
-        matcher = matchers.removeFirst();
+        // Sometimes tagsoup returns double end tags, so the stack might
+        // be empty! TODO: Remove this when the tagsoup problem is fixed.
+        if (!matchers.isEmpty()) {
+            matcher = matchers.removeFirst();
+        }
     }
 
     public void characters(char[] ch, int start, int length)
