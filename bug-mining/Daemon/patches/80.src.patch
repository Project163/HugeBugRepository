diff --git a/src/changes/changes.xml b/src/changes/changes.xml
index 0d14f48..26a2208 100644
--- a/src/changes/changes.xml
+++ b/src/changes/changes.xml
@@ -1,4 +1,4 @@
-<?xml version="1.0"?>
+<?xml version="1.0" encoding="UTF-8"?>
 <!--
   Licensed to the Apache Software Foundation (ASF) under one or more
   contributor license agreements. See the NOTICE file distributed with
@@ -99,6 +99,11 @@
         Correct conflicting information for the behaviour of procrun when using
         jvm mode.
       </action>
+      <action issue="DAEMON-372" type="fix" dev="markt" due-to="SÃ©rgio Ozaki">
+        Ensure that, when using procrun in java or exe mode, the service process
+        waits for the stop process to complete before starting clean-up to avoid
+        a crash in the stop process. 
+      </action>
     </release>
   </body>
 </document>
diff --git a/src/native/windows/apps/prunsrv/prunsrv.c b/src/native/windows/apps/prunsrv/prunsrv.c
index 1b98e05..fa13f7f 100644
--- a/src/native/windows/apps/prunsrv/prunsrv.c
+++ b/src/native/windows/apps/prunsrv/prunsrv.c
@@ -1016,6 +1016,12 @@ static DWORD WINAPI serviceStop(LPVOID lpParameter)
             apxLogWrite(APXLOG_MARK_ERROR "Failed creating process");
             return 1;
         }
+        /* If the service process completes before the stop process does the
+         * cleanup code below will free structures required by the stop process
+         * which will, in all probability, trigger a crash. Wait for the stop
+         * process to complete before cleaning up.
+         */
+        gShutdownEvent = CreateEvent(NULL, TRUE, FALSE, NULL);
         if (!apxProcessSetExecutableW(hWorker, SO_STOPIMAGE)) {
             apxLogWrite(APXLOG_MARK_ERROR "Failed setting process executable %S",
                         SO_STOPIMAGE);
