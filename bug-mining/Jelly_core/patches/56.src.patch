diff --git a/src/java/org/apache/commons/jelly/JellyContext.java b/src/java/org/apache/commons/jelly/JellyContext.java
index 7b6065b8..616ccbb4 100644
--- a/src/java/org/apache/commons/jelly/JellyContext.java
+++ b/src/java/org/apache/commons/jelly/JellyContext.java
@@ -956,9 +956,14 @@ public class JellyContext {
      */
     protected URL getJellyContextURL(InputSource source) throws MalformedURLException {
         String text = source.getSystemId();
-        int idx = text.lastIndexOf('/');
-        text = text.substring(0, idx + 1);
-        return new URL(text);
+        if (text != null) {
+            int idx = text.lastIndexOf('/');
+            text = text.substring(0, idx + 1);
+            return new URL(text);
+        } else {
+            return null;
+        }
+        
     }
 
     /**
diff --git a/src/test/org/apache/commons/jelly/test/impl/TestEmbedded.java b/src/test/org/apache/commons/jelly/test/impl/TestEmbedded.java
index 4cd49399..fce0b296 100644
--- a/src/test/org/apache/commons/jelly/test/impl/TestEmbedded.java
+++ b/src/test/org/apache/commons/jelly/test/impl/TestEmbedded.java
@@ -17,8 +17,13 @@ package org.apache.commons.jelly.test.impl;
 
 import java.io.ByteArrayInputStream;
 import java.io.ByteArrayOutputStream;
+import java.io.OutputStream;
+import java.io.StringReader;
 
+import org.apache.commons.jelly.JellyContext;
+import org.apache.commons.jelly.XMLOutput;
 import org.apache.commons.jelly.impl.Embedded;
+import org.xml.sax.InputSource;
 
 import junit.framework.Test;
 import junit.framework.TestCase;
@@ -93,8 +98,27 @@ public class TestEmbedded extends TestCase
         boolean status = embedded.execute();
         //executed properly without script errors
         assertEquals(status, true);
-        //check that the output  confirms the exepected
+        //check that the output confirms the expected
         assertEquals("jelly-test-case", new String(baos.toByteArray()));
-
+    }
+    
+    /**
+     * Test simple 'raw' execution of a string. See JELLY-189.
+     */
+    public void testRawExecuteAsString() throws Exception
+    {
+        String message =
+            "<?xml version=\"1.0\"?>"
+                + " <j:jelly xmlns:j=\"jelly:core\">"
+                + "jelly-test-case"
+                + " </j:jelly>";
+       ByteArrayOutputStream output = new ByteArrayOutputStream();
+       XMLOutput xmlOutput = XMLOutput.createXMLOutput(output);
+       InputSource script = new InputSource( new StringReader(message.toString()) );
+       JellyContext context = new JellyContext();
+       context.runScript( script, xmlOutput);
+       output.close();
+       //check that the output confirms the expected
+       assertEquals("jelly-test-case", new String(output.toByteArray()));
     }
 }
