diff --git a/src/main/java/org/apache/commons/jexl3/internal/Engine.java b/src/main/java/org/apache/commons/jexl3/internal/Engine.java
index 17a972be..e3de73db 100644
--- a/src/main/java/org/apache/commons/jexl3/internal/Engine.java
+++ b/src/main/java/org/apache/commons/jexl3/internal/Engine.java
@@ -237,28 +237,28 @@ public class Engine extends JexlEngine {
 
     @Override
     public void setClassLoader(ClassLoader loader) {
+        jxlt = null;
         uberspect.setClassLoader(loader);
         if (functions != null) {
-            ClassLoader nloader = uberspect.getClassLoader();
             List<String> names = new ArrayList<String>(functions.keySet());
             for(String name : names) {
                 Object functor = functions.get(name);
                 if (functor instanceof Class<?>) {
                     Class<?> fclass = ((Class<?>) functor);
                     try {
-                        Class<?> nclass = nloader.loadClass(fclass.getName());
+                        Class<?> nclass = loader.loadClass(fclass.getName());
                         if (nclass != fclass) {
-                            if (nclass == null) {
-                                nclass = Void.class;
-                            }
                             functions.put(name, nclass);
                         }
                     } catch (ClassNotFoundException xany) {
-                         functions.remove(name);
+                         functions.put(name, fclass.getName());
                     }
                 }
             }
         }
+        if (cache != null) {
+            cache.clear();
+        }
     }
 
     @Override
