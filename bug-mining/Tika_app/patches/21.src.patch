diff --git a/tika-app/src/main/java/org/apache/tika/cli/TikaCLI.java b/tika-app/src/main/java/org/apache/tika/cli/TikaCLI.java
index 073eed38f..dc0d15f21 100644
--- a/tika-app/src/main/java/org/apache/tika/cli/TikaCLI.java
+++ b/tika-app/src/main/java/org/apache/tika/cli/TikaCLI.java
@@ -706,16 +706,17 @@ public class TikaCLI {
 
             String relID = metadata.get(Metadata.EMBEDDED_RELATIONSHIP_ID);
             if (relID != null && !name.startsWith(relID)) {
-              name = relID + "_" + name;
+                name = relID + "_" + name;
             }
 
             File outputFile = new File(extractDir, name);
-            if (outputFile.exists()) {
-                System.err.println("File '"+name+"' already exists; skipping");
-                return;
+            File parent = outputFile.getParentFile();
+            if (!parent.exists()) {
+                if (!parent.mkdirs()) {
+                    throw new IOException("unable to create directory \"" + parent + "\"");
+                }
             }
-
-            System.out.println("Extracting '"+name+"' ("+contentType+")");
+            System.out.println("Extracting '"+name+"' ("+contentType+") to " + outputFile);
 
             FileOutputStream os = new FileOutputStream(outputFile);
 
diff --git a/tika-app/src/test/java/org/apache/tika/cli/TikaCLITest.java b/tika-app/src/test/java/org/apache/tika/cli/TikaCLITest.java
index d5366178f..d6b5ee9d8 100644
--- a/tika-app/src/test/java/org/apache/tika/cli/TikaCLITest.java
+++ b/tika-app/src/test/java/org/apache/tika/cli/TikaCLITest.java
@@ -215,4 +215,14 @@ public class TikaCLITest extends TestCase{
         assertTrue(content.contains("sheetNames: Logical Sheet 3"));
         assertTrue(content.contains("sheetNames: Sheet 4"));
     }
+
+    // TIKA-1031
+    public void testZipWithSubdirs() throws Exception {
+        String[] params = {"-z", resourcePrefix + "testWithSubdirs.zip"};
+        new File("subdir/foo.txt").delete();
+        new File("subdir").delete();
+        TikaCLI.main(params);
+        String content = outContent.toString();
+        assertTrue(content.contains("Extracting 'subdir/foo.txt'"));
+    }
 }
diff --git a/tika-app/src/test/resources/test-data/testWithSubdirs.zip b/tika-app/src/test/resources/test-data/testWithSubdirs.zip
new file mode 100644
index 000000000..10e90002a
Binary files /dev/null and b/tika-app/src/test/resources/test-data/testWithSubdirs.zip differ
