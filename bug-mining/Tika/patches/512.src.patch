diff --git a/tika-parsers/src/main/java/org/apache/tika/parser/chm/CHM2XHTML.java b/tika-parsers/src/main/java/org/apache/tika/parser/chm/CHM2XHTML.java
deleted file mode 100644
index 114821ce3..000000000
--- a/tika-parsers/src/main/java/org/apache/tika/parser/chm/CHM2XHTML.java
+++ /dev/null
@@ -1,57 +0,0 @@
-/*
- * Licensed to the Apache Software Foundation (ASF) under one or more
- * contributor license agreements.  See the NOTICE file distributed with
- * this work for additional information regarding copyright ownership.
- * The ASF licenses this file to You under the Apache License, Version 2.0
- * (the "License"); you may not use this file except in compliance with
- * the License.  You may obtain a copy of the License at
- *
- *     http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- */
-
-package org.apache.tika.parser.chm;
-
-import org.apache.tika.exception.TikaException;
-import org.apache.tika.sax.TextContentHandler;
-import org.xml.sax.ContentHandler;
-import org.xml.sax.SAXException;
-
-/**
- * Utility class
- * 
- * 
- */
-public class CHM2XHTML {
-
-    public static void process(CHMDocumentInformation chmDoc,
-            ContentHandler handler) throws TikaException {
-        String text = chmDoc.getText();
-        try {
-            if (text.length() > 0) {
-                handler.characters(text.toCharArray(), 0, text.length());
-                new CHM2XHTML(chmDoc, handler);
-            } else
-                throw new TikaException("Could not extract content");
-
-        } catch (SAXException e) {
-            throw new RuntimeException(e);
-        }
-    }
-
-    protected String getText(CHMDocumentInformation chmDoc)
-            throws TikaException {
-        return chmDoc.getText();
-    }
-
-    protected TextContentHandler handler;
-
-    public CHM2XHTML(CHMDocumentInformation chmDoc, ContentHandler handler) {
-        this.handler = new TextContentHandler(handler);
-    }
-}
diff --git a/tika-parsers/src/main/java/org/apache/tika/parser/chm/ChmParser.java b/tika-parsers/src/main/java/org/apache/tika/parser/chm/ChmParser.java
index 72f8af4ec..f74db471e 100644
--- a/tika-parsers/src/main/java/org/apache/tika/parser/chm/ChmParser.java
+++ b/tika-parsers/src/main/java/org/apache/tika/parser/chm/ChmParser.java
@@ -28,6 +28,7 @@ import org.apache.tika.metadata.Metadata;
 import org.apache.tika.mime.MediaType;
 import org.apache.tika.parser.AbstractParser;
 import org.apache.tika.parser.ParseContext;
+import org.apache.tika.sax.XHTMLContentHandler;
 import org.xml.sax.ContentHandler;
 import org.xml.sax.SAXException;
 
@@ -50,13 +51,16 @@ public class ChmParser extends AbstractParser {
             Metadata metadata, ParseContext context) throws IOException,
             SAXException, TikaException {
         CHMDocumentInformation chmInfo = CHMDocumentInformation.load(stream);
-        metadata.set(Metadata.CONTENT_TYPE, "application/vnd.ms-htmlhelp");
-        extractMetadata(chmInfo, metadata);
-        CHM2XHTML.process(chmInfo, handler);
-    }
 
-    private void extractMetadata(CHMDocumentInformation chmInfo,
-            Metadata metadata) throws TikaException, IOException {
+        // metadata
+        metadata.set(Metadata.CONTENT_TYPE, "application/vnd.ms-htmlhelp");
         chmInfo.getCHMDocInformation(metadata);
+
+        // content
+        XHTMLContentHandler xhtml = new XHTMLContentHandler(handler, metadata);
+        xhtml.startDocument();
+        xhtml.characters(chmInfo.getText());
+        xhtml.endDocument();
     }
+
 }
diff --git a/tika-parsers/src/test/java/org/apache/tika/parser/AutoDetectParserTest.java b/tika-parsers/src/test/java/org/apache/tika/parser/AutoDetectParserTest.java
index e245b22dd..606b7d488 100644
--- a/tika-parsers/src/test/java/org/apache/tika/parser/AutoDetectParserTest.java
+++ b/tika-parsers/src/test/java/org/apache/tika/parser/AutoDetectParserTest.java
@@ -49,6 +49,7 @@ public class AutoDetectParserTest {
     private static final String KEYNOTE    = "application/vnd.apple.keynote";
     private static final String PAGES      = "application/vnd.apple.pages";
     private static final String NUMBERS    = "application/vnd.apple.numbers";
+    private static final String CHM        = "application/vnd.ms-htmlhelp";
     private static final String RTF        = "application/rtf";
     private static final String PLAINTEXT  = "text/plain; charset=ISO-8859-1";
     private static final String UTF8TEXT   = "text/plain; charset=UTF-8";
@@ -164,6 +165,11 @@ public class AutoDetectParserTest {
         assertAutoDetect("testNumbers.numbers", NUMBERS, "Checking Account: 300545668");
     }
 
+    @Test
+    public void testChm() throws Exception {
+        assertAutoDetect("testChm.chm", CHM, "If you do not specify a window type or a window name, the main window is used.");
+    }
+
     @Test
     public void testEpub() throws Exception {
         assertAutoDetect(
