diff --git a/src/java/org/apache/commons/configuration/HierarchicalINIConfiguration.java b/src/java/org/apache/commons/configuration/HierarchicalINIConfiguration.java
index 26427322..4ac5528d 100644
--- a/src/java/org/apache/commons/configuration/HierarchicalINIConfiguration.java
+++ b/src/java/org/apache/commons/configuration/HierarchicalINIConfiguration.java
@@ -714,7 +714,10 @@ public class HierarchicalINIConfiguration extends
             ConfigurationNode node = (ConfigurationNode) it.next();
             if (!isSectionNode(node))
             {
-                parent.addChild(node);
+                synchronized (node)
+                {
+                    parent.addChild(node);
+                }
             }
         }
 
diff --git a/src/test/org/apache/commons/configuration/TestHierarchicalINIConfiguration.java b/src/test/org/apache/commons/configuration/TestHierarchicalINIConfiguration.java
index 2837f036..7041fd51 100644
--- a/src/test/org/apache/commons/configuration/TestHierarchicalINIConfiguration.java
+++ b/src/test/org/apache/commons/configuration/TestHierarchicalINIConfiguration.java
@@ -512,6 +512,27 @@ public class TestHierarchicalINIConfiguration extends TestCase
                 .getString("globalVar"));
     }
 
+    /**
+     * Tests concurrent access to the global section.
+     */
+    public void testGetSectionGloabalMultiThreaded()
+            throws ConfigurationException, InterruptedException
+    {
+        HierarchicalINIConfiguration config = setUpConfig(INI_DATA_GLOBAL);
+        final int threadCount = 10;
+        GlobalSectionTestThread[] threads = new GlobalSectionTestThread[threadCount];
+        for (int i = 0; i < threadCount; i++)
+        {
+            threads[i] = new GlobalSectionTestThread(config);
+            threads[i].start();
+        }
+        for (int i = 0; i < threadCount; i++)
+        {
+            threads[i].join();
+            assertFalse("Exception occurred", threads[i].error);
+        }
+    }
+
     /**
      * Tests querying the content of the global section if there is none.
      */
@@ -608,4 +629,48 @@ public class TestHierarchicalINIConfiguration extends TestCase
         assertEquals("Wrong value", "one" + LINE_SEPARATOR, config
                 .getString("section5.continueNoLine"));
     }
+
+    /**
+     * A thread class for testing concurrent access to the global section.
+     */
+    private static class GlobalSectionTestThread extends Thread
+    {
+        /** The configuration. */
+        private final HierarchicalINIConfiguration config;
+
+        /** A flag whether an error was found. */
+        volatile boolean error;
+
+        /**
+         * Creates a new instance of <code>GlobalSectionTestThread</code> and
+         * initializes it.
+         *
+         * @param conf the configuration object
+         */
+        public GlobalSectionTestThread(HierarchicalINIConfiguration conf)
+        {
+            config = conf;
+        }
+
+        /**
+         * Accesses the global section in a loop. If there is no correct
+         * synchronization, this can cause an exception.
+         */
+        public void run()
+        {
+            final int loopCount = 250;
+
+            for (int i = 0; i < loopCount && !error; i++)
+            {
+                try
+                {
+                    config.getSection(null);
+                }
+                catch (IllegalStateException istex)
+                {
+                    error = true;
+                }
+            }
+        }
+    }
 }
diff --git a/xdocs/changes.xml b/xdocs/changes.xml
index e0a6c993..08150207 100644
--- a/xdocs/changes.xml
+++ b/xdocs/changes.xml
@@ -23,6 +23,10 @@
 
   <body>
     <release version="1.7" date="in SVN" description="">
+      <action dev="oheger" type="fix" issue="CONFIGURATION-407">
+        Fixed a potential IllegalStateException in HierarchicalINIConfiguration
+        that can be thrown when the global section is requested concurrently.
+      </action>
       <action dev="oheger" type="fix" issue="CONFIGURATION-405">
         XMLPropertyListConfiguration no longer throws a ConfigurationException
         if the file to be loaded does not have an outer dict element.
