diff --git a/src/changes/changes.xml b/src/changes/changes.xml
index 6a24dd79..b861a2ee 100644
--- a/src/changes/changes.xml
+++ b/src/changes/changes.xml
@@ -68,6 +68,10 @@ The <action> type attribute can be add,update,fix,remove.
           due-to="Alexander Sova" due-to-email="bird@noir.crocodile.org">
         Short files could cause an unexpected end of the item stream.
       </action>
+      <action dev="jochen" type="fix" issue="FILEUPLOAD-145">
+        A FileSizeLimitExceededException was deferred until the complete
+        file has been uploaded.
+      </action>
     </release>
 
 	<release version="1.2" date="2007-02-13">
diff --git a/src/java/org/apache/commons/fileupload/FileUploadBase.java b/src/java/org/apache/commons/fileupload/FileUploadBase.java
index ae330e83..ff4ca40d 100644
--- a/src/java/org/apache/commons/fileupload/FileUploadBase.java
+++ b/src/java/org/apache/commons/fileupload/FileUploadBase.java
@@ -28,6 +28,7 @@ import java.util.NoSuchElementException;
 
 import javax.servlet.http.HttpServletRequest;
 
+import org.apache.commons.fileupload.MultipartStream.ItemInputStream;
 import org.apache.commons.fileupload.servlet.ServletFileUpload;
 import org.apache.commons.fileupload.servlet.ServletRequestContext;
 import org.apache.commons.fileupload.util.Closeable;
@@ -715,11 +716,13 @@ public abstract class FileUploadBase {
                 fieldName = pFieldName;
                 contentType = pContentType;
                 formField = pFormField;
-                InputStream istream = multi.newInputStream();
+                final ItemInputStream itemStream = multi.newInputStream();
+                InputStream istream = itemStream;
                 if (fileSizeMax != -1) {
                     istream = new LimitedInputStream(istream, fileSizeMax) {
                         protected void raiseError(long pSizeMax, long pCount)
                                 throws IOException {
+                            itemStream.close(true);
                             FileUploadException e =
                                 new FileSizeLimitExceededException(
                                     "The field " + fieldName
diff --git a/src/java/org/apache/commons/fileupload/MultipartStream.java b/src/java/org/apache/commons/fileupload/MultipartStream.java
index 3e590ac5..3f606d72 100644
--- a/src/java/org/apache/commons/fileupload/MultipartStream.java
+++ b/src/java/org/apache/commons/fileupload/MultipartStream.java
@@ -897,18 +897,32 @@ public class MultipartStream {
          * @throws IOException An I/O error occurred.
          */
         public void close() throws IOException {
+            close(false);
+        }
+
+        /**
+         * Closes the input stream.
+         * @param pCloseUnderlying Whether to close the underlying stream (hard close)
+         * @throws IOException An I/O error occurred.
+         */
+        public void close(boolean pCloseUnderlying) throws IOException {
             if (closed) {
                 return;
             }
-            for (;;) {
-                int av = available();
-                if (av == 0) {
-                    av = makeAvailable();
+            if (pCloseUnderlying) {
+                closed = true;
+                input.close();
+            } else {
+                for (;;) {
+                    int av = available();
                     if (av == 0) {
-                        break;
+                        av = makeAvailable();
+                        if (av == 0) {
+                            break;
+                        }
                     }
+                    skip(av);
                 }
-                skip(av);
             }
             closed = true;
         }
